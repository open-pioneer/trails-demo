var _e=h=>{throw TypeError(h)};var xe=(h,e,x)=>e.has(h)||_e("Cannot "+x);var E=(h,e,x)=>(xe(h,e,"read from private field"),x?x.call(h):e.get(h)),q=(h,e,x)=>e.has(h)?_e("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(h):e.set(h,x),G=(h,e,x,b)=>(xe(h,e,"write to private field"),b?b.call(h,x):e.set(h,x),x),ie=(h,e,x)=>(xe(h,e,"access private method"),x);import{h as Pe,a1 as Me,G as Ne,j as A,n as He,l as Ke,a7 as Be,Z as ze,_ as De,a8 as Ve,c as qe,a as Je,b as Ye}from"./D2oXSZAF25Nh.js";import{r as Ge,A as $e,u as We,F as Xe}from"./B67hOg_U-Yp9.js";import{N as Qe,a as Ze}from"./LKojhJIlmLP8.js";import{H as er}from"./CNWmJGa2bJMS.js";import{_ as Fe}from"./CmsKOCeNyeyo.js";import{u as rr}from"./CEqcg7qjrBaf.js";import{B as Re}from"./ByauQZPFLiUp.js";import{C as tr,H as Ae}from"./D5d8MKrNO9TY.js";import{F as nr}from"./CJAaOOGk-WF8.js";import{V as Ie}from"./C01kSkQ--ETF.js";import{T as ae}from"./DfwCaCqN11zg.js";import{U as or,L as we}from"./Cuqg4Q-7MAjf.js";import{B as Ue}from"./CW9VlGYS245s.js";import"./DMyVcVfFoYJc.js";import"./CZpnpGhF6lFQ.js";const ee=Pe(function(e,x){const b=Me("Code",e),{className:L,...y}=Ne(e);return A.jsx(He.code,{ref:x,className:Ke("chakra-code",e.className),...y,__css:{display:"inline-block",...b}})});ee.displayName="Code";class ir{authService;constructor(e){this.authService=e.references.authService}beforeRequest({target:e,options:x}){const b=this.authService.getAuthState(),j=((b.kind=="authenticated"?b.sessionInfo:void 0)?.attributes?.keycloak).token;e.protocol==="https:"&&e.hostname==="ogc-api.nrw.de"&&j&&x.headers.set("Authorization",j)}}var Le={exports:{}};const ar={},sr=Object.freeze(Object.defineProperty({__proto__:null,default:ar},Symbol.toStringTag,{value:"Module"})),Ee=Be(sr);/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2024
 * @license MIT
 */(function(h){(function(){var e="input is invalid type",x=typeof window=="object",b=x?window:{};b.JS_SHA256_NO_WINDOW&&(x=!1);var L=!x&&typeof self=="object",y=!b.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;y?b=ze:L&&(b=self);var j=!b.JS_SHA256_NO_COMMON_JS&&!0&&h.exports,H=!b.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",m="0123456789abcdef".split(""),$=[-2147483648,8388608,32768,128],N=[24,16,8,0],ne=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],oe=["hex","array","digest","arrayBuffer"],C=[];(b.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"}),H&&(b.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(n){return typeof n=="object"&&n.buffer&&n.buffer.constructor===ArrayBuffer});var ve=function(n,f){return function(w){return new R(f,!0).update(w)[n]()}},ge=function(n){var f=ve("hex",n);y&&(f=D(f,n)),f.create=function(){return new R(n)},f.update=function(v){return f.create().update(v)};for(var w=0;w<oe.length;++w){var d=oe[w];f[d]=ve(d,n)}return f},D=function(n,f){var w=Ee,d=Ee.Buffer,v=f?"sha224":"sha256",u;d.from&&!b.JS_SHA256_NO_BUFFER_FROM?u=d.from:u=function(s){return new d(s)};var F=function(s){if(typeof s=="string")return w.createHash(v).update(s,"utf8").digest("hex");if(s==null)throw new Error(e);return s.constructor===ArrayBuffer&&(s=new Uint8Array(s)),Array.isArray(s)||ArrayBuffer.isView(s)||s.constructor===d?w.createHash(v).update(u(s)).digest("hex"):n(s)};return F},ke=function(n,f){return function(w,d){return new Z(w,f,!0).update(d)[n]()}},J=function(n){var f=ke("hex",n);f.create=function(v){return new Z(v,n)},f.update=function(v,u){return f.create(v).update(u)};for(var w=0;w<oe.length;++w){var d=oe[w];f[d]=ke(d,n)}return f};function R(n,f){f?(C[0]=C[16]=C[1]=C[2]=C[3]=C[4]=C[5]=C[6]=C[7]=C[8]=C[9]=C[10]=C[11]=C[12]=C[13]=C[14]=C[15]=0,this.blocks=C):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=n}R.prototype.update=function(n){if(!this.finalized){var f,w=typeof n;if(w!=="string"){if(w==="object"){if(n===null)throw new Error(e);if(H&&n.constructor===ArrayBuffer)n=new Uint8Array(n);else if(!Array.isArray(n)&&(!H||!ArrayBuffer.isView(n)))throw new Error(e)}else throw new Error(e);f=!0}for(var d,v=0,u,F=n.length,s=this.blocks;v<F;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,this.block=s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),f)for(u=this.start;v<F&&u<64;++v)s[u>>>2]|=n[v]<<N[u++&3];else for(u=this.start;v<F&&u<64;++v)d=n.charCodeAt(v),d<128?s[u>>>2]|=d<<N[u++&3]:d<2048?(s[u>>>2]|=(192|d>>>6)<<N[u++&3],s[u>>>2]|=(128|d&63)<<N[u++&3]):d<55296||d>=57344?(s[u>>>2]|=(224|d>>>12)<<N[u++&3],s[u>>>2]|=(128|d>>>6&63)<<N[u++&3],s[u>>>2]|=(128|d&63)<<N[u++&3]):(d=65536+((d&1023)<<10|n.charCodeAt(++v)&1023),s[u>>>2]|=(240|d>>>18)<<N[u++&3],s[u>>>2]|=(128|d>>>12&63)<<N[u++&3],s[u>>>2]|=(128|d>>>6&63)<<N[u++&3],s[u>>>2]|=(128|d&63)<<N[u++&3]);this.lastByteIndex=u,this.bytes+=u-this.start,u>=64?(this.block=s[16],this.start=u-64,this.hash(),this.hashed=!0):this.start=u}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},R.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,f=this.lastByteIndex;n[16]=this.block,n[f>>>2]|=$[f&3],this.block=n[16],f>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}},R.prototype.hash=function(){var n=this.h0,f=this.h1,w=this.h2,d=this.h3,v=this.h4,u=this.h5,F=this.h6,s=this.h7,_=this.blocks,T,O,P,B,I,V,r,t,i,l,o;for(T=16;T<64;++T)I=_[T-15],O=(I>>>7|I<<25)^(I>>>18|I<<14)^I>>>3,I=_[T-2],P=(I>>>17|I<<15)^(I>>>19|I<<13)^I>>>10,_[T]=_[T-16]+O+_[T-7]+P<<0;for(o=f&w,T=0;T<64;T+=4)this.first?(this.is224?(t=300032,I=_[0]-1413257819,s=I-150054599<<0,d=I+24177077<<0):(t=704751109,I=_[0]-210244248,s=I-1521486534<<0,d=I+143694565<<0),this.first=!1):(O=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),P=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7),t=n&f,B=t^n&w^o,r=v&u^~v&F,I=s+P+r+ne[T]+_[T],V=O+B,s=d+I<<0,d=I+V<<0),O=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),P=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),i=d&n,B=i^d&f^t,r=s&v^~s&u,I=F+P+r+ne[T+1]+_[T+1],V=O+B,F=w+I<<0,w=I+V<<0,O=(w>>>2|w<<30)^(w>>>13|w<<19)^(w>>>22|w<<10),P=(F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7),l=w&d,B=l^w&n^i,r=F&s^~F&v,I=u+P+r+ne[T+2]+_[T+2],V=O+B,u=f+I<<0,f=I+V<<0,O=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),P=(u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7),o=f&w,B=o^f&d^l,r=u&F^~u&s,I=v+P+r+ne[T+3]+_[T+3],V=O+B,v=n+I<<0,n=I+V<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+n<<0,this.h1=this.h1+f<<0,this.h2=this.h2+w<<0,this.h3=this.h3+d<<0,this.h4=this.h4+v<<0,this.h5=this.h5+u<<0,this.h6=this.h6+F<<0,this.h7=this.h7+s<<0},R.prototype.hex=function(){this.finalize();var n=this.h0,f=this.h1,w=this.h2,d=this.h3,v=this.h4,u=this.h5,F=this.h6,s=this.h7,_=m[n>>>28&15]+m[n>>>24&15]+m[n>>>20&15]+m[n>>>16&15]+m[n>>>12&15]+m[n>>>8&15]+m[n>>>4&15]+m[n&15]+m[f>>>28&15]+m[f>>>24&15]+m[f>>>20&15]+m[f>>>16&15]+m[f>>>12&15]+m[f>>>8&15]+m[f>>>4&15]+m[f&15]+m[w>>>28&15]+m[w>>>24&15]+m[w>>>20&15]+m[w>>>16&15]+m[w>>>12&15]+m[w>>>8&15]+m[w>>>4&15]+m[w&15]+m[d>>>28&15]+m[d>>>24&15]+m[d>>>20&15]+m[d>>>16&15]+m[d>>>12&15]+m[d>>>8&15]+m[d>>>4&15]+m[d&15]+m[v>>>28&15]+m[v>>>24&15]+m[v>>>20&15]+m[v>>>16&15]+m[v>>>12&15]+m[v>>>8&15]+m[v>>>4&15]+m[v&15]+m[u>>>28&15]+m[u>>>24&15]+m[u>>>20&15]+m[u>>>16&15]+m[u>>>12&15]+m[u>>>8&15]+m[u>>>4&15]+m[u&15]+m[F>>>28&15]+m[F>>>24&15]+m[F>>>20&15]+m[F>>>16&15]+m[F>>>12&15]+m[F>>>8&15]+m[F>>>4&15]+m[F&15];return this.is224||(_+=m[s>>>28&15]+m[s>>>24&15]+m[s>>>20&15]+m[s>>>16&15]+m[s>>>12&15]+m[s>>>8&15]+m[s>>>4&15]+m[s&15]),_},R.prototype.toString=R.prototype.hex,R.prototype.digest=function(){this.finalize();var n=this.h0,f=this.h1,w=this.h2,d=this.h3,v=this.h4,u=this.h5,F=this.h6,s=this.h7,_=[n>>>24&255,n>>>16&255,n>>>8&255,n&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,w>>>24&255,w>>>16&255,w>>>8&255,w&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,F>>>24&255,F>>>16&255,F>>>8&255,F&255];return this.is224||_.push(s>>>24&255,s>>>16&255,s>>>8&255,s&255),_},R.prototype.array=R.prototype.digest,R.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(this.is224?28:32),f=new DataView(n);return f.setUint32(0,this.h0),f.setUint32(4,this.h1),f.setUint32(8,this.h2),f.setUint32(12,this.h3),f.setUint32(16,this.h4),f.setUint32(20,this.h5),f.setUint32(24,this.h6),this.is224||f.setUint32(28,this.h7),n};function Z(n,f,w){var d,v=typeof n;if(v==="string"){var u=[],F=n.length,s=0,_;for(d=0;d<F;++d)_=n.charCodeAt(d),_<128?u[s++]=_:_<2048?(u[s++]=192|_>>>6,u[s++]=128|_&63):_<55296||_>=57344?(u[s++]=224|_>>>12,u[s++]=128|_>>>6&63,u[s++]=128|_&63):(_=65536+((_&1023)<<10|n.charCodeAt(++d)&1023),u[s++]=240|_>>>18,u[s++]=128|_>>>12&63,u[s++]=128|_>>>6&63,u[s++]=128|_&63);n=u}else if(v==="object"){if(n===null)throw new Error(e);if(H&&n.constructor===ArrayBuffer)n=new Uint8Array(n);else if(!Array.isArray(n)&&(!H||!ArrayBuffer.isView(n)))throw new Error(e)}else throw new Error(e);n.length>64&&(n=new R(f,!0).update(n).array());var T=[],O=[];for(d=0;d<64;++d){var P=n[d]||0;T[d]=92^P,O[d]=54^P}R.call(this,f,w),this.update(O),this.oKeyPad=T,this.inner=!0,this.sharedMemory=w}Z.prototype=new R,Z.prototype.finalize=function(){if(R.prototype.finalize.call(this),this.inner){this.inner=!1;var n=this.array();R.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(n),R.prototype.finalize.call(this)}};var K=ge();K.sha256=K,K.sha224=ge(!0),K.sha256.hmac=J(),K.sha224.hmac=J(!0),j?h.exports=K:(b.sha256=K.sha256,b.sha224=K.sha224)})()})(Le);var cr=Le.exports;const lr=De(cr);class fe extends Error{}fe.prototype.name="InvalidTokenError";function ur(h){return decodeURIComponent(atob(h).replace(/(.)/g,(e,x)=>{let b=x.charCodeAt(0).toString(16).toUpperCase();return b.length<2&&(b="0"+b),"%"+b}))}function fr(h){let e=h.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return ur(e)}catch{return atob(e)}}function be(h,e){if(typeof h!="string")throw new fe("Invalid token specified: must be a string");e||(e={});const x=e.header===!0?0:1,b=h.split(".")[x];if(typeof b!="string")throw new fe(`Invalid token specified: missing part #${x+1}`);let L;try{L=fr(b)}catch(y){throw new fe(`Invalid token specified: invalid base64 for part #${x+1} (${y.message})`)}try{return JSON.parse(L)}catch(y){throw new fe(`Invalid token specified: invalid json for part #${x+1} (${y.message})`)}}if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");function je(h){if(!(this instanceof je))throw new Error("The 'Keycloak' constructor must be invoked with 'new'.");for(var e=this,x,b=[],L,y={enable:!0,callbackList:[],interval:5},j=document.getElementsByTagName("script"),H=0;H<j.length;H++)(j[H].src.indexOf("keycloak.js")!==-1||j[H].src.indexOf("keycloak.min.js")!==-1)&&j[H].src.indexOf("version=")!==-1&&(e.iframeVersion=j[H].src.substring(j[H].src.indexOf("version=")+8).split("&")[0]);var m=!0,$=V(console.info),N=V(console.warn);e.init=function(r){if(e.didInitialize)throw new Error("A 'Keycloak' instance can only be initialized once.");e.didInitialize=!0,e.authenticated=!1,L=I();var t=["default","cordova","cordova-native"];if(r&&t.indexOf(r.adapter)>-1?x=O(r.adapter):r&&typeof r.adapter=="object"?x=r.adapter:window.Cordova||window.cordova?x=O("cordova"):x=O(),r){if(typeof r.useNonce<"u"&&(m=r.useNonce),typeof r.checkLoginIframe<"u"&&(y.enable=r.checkLoginIframe),r.checkLoginIframeInterval&&(y.interval=r.checkLoginIframeInterval),r.onLoad==="login-required"&&(e.loginRequired=!0),r.responseMode)if(r.responseMode==="query"||r.responseMode==="fragment")e.responseMode=r.responseMode;else throw"Invalid value for responseMode";if(r.flow){switch(r.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=r.flow}if(r.timeSkew!=null&&(e.timeSkew=r.timeSkew),r.redirectUri&&(e.redirectUri=r.redirectUri),r.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=r.silentCheckSsoRedirectUri),typeof r.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=r.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,typeof r.pkceMethod<"u"){if(r.pkceMethod!=="S256"&&r.pkceMethod!==!1)throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${r.pkceMethod}.`);e.pkceMethod=r.pkceMethod}else e.pkceMethod="S256";typeof r.enableLogging=="boolean"?e.enableLogging=r.enableLogging:e.enableLogging=!1,r.logoutMethod==="POST"?e.logoutMethod="POST":e.logoutMethod="GET",typeof r.scope=="string"&&(e.scope=r.scope),typeof r.acrValues=="string"&&(e.acrValues=r.acrValues),typeof r.messageReceiveTimeout=="number"&&r.messageReceiveTimeout>0?e.messageReceiveTimeout=r.messageReceiveTimeout:e.messageReceiveTimeout=1e4}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var i=v(),l=v();l.promise.then(function(){e.onReady&&e.onReady(e.authenticated),i.setSuccess(e.authenticated)}).catch(function(k){i.setError(k)});var o=R();function p(){var k=function(U){U||(S.prompt="none"),r&&r.locale&&(S.locale=r.locale),e.login(S).then(function(){l.setSuccess()}).catch(function(Y){l.setError(Y)})},g=function(){var U=document.createElement("iframe"),Y=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});U.setAttribute("src",Y),U.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),U.setAttribute("title","keycloak-silent-check-sso"),U.style.display="none",document.body.appendChild(U);var Q=function(z){if(!(z.origin!==window.location.origin||U.contentWindow!==z.source)){var ue=f(z.data);J(ue,l),document.body.removeChild(U),window.removeEventListener("message",Q)}};window.addEventListener("message",Q)},S={};switch(r.onLoad){case"check-sso":y.enable?F().then(function(){_().then(function(U){U?l.setSuccess():e.silentCheckSsoRedirectUri?g():k(!1)}).catch(function(U){l.setError(U)})}):e.silentCheckSsoRedirectUri?g():k(!1);break;case"login-required":k(!0);break;default:throw"Invalid value for onLoad"}}function a(){var k=f(window.location.href);if(k&&window.history.replaceState(window.history.state,null,k.newUrl),k&&k.valid)return F().then(function(){J(k,l)}).catch(function(g){l.setError(g)});r?r.token&&r.refreshToken?(K(r.token,r.refreshToken,r.idToken),y.enable?F().then(function(){_().then(function(g){g?(e.onAuthSuccess&&e.onAuthSuccess(),l.setSuccess(),s()):l.setSuccess()}).catch(function(g){l.setError(g)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),l.setSuccess()}).catch(function(g){e.onAuthError&&e.onAuthError(),r.onLoad?p():l.setError(g)})):r.onLoad?p():l.setSuccess():l.setSuccess()}function c(){var k=v(),g=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",g),k.setSuccess())};return document.addEventListener("readystatechange",g),g(),k.promise}return o.then(function(){c().then(T).then(a).catch(function(k){i.setError(k)})}),o.catch(function(k){i.setError(k)}),i.promise},e.login=function(r){return x.login(r)};function ne(r){var t=null,i=window.crypto||window.msCrypto;if(i&&i.getRandomValues&&window.Uint8Array)return t=new Uint8Array(r),i.getRandomValues(t),t;t=new Array(r);for(var l=0;l<t.length;l++)t[l]=Math.floor(256*Math.random());return t}function oe(r){return C(r,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function C(r,t){for(var i=ne(r),l=new Array(r),o=0;o<r;o++)l[o]=t.charCodeAt(i[o]%t.length);return String.fromCharCode.apply(null,l)}function ve(r,t){if(r!=="S256")throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${r}'.`);const i=new Uint8Array(lr.arrayBuffer(t));return dr(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function ge(r){var t={id_token:{acr:r}};return JSON.stringify(t)}e.createLoginUrl=function(r){var t=n(),i=n(),l=x.redirectUri(r),o={state:t,nonce:i,redirectUri:encodeURIComponent(l),loginOptions:r};r&&r.prompt&&(o.prompt=r.prompt);var p;r&&r.action=="register"?p=e.endpoints.register():p=e.endpoints.authorize();var a=r&&r.scope||e.scope;a?a.indexOf("openid")===-1&&(a="openid "+a):a="openid";var c=p+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(l)+"&state="+encodeURIComponent(t)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(a);if(m&&(c=c+"&nonce="+encodeURIComponent(i)),r&&r.prompt&&(c+="&prompt="+encodeURIComponent(r.prompt)),r&&r.maxAge&&(c+="&max_age="+encodeURIComponent(r.maxAge)),r&&r.loginHint&&(c+="&login_hint="+encodeURIComponent(r.loginHint)),r&&r.idpHint&&(c+="&kc_idp_hint="+encodeURIComponent(r.idpHint)),r&&r.action&&r.action!="register"&&(c+="&kc_action="+encodeURIComponent(r.action)),r&&r.locale&&(c+="&ui_locales="+encodeURIComponent(r.locale)),r&&r.acr){var k=ge(r.acr);c+="&claims="+encodeURIComponent(k)}if((r&&r.acrValues||e.acrValues)&&(c+="&acr_values="+encodeURIComponent(r.acrValues||e.acrValues)),e.pkceMethod){var g=oe(96);o.pkceCodeVerifier=g;var S=ve(e.pkceMethod,g);c+="&code_challenge="+S,c+="&code_challenge_method="+e.pkceMethod}return L.add(o),c},e.logout=function(r){return x.logout(r)},e.createLogoutUrl=function(r){if((r?.logoutMethod??e.logoutMethod)==="POST")return e.endpoints.logout();var i=e.endpoints.logout()+"?client_id="+encodeURIComponent(e.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(x.redirectUri(r,!1));return e.idToken&&(i+="&id_token_hint="+encodeURIComponent(e.idToken)),i},e.register=function(r){return x.register(r)},e.createRegisterUrl=function(r){return r||(r={}),r.action="register",e.createLoginUrl(r)},e.createAccountUrl=function(r){var t=D(),i=void 0;return typeof t<"u"&&(i=t+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(x.redirectUri(r))),i},e.accountManagement=function(){return x.accountManagement()},e.hasRealmRole=function(r){var t=e.realmAccess;return!!t&&t.roles.indexOf(r)>=0},e.hasResourceRole=function(r,t){if(!e.resourceAccess)return!1;var i=e.resourceAccess[t||e.clientId];return!!i&&i.roles.indexOf(r)>=0},e.loadUserProfile=function(){var r=D()+"/account",t=new XMLHttpRequest;t.open("GET",r,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+e.token);var i=v();return t.onreadystatechange=function(){t.readyState==4&&(t.status==200?(e.profile=JSON.parse(t.responseText),i.setSuccess(e.profile)):i.setError())},t.send(),i.promise},e.loadUserInfo=function(){var r=e.endpoints.userinfo(),t=new XMLHttpRequest;t.open("GET",r,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+e.token);var i=v();return t.onreadystatechange=function(){t.readyState==4&&(t.status==200?(e.userInfo=JSON.parse(t.responseText),i.setSuccess(e.userInfo)):i.setError())},t.send(),i.promise},e.isTokenExpired=function(r){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return $("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var t=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(r){if(isNaN(r))throw"Invalid minValidity";t-=r}return t<0},e.updateToken=function(r){var t=v();if(!e.refreshToken)return t.setError(),t.promise;r=r||5;var i=function(){var o=!1;if(r==-1?(o=!0,$("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(r))&&(o=!0,$("[KEYCLOAK] Refreshing token: token expired")),!o)t.setSuccess(!1);else{var p="grant_type=refresh_token&refresh_token="+e.refreshToken,a=e.endpoints.token();if(b.push(t),b.length==1){var c=new XMLHttpRequest;c.open("POST",a,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.withCredentials=!0,p+="&client_id="+encodeURIComponent(e.clientId);var k=new Date().getTime();c.onreadystatechange=function(){if(c.readyState==4)if(c.status==200){$("[KEYCLOAK] Token refreshed"),k=(k+new Date().getTime())/2;var g=JSON.parse(c.responseText);K(g.access_token,g.refresh_token,g.id_token,k),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var S=b.pop();S!=null;S=b.pop())S.setSuccess(!0)}else{N("[KEYCLOAK] Failed to refresh token"),c.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var S=b.pop();S!=null;S=b.pop())S.setError(!0)}},c.send(p)}}};if(y.enable){var l=_();l.then(function(){i()}).catch(function(o){t.setError(o)})}else i();return t.promise},e.clearToken=function(){e.token&&(K(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function D(){if(typeof e.authServerUrl<"u")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function ke(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function J(r,t){var i=r.code,l=r.error,o=r.prompt,p=new Date().getTime();if(r.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(r.kc_action_status),l){if(o!="none")if(r.error_description&&r.error_description==="authentication_expired")e.login(r.loginOptions);else{var a={error:l,error_description:r.error_description};e.onAuthError&&e.onAuthError(a),t&&t.setError(a)}else t&&t.setSuccess();return}else e.flow!="standard"&&(r.access_token||r.id_token)&&S(r.access_token,null,r.id_token,!0);if(e.flow!="implicit"&&i){var c="code="+i+"&grant_type=authorization_code",k=e.endpoints.token(),g=new XMLHttpRequest;g.open("POST",k,!0),g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c+="&client_id="+encodeURIComponent(e.clientId),c+="&redirect_uri="+r.redirectUri,r.pkceCodeVerifier&&(c+="&code_verifier="+r.pkceCodeVerifier),g.withCredentials=!0,g.onreadystatechange=function(){if(g.readyState==4)if(g.status==200){var U=JSON.parse(g.responseText);S(U.access_token,U.refresh_token,U.id_token,e.flow==="standard"),s()}else e.onAuthError&&e.onAuthError(),t&&t.setError()},g.send(c)}function S(U,Y,Q,z){p=(p+new Date().getTime())/2,K(U,Y,Q,p),m&&e.idTokenParsed&&e.idTokenParsed.nonce!=r.storedNonce?($("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),t&&t.setError()):z&&(e.onAuthSuccess&&e.onAuthSuccess(),t&&t.setSuccess())}}function R(r){var t=v(),i;h?typeof h=="string"&&(i=h):i="keycloak.json";function l(g){g?e.endpoints={authorize:function(){return g.authorization_endpoint},token:function(){return g.token_endpoint},logout:function(){if(!g.end_session_endpoint)throw"Not supported by the OIDC server";return g.end_session_endpoint},checkSessionIframe:function(){if(!g.check_session_iframe)throw"Not supported by the OIDC server";return g.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!g.userinfo_endpoint)throw"Not supported by the OIDC server";return g.userinfo_endpoint}}:e.endpoints={authorize:function(){return D()+"/protocol/openid-connect/auth"},token:function(){return D()+"/protocol/openid-connect/token"},logout:function(){return D()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var S=D()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(S=S+"?version="+e.iframeVersion),S},thirdPartyCookiesIframe:function(){var S=D()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(S=S+"?version="+e.iframeVersion),S},register:function(){return D()+"/protocol/openid-connect/registrations"},userinfo:function(){return D()+"/protocol/openid-connect/userinfo"}}}if(i){var o=new XMLHttpRequest;o.open("GET",i,!0),o.setRequestHeader("Accept","application/json"),o.onreadystatechange=function(){if(o.readyState==4)if(o.status==200||Z(o)){var g=JSON.parse(o.responseText);e.authServerUrl=g["auth-server-url"],e.realm=g.realm,e.clientId=g.resource,l(null),t.setSuccess()}else t.setError()},o.send()}else{if(!h.clientId)throw"clientId missing";e.clientId=h.clientId;var p=h.oidcProvider;if(p)if(typeof p=="string"){var k;p.charAt(p.length-1)=="/"?k=p+".well-known/openid-configuration":k=p+"/.well-known/openid-configuration";var o=new XMLHttpRequest;o.open("GET",k,!0),o.setRequestHeader("Accept","application/json"),o.onreadystatechange=function(){if(o.readyState==4)if(o.status==200||Z(o)){var S=JSON.parse(o.responseText);l(S),t.setSuccess()}else t.setError()},o.send()}else l(p),t.setSuccess();else{if(!h.url){for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++)if(a[c].src.match(/.*keycloak\.js/)){h.url=a[c].src.substr(0,a[c].src.indexOf("/js/keycloak.js"));break}}if(!h.realm)throw"realm missing";e.authServerUrl=h.url,e.realm=h.realm,l(null),t.setSuccess()}}return t.promise}function Z(r){return r.status==0&&r.responseText&&r.responseURL.startsWith("file:")}function K(r,t,i,l){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),t?(e.refreshToken=t,e.refreshTokenParsed=be(t)):(delete e.refreshToken,delete e.refreshTokenParsed),i?(e.idToken=i,e.idTokenParsed=be(i)):(delete e.idToken,delete e.idTokenParsed),r){if(e.token=r,e.tokenParsed=be(r),e.sessionId=e.tokenParsed.sid,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,l&&(e.timeSkew=Math.floor(l/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&($("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var o=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;$("[KEYCLOAK] Token expires in "+Math.round(o/1e3)+" s"),o<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,o)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function n(){var r="0123456789abcdef",t=C(36,r).split("");t[14]="4",t[19]=r.substr(t[19]&3|8,1),t[8]=t[13]=t[18]=t[23]="-";var i=t.join("");return i}function f(r){var t=w(r);if(t){var i=L.get(t.state);return i&&(t.valid=!0,t.redirectUri=i.redirectUri,t.storedNonce=i.nonce,t.prompt=i.prompt,t.pkceCodeVerifier=i.pkceCodeVerifier,t.loginOptions=i.loginOptions),t}}function w(r){var t;switch(e.flow){case"standard":t=["code","state","session_state","kc_action_status","iss"];break;case"implicit":t=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","iss"];break;case"hybrid":t=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","iss"];break}t.push("error"),t.push("error_description"),t.push("error_uri");var i=r.indexOf("?"),l=r.indexOf("#"),o,p;if(e.responseMode==="query"&&i!==-1?(o=r.substring(0,i),p=d(r.substring(i+1,l!==-1?l:r.length),t),p.paramsString!==""&&(o+="?"+p.paramsString),l!==-1&&(o+=r.substring(l))):e.responseMode==="fragment"&&l!==-1&&(o=r.substring(0,l),p=d(r.substring(l+1),t),p.paramsString!==""&&(o+="#"+p.paramsString)),p&&p.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((p.oauthParams.code||p.oauthParams.error)&&p.oauthParams.state)return p.oauthParams.newUrl=o,p.oauthParams}else if(e.flow==="implicit"&&(p.oauthParams.access_token||p.oauthParams.error)&&p.oauthParams.state)return p.oauthParams.newUrl=o,p.oauthParams}}function d(r,t){for(var i=r.split("&"),l={paramsString:"",oauthParams:{}},o=0;o<i.length;o++){var p=i[o].indexOf("="),a=i[o].slice(0,p);t.indexOf(a)!==-1?l.oauthParams[a]=i[o].slice(p+1):(l.paramsString!==""&&(l.paramsString+="&"),l.paramsString+=i[o])}return l}function v(){var r={setSuccess:function(t){r.resolve(t)},setError:function(t){r.reject(t)}};return r.promise=new Promise(function(t,i){r.resolve=t,r.reject=i}),r}function u(r,t,i){var l=null,o=new Promise(function(p,a){l=setTimeout(function(){a({error:i})},t)});return Promise.race([r,o]).finally(function(){clearTimeout(l)})}function F(){var r=v();if(!y.enable||y.iframe)return r.setSuccess(),r.promise;var t=document.createElement("iframe");y.iframe=t,t.onload=function(){var o=e.endpoints.authorize();o.charAt(0)==="/"?y.iframeOrigin=ke():y.iframeOrigin=o.substring(0,o.indexOf("/",8)),r.setSuccess()};var i=e.endpoints.checkSessionIframe();t.setAttribute("src",i),t.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),t.setAttribute("title","keycloak-session-iframe"),t.style.display="none",document.body.appendChild(t);var l=function(o){if(!(o.origin!==y.iframeOrigin||y.iframe.contentWindow!==o.source)&&(o.data=="unchanged"||o.data=="changed"||o.data=="error")){o.data!="unchanged"&&e.clearToken();for(var p=y.callbackList.splice(0,y.callbackList.length),a=p.length-1;a>=0;--a){var c=p[a];o.data=="error"?c.setError():c.setSuccess(o.data=="unchanged")}}};return window.addEventListener("message",l,!1),r.promise}function s(){y.enable&&e.token&&setTimeout(function(){_().then(function(r){r&&s()})},y.interval*1e3)}function _(){var r=v();if(y.iframe&&y.iframeOrigin){var t=e.clientId+" "+(e.sessionId?e.sessionId:"");y.callbackList.push(r);var i=y.iframeOrigin;y.callbackList.length==1&&y.iframe.contentWindow.postMessage(t,i)}else r.setSuccess();return r.promise}function T(){var r=v();if(y.enable||e.silentCheckSsoRedirectUri){var t=document.createElement("iframe");t.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),t.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),t.setAttribute("title","keycloak-3p-check-iframe"),t.style.display="none",document.body.appendChild(t);var i=function(l){t.contentWindow===l.source&&(l.data!=="supported"&&l.data!=="unsupported"||(l.data==="unsupported"&&(N(`[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:

 - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).
 - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).

For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers`),y.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1)),document.body.removeChild(t),window.removeEventListener("message",i),r.setSuccess()))};window.addEventListener("message",i,!1)}else r.setSuccess();return u(r.promise,e.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function O(r){if(!r||r=="default")return{login:function(a){return window.location.assign(e.createLoginUrl(a)),v().promise},logout:async function(a){if((a?.logoutMethod??e.logoutMethod)==="GET"){window.location.replace(e.createLogoutUrl(a));return}const k=e.createLogoutUrl(a),g=await fetch(k,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id_token_hint:e.idToken,client_id:e.clientId,post_logout_redirect_uri:x.redirectUri(a,!1)})});if(g.redirected){window.location.href=g.url;return}if(g.ok){window.location.reload();return}throw new Error("Logout failed, request returned an error code.")},register:function(a){return window.location.assign(e.createRegisterUrl(a)),v().promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u")window.location.href=a;else throw"Not supported by the OIDC server";return v().promise},redirectUri:function(a,c){return a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(r=="cordova"){y.enable=!1;var t=function(a,c,k){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(a,c,k):window.open(a,c,k)},i=function(a){return a&&a.cordovaOptions?Object.keys(a.cordovaOptions).reduce(function(c,k){return c[k]=a.cordovaOptions[k],c},{}):{}},l=function(a){return Object.keys(a).reduce(function(c,k){return c.push(k+"="+a[k]),c},[]).join(",")},o=function(a){var c=i(a);return c.location="no",a&&a.prompt=="none"&&(c.hidden="yes"),l(c)},p=function(){return e.redirectUri||"http://localhost"};return{login:function(a){var c=v(),k=o(a),g=e.createLoginUrl(a),S=t(g,"_blank",k),U=!1,Y=!1,Q=function(){Y=!0,S.close()};return S.addEventListener("loadstart",function(z){if(z.url.indexOf(p())==0){var ue=f(z.url);J(ue,c),Q(),U=!0}}),S.addEventListener("loaderror",function(z){if(!U)if(z.url.indexOf(p())==0){var ue=f(z.url);J(ue,c),Q(),U=!0}else c.setError(),Q()}),S.addEventListener("exit",function(z){Y||c.setError({reason:"closed_by_user"})}),c.promise},logout:function(a){var c=v(),k=e.createLogoutUrl(a),g=t(k,"_blank","location=no,hidden=yes,clearcache=yes"),S;return g.addEventListener("loadstart",function(U){U.url.indexOf(p())==0&&g.close()}),g.addEventListener("loaderror",function(U){U.url.indexOf(p())==0||(S=!0),g.close()}),g.addEventListener("exit",function(U){S?c.setError():(e.clearToken(),c.setSuccess())}),c.promise},register:function(a){var c=v(),k=e.createRegisterUrl(),g=o(a),S=t(k,"_blank",g);return S.addEventListener("loadstart",function(U){if(U.url.indexOf(p())==0){S.close();var Y=f(U.url);J(Y,c)}}),c.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u"){var c=t(a,"_blank","location=no");c.addEventListener("loadstart",function(k){k.url.indexOf(p())==0&&c.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(a){return p()}}}if(r=="cordova-native")return y.enable=!1,{login:function(a){var c=v(),k=e.createLoginUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var S=f(g.url);J(S,c)}),window.cordova.plugins.browsertab.openUrl(k),c.promise},logout:function(a){var c=v(),k=e.createLogoutUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),c.setSuccess()}),window.cordova.plugins.browsertab.openUrl(k),c.promise},register:function(a){var c=v(),k=e.createRegisterUrl(a);return universalLinks.subscribe("keycloak",function(g){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var S=f(g.url);J(S,c)}),window.cordova.plugins.browsertab.openUrl(k),c.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u")window.cordova.plugins.browsertab.openUrl(a);else throw"Not supported by the OIDC server"},redirectUri:function(a){return a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+r}var P=function(){if(!(this instanceof P))return new P;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var r=this;function t(){for(var i=new Date().getTime(),l=0;l<localStorage.length;l++){var o=localStorage.key(l);if(o&&o.indexOf("kc-callback-")==0){var p=localStorage.getItem(o);if(p)try{var a=JSON.parse(p).expires;(!a||a<i)&&localStorage.removeItem(o)}catch{localStorage.removeItem(o)}}}}r.get=function(i){if(i){var l="kc-callback-"+i,o=localStorage.getItem(l);return o&&(localStorage.removeItem(l),o=JSON.parse(o)),t(),o}},r.add=function(i){t();var l="kc-callback-"+i.state;i.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(l,JSON.stringify(i))}},B=function(){if(!(this instanceof B))return new B;var r=this;r.get=function(o){if(o){var p=i("kc-callback-"+o);if(l("kc-callback-"+o,"",t(-100)),p)return JSON.parse(p)}},r.add=function(o){l("kc-callback-"+o.state,JSON.stringify(o),t(60))},r.removeItem=function(o){l(o,"",t(-100))};var t=function(o){var p=new Date;return p.setTime(p.getTime()+o*60*1e3),p},i=function(o){for(var p=o+"=",a=document.cookie.split(";"),c=0;c<a.length;c++){for(var k=a[c];k.charAt(0)==" ";)k=k.substring(1);if(k.indexOf(p)==0)return k.substring(p.length,k.length)}return""},l=function(o,p,a){var c=o+"="+p+"; expires="+a.toUTCString()+"; ";document.cookie=c}};function I(){try{return new P}catch{}return new B}function V(r){return function(){e.enableLogging&&r.apply(console,Array.prototype.slice.call(arguments))}}}function dr(h){const e=String.fromCodePoint(...h);return btoa(e)}const W=qe("authentication-keycloak:KeycloakAuthPlugin");var he,se,re,M,ce,le,te,pe,me,X,Oe,de;class hr{constructor(e){q(this,X);q(this,he);q(this,se);q(this,re);q(this,M);q(this,ce);q(this,le);q(this,te);q(this,pe);q(this,me,Ge({kind:"pending"}));G(this,he,e.references.notifier),G(this,se,e.intl),G(this,ce,{redirectUri:void 0}),G(this,le,{redirectUri:void 0});try{G(this,re,pr(e.properties))}catch(x){throw new Error("Invalid keycloak configuration",{cause:x})}try{G(this,M,new je(E(this,re).keycloakConfig))}catch(x){throw new Error("Failed to construct keycloak instance",{cause:x})}ie(this,X,Oe).call(this).catch(x=>{ie(this,X,de).call(this,{kind:"error",error:x}),E(this,he).notify({level:"error",title:E(this,se).formatMessage({id:"loginFailed.title"}),message:E(this,se).formatMessage({id:"loginFailed.message"})}),W.error("Failed to check if user is authenticated",x)})}destroy(){clearInterval(E(this,te)),G(this,pe,Ve(E(this,pe))),G(this,te,void 0)}getAuthState(){return E(this,me).value}getLoginBehavior(){return{kind:"effect",login:()=>{W.debug("Login with options",E(this,le)),E(this,M).login(E(this,le))}}}logout(){W.debug("Logout with options",E(this,ce)),E(this,M).logout(E(this,ce))}__refresh(e,x){clearInterval(E(this,te)),G(this,te,setInterval(()=>{E(this,M).updateToken(x).catch(b=>{W.error("Failed to refresh token",b),ie(this,X,de).call(this,{kind:"not-authenticated"}),this.destroy()})},e))}}he=new WeakMap,se=new WeakMap,re=new WeakMap,M=new WeakMap,ce=new WeakMap,le=new WeakMap,te=new WeakMap,pe=new WeakMap,me=new WeakMap,X=new WeakSet,Oe=async function(){const e=E(this,re),x=E(this,re).keycloakInitOptions,b=e.refreshOptions;let L;try{L=await E(this,M).init(x)}catch(y){const j=typeof y=="string"?new Error(y):y;throw new Error("Failed to initialize keycloak session",{cause:j})}L?(ie(this,X,de).call(this,{kind:"authenticated",sessionInfo:{userId:E(this,M).subject?E(this,M).subject:"undefined",userName:E(this,M).idTokenParsed?.preferred_username,attributes:{keycloak:E(this,M),familyName:E(this,M).idTokenParsed?.family_name,givenName:E(this,M).idTokenParsed?.given_name,userName:E(this,M).idTokenParsed?.preferred_username}}}),W.debug(`User ${E(this,M).subject} is authenticated`),b.autoRefresh&&(W.debug("Starting auto-refresh",b),this.__refresh(b.interval,b.timeLeft))):(ie(this,X,de).call(this,{kind:"not-authenticated"}),W.debug("User is not authenticated"))},de=function(e){E(this,me).value=e};const Te={autoRefresh:!0,interval:6e3,timeLeft:70},Ce={onLoad:"check-sso",pkceMethod:"S256"};function pr(h){const{keycloakOptions:e}=h,{refreshOptions:x,keycloakInitOptions:b,keycloakConfig:L}=e;return{refreshOptions:{...mr(x)},keycloakInitOptions:{...vr(b)},keycloakConfig:{...gr(L)}}}function mr(h){return!h||Se(h)?(W.warn(`The autorefresh options of the Keycloak configuration should be set to ensure automatic refreshes at specified intervals. Defaulting to '${Te}'.`),Object.assign({},{...Te})):h}function vr(h){return!h||Se(h)?(W.warn(`The Keycloak init options of the keycloak configuration should be set. Defaulting to '${Ce}'.`),Object.assign({},{...Ce})):h}function gr(h){if(!h||Se(h))throw new Error("KeycloakConfig not found: The Keycloak configuration options are required by the plugin to perform login and logout operations");return h}const Se=h=>h&&Object.keys(h).length===0&&h.constructor===Object,kr={"keycloak-sample":{name:"keycloak-sample",services:{SampleTokenInterceptor:{name:"SampleTokenInterceptor",clazz:ir,provides:[{name:"http.Interceptor",qualifier:void 0}],references:{authService:{name:"authentication.AuthService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1},{name:"http.HttpService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:$e,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Qe,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/reactivity":{name:"@open-pioneer/reactivity",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:er,provides:[{name:"http.HttpService",qualifier:void 0}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/authentication-keycloak":{name:"@open-pioneer/authentication-keycloak",services:{KeycloakAuthPlugin:{name:"KeycloakAuthPlugin",clazz:hr,provides:[{name:"authentication.AuthPlugin",qualifier:void 0},{name:"authentication-keycloak.KeycloakAuthPlugin",qualifier:void 0}],references:{notifier:{name:"notifier.NotificationService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{keycloakOptions:{value:{refreshOptions:null,keycloakInitOptions:null,keycloakConfig:null,keycloakLogoutOptions:null,keycloakLoginOptions:null},required:!1}}}},xr="",wr=["de","en"];function br(h){switch(h){case"de":return Fe(()=>import("./DHsSmHrBD0L-.js"),[],import.meta.url).then(e=>e.default);case"en":return Fe(()=>import("./DOFgVa_i9Fer.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${h}'`)}const yr=Je(xr),Sr=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:br,locales:wr,packages:kr,styles:yr},Symbol.toStringTag,{value:"Module"})),_r="keycloak-sample",ye=rr.bind(void 0,_r);function Fr(){const h=ye("authentication.AuthService"),e=()=>{h.logout()};return A.jsx(Re,{colorScheme:"red",onClick:e,children:"Log out"})}function Ar(){const h=ye("authentication.AuthService"),e=ye("http.HttpService"),x=We(h),L=(x.kind=="authenticated"?x.sessionInfo:void 0)?.userName,y=()=>{e.fetch("https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json").catch(j=>console.error("Request failed",j))};return A.jsxs(A.Fragment,{children:[A.jsx(Ze,{}),A.jsxs(tr,{maxW:"800px",children:[A.jsxs(nr,{height:"100%",direction:"column",overflow:"hidden",children:[A.jsx(Ae,{as:"h1",size:"2xl",children:"Keycloak Sample"}),A.jsxs(Ie,{mt:4,spacing:2,align:"stretch",children:[A.jsx(Ae,{as:"h2",size:"xl",children:"Additional Setup"}),A.jsx(ae,{children:"This application requires additional setup. Most importantly, a Keycloak installation must be present."}),A.jsxs(ae,{children:["The following environment properties should be set via vite (e.g. in"," ",A.jsx(ee,{children:".env.local"}),"):"]}),A.jsxs(or,{children:[A.jsxs(we,{children:[A.jsx(ee,{children:"VITE_KEYCLOAK_CONFIG_URL"})," (the URL to the Keycloak instance)"]}),A.jsxs(we,{children:[A.jsx(ee,{children:"VITE_KEYCLOAK_CONFIG_REALM"})," (the Keycloak realm)"]}),A.jsxs(we,{children:[A.jsx(ee,{children:"VITE_KEYCLOAK_CONFIG_CLIENT_ID"})," (the client id of this application)"]})]}),A.jsxs(ae,{textAlign:"center",children:[A.jsx(ae,{as:"b",children:"Status: "}),L!=null?A.jsxs(A.Fragment,{children:["Logged in as ",A.jsx(ee,{children:L}),"."]}):A.jsx(A.Fragment,{children:"Not logged in."})]})]})]}),A.jsx(Xe,{renderErrorFallback:j=>A.jsxs(A.Fragment,{children:[A.jsx(Ue,{children:"An Error occured while trying to login!"}),A.jsx(Ue,{color:"red",children:j.message})]}),children:A.jsxs(Ie,{align:"center",p:10,mt:2,spacing:3,border:"2px solid red",borderRadius:5,children:[A.jsx(ae,{textAlign:"center",children:"This part of the application is only visible when logged in."}),A.jsx(Fr,{}),A.jsxs(ae,{children:["The following button triggers a request against a backend. The request will automatically include the Keycloak token (see"," ",A.jsx(ee,{children:"SampleTokenInterceptor.ts"}),"):"]}),A.jsx(Re,{onClick:y,children:"Trigger Request With Token"})]})})]})]})}const Ir=new URLSearchParams(window.location.search),Ur=Ir.get("lang")||void 0,Er=Ye({component:Ar,appMetadata:Sr,config:{properties:{"@open-pioneer/authentication-keycloak":{keycloakOptions:{refreshOptions:{autoRefresh:!0,interval:6e3,timeLeft:70},keycloakInitOptions:{onLoad:"check-sso",pkceMethod:"S256"},keycloakConfig:{url:void 0,realm:void 0,clientId:void 0}}}},locale:Ur}});customElements.define("keycloak-app-element",Er);
