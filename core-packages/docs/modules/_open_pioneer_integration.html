<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@open-pioneer/integration - v2.3.0 | Trails Packages</title><meta name="description" content="Documentation for Trails Packages"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Trails Packages</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">Trails Packages</a></li><li><a href="_open_pioneer_integration.html">@open-pioneer/integration</a></li></ul><h1>Module @open-pioneer/integration - v2.3.0</h1></div><section class="tsd-panel tsd-typography"><a id="md:open-pioneerintegration" class="tsd-anchor"></a><h1 class="tsd-anchor-link">@open-pioneer/integration<a href="#md:open-pioneerintegration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>This package provides techniques for the communication between an application (web component) and its embedding site.
This is useful when the application's web component is embedded into another site.</p>
<p>The package exports the <code>ApiExtension</code> interface that can be used to provide API functions that can be called from the outer site to trigger actions in the web component.
The ApiExtension support is implemented in the <code>@open-pioneer/runtime</code> package.</p>
<p>Additionally, the package contains the <code>ExternalEventService</code>,
which can be used to emit events to the host site from inside the Open Pioneer Trails application.</p>
<a id="md:usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#md:usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:web-component-api" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Web component API<a href="#md:web-component-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To provide API functions a service providing <code>&quot;integration.ApiExtension&quot;</code> needs to be implemented.
The service must implement the <code>ApiExtension</code> interface with its <code>getApiMethods()</code> function.
The functions returned by <code>getApiMethods()</code> will be available as methods on the web component's API.</p>
<p>For example:</p>
<pre><code class="js"><span class="hl-3">// build.config.mjs</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">defineBuildConfig</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-7">&quot;@open-pioneer/build-support&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-4">default</span><span class="hl-1"> </span><span class="hl-6">defineBuildConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">ExampleApiExtension:</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">provides:</span><span class="hl-1"> </span><span class="hl-7">&quot;integration.ApiExtension&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            ...</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        ...</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    ...</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-3">// TextApiExtension.ts</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">ServiceOptions</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-7">&quot;@open-pioneer/runtime&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">ApiExtension</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-7">&quot;@open-pioneer/integration&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// implement ApiExtension interface</span><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-0">class</span><span class="hl-1"> </span><span class="hl-9">TextApiExtension</span><span class="hl-1"> </span><span class="hl-0">implements</span><span class="hl-1"> </span><span class="hl-9">ApiExtension</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">// returns a set of methods that will be added to the web component&#39;s API.</span><br/><span class="hl-1">    </span><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-6">getApiMethods</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-4">return</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-3">// exampleMethodName method is available</span><br/><span class="hl-1">            </span><span class="hl-6">exampleMethodName</span><span class="hl-5">:</span><span class="hl-1"> (</span><span class="hl-5">sampleParameter</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-3">// do something</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">        };</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>To use the API methods in the surrounding site, call the <code>when()</code> method on the app.
It resolves to the app's API when the application has started.
It is then possible to call the provided methods on the returned API instance.</p>
<p>For example:</p>
<pre><code class="html"><span class="hl-8">&lt;!</span><span class="hl-13">doctype</span><span class="hl-1"> </span><span class="hl-10">html</span><span class="hl-8">&gt;</span><br/><span class="hl-8">&lt;</span><span class="hl-13">html</span><span class="hl-1"> </span><span class="hl-10">lang</span><span class="hl-1">=</span><span class="hl-14">&quot;en&quot;</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    ...</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-13">body</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-13">api-app</span><span class="hl-1"> </span><span class="hl-10">id</span><span class="hl-1">=</span><span class="hl-14">&quot;app&quot;</span><span class="hl-8">&gt;&lt;/</span><span class="hl-13">api-app</span><span class="hl-8">&gt;</span><br/><span class="hl-1">        </span><span class="hl-8">&lt;</span><span class="hl-13">script</span><span class="hl-12"> </span><span class="hl-10">type</span><span class="hl-12">=</span><span class="hl-14">&quot;module&quot;</span><span class="hl-12"> </span><span class="hl-10">src</span><span class="hl-12">=</span><span class="hl-14">&quot;example-path/app.ts&quot;</span><span class="hl-8">&gt;&lt;/</span><span class="hl-13">script</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;/</span><span class="hl-13">body</span><span class="hl-8">&gt;</span><br/><span class="hl-1">    </span><span class="hl-8">&lt;</span><span class="hl-13">script</span><span class="hl-8">&gt;</span><br/><span class="hl-12">        </span><span class="hl-5">customElements</span><span class="hl-12">.</span><span class="hl-6">whenDefined</span><span class="hl-12">(</span><span class="hl-7">&quot;api-app&quot;</span><span class="hl-12">).</span><span class="hl-6">then</span><span class="hl-12">(() </span><span class="hl-0">=&gt;</span><span class="hl-12"> {</span><br/><span class="hl-12">            </span><span class="hl-0">const</span><span class="hl-12"> </span><span class="hl-2">app</span><span class="hl-12"> </span><span class="hl-1">=</span><span class="hl-12"> </span><span class="hl-5">document</span><span class="hl-12">.</span><span class="hl-6">getElementById</span><span class="hl-12">(</span><span class="hl-7">&quot;app&quot;</span><span class="hl-12">);</span><br/><span class="hl-12">            </span><span class="hl-5">app</span><span class="hl-12">.</span><span class="hl-6">when</span><span class="hl-12">().</span><span class="hl-6">then</span><span class="hl-12">((</span><span class="hl-5">api</span><span class="hl-12">) </span><span class="hl-0">=&gt;</span><span class="hl-12"> {</span><br/><span class="hl-12">                </span><span class="hl-5">api</span><span class="hl-12">.</span><span class="hl-6">exampleMethodName</span><span class="hl-12">(</span><span class="hl-7">&quot;Example string&quot;</span><span class="hl-12">);</span><br/><span class="hl-12">            });</span><br/><span class="hl-12">        });</span><br/><span class="hl-12">    </span><span class="hl-8">&lt;/</span><span class="hl-13">script</span><span class="hl-8">&gt;</span><br/><span class="hl-8">&lt;/</span><span class="hl-13">html</span><span class="hl-8">&gt;</span>
</code><button type="button">Copy</button></pre>

<blockquote>
<p>Note: The <code>when()</code> method is implemented as a method on the custom element class generated by the <code>createCustomElement()</code> function in the runtime package.
It is available once the web component is defined (which is why the example code waits by calling <code>customElements.whenDefined</code>).</p>
</blockquote>
<a id="md:externaleventservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ExternalEventService<a href="#md:externaleventservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In your UI or one of your services, reference the <code>&quot;integration.ExternalEventService&quot;</code> interface to obtain an instance of the <code>ExternalEventService</code>.
For example:</p>
<pre><code class="js"><span class="hl-3">// build.config.mjs</span><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-4">default</span><span class="hl-1"> </span><span class="hl-6">defineBuildConfig</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">services:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-5">YourService:</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">references:</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-5">eventService:</span><span class="hl-1"> </span><span class="hl-7">&quot;integration.ExternalEventService&quot;</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Then, call <code>emitEvent</code> on the service to emit an event:</p>
<pre><code class="js"><span class="hl-3">// Emits a new custom event from the web component.</span><br/><span class="hl-3">//</span><br/><span class="hl-3">// The second parameter supports arbitrary payloads.</span><br/><span class="hl-3">// It will be transported in the CustomEvent&#39;s `detail` property.</span><br/><span class="hl-3">//</span><br/><span class="hl-3">// See also https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail</span><br/><span class="hl-5">eventService</span><span class="hl-1">.</span><span class="hl-6">emitEvent</span><span class="hl-1">(</span><span class="hl-7">&quot;extent-selected&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-5">extent:</span><span class="hl-1"> ...</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">// You can also emit your own event instances (subclasses of the browser&#39;s Event class etc.)</span><br/><span class="hl-5">eventService</span><span class="hl-1">.</span><span class="hl-6">emitEvent</span><span class="hl-1">(</span><span class="hl-0">new</span><span class="hl-1"> </span><span class="hl-6">CustomEvent</span><span class="hl-1">(...));</span>
</code><button type="button">Copy</button></pre>

<p>The events are emitted on the application's host node.
You can subscribe to them from outside the application via <code>addEventListener</code>:</p>
<pre><code class="js"><span class="hl-3">/* If the html looks like this:</span><br/><span class="hl-3">    &lt;html&gt;</span><br/><span class="hl-3">        &lt;body&gt;</span><br/><span class="hl-3">            &lt;my-pioneer-app id=&quot;app&quot;&gt;&lt;/my-pioneer-app&gt;</span><br/><span class="hl-3">        &lt;/body&gt;</span><br/><span class="hl-3">    &lt;/html&gt;</span><br/><span class="hl-3">*/</span><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">app</span><span class="hl-1"> = </span><span class="hl-5">document</span><span class="hl-1">.</span><span class="hl-6">getElementById</span><span class="hl-1">(</span><span class="hl-7">&quot;app&quot;</span><span class="hl-1">);</span><br/><span class="hl-5">app</span><span class="hl-1">.</span><span class="hl-6">addEventListener</span><span class="hl-1">(</span><span class="hl-7">&quot;extent-selected&quot;</span><span class="hl-1">, (</span><span class="hl-5">event</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-7">&quot;Selected extent:&quot;</span><span class="hl-1">, </span><span class="hl-5">event</span><span class="hl-1">.</span><span class="hl-5">detail</span><span class="hl-1">.</span><span class="hl-5">extent</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#md:license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Apache-2.0 (see <code>LICENSE</code> file)</p>
</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Interfaces</h3><div class="tsd-index-list"><a href="../interfaces/_open_pioneer_integration.ApiExtension.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>Api<wbr/>Extension</span></a>
<a href="../interfaces/_open_pioneer_integration.ExternalEventService.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-256"></use></svg><span>External<wbr/>Event<wbr/>Service</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Type Aliases</h3><div class="tsd-index-list"><a href="../types/_open_pioneer_integration.ApiMethod.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Api<wbr/>Method</span></a>
<a href="../types/_open_pioneer_integration.ApiMethods.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2097152"></use></svg><span>Api<wbr/>Methods</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Variables</h3><div class="tsd-index-list"><a href="../variables/_open_pioneer_integration.default.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-32"></use></svg><span>default</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:open-pioneerintegration"><span>@open-<wbr/>pioneer/integration</span></a><ul><li><a href="#md:usage"><span>Usage</span></a></li><li><ul><li><a href="#md:web-component-api"><span>Web component API</span></a></li><li><a href="#md:externaleventservice"><span>External<wbr/>Event<wbr/>Service</span></a></li></ul></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>Trails Packages</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
