var Vo=Object.defineProperty;var Bo=(s,e,t)=>e in s?Vo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var It=(s,e,t)=>(Bo(s,typeof e!="symbol"?e+"":e,t),t),ct=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var E=(s,e,t)=>(ct(s,e,"read from private field"),t?t.call(s):e.get(s)),D=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},O=(s,e,t,o)=>(ct(s,e,"write to private field"),o?o.call(s,t):e.set(s,t),t);var F=(s,e,t)=>(ct(s,e,"access private method"),t);import{c as Ee,f as Go,j as c,r as g,i as xt,E as K,a as Oe,b as Uo,B as St,C as zo,t as $o,u as Ho,R as Wo,A as dt,d as ut,F as qo,e as Ko}from"./106ba7f1a803.js";import{t as Yo}from"./31d9a1ccbdfc.js";import{g as wt,u as me,S as Zo,c as Xo,i as Jo,f as Qo,d as es,r as ts,a as ue,T as kt,O as no,V as je,b as Ne,v as io,P as os,F as ss,e as ns,h as At,s as is,n as rs,j as Rt,k as as,I as ls,E as ro,M as J,l as cs,m as ds,o as ao,p as ne,q as Ye,t as Dt,w as us,B as lo,x as nt,y as hs,z as co,A as ps,C as fs,D as uo,G as gs,H as ms,J as Ot,K as vs,L as bs,N as ws,Q as _s,R as ys,U as xs,W as ho,X as po,Y as Ss,Z as ks,_ as fo,$ as Cs,a0 as Z,a1 as go,a2 as Es,a3 as Se,a4 as mo,a5 as Ie,a6 as ae,a7 as Ps,a8 as Ms,a9 as Ts,aa as vo,ab as Ls,ac as jt,ad as bo,ae as Is,af as Nt,ag as As,ah as ht,ai as Rs,aj as Ft,ak as Ds,al as Os,am as js,an as Ns,ao as Fs,ap as Vs,aq as Vt,ar as Bs,as as Gs,at as Us,au as zs,av as Ve}from"./b43e50dd44f1.js";import{W as wo,P as _o,a as yo,b as $s,c as Hs,d as Ws}from"./0a738be4f67a.js";import{W as qs,a as Ks}from"./63b27f633195.js";import{u as oe,T as Te,c as it,a as Be,S as Ge}from"./19f63b64ac76.js";import{G as rt,M as Ys,a as xo,b as So,c as Zs,T as Xs}from"./fad79756258d.js";import{N as Js,u as _t,a as Qs}from"./613d1c800b5c.js";import{_ as Bt,G as en}from"./4695bf11ddfb.js";import{u as ce,a as Ct}from"./c4dd8eb87831.js";import{T as Fe}from"./d96189fcb954.js";import{B as G}from"./5c77848511f6.js";import{E as tn}from"./960f2965a833.js";import{I as on,Z as sn,a as nn}from"./66863548a90b.js";import{L as ve}from"./fcff1d2afdb5.js";import{F as rn}from"./040a72e8f888.js";import{F as an}from"./682136e91845.js";import{H as ln}from"./737d5cc44209.js";import{S as cn}from"./ef29400d4dbd.js";import{c as dn}from"./4cfa7387829d.js";import{c as de,S as un}from"./449ae6682a50.js";import{F as ie}from"./e730329648f9.js";import{L as hn}from"./3bda207f1c2d.js";import{S as pn}from"./28bb26c297d6.js";import{V as Gt}from"./1581ba41e476.js";import{I as fn}from"./fa41ce6dda2d.js";import{D as gn}from"./2685b0968796.js";import"./c5d63cd676bd.js";import"./b3b926b3826d.js";import"./a051a301c677.js";import"./1c45633833ac.js";import"./fa8a8a73112e.js";var ko=Ee("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});ko.displayName="Center";var mn={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};Go(function(e,t){const{axis:o="both",...n}=e;return c.jsx(Ee.div,{ref:t,__css:mn[o],...n,position:"absolute"})});const vn=25.4/.28,bn=39.37;function Et(s){return Pt(s,wn,_n)}function wn(s){return s.getView()}function _n(s,e){return s.on("change:view",e)}function Co(s){return Et(s)?.getProjection()}function yn(s){const e=Et(s);return Pt(e,xn,Sn)}function xn(s){return s.getResolution()}function Sn(s,e){return s.on("change:resolution",e)}function kn(s){const e=Et(s);return Pt(e,Cn,En)}function Cn(s){return s.getCenter()}function En(s,e){return s.on("change:center",e)}function Pn(s){const e=kn(s),t=yn(s),o=Co(s);return g.useMemo(()=>{if(o==null||t==null||e==null)return;const i=wt(o,t,e);return Math.round(i*bn*vn)},[o,t,e])}function Pt(s,e,t){const o=g.useCallback(()=>s?e(s):void 0,[s,e]),n=g.useCallback(i=>{if(!s)return()=>{};const r=t(s,i);return()=>me(r)},[s,t]);return g.useSyncExternalStore(n,o)}class at extends Zo{constructor(e,t,o){super(),o!==void 0&&t===void 0?this.setFlatCoordinates(o,e):(t=t||0,this.setCenterAndRadius(e,t,o))}clone(){const e=new at(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,o,n){const i=this.flatCoordinates,r=e-i[0],a=t-i[1],l=r*r+a*a;if(l<n){if(l===0)for(let d=0;d<this.stride;++d)o[d]=i[d];else{const d=this.getRadius()/Math.sqrt(l);o[0]=i[0]+d*r,o[1]=i[1]+d*a;for(let u=2;u<this.stride;++u)o[u]=i[u]}return o.length=this.stride,l}return n}containsXY(e,t){const o=this.flatCoordinates,n=e-o[0],i=t-o[1];return n*n+i*i<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,o=t[this.stride]-t[0];return Xo(t[0]-o,t[1]-o,t[0]+o,t[1]+o,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(Jo(e,t)){const o=this.getCenter();return e[0]<=o[0]&&e[2]>=o[0]||e[1]<=o[1]&&e[3]>=o[1]?!0:Qo(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,o=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+o;for(let i=1;i<t;++i)n[t+i]=e[i];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(e,t,o){this.setLayout(o,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let i=es(n,0,e,this.stride);n[i++]=n[0]+t;for(let r=1,a=this.stride;r<a;++r)n[i++]=n[r];n.length=i,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const o=this.getCenter(),n=this.getStride();this.setCenter(ts(o,0,o.length,n,e,t,o)),this.changed()}}at.prototype.transform;const Mn=at,B="main";class Tn{mapId=B;async getMapConfig(){return{initialView:{kind:"position",center:{x:404747,y:5757920},zoom:14},projection:"EPSG:25832",layers:[new ue({id:"topplus_open",title:"TopPlus Open",isBaseLayer:!0,visible:!0,healthCheck:"https://sgx.geodatenzentrum.de/wmts_topplus_open/1.0.0/WMTSCapabilities.xml",olLayer:pt("web")}),new ue({id:"topplus_open_grau",title:"TopPlus Open (Grau)",isBaseLayer:!0,visible:!1,olLayer:pt("web_grau")}),new ue({id:"topplus_open_light",title:"TopPlus Open (Light)",isBaseLayer:!0,visible:!1,olLayer:pt("web_light")}),new ue({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new kt({source:new no})}),new ue({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:Ln()}),new ue({title:"Kindertagesstätten",visible:!0,olLayer:In()}),An(),Rn()]}}}function pt(s){const e=[-380316598427299e-8,880590808284866e-8],t=[4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.874056570353,76.4370282851763,38.2185141425881,19.1092570712941,9.55462853564703,4.77731426782352,2.38865713391176,1.19432856695588,.59716428347794],o=new Array(t.length);for(let i=0;i<t.length;i++)o[i]=i;const n=new qs({url:`https://sgx.geodatenzentrum.de/wmts_topplus_open/tile/1.0.0/${s}/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png`,layer:"web_grau",matrixSet:"EU_EPSG_25832_TOPPLUS",format:"image/png",projection:"EPSG:25832",requestEncoding:"REST",tileGrid:new Ks({origin:e,resolutions:t,matrixIds:o}),style:"default",attributions:`Kartendarstellung und Präsentationsgraphiken: © Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html" target="_blank">Datenquellen</a>`});return new kt({source:n})}function Ln(){const s=new je({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new rt,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new Ne({source:s})}function In(){const s=new je({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new rt,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new Ne({source:s})}function An(){return new wo({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW"}],sourceOptions:{ratio:1}})}function Rn(){return new wo({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",sublayers:[{name:"1",title:"Verwaltungen"},{name:"4",title:"Abschnitte und Äste"},{name:"6",title:"Unfälle"}]})}var $,Ae,Re,Je,Eo,Qe,Po;class Dn{constructor(e){D(this,Je);D(this,Qe);It(this,"label");D(this,$,void 0);D(this,Ae,void 0);D(this,Re,void 0);this.label=e.label,O(this,$,e);const{baseUrl:t,params:o}=jn(e.baseUrl);O(this,Ae,t),O(this,Re,o)}async search(e,{mapProjection:t,maxResults:o,signal:n}){const i=F(this,Qe,Po).call(this,e,o),r=new rt({dataProjection:"EPSG:4326",featureProjection:t});return(await On(i,n)).features.map(l=>F(this,Je,Eo).call(this,l,r))}}$=new WeakMap,Ae=new WeakMap,Re=new WeakMap,Je=new WeakSet,Eo=function(e,t){const o=E(this,$).renderLabel?.(e),n=e.properties[E(this,$).labelProperty],i=e.properties[E(this,$).searchProperty],r=(()=>o||(n!==void 0?String(n):i!==void 0?String(i):""))();return{id:e.id??io(),label:r,geometry:t.readGeometry(e.geometry),properties:e.properties}},Qe=new WeakSet,Po=function(e,t){const o=new URL(`${E(this,Ae)}/collections/${E(this,$).collectionId}/items`);for(const[n,i]of E(this,Re))o.searchParams.append(n,i);return o.searchParams.set(E(this,$).searchProperty,`*${e}*`),o.searchParams.set("limit",String(t)),o.searchParams.set("f","json"),E(this,$).rewriteUrl?.(new URL(o))??o};async function On(s,e){try{const t=await fetch(s,{signal:e,headers:{Accept:"application/json"}});if(!t.ok)throw new Error("Request failed with status "+t.status);return await t.json()}catch(t){throw xt(t)?t:new Error("Failed to search on OGC API Features service",{cause:t})}}function jn(s){const e=new URL(s),t=new URLSearchParams(e.searchParams);return e.search="",{baseUrl:e.href.replace(/\/+$/,""),params:t}}class Nn{label;filteredTypes;constructor(e,t){this.label=e,this.filteredTypes=t}async request(e,t,o){const n=new URL("https://photon.komoot.io/api?");n.searchParams.set("q",e),n.searchParams.set("lang","de"),n.searchParams.set("lat","51.961563"),n.searchParams.set("lon","7.628202"),n.searchParams.set("limit",t.toString());const i=await fetch(n,{signal:o});if(!i.ok)throw new Error("Request failed: "+i.status);return await i.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}async search(e,{mapProjection:t,signal:o}){const n=await this.request(e,100,o),i=new rt({dataProjection:"EPSG:4326",featureProjection:t});return n.features.filter(r=>this.filteredTypes.includes(r.properties.type)).map((r,a)=>{const l=i.readGeometry(r.geometry);return{id:r.properties.osm_id||a,label:this.createLabel(r),geometry:l,properties:r.properties}})}}class Fn{intl;constructor({intl:e}){this.intl=e}getSearchSources(){return[new Dn({label:this.intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(t){const o=t?.properties?.name,n=t?.id;return typeof o=="string"?o+" ("+n+")":String(n)},rewriteUrl(t){return t.searchParams.set("properties","name"),t}}),new Nn("Photon Geocoder",["city","street"])]}}const Ue={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class ze extends lo{constructor(e,t){super(e),this.feature=t}}function Vn(s,e){const t=[];for(let o=0;o<e.length;++o){const i=e[o].getGeometry();Mo(s,i,t)}return t}function $e(s,e){return co(s[0],s[1],e[0],e[1])}function fe(s,e){const t=s.length;return e<0?s[e+t]:e>=t?s[e-t]:s[e]}function He(s,e,t){let o,n;e<t?(o=e,n=t):(o=t,n=e);const i=Math.ceil(o),r=Math.floor(n);if(i>r){const l=ge(s,o),d=ge(s,n);return $e(l,d)}let a=0;if(o<i){const l=ge(s,o),d=fe(s,i);a+=$e(l,d)}if(r<n){const l=fe(s,r),d=ge(s,n);a+=$e(l,d)}for(let l=i;l<r-1;++l){const d=fe(s,l),u=fe(s,l+1);a+=$e(d,u)}return a}function Mo(s,e,t){if(e instanceof ve){We(s,e.getCoordinates(),!1,t);return}if(e instanceof xo){const o=e.getCoordinates();for(let n=0,i=o.length;n<i;++n)We(s,o[n],!1,t);return}if(e instanceof nt){const o=e.getCoordinates();for(let n=0,i=o.length;n<i;++n)We(s,o[n],!0,t);return}if(e instanceof So){const o=e.getCoordinates();for(let n=0,i=o.length;n<i;++n){const r=o[n];for(let a=0,l=r.length;a<l;++a)We(s,r[a],!0,t)}return}if(e instanceof Zs){const o=e.getGeometries();for(let n=0;n<o.length;++n)Mo(s,o[n],t);return}}const ft={index:-1,endIndex:NaN};function Bn(s,e,t,o){const n=s[0],i=s[1];let r=1/0,a=-1,l=NaN;for(let p=0;p<e.targets.length;++p){const f=e.targets[p],v=f.coordinates;let x=1/0,C;for(let T=0;T<v.length-1;++T){const R=v[T],L=v[T+1],M=To(n,i,R,L);M.squaredDistance<x&&(x=M.squaredDistance,C=T+M.along)}x<r&&(r=x,f.ring&&e.targetIndex===p&&(f.endIndex>f.startIndex?C<f.startIndex&&(C+=v.length):f.endIndex<f.startIndex&&C>f.startIndex&&(C-=v.length)),l=C,a=p)}const d=e.targets[a];let u=d.ring;if(e.targetIndex===a&&u){const p=ge(d.coordinates,l),f=t.getPixelFromCoordinate(p);ao(f,e.startPx)>o&&(u=!1)}if(u){const p=d.coordinates,f=p.length,v=d.startIndex,x=l;if(v<x){const C=He(p,v,x);He(p,v,x-f)<C&&(l-=f)}else{const C=He(p,v,x);He(p,v,x+f)<C&&(l+=f)}}return ft.index=a,ft.endIndex=l,ft}function We(s,e,t,o){const n=s[0],i=s[1];for(let r=0,a=e.length-1;r<a;++r){const l=e[r],d=e[r+1],u=To(n,i,l,d);if(u.squaredDistance===0){const p=r+u.along;o.push({coordinates:e,ring:t,startIndex:p,endIndex:p});return}}}const gt={along:0,squaredDistance:0};function To(s,e,t,o){const n=t[0],i=t[1],r=o[0],a=o[1],l=r-n,d=a-i;let u=0,p=n,f=i;return(l!==0||d!==0)&&(u=fs(((s-n)*l+(e-i)*d)/(l*l+d*d),0,1),p+=l*u,f+=d*u),gt.along=u,gt.squaredDistance=hs(co(s,e,p,f),10),gt}function ge(s,e){const t=s.length;let o=Math.floor(e);const n=e-o;o>=t?o-=t:o<0&&(o+=t);let i=o+1;i>=t&&(i-=t);const r=s[o],a=r[0],l=r[1],d=s[i],u=d[0]-a,p=d[1]-l;return[a+u*n,l+p*n]}class Gn extends os{constructor(e){const t=e;t.stopDown||(t.stopDown=ss),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=zn(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:ns,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let o=e.geometryFunction;if(!o){const n=this.mode_;if(n==="Circle")o=function(i,r,a){const l=r||new Mn([NaN,NaN]),d=At(i[0]),u=is(d,At(i[i.length-1]));return l.setCenterAndRadius(d,Math.sqrt(u),this.geometryLayout_),l};else{let i;n==="Point"?i=Ye:n==="LineString"?i=ve:n==="Polygon"&&(i=nt),o=function(r,a,l){return a?n==="Polygon"?r[0].length?a.setCoordinates([r[0].concat([r[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(r,this.geometryLayout_):a=new i(r,this.geometryLayout_),a}}}this.geometryFunction_=o,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Ne({source:new je({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:Un(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:rs,this.freehandCondition_,e.freehand?this.freehandCondition_=Rt:this.freehandCondition_=e.freehandCondition?e.freehandCondition:as,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(ls.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=Rt:t=e:t=ps,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===ro.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===J.POINTERMOVE,o=!0;return!this.freehand_&&this.lastDragTime_&&e.type===J.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===J.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),o=!1):this.freehand_&&e.type===J.POINTERDOWN?o=!1:t&&this.getPointerCount()<2?(o=e.type===J.POINTERMOVE,o&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===J.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===J.DBLCLICK&&(o=!1),super.handleEvent(e)&&o}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new cs(J.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),o=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),n=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),i=ds([o,n]),r=this.traceSource_.getFeaturesInExtent(i);if(r.length===0)return;const a=Vn(e.coordinate,r);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const o=e.startIndex<=e.endIndex,n=e.startIndex<=t;o===n?o&&t>e.endIndex||!o&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(o&&t<e.endIndex||!o&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let o=0;if(e<t){const n=Math.ceil(e);let i=Math.floor(t);i===t&&(i-=1),o=i-n+1}else{const n=Math.floor(e);let i=Math.ceil(t);i===t&&(i+=1),o=n-i+1}o>0&&this.removeLastPoints_(o)}addTracedCoordinates_(e,t,o){if(t===o)return;const n=[];if(t<o){const i=Math.ceil(t);let r=Math.floor(o);r===o&&(r-=1);for(let a=i;a<=r;++a)n.push(fe(e.coordinates,a))}else{const i=Math.floor(t);let r=Math.ceil(o);r===o&&(r+=1);for(let a=i;a>=r;--a)n.push(fe(e.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&ao(t.startPx,e.pixel)<this.snapTolerance_)return;const o=Bn(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==o.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=t.targets[o.index];this.addTracedCoordinates_(a,a.startIndex,o.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,o.endIndex)}t.targetIndex=o.index;const n=t.targets[t.targetIndex];n.endIndex=o.endIndex;const i=ge(n.coordinates,n.endIndex),r=this.getMap().getPixelFromCoordinate(i);e.coordinate=i,e.pixel=[Math.round(r[0]),Math.round(r[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const o=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(e.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(e.pixel,o)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,o=e.pixel,n=t[0]-o[0],i=t[1]-o[1],r=n*n+i*i;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let o=!1;if(this.sketchFeature_){let n=!1,i=[this.finishCoordinate_];const r=this.mode_;if(r==="Point")o=!0;else if(r==="Circle")o=this.sketchCoords_.length===2;else if(r==="LineString")n=!t&&this.sketchCoords_.length>this.minPoints_;else if(r==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,i=[a[0][0],a[0][a[0].length-2]],t?i=[a[0][0]]:i=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let l=0,d=i.length;l<d;l++){const u=i[l],p=a.getPixelFromCoordinate(u),f=e[0]-p[0],v=e[1]-p[1],x=this.freehand_?1:this.snapTolerance_;if(o=Math.sqrt(f*f+v*v)<=x,o){this.finishCoordinate_=u;break}}}}return o}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ne(new Ye(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new ne);const t=e.getLinearRing(0);let o=this.sketchLine_.getGeometry();o?(o.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),o.changed()):(o=new ve(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(o))}startDrawing_(e){const t=this.getMap().getView().getProjection(),o=Dt(this.geometryLayout_);for(;e.length<o;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ne(new ve(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new ne,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new ze(Ue.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),o=this.sketchFeature_.getGeometry(),n=t.getView().getProjection(),i=Dt(this.geometryLayout_);let r,a;for(;e.length<i;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(r=this.sketchCoords_[0],a=r[r.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(r=this.sketchCoords_,a=r[r.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,o,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),o.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(o):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection();let n,i;const r=this.mode_;r==="LineString"||r==="Circle"?(this.finishCoordinate_=e.slice(),i=this.sketchCoords_,i.length>=this.maxPoints_&&(this.freehand_?i.pop():n=!0),i.push(e.slice()),this.geometryFunction_(i,t,o)):r==="Polygon"&&(i=this.sketchCoords_[0],i.length>=this.maxPoints_&&(this.freehand_?i.pop():n=!0),i.push(e.slice()),n&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,t,o)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),n&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection(),n=this.mode_;for(let i=0;i<e;++i){let r;if(n==="LineString"||n==="Circle"){if(r=this.sketchCoords_,r.splice(-2,1),r.length>=2){this.finishCoordinate_=r[r.length-2].slice();const a=this.finishCoordinate_.slice();r[r.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(r,t,o),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(n==="Polygon"){r=this.sketchCoords_[0],r.splice(-2,1);const a=this.sketchLine_.getGeometry();if(r.length>=2){const l=r[r.length-2].slice();r[r.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(r),this.geometryFunction_(this.sketchCoords_,t,o)}if(r.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const o=e.getGeometry(),n=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,o,n)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,o,n),t=o.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Ys([t])):this.type_==="MultiLineString"?e.setGeometry(new xo([t])):this.type_==="MultiPolygon"&&e.setGeometry(new So([t])),this.dispatchEvent(new ze(Ue.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new ze(Ue.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,o=!this.sketchFeature_;o&&this.startDrawing_(e[0]);let n;if(t==="LineString"||t==="Circle")n=this.sketchCoords_;else if(t==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;o&&n.shift(),n.pop();for(let r=0;r<e.length;r++)this.addToDrawing_(e[r]);const i=e[e.length-1];this.addToDrawing_(i),this.modifyDrawing_(i)}extend(e){const o=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=o.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new ne(new Ye(n)),this.updateSketchFeatures_(),this.dispatchEvent(new ze(Ue.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function Un(){const s=us();return function(e,t){return s[e.getGeometry().getType()]}}function zn(s){switch(s){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+s)}}const $n=Gn,A={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Hn={ERROR:"error"};class Wn extends lo{constructor(e){super(Hn.ERROR),this.code=e.code,this.message=e.message}}let qn=class extends uo{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=gs,this.watchId_=void 0,this.addChangeListener(A.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(A.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=ms(Ot("EPSG:4326"),e),this.position_&&this.set(A.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(A.ACCURACY,t.accuracy),this.set(A.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(A.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(A.HEADING,t.heading===null?void 0:vs(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const o=this.transform_(this.position_);this.set(A.POSITION,o.slice()),this.set(A.SPEED,t.speed===null?void 0:t.speed);const n=bs(this.position_,t.accuracy);n.applyTransform(this.transform_),this.set(A.ACCURACY_GEOMETRY,n),this.changed()}positionError_(e){this.dispatchEvent(new Wn(e))}getAccuracy(){return this.get(A.ACCURACY)}getAccuracyGeometry(){return this.get(A.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(A.ALTITUDE)}getAltitudeAccuracy(){return this.get(A.ALTITUDE_ACCURACY)}getHeading(){return this.get(A.HEADING)}getPosition(){return this.get(A.POSITION)}getProjection(){return this.get(A.PROJECTION)}getSpeed(){return this.get(A.SPEED)}getTracking(){return this.get(A.TRACKING)}getTrackingOptions(){return this.get(A.TRACKING_OPTIONS)}setProjection(e){this.set(A.PROJECTION,Ot(e))}setTracking(e){this.set(A.TRACKING,e)}setTrackingOptions(e){this.set(A.TRACKING_OPTIONS,e)}};const Kn=qn,V={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Yn extends uo{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+ws,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(V.ELEMENT,this.handleElementChanged),this.addChangeListener(V.MAP,this.handleMapChanged),this.addChangeListener(V.OFFSET,this.handleOffsetChanged),this.addChangeListener(V.POSITION,this.handlePositionChanged),this.addChangeListener(V.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(V.ELEMENT)}getId(){return this.id}getMap(){return this.get(V.MAP)||null}getOffset(){return this.get(V.OFFSET)}getPosition(){return this.get(V.POSITION)}getPositioning(){return this.get(V.POSITIONING)}handleElementChanged(){_s(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(ys(this.element),xs(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=ho(e,po.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(V.ELEMENT,e)}setMap(e){this.set(V.MAP,e)}setOffset(e){this.set(V.OFFSET,e)}setPosition(e){this.set(V.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(V.POSITION))return;const o=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),i=this.getRect(n,[Ss(n),ks(n)]);e=e||{};const r=e.margin===void 0?20:e.margin;if(!fo(o,i)){const a=i[0]-o[0],l=o[2]-i[2],d=i[1]-o[1],u=o[3]-i[3],p=[0,0];if(a<0?p[0]=a-r:l<0&&(p[0]=Math.abs(l)+r),d<0?p[1]=d-r:u<0&&(p[1]=Math.abs(u)+r),p[0]!==0||p[1]!==0){const f=t.getView().getCenterInternal(),v=t.getPixelFromCoordinateInternal(f);if(!v)return;const x=[v[0]+p[0],v[1]+p[1]],C=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(x),duration:C.duration,easing:C.easing})}}}getRect(e,t){const o=e.getBoundingClientRect(),n=o.left+window.pageXOffset,i=o.top+window.pageYOffset;return[n,i,n+t[0],i+t[1]]}setPositioning(e){this.set(V.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const o=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(o,n)}updateRenderedPosition(e,t){const o=this.element.style,n=this.getOffset(),i=this.getPositioning();this.setVisible(!0);const r=Math.round(e[0]+n[0])+"px",a=Math.round(e[1]+n[1])+"px";let l="0%",d="0%";i=="bottom-right"||i=="center-right"||i=="top-right"?l="-100%":(i=="bottom-center"||i=="center-center"||i=="top-center")&&(l="-50%"),i=="bottom-left"||i=="bottom-center"||i=="bottom-right"?d="-100%":(i=="center-left"||i=="center-center"||i=="center-right")&&(d="-50%");const u=`translate(${l}, ${d}) translate(${r}, ${a})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,o.transform=u)}getOptions(){return this.options}}const yt=Yn;class Zn{constructor({properties:e}){const t=e.logLevel;console.debug("Log Service created with log level",t)}destroy(){console.debug("Log Service destroyed")}log(e){console.info("LOG: "+e)}}const le=Oe("local-storage"),Xn=0,Y={CORRUPTED_DATA:"local-storage:corrupted-data",INVALID_PATH:"local-storage:invalid-path",INVALID_VALUE:"local-storage:invalid-value",NOT_SUPPORTED:"local-storage:not-supported",INTERNAL:"local-storage:internal-error"};var be,H,ee,we,W,et,Lo,tt,Io,re,Le,te,pe,ot,Ao;class Jn{constructor(e){D(this,et);D(this,tt);D(this,re);D(this,te);D(this,ot);D(this,be,void 0);D(this,H,{});D(this,ee,void 0);D(this,we,void 0);D(this,W,void 0);O(this,be,oi(e.properties)),O(this,ee,si()),E(this,ee)&&(F(this,tt,Io).call(this),O(this,we,F(this,ot,Ao).call(this)))}destroy(){E(this,W)&&(clearTimeout(E(this,W)),O(this,W,void 0)),E(this,ee)&&F(this,re,Le).call(this)}get isSupported(){return!!E(this,we)}get(e){return F(this,te,pe).call(this).get(e)}set(e,t){return F(this,te,pe).call(this).set(e,t)}remove(e){return F(this,te,pe).call(this).remove(e)}removeAll(){return F(this,te,pe).call(this).removeAll()}getNamespace(e){return F(this,te,pe).call(this).getNamespace(e)}}be=new WeakMap,H=new WeakMap,ee=new WeakMap,we=new WeakMap,W=new WeakMap,et=new WeakSet,Lo=function(){E(this,W)&&clearTimeout(E(this,W)),O(this,W,setTimeout(()=>{O(this,W,void 0),F(this,re,Le).call(this)},Xn))},tt=new WeakSet,Io=function(){try{const e=E(this,ee);if(!e)throw new K(Y.INTERNAL,"Local storage is not available.");const t=e.getItem(E(this,be));if(t==null){O(this,H,{}),F(this,re,Le).call(this);return}try{const o=JSON.parse(t);if(!ke(o))throw new K(Y.CORRUPTED_DATA,"Persisted value should be an object.");O(this,H,o)}catch(o){le.warn("Invalid persisted data, reverting to default.",o),O(this,H,{}),F(this,re,Le).call(this)}}catch(e){le.error("Failed to load from local storage",e)}},re=new WeakSet,Le=function(){try{const e=E(this,ee);if(!e)throw new K(Y.INTERNAL,"Local storage is not available.");const t=JSON.stringify(E(this,H));e.setItem(E(this,be),t)}catch(e){le.error("Failed to save to local storage",e)}},te=new WeakSet,pe=function(){const e=E(this,we);if(!e)throw new K(Y.NOT_SUPPORTED,"Local storage is not supported by this browser.");return e},ot=new WeakSet,Ao=function(){const e={getByPath:t=>zt(Qn(E(this,H),t)),setByPath:(t,o)=>{if(!ti(o))throw new K(Y.INVALID_VALUE,"The value is not supported by local storage.");if(o=zt(o),t.length===0){if(!ke(o))throw new K(Y.INVALID_VALUE,"The root value must be a plain object.");O(this,H,o)}else ei(E(this,H),t,o);F(this,et,Lo).call(this)}};return new Mt([],e)};class Mt{path;access;constructor(e,t){this.path=e,this.access=t}get(e){return this.access.getByPath([...this.path,e])}set(e,t){this.access.setByPath([...this.path,e],t)}remove(e){this.access.setByPath([...this.path,e],void 0)}removeAll(){this.access.setByPath(this.path,{})}getNamespace(e){const t=this.get(e);if(t===void 0)this.set(e,{});else if(!ke(t))throw new K(Y.INVALID_PATH,`Cannot use '${e}' as a namespace because it is not associated with an object.`);return new Mt(this.path.concat([e]),this.access)}}const Ut="trails-state";function Qn(s,e){let t=s;for(const o of e){if(!ke(t))throw new K(Y.INVALID_PATH,`Cannot get nested property '${o}' because the parent is no object.`);t=t[o]}return t}function ei(s,e,t){if(!e.length)throw new K(Y.INTERNAL,"Path must not be empty.");let o=s;for(let i=0,r=e.length-1;i<r;++i){const a=e[i],l=o[a];if(!ke(l))throw new K(Y.INVALID_PATH,`Cannot set property on '${a}' because it is no object.`);o=l}const n=e[e.length-1];o[n]=t}function ke(s){return!!(s&&typeof s=="object"&&!Array.isArray(s))}function ti(s){const e=typeof s;return e==="boolean"||e==="number"||e==="string"||e==="undefined"||s===null||Array.isArray(s)||ke(s)}function oi(s){const e=s.storageId;return!e||typeof e!="string"?(le.warn(`The 'storageId' property of the 'local-storage' package should be set to a valid string to avoid collisions with other applications. Defaulting to '${Ut}'.`),Ut):e}function si(){if(typeof Storage>"u"){le.warn("Local storage is not supported by this browser.");return}try{const s=globalThis.localStorage;if(!s){le.warn("Local storage is not supported by this browser.");return}return s}catch(s){le.warn("Local storage is not supported by this browser.",s);return}}function zt(s){return s!=null&&(s=JSON.parse(JSON.stringify(s))),s}const ni={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:Tn,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{}},AppConfig:{name:"AppConfig",clazz:Fn,provides:[{name:"ol-app.AppConfig",qualifier:void 0}],references:{}}},ui:{references:[{name:"map-sample-logging.LogService",qualifier:void 0,all:!1},{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppConfig",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:Cs,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Js,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"map-sample-logging":{name:"map-sample-logging",services:{LogService:{name:"LogService",clazz:Zn,provides:[{name:"map-sample-logging.LogService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{logLevel:{value:"INFO",required:!1}}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:Jn,provides:[{name:"local-storage.LocalStorageService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}}},ii=`@media only screen and (max-width: 500px){.search-top-center-placement{position:absolute;left:0;top:0;width:100%;z-index:1}}@media only screen and (min-width: 501px){.search-top-center-placement{position:absolute;left:50%;top:0;transform:translate(-50%);width:500px;z-index:1}}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}
`,ri=["en","de"];function ai(s){switch(s){case"en":return Bt(()=>import("./58f528125a3e.js"),[],import.meta.url).then(e=>e.default);case"de":return Bt(()=>import("./2a797aae8c98.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${s}'`)}const li=Uo(ii),ci=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:ai,locales:ri,packages:ni,styles:li},Symbol.toStringTag,{value:"Module"})),di="@open-pioneer/coordinate-viewer",ui=ce.bind(void 0,di),hi=4,pi=s=>{const{mapId:e,precision:t}=s,{containerProps:o}=oe("coordinate-viewer",s),{map:n}=Z(e),i=n?.olMap,{coordinates:r}=gi(i),a=fi(r,t),l=Co(i)?.getCode()??"",d=a?a+" "+l:"";return c.jsx(G,{...o,children:c.jsx(Fe,{className:"coordinate-viewer-text",children:d})})};function fi(s,e){const t=ui();return s?mi(s,e,t):""}function gi(s){const[e,t]=g.useState();return g.useEffect(()=>{if(!s)return;const o=s.on("pointermove",n=>{t(n.coordinate)});return()=>me(o)},[s]),{coordinates:e}}function mi(s,e,t){if(s[0]==null||s[1]==null)return"";const o=e??hi,[n,i]=s,r=t.formatNumber(n,{maximumFractionDigits:o,minimumFractionDigits:o}),a=t.formatNumber(i,{maximumFractionDigits:o,minimumFractionDigits:o});return r+" "+a}const Ro="@open-pioneer/geolocation",vi=Ct.bind(void 0,Ro),bi=ce.bind(void 0,Ro);function wi(s){return en({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(s)}const $t=Oe("geolocation:GeolocationController"),Ht=17;class _i extends tn{olMap;positionHighlightLayer;geolocation;maxZoom=Ht;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new ne,this.accuracyFeature.setStyle(qt()),this.positionFeature=new ne,this.positionFeature.setStyle(Wt()),this.positionHighlightLayer=new Ne({source:new je({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(go);const o=t||yi();this.geolocation=new Kn({tracking:!1,trackingOptions:o,projection:e.getView()?.getProjection()}),this.trackingOptions=o,this.geolocation.on("error",n=>this.handleGeolocationError(n))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(o=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const n=this.geolocation.on("change:accuracyGeometry",()=>{const l=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(l),this.accuracyFeature?.getGeometry()!==void 0&&o(),this.isInitialZoom){const d=this?.accuracyFeature?.getGeometry()?.getExtent();if(d){const u=Es(d);if(!u)return;e.getView().fit(u,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),i=this.geolocation.on("change:position",()=>{const l=this.geolocation.getPosition();l&&(l[0]||l[1])!==void 0&&(this.positionFeature?.setGeometry(new Ye(l)),this.setMapToPosition&&e.getView().setCenter(l),this.positionFeature?.getGeometry()!==void 0&&o())}),r=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",l=>{l.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(n,i,r,a),e.addLayer(this.positionHighlightLayer)}).catch(o=>{$t.error("Failed to determine location",o)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{me(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??Wt())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??qt())}setMaxZoom(e){this.maxZoom=e??Ht}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){$t.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const Wt=()=>new Se({image:new mo({radius:6,fill:new Ie({color:"#3399CC"}),stroke:new ae({color:"#fff",width:2})})}),qt=()=>new Se({stroke:new ae({color:"#3399CC",width:3}),fill:new Ie({color:"rgba(0, 0, 255, 0.05)"})}),yi=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),xi=g.forwardRef(function(e,t){const{mapId:o,maxZoom:n,positionFeatureStyle:i,accuracyFeatureStyle:r,trackingOptions:a}=e,{containerProps:l}=oe("geolocation",e),d=!!navigator.geolocation,[u,p]=g.useState(!1),[f,v]=g.useState(!1),{map:x}=Z(o),C=bi(),T=vi("notifier.NotificationService"),R=Si(x,n,a,i,r),L=(()=>d?u?C.formatMessage({id:"locateMeEnd"}):C.formatMessage({id:"locateMeStart"}):C.formatMessage({id:"locateNotSupported"}))();g.useEffect(()=>{if(R===void 0)return;const z=R.on("error",function(X){const U=C.formatMessage({id:"error"}),se=(()=>{switch(X){case"permission-denied":return C.formatMessage({id:"permissionDenied"});case"position-unavailable":return C.formatMessage({id:"positionUnavailable"});case"timeout":return C.formatMessage({id:"timeout"});case"unknown":return C.formatMessage({id:"unknownError"})}})();v(!1),p(!1),T.notify({level:"error",title:U,message:se})});return()=>{z.destroy()}},[R,C,T]),g.useEffect(()=>{if(!R){v(!1);return}return u&&(v(!0),R.startGeolocation().then(()=>{v(!1)})),()=>{R?.stopGeolocation(),v(!1)}},[R,u]);const M=()=>{x&&p(!u)};return c.jsx(Te,{ref:t,label:L,icon:c.jsx(wi,{}),onClick:()=>M(),isActive:u,isLoading:f,isDisabled:!d,...l})});function Si(s,e,t,o,n){const[i,r]=g.useState();return g.useEffect(()=>{if(!s)return;const a=new _i(s.olMap,t);return r(a),()=>{a.destroy(),r(void 0)}},[s,t]),g.useEffect(()=>{i?.setPositionFeatureStyle(o)},[i,o]),g.useEffect(()=>{i?.setAccuracyFeatureStyle(n)},[i,n]),g.useEffect(()=>{i?.setMaxZoom(e)},[i,e]),i}const ki="@open-pioneer/measurement",Ci=ce.bind(void 0,ki);class Ei{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const o=this.source=new je;this.layer=new Ne({source:o}),this.layer.setZIndex(go),e.addLayer(this.layer);const n=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){me(n)}});const i=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",i),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",i)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=Ps(e);this.activeFeatureStyle=(o,...n)=>{const i=o?.getGeometry()?.getType();if(i==="Polygon"||i==="LineString"||i==="Point")return t(o,...n)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",o=this.draw=new $n({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(o);let n,i;o.on("drawstart",r=>{n=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=r.feature;if(!a)return;let l;i=a.getGeometry()?.on("change",d=>{const u=d.target,p=this.olMap.getView().getProjection();let f="";u instanceof nt?(f=Mi(u,p,this.messages),l=u.getInteriorPoint().getCoordinates()||null):u instanceof ve&&(f=Ti(u,p,this.messages),l=u.getLastCoordinate()||null),n&&(n.element.innerHTML=f,l&&n?.overlay.setPosition(l))})}),o.on("drawend",()=>{if(n){const r=n.element.classList;r.remove("measurement-active-tooltip"),r.add("measurement-finished-tooltip"),n.overlay.setOffset([0,-7]),this.overlayTooltips.push(n),this.measureTooltip=n=void 0}this.sketch=void 0,i&&me(i)}),o.on("drawabort",()=>{n&&(n.destroy(),this.measureTooltip=n=void 0),this.sketch=void 0,i&&me(i)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip";const t=new yt({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),o=this.olMap;return o.addOverlay(t),{overlay:t,element:e,destroy(){o.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip hidden";const t=new yt({element:e,offset:[15,0],positioning:"center-left"}),o=this.olMap;return o.addOverlay(t),{overlay:t,element:e,destroy(){o.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,o=Pi(this.messages,this.sketch);t.element.textContent=o,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function Pi(s,e){if(e){const t=e.getGeometry();if(t instanceof nt||t instanceof ve)return s.getContinueMessage()}return s.getHelpMessage()}function Mi(s,e,t){const o=Ms(s,{projection:e});let n;return o>=1e6?n=`${t.formatNumber(o/1e6)} km<sup>2</sup>`:n=`${t.formatNumber(o)} m<sup>2</sup>`,n}function Ti(s,e,t){const o=Ts(s,{projection:e});let n;return o>=1e3?n=`${t.formatNumber(o/1e3)} km`:n=`${t.formatNumber(o)} m`,n}const Li=s=>{const e=Ci(),{mapId:t,activeFeatureStyle:o,finishedFeatureStyle:n}=s,{containerProps:i}=oe("measurement",s),[r,a]=g.useState("distance"),l=v=>e.formatMessage({id:v}),d=Z(t),u=Ii(d.map,e);g.useEffect(()=>{u?.setActiveFeatureStyle(o??Ai())},[u,o]),g.useEffect(()=>{u?.setFinishedFeatureStyle(n??Ri())},[u,n]),g.useEffect(()=>{if(u)return u.startMeasurement(r),()=>{u.stopMeasurement()}},[u,r]);function p(v){if(v==="distance"||v==="area")a(v);else throw new Error(`Unexpected measurement type: '${v}'.`)}function f(){u?.clearMeasurements()}return c.jsxs(G,{...i,children:[c.jsx(Fe,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),c.jsx(rn,{mb:4,alignItems:"center",children:c.jsxs(ln,{mb:2,children:[c.jsx(an,{mb:1,children:l("measurementLabel")}),c.jsxs(cn,{value:r,onChange:v=>p(v.target.value),className:"measurement-select",children:[c.jsx("option",{value:"distance",children:l("distance")}),c.jsx("option",{value:"area",children:l("area")})]})]})}),c.jsx(St,{padding:2,className:"measurement-delete-button",onClick:f,width:"100%",children:l("deleteMeasurementLabel")})]})};function Ii(s,e){const[t,o]=g.useState(void 0);return g.useEffect(()=>{if(!s)return;const n=new Ei(s.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(i){return e.formatNumber(i,{maximumFractionDigits:2})}});return o(n),()=>{n.destroy(),o(void 0)}},[s,e]),t}function Ai(){return[new Se({stroke:new ae({color:"#fff",lineDash:[10,10],width:5})}),new Se({fill:new Ie({color:"rgba(0,0,0,0.15)"}),stroke:new ae({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new mo({radius:5,stroke:new ae({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new Ie({color:"rgba(255, 255, 255, 0.2)"})})})]}function Ri(){return[new Se({stroke:new ae({color:"#fff",width:5})}),new Se({stroke:new ae({color:"#0b96fc",width:3}),fill:new Ie({color:"rgba(11,150,252,0.15)"})})]}var Di=dn({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const mt=.75,qe=.1;let Oi=class extends vo{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",o=e.tipLabel!==void 0?e.tipLabel:"Overview map",n=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const i=e.label!==void 0?e.label:"›";typeof i=="string"?(this.label_=document.createElement("span"),this.label_.textContent=i):this.label_=i;const r=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=o,a.appendChild(r),a.addEventListener(ro.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const l=new Ls({view:e.view,controls:new jt,interactions:new jt});this.ovmap_=l,e.layers&&e.layers.forEach(function(L){l.addLayer(L)});const d=document.createElement("div");d.className="ol-overviewmap-box",d.style.boxSizing="border-box",this.boxOverlay_=new yt({position:[0,0],positioning:"center-center",element:d}),this.ovmap_.addOverlay(this.boxOverlay_);const u=t+" "+bo+" "+Is+(this.collapsed_&&this.collapsible_?" "+Nt:"")+(this.collapsible_?"":" ol-uncollapsible"),p=this.element;p.className=u,p.appendChild(this.ovmapDiv_),p.appendChild(a);const f=this,v=this.boxOverlay_,x=this.boxOverlay_.getElement(),C=function(L){return{clientX:L.clientX,clientY:L.clientY}},T=function(L){const M=C(L),z=l.getEventCoordinateInternal(M);v.setPosition(z)},R=function(L){const M=l.getEventCoordinateInternal(L);f.getMap().getView().setCenterInternal(M),window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",R)};x.addEventListener("mousedown",function(){window.addEventListener("mousemove",T),window.addEventListener("mouseup",R)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const o=t.getView();o&&this.unbindView_(o),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(ho(e,As.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const o=e.getView();o&&(this.bindView_(o),o.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===ht.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const o=this.getMap().getView();this.bindView_(o)}else!this.ovmap_.isRendered()&&(e.key===ht.TARGET||e.key===ht.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new Rs({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(Ft.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(Ft.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const o=e.getSize(),i=e.getView().calculateExtentInternal(o);if(this.viewExtent_&&Ds(i,this.viewExtent_))return;this.viewExtent_=i;const r=t.getSize(),l=t.getView().calculateExtentInternal(r),d=t.getPixelFromCoordinateInternal(Os(i)),u=t.getPixelFromCoordinateInternal(js(i)),p=Math.abs(d[0]-u[0]),f=Math.abs(d[1]-u[1]),v=r[0],x=r[1];p<v*qe||f<x*qe||p>v*mt||f>x*mt?this.resetExtent_():fo(l,i)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,o=e.getSize(),i=e.getView().calculateExtentInternal(o),r=t.getView(),a=Math.log(mt/qe)/Math.LN2,l=1/(Math.pow(2,a/2)*qe);Ns(i,l),r.fitInternal(Fs(i))}recenter_(){const e=this.getMap(),t=this.ovmap_,o=e.getView();t.getView().setCenterInternal(o.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const o=e.getSize(),n=e.getView(),i=t.getView(),r=this.rotateWithView_?0:-n.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),d=n.getCenterInternal(),u=n.getResolution(),p=i.getResolution(),f=o[0]*u/p,v=o[1]*u/p;if(a.setPosition(d),l){l.style.width=f+"px",l.style.height=v+"px";const x="rotate("+r+"rad)";l.style.transform=x}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=Vs(this.ovmap_,po.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(Nt),this.collapsed_?Vt(this.collapseLabel_,this.label_):Vt(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const ji=Oi,vt="units",Ni=[1,2,5],Pe=25.4/.28;class Fi extends vo{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const o=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=o+"-inner",this.element.className=o+" "+bo,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(vt,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(vt)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(vt,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,o=e.projection,n=this.getUnits(),i=n=="degrees"?"degrees":"m";let r=wt(o,e.resolution,t,i);const a=this.minWidth_*(this.dpi_||Pe)/Pe,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Pe)/Pe:void 0;let d=a*r,u="";if(n=="degrees"){const M=Bs.degrees;d*=M,d<M/60?(u="″",r*=3600):d<M?(u="′",r*=60):u="°"}else if(n=="imperial")d<.9144?(u="in",r/=.0254):d<1609.344?(u="ft",r/=.3048):(u="mi",r/=1609.344);else if(n=="nautical")r/=1852,u="NM";else if(n=="metric")d<.001?(u="μm",r*=1e6):d<1?(u="mm",r*=1e3):d<1e3?u="m":(u="km",r/=1e3);else if(n=="us")d<.9144?(u="in",r*=39.37):d<1609.344?(u="ft",r/=.30480061):(u="mi",r/=1609.3472);else throw new Error("Invalid units");let p=3*Math.floor(Math.log(a*r)/Math.log(10)),f,v,x,C,T,R;for(;;){x=Math.floor(p/3);const M=Math.pow(10,x);if(f=Ni[(p%3+3)%3]*M,v=Math.round(f/r),isNaN(v)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&v>=l){f=C,v=T,x=R;break}else if(v>=a)break;C=f,T=v,R=x,++p}const L=this.scaleBar_?this.createScaleBar(v,f,u):f.toFixed(x<0?-x:0)+" "+u;this.renderedHTML_!=L&&(this.innerElement_.innerHTML=L,this.renderedHTML_=L),this.renderedWidth_!=v&&(this.innerElement_.style.width=v+"px",this.renderedWidth_=v),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,o){const n=this.getScaleForResolution(),i=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),r=this.scaleBarSteps_,a=e/r,l=[this.createMarker("absolute")];for(let u=0;u<r;++u){const p=u%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${p}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(u%2===0||r===2?this.createStepText(u,e,!1,t,o):"")+"</div>")}return l.push(this.createStepText(r,e,!0,t,o)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+i+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,o,n,i){const a=(e===0?0:Math.round(n/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+i),l=e===0?-3:t/this.scaleBarSteps_*-1,d=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${d}px;left: ${o?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=wt(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Pe,o=1e3/25.4;return e*o*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const Vi=Fi,Bi="200px",Gi="300px",Ui=s=>{const{mapId:e,olLayer:t,height:o=Bi,width:n=Gi}=s,{containerProps:i}=oe("overview-map",s),r=g.useRef(null),{map:a}=Z(e);return g.useEffect(()=>{if(r.current&&a&&t){const l=a.olMap,d=new ji({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:r.current});return l.addControl(d),()=>{l.removeControl(d)}}},[a,t]),c.jsx(G,{height:o,width:n,ref:r,...i})},zi=s=>{const{mapId:e,displayMode:t="line"}=s,{containerProps:o}=oe("scale-bar",s),{map:n}=Z(e),i=g.useRef(null);return g.useEffect(()=>{if(i.current&&n){const r=n.olMap,a=new Vi({units:"metric",target:i.current,bar:t==="bar"});return r.addControl(a),()=>{r.removeControl(a)}}},[t,n]),c.jsx(G,{...o,ref:i})},$i="@open-pioneer/scale-viewer",Hi=ce.bind(void 0,$i),Wi=s=>{const{mapId:e}=s,{containerProps:t}=oe("scale-viewer",s),{map:o}=Z(e),n=Hi(),i=Pn(o?.olMap),r=i?n.formatNumber(i):void 0;return c.jsx(G,{...t,children:r&&c.jsxs(Fe,{children:["1:",r]})})},qi="@open-pioneer/search",lt=ce.bind(void 0,qi);function Ki(s){const e=s.selectProps.inputValue.length>0,t={...s,className:it(s.className,{"search-invisible":!e})};return c.jsx(de.Menu,{...t,children:s.children})}function Yi(s){const t=lt().formatMessage({id:"noOptionsText"});return c.jsx(de.NoOptionsMessage,{...s,children:c.jsx(Ee.span,{className:"search-no-match",children:t})})}function Zi(s){const t=lt().formatMessage({id:"loadingText"});return c.jsx(de.LoadingMessage,{...s,children:c.jsx(Ee.span,{className:"search-loading-text",children:t})})}function Xi({children:s,...e}){const t={...e,className:it(e.className,"search-value-container")};return c.jsxs(de.ValueContainer,{...t,children:[!!s&&c.jsx(Di,{style:{position:"absolute",left:8}}),s]})}function Ji(s){const e={...s,isHidden:!1};return c.jsx(de.Input,{...e})}function Qi(s){return null}function er(s){return c.jsxs(de.IndicatorsContainer,{...s,children:[s.children,!s.selectProps.isLoading&&s.selectProps.inputValue&&c.jsx(tr,{selectProps:s.selectProps,clearValue:s.clearValue})]})}function tr(s){const t=lt().formatMessage({id:"ariaLabel.clearButton"}),o=n=>{n.preventDefault(),n.stopPropagation(),s.clearValue()};return c.jsx(zo,{role:"button",size:"md",mr:1,"aria-label":t,onClick:o,onTouchEnd:o,onMouseDown:n=>n.preventDefault()})}function or(s){return null}function sr(s){const e=s.selectProps.inputValue,t=s.data.label,o={...s,className:it(s.className,"search-option")};return c.jsx(de.Option,{...o,children:c.jsx(Ee.div,{className:"search-option-label",children:e.trim().length>0?nr(t,e):t})})}function nr(s,e){const t=s.toLowerCase().indexOf(e.toLowerCase());return t>=0?c.jsxs(c.Fragment,{children:[s.substring(0,t),c.jsx(Ee.span,{className:"search-highlighted-match",children:s.substring(t,t+e.length)},"highlighted"),s.substring(t+e.length)]}):s}const Kt=Oe("search:SearchController"),Yt=200,Zt=5;var De,_e,ye,xe,q,st,Do;class ir{constructor(e,t){D(this,st);D(this,De,void 0);D(this,_e,[]);D(this,ye,Zt);D(this,xe,Yt);D(this,q,void 0);O(this,De,e),O(this,_e,t)}destroy(){E(this,q)?.abort(),O(this,q,void 0)}async search(e){if(E(this,q)?.abort(),O(this,q,void 0),!e)return[];const t=O(this,q,new AbortController);try{return await rr(t.signal,E(this,xe)),t.signal.aborted&&(Kt.debug(`search canceled with ${e}`),$o()),(await Promise.all(E(this,_e).map(n=>F(this,st,Do).call(this,n,e,t.signal)))).filter(n=>n!=null)}finally{E(this,q)===t&&O(this,q,void 0)}}get searchTypingDelay(){return E(this,xe)}set searchTypingDelay(e){O(this,xe,e??Yt)}get maxResultsPerSource(){return E(this,ye)}set maxResultsPerSource(e){O(this,ye,e??Zt)}get sources(){return E(this,_e)}}De=new WeakMap,_e=new WeakMap,ye=new WeakMap,xe=new WeakMap,q=new WeakMap,st=new WeakSet,Do=async function(e,t,o){const n=e.label,i=E(this,De).olMap.getView().getProjection();try{const r=E(this,ye);let a=await e.search(t,{maxResults:r,signal:o,mapProjection:i});return a.length>r&&(a=a.slice(0,r)),{label:n,source:e,results:a}}catch(r){xt(r)||Kt.error(`search for source ${n} failed`,r);return}};async function rr(s,e){s.aborted||await new Promise(t=>{const o=()=>{s.removeEventListener("abort",o),clearTimeout(n),t()};s.addEventListener("abort",o);const n=setTimeout(o,e)})}const Ze=Oe("search:Search"),ar=s=>{const{mapId:e,sources:t,searchTypingDelay:o,maxResultsPerGroup:n,onSelect:i,onClear:r}=s,{containerProps:a}=oe("search",s),{map:l}=Z(e),d=lt(),u=ur(t,o,n,l),{input:p,search:f,selectedOption:v,onInputChanged:x,onResultConfirmed:C}=hr(u),T=dr(),R=lr(d),L=cr(),M=_t((U,se)=>{se.action==="input-change"&&x(U)}),z=_t((U,se)=>{switch(se.action){case"select-option":U&&(C(U),i?.({source:U.source,result:U.result}));break;case"clear":x(""),X.current?.blur(),X.current?.focus(),r?.();break;default:Ze.debug(`Unhandled action type '${se.action}'.`);break}}),X=g.useRef(null);return c.jsx(G,{...a,children:c.jsx(un,{className:"search-component",classNamePrefix:"react-select",ref:X,inputValue:p,onInputChange:M,"aria-label":d.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:R,colorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:T,isClearable:!0,placeholder:d.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:f.kind==="loading",options:f.kind==="ready"?f.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:L,onChange:z,value:v})})};function lr(s){return g.useMemo(()=>({onFocus:({focused:i})=>`${i.label} ${s.formatMessage({id:"ariaLabel.searchFocus"})}.`,onChange:({action:i,label:r})=>{let a="";switch(i){case"select-option":a=`${r} ${s.formatMessage({id:"ariaLabel.searchSelect"})}.`;break;case"clear":a=`${r} ${s.formatMessage({id:"ariaLabel.searchClear"})}.`;break}return a},guidance:()=>`${s.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[s])}function cr(){return g.useMemo(()=>({Menu:Ki,Input:Ji,SingleValue:Qi,Option:sr,NoOptionsMessage:Yi,LoadingMessage:Zi,ValueContainer:Xi,IndicatorsContainer:er,ClearIndicator:or}),[])}function dr(){const[s,e]=Ho("colors",["trails.100","trails.50"],["#d5e5ec","#eaf2f5"]);return g.useMemo(()=>({groupHeading:o=>({...o,backgroundColor:s,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:o=>({...o,backgroundColor:"inherit",_focus:{backgroundColor:e}}),dropdownIndicator:o=>({...o,display:"none"})}),[s,e])}function ur(s,e,t,o){const[n,i]=g.useState(void 0);return g.useEffect(()=>{if(!o)return;const r=new ir(o,s);return i(r),()=>{r.destroy(),i(void 0)}},[o,s]),g.useEffect(()=>{n&&(n.searchTypingDelay=e)},[n,e]),g.useEffect(()=>{n&&(n.maxResultsPerSource=t)},[n,t]),n}function hr(s){const[e,t]=g.useReducer((a,l)=>{switch(l.kind){case"input":return{...a,query:l.query,selectedOption:null};case"select-option":return{...a,selectedOption:l.option,query:l.option.label};case"load-results":return{...a,search:{kind:"loading"}};case"accept-results":return{...a,search:{kind:"ready",results:l.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),o=g.useRef(),n=_t(a=>{if(!s){o.current=void 0,t({kind:"accept-results",results:[]});return}Ze.isDebug()&&Ze.debug(`Starting new search for query ${JSON.stringify(a)}.`),t({kind:"load-results"});const l=o.current=pr(s,a).then(d=>{o.current===l&&t({kind:"accept-results",results:d})})}),i=g.useCallback(a=>{t({kind:"select-option",option:a})},[]),r=g.useCallback(a=>{t({kind:"input",query:a}),n(a)},[n]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:i,onInputChanged:r}}async function pr(s,e){let t;try{t=await s.search(e)}catch(o){xt(o)||Ze.error("Search failed",o),t=[]}return fr(t)}function fr(s){return s.map((t,o)=>({label:t.label,options:t.results.map(n=>({value:`${o}-${n.id}`,label:n.label,source:t.source,result:n}))}))}let gr=0;function mr(s,e){const t=`atom${++gr}`,o={toString:()=>t};return typeof s=="function"?o.read=s:(o.init=s,o.read=function(n){return n(this)},o.write=function(n,i,r){return i(this,typeof r=="function"?r(n(this)):r)}),e&&(o.write=e),o}const Xt=s=>"init"in s,Jt=s=>!!s.write,Xe=new WeakMap,vr=(s,e)=>{Xe.set(s,e),s.catch(()=>{}).finally(()=>Xe.delete(s))},Qt=(s,e)=>{const t=Xe.get(s);t&&(Xe.delete(s),t(e))},eo=(s,e)=>{s.status="fulfilled",s.value=e},to=(s,e)=>{s.status="rejected",s.reason=e},br=s=>typeof s?.then=="function",Me=(s,e)=>!!s&&"v"in s&&"v"in e&&Object.is(s.v,e.v),oo=(s,e)=>!!s&&"e"in s&&"e"in e&&Object.is(s.e,e.e),he=s=>!!s&&"v"in s&&s.v instanceof Promise,wr=(s,e)=>"v"in s&&"v"in e&&s.v.orig&&s.v.orig===e.v.orig,Ke=s=>{if("e"in s)throw s.e;return s.v},Tt=()=>{const s=new WeakMap,e=new WeakMap,t=new Map;let o,n;const i=h=>s.get(h),r=(h,b)=>{const _=s.get(h);if(s.set(h,b),t.has(h)||t.set(h,_),he(_)){const m="v"in b?b.v instanceof Promise?b.v:Promise.resolve(b.v):Promise.reject(b.e);_.v!==m&&Qt(_.v,m)}},a=(h,b,_)=>{const m=new Map;let y=!1;_.forEach((k,w)=>{!k&&w===h&&(k=b),k&&(m.set(w,k),b.d.get(w)!==k&&(y=!0))}),(y||b.d.size!==m.size)&&(b.d=m)},l=(h,b,_)=>{const m=i(h),y={d:m?.d||new Map,v:b};if(_&&a(h,y,_),Me(m,y)&&m.d===y.d)return m;if(he(m)&&he(y)&&wr(m,y)){if(m.d===y.d)return m;y.v=m.v}return r(h,y),y},d=(h,b,_,m)=>{if(br(b)){let y;const k=()=>{const S=i(h);if(!he(S)||S.v!==w)return;const j=l(h,w,_);e.has(h)&&S.d!==j.d&&X(h,j,S.d)},w=new Promise((S,j)=>{let P=!1;b.then(I=>{P||(P=!0,eo(w,I),S(I),k())},I=>{P||(P=!0,to(w,I),j(I),k())}),y=I=>{P||(P=!0,I.then(N=>eo(w,N),N=>to(w,N)),S(I))}});return w.orig=b,w.status="pending",vr(w,S=>{S&&y(S),m?.()}),l(h,w,_)}return l(h,b,_)},u=(h,b,_)=>{const m=i(h),y={d:m?.d||new Map,e:b};return _&&a(h,y,_),oo(m,y)&&m.d===y.d?m:(r(h,y),y)},p=(h,b)=>{const _=i(h);if(!b&&_&&(e.has(h)||Array.from(_.d).every(([P,I])=>{if(P===h)return!0;const N=p(P);return N===I||Me(N,I)})))return _;const m=new Map;let y=!0;const k=P=>{if(P===h){const N=i(P);if(N)return m.set(P,N),Ke(N);if(Xt(P))return m.set(P,void 0),P.init;throw new Error("no atom init")}const I=p(P);return m.set(P,I),Ke(I)};let w,S;const j={get signal(){return w||(w=new AbortController),w.signal},get setSelf(){return!S&&Jt(h)&&(S=(...P)=>{if(!y)return L(h,...P)}),S}};try{const P=h.read(k,j);return d(h,P,m,()=>w?.abort())}catch(P){return u(h,P,m)}finally{y=!1}},f=h=>Ke(p(h)),v=h=>{let b=e.get(h);return b||(b=M(h)),b},x=(h,b)=>!b.l.size&&(!b.t.size||b.t.size===1&&b.t.has(h)),C=h=>{const b=e.get(h);b&&x(h,b)&&z(h)},T=h=>{const b=new Map,_=new WeakMap,m=w=>{var S;const j=new Set((S=e.get(w))==null?void 0:S.t);return t.forEach((P,I)=>{var N;(N=i(I))!=null&&N.d.has(w)&&j.add(I)}),j},y=w=>{m(w).forEach(S=>{S!==w&&(b.set(S,(b.get(S)||new Set).add(w)),_.set(S,(_.get(S)||0)+1),y(S))})};y(h);const k=w=>{m(w).forEach(S=>{var j;if(S!==w){let P=_.get(S);if(P&&_.set(S,--P),!P){let I=!!((j=b.get(S))!=null&&j.size);if(I){const N=i(S),Fo=p(S,!0);I=!Me(N,Fo)}I||b.forEach(N=>N.delete(S))}k(S)}})};k(h)},R=(h,...b)=>{let _=!0;const m=w=>Ke(p(w)),y=(w,...S)=>{let j;if(w===h){if(!Xt(w))throw new Error("atom not writable");const P=i(w),I=d(w,S[0]);Me(P,I)||T(w)}else j=R(w,...S);if(!_){const P=U()}return j},k=h.write(m,y,...b);return _=!1,k},L=(h,...b)=>{const _=R(h,...b),m=U();return _},M=(h,b,_)=>{var m;const y=_||[];(m=i(h))==null||m.d.forEach((w,S)=>{const j=e.get(S);j?j.t.add(h):S!==h&&M(S,h,y)}),p(h);const k={t:new Set(b&&[b]),l:new Set};if(e.set(h,k),Jt(h)&&h.onMount){const{onMount:w}=h;y.push(()=>{const S=w((...j)=>L(h,...j));S&&(k.u=S)})}return _||y.forEach(w=>w()),k},z=h=>{var b;const _=(b=e.get(h))==null?void 0:b.u;_&&_(),e.delete(h);const m=i(h);m&&(he(m)&&Qt(m.v),m.d.forEach((y,k)=>{if(k!==h){const w=e.get(k);w&&(w.t.delete(h),x(k,w)&&z(k))}}))},X=(h,b,_)=>{const m=new Set(b.d.keys());_?.forEach((y,k)=>{if(m.has(k)){m.delete(k);return}const w=e.get(k);w&&(w.t.delete(h),x(k,w)&&z(k))}),m.forEach(y=>{const k=e.get(y);k?k.t.add(h):e.has(h)&&M(y,h)})},U=()=>{let h;for(;t.size;){const b=Array.from(t);t.clear(),b.forEach(([_,m])=>{const y=i(_);if(y){const k=e.get(_);k&&y.d!==m?.d&&X(_,y,m?.d),k&&!(!he(m)&&(Me(m,y)||oo(m,y)))&&k.l.forEach(w=>w())}})}};return{get:f,set:L,sub:(h,b)=>{const _=v(h),m=U(),y=_.l;return y.add(b),()=>{y.delete(b),C(h)}}}};let bt;const _r=()=>(bt||(bt=Tt()),bt),Oo=g.createContext(void 0),yr=s=>{const e=g.useContext(Oo);return s?.store||e||_r()},xr=({children:s,store:e})=>{const t=g.useRef();return!e&&!t.current&&(t.current=Tt()),g.createElement(Oo.Provider,{value:e||t.current},s)},Sr=s=>typeof s?.then=="function",kr=Wo.use||(s=>{if(s.status==="pending")throw s;if(s.status==="fulfilled")return s.value;throw s.status==="rejected"?s.reason:(s.status="pending",s.then(e=>{s.status="fulfilled",s.value=e},e=>{s.status="rejected",s.reason=e}),s)});function Cr(s,e){const t=yr(e),[[o,n,i],r]=g.useReducer(d=>{const u=t.get(s);return Object.is(d[0],u)&&d[1]===t&&d[2]===s?d:[u,t,s]},void 0,()=>[t.get(s),t,s]);let a=o;(n!==t||i!==s)&&(r(),a=t.get(s));const l=e?.delay;return g.useEffect(()=>{const d=t.sub(s,()=>{if(typeof l=="number"){setTimeout(r,l);return}r()});return r(),d},[t,s,l]),g.useDebugValue(a),Sr(a)?kr(a):a}const jo="@open-pioneer/spatial-bookmarks",Er=Ct.bind(void 0,jo),Pr=ce.bind(void 0,jo),Q=Oe("spatial-bookmark:SpatialBookmarkViewModel");class Mr{map;packageNamespace;writableBookmarks=mr([]);stopBookmarksListener;store;get bookmarks(){return this.writableBookmarks}constructor(e,t){this.map=e,this.packageNamespace=t.getNamespace("spatial-bookmarks"),this.store=Tt(),this.loadState(),this.stopBookmarksListener=this.store.sub(this.bookmarks,()=>{this.saveState()})}destroy(){this.stopBookmarksListener()}createBookmark(e){const t=this.map.olMap,o=t.getView().calculateExtent(),n=t.getView().getProjection().getCode(),i={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]},r={id:io(),title:e,extent:i,projection:n};Q.debug("Created a new bookmark",r);const a=this.writableBookmarks;this.store.set(a,[...this.store.get(a),r])}activateBookmark(e){Q.debug("Activating bookmark",e);const t=this.getBookmarkExtent(e);Q.debug("Attempting to apply extent",t),this.applyExtent(t)}deleteBookmark(e){Q.debug("Deleting bookmark",e);const t=this.writableBookmarks;this.store.set(t,[...this.store.get(t).filter(o=>o.id!==e)])}deleteAllBookmarks(){Q.debug("Deleting all bookmarks"),this.store.set(this.writableBookmarks,[])}loadState(){Q.debug("Restoring bookmarks from local storage");const e=this.packageNamespace.get("bookmarks")??[];try{Tr(e),this.store.set(this.writableBookmarks,e)}catch(t){Q.error("Bookmarks data in local storage is invalid, resetting to default value.",t),this.store.set(this.writableBookmarks,[]),this.saveState()}}saveState(){Q.debug("Saving bookmarks to local storage"),this.packageNamespace.set("bookmarks",this.store.get(this.bookmarks))}getBookmarkExtent(e){const o=this.map.olMap.getView(),n=e.extent,i=[n.minX,n.minY,n.maxX,n.maxY],r=o.getProjection(),a=e.projection;return Gs(i,a,r)}applyExtent(e){const o=this.map.olMap.getView(),n=Us(e),i=o.getResolutionForExtent(e);o.setCenter(n),o.setResolution(i)}}function Tr(s){if(!Array.isArray(s))throw new Error("Expected bookmarks from local storage to be an array.");for(const e of s)Lr(e)}function Lr(s){if(!s||typeof s!="object")throw new Error("Expected bookmark from local storage to be an object.");const e=s;if(typeof e.id!="string")throw new Error("Bookmark does not have a valid id.");if(typeof e.title!="string")throw new Error("Bookmark does not have a valid title.");if(Ir(e.extent),typeof e.projection!="string")throw new Error("Bookmark does not have a valid projection value.")}function Ir(s){if(!s||typeof s!="object")throw new Error("Expected bookmark extent from local storage to be an object.");const e=s;if(typeof e.minX!="number"||typeof e.minY!="number"||typeof e.maxX!="number"||typeof e.maxY!="number")throw new Error("Expected bookmark extent from local storage to have valid coordinates.")}const Ar=s=>{const{map:e}=Z(s.mapId),t=Er("local-storage.LocalStorageService"),o=Vr(e,t);return o&&c.jsx(xr,{store:o.store,children:c.jsx(Rr,{...s,viewModel:o})})};function Rr(s){const{viewModel:e}=s,t=Pr(),o=g.useRef([]),[n,i]=g.useState(!1),r=Cr(e.bookmarks),[a,l]=g.useState(""),d=a.trim().length>0,{containerProps:u}=oe("spatial-bookmarks",s),[p,f]=g.useState("list"),v=()=>{e.deleteAllBookmarks(),f("list")},x=()=>{d&&(e.createBookmark(a),f("list"),l(""),i(!0))};g.useEffect(()=>{if(n){const M=o.current;M&&M[r.length-1]?.scrollIntoView?.(),i(!1)}},[r,n]);const C=()=>c.jsxs(Gt,{children:[c.jsxs(dt,{rounded:"md",status:"warning",children:[c.jsx(ut,{}),t.formatMessage({id:"bookmark.alert.delete"})]}),c.jsx(Nr,{intl:t,onClear:v,onCancel:()=>f("list")})]}),T=()=>c.jsxs(Gt,{children:[c.jsxs(dt,{rounded:"md",status:"info",children:[c.jsx(ut,{}),t.formatMessage({id:"bookmark.alert.create"})]}),c.jsx(fn,{"aria-label":t.formatMessage({id:"bookmark.input.label"}),placeholder:t.formatMessage({id:"bookmark.input.placeholder"}),value:a,onChange:M=>{l(M.target.value)},onKeyDown:M=>{M.key==="Enter"&&x()},isRequired:!0,isInvalid:!d,autoFocus:!0}),c.jsx(Fr,{intl:t,isInvalid:!d,onCancel:()=>{l(""),f("list")},onSave:x})]}),R=()=>c.jsxs(c.Fragment,{children:[r.length?Dr(r,e,t,o):c.jsxs(dt,{rounded:"md",status:"info",children:[c.jsx(ut,{}),t.formatMessage({id:"bookmark.alert.noSaved"})]}),c.jsx(jr,{intl:t,bookmarks:r,showCreate:()=>f("create"),showDelete:()=>f("delete")})]}),L=c.jsxs(c.Fragment,{children:[p==="list"&&R(),p==="create"&&T(),p==="delete"&&C()]});return c.jsx(ie,{flexDirection:"column",...u,children:L})}function Dr(s,e,t,o){const n=t.formatMessage({id:"bookmark.button.deleteOne"}),i=s.map((r,a)=>c.jsx(Or,{index:a,listItemNodes:o,bookmark:r,onActivate:()=>e.activateBookmark(r),onDelete:()=>e.deleteBookmark(r.id),deleteBtnLabel:n},r.id));return c.jsx(hn,{as:"ul",className:"spatial-bookmark-list",role:"listbox","aria-label":t.formatMessage({id:"bookmark.list.label"}),flexShrink:1,flexGrow:1,p:1,spacing:1,overflowY:"auto",listStyleType:"none",children:i})}const so={ArrowDown:1,ArrowUp:-1};function Or(s){const{index:e,listItemNodes:t,bookmark:o,onDelete:n,onActivate:i,deleteBtnLabel:r}=s,a=o.title,l=d=>{const u=d.key;if(u==="Enter"){d.target===d.currentTarget&&i();return}if(so[u]!=null){const p=t.current?.length;if(!p)return;let f=(e+so[u])%p;f<0&&(f=p-1),t.current[f]?.focus()}};return c.jsx(G,{as:"li",p:1,ref:d=>{if(!d){t.current.splice(e,1);return}t.current[e]=d},className:it("spatial-bookmarks-item"),tabIndex:0,rounded:"md",role:"option",cursor:"pointer",outline:0,_hover:{background:"trails.50"},_focusVisible:{boxShadow:"outline"},onKeyDown:l,onClick:i,children:c.jsxs(ie,{width:"100%",flexDirection:"row",align:"center",gap:1,children:[c.jsx(ko,{children:c.jsx(_o,{})}),c.jsx(Fe,{ps:2,noOfLines:1,children:a}),c.jsx(pn,{}),c.jsx(qo,{hasArrow:!0,label:r,placement:"right",children:c.jsx(St,{className:"spatial-bookmarks-item-delete","aria-label":r,borderRadius:"full",iconSpacing:0,padding:0,colorScheme:"red",variant:"ghost",leftIcon:c.jsx(yo,{}),onClick:d=>{n(),d.stopPropagation()}})},e)]})})}function jr(s){const{intl:e,bookmarks:t,showCreate:o,showDelete:n}=s;return c.jsxs(Lt,{children:[c.jsx(Ce,{isDisabled:t.length===0,colorScheme:"red",width:void 0,iconSpacing:0,leftIcon:c.jsx(yo,{}),onClick:n,"aria-label":e.formatMessage({id:"bookmark.button.deleteAll"}),variant:"outline"}),c.jsx(Ce,{onClick:o,width:"100%",children:e.formatMessage({id:"bookmark.button.create"})})]})}function Nr(s){const{intl:e,onCancel:t,onClear:o}=s;return c.jsxs(Lt,{children:[c.jsx(Ce,{variant:"outline",onClick:t,children:e.formatMessage({id:"bookmark.button.cancelDelete"})}),c.jsx(Ce,{onClick:o,children:e.formatMessage({id:"bookmark.button.confirmDelete"})})]})}function Fr(s){const{intl:e,onCancel:t,onSave:o,isInvalid:n}=s;return c.jsxs(Lt,{children:[c.jsx(Ce,{variant:"outline",onClick:()=>t(),children:e.formatMessage({id:"bookmark.button.cancel"})}),c.jsx(Ce,{isDisabled:n,onClick:()=>o(),children:e.formatMessage({id:"bookmark.button.save"})})]})}function Lt(s){return c.jsx(ie,{width:"100%",flexDirection:"row",mt:2,gap:1,flexGrow:0,flexShrink:0,children:s.children})}function Ce(s){return c.jsx(St,{width:"100%",...s})}function Vr(s,e){const[t,o]=g.useState();return g.useEffect(()=>{let n;return s?n=new Mr(s,e):n=void 0,o(n),()=>n?.destroy()},[s,e]),t}const No="ol-map",Br=Ct.bind(void 0,No),Gr=ce.bind(void 0,No);function Ur(){const s=Gr(),e=g.useId(),t=g.useId(),o=g.useId(),[n,i]=g.useState(!1),[r,a]=g.useState(!0),[l,d]=g.useState(!1);function u(){d(!l)}const[p,f]=g.useState(!0);function v(){i(!n)}function x(){a(!r)}function C(){f(!p)}const T=g.useMemo(()=>new kt({source:new no}),[]);return c.jsxs(ie,{height:"100%",direction:"column",overflow:"hidden",children:[c.jsx(Qs,{position:"top-right"}),c.jsxs(Be,{title:c.jsx(G,{role:"region","aria-label":s.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:c.jsx(Ge,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[c.jsx(ie,{flex:"1",direction:"column",position:"relative",children:c.jsxs(zs,{mapId:B,role:"main","aria-label":s.formatMessage({id:"ariaLabel.map"}),children:[c.jsx(G,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-top-center-placement",children:c.jsx(zr,{})}),c.jsx(Ve,{position:"top-left",horizontalGap:20,verticalGap:20,children:(p||n)&&c.jsxs(G,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:[p&&c.jsx(G,{role:"dialog","aria-labelledby":e,children:c.jsx(Be,{title:c.jsx(Ge,{id:e,size:"md",mb:2,children:c.jsx(Fe,{children:s.formatMessage({id:"tocTitle"})})}),children:c.jsx(Xs,{mapId:B,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})}),p&&n&&c.jsx(gn,{mt:4,mb:4}),n&&c.jsx(G,{role:"dialog","aria-labelledby":t,children:c.jsx(Be,{title:c.jsx(Ge,{id:t,size:"md",mb:2,children:s.formatMessage({id:"measurementTitle"})}),children:c.jsx(Li,{mapId:B})})})]})}),c.jsx(Ve,{position:"top-right",horizontalGap:20,verticalGap:20,children:r&&c.jsx(G,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",children:c.jsx(Ui,{mapId:B,olLayer:T})})}),c.jsx(Ve,{horizontalGap:20,position:"bottom-left",children:l&&c.jsx(G,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:c.jsx(G,{role:"dialog","aria-labelledby":o,children:c.jsx(Be,{title:c.jsx(Ge,{id:o,size:"md",mb:2,children:s.formatMessage({id:"spatialBookmarkTitle"})}),children:c.jsx(Ar,{mapId:B})})})})}),c.jsx(Ve,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:c.jsxs(ie,{role:"toolbar","aria-label":s.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[c.jsx(Te,{label:s.formatMessage({id:"spatialBookmarkTitle"}),icon:c.jsx($s,{}),isActive:l,onClick:u}),c.jsx(xi,{mapId:B}),c.jsx(Te,{label:s.formatMessage({id:"tocTitle"}),icon:c.jsx(Hs,{}),isActive:p,onClick:C}),c.jsx(Te,{label:s.formatMessage({id:"measurementTitle"}),icon:c.jsx(Ws,{}),isActive:n,onClick:v}),c.jsx(Te,{label:s.formatMessage({id:"overviewMapTitle"}),icon:c.jsx(_o,{}),isActive:r,onClick:x}),c.jsx(on,{mapId:B}),c.jsx(sn,{mapId:B}),c.jsx(nn,{mapId:B})]})})]})}),c.jsxs(ie,{role:"region","aria-label":s.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[c.jsx(pi,{mapId:B,precision:2}),c.jsx(zi,{mapId:B}),c.jsx(Wi,{mapId:B})]})]})]})}function zr(){const{map:s}=Z(B),e=Br("ol-app.AppConfig"),t=g.useMemo(()=>e.getSearchSources(),[e]);function o(i){if(console.debug("The user selected the following item: ",i.result),!s)return;const r=i.result.geometry;r&&s.highlightAndZoom([r])}function n(){console.debug("The user cleared the search"),s?.removeHighlight()}return c.jsx(ar,{mapId:B,sources:t,maxResultsPerGroup:10,onSelect:o,onClear:n})}const $r=Ko({component:Ur,theme:Yo,appMetadata:ci,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(s){const e=s.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",$r);const Hr=document.getElementsByTagName("body")[0];Wr();function Wr(){const s=window.location.search,t=new URLSearchParams(s).get("lang"),o=document.createElement("ol-map-app");o.classList.add("full-height"),o.classList.add("app"),o.setAttribute("id","test"),t&&o.setAttribute("forced-locale",t),Hr.appendChild(o)}
