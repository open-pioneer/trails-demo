var D=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var c=(n,e,t)=>(D(n,e,"read from private field"),t?t.call(n):e.get(n)),b=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},m=(n,e,t,s)=>(D(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t);var X=(n,e,t)=>(D(n,e,"access private method"),t);import{r as l,f as y,u as B,o as w,a as se,j as i,c as I,b as j,d as be,e as _e,g as ie,h as Ae,i as Ee,A as Z,k as ee,l as Ne,m as we,F as te,B as W,n as Ce,p as Le,q as Pe,s as Fe,t as Te,v as re,w as Me,x as Re}from"./36e8fa6e78e2.js";const T=Symbol("EventEmitterState");class ae{[T]=new Be;on(e,t){return this[T].on(e,{listener:t})}once(e,t){return this[T].on(e,{listener:t,once:!0})}emit(e,...t){this[T].emit(e,t[0])}}class Be{handlers=new Map;on(e,t){let s=this.handlers.get(e);return s||(s=new Set,this.handlers.set(e,s)),s.add(t),{destroy(){t.removed=!0,s?.delete(t),s=void 0}}}emit(e,t){const s=this.handlers.get(e);if(!s)return;const r=[...s];for(const a of r)a.removed||(a.once&&(a.removed=!0,s.delete(a)),a.listener(t))}}function oe(n){const e=Object.assign({},n);for(let t in e)e[t]===void 0&&delete e[t];return e}function ce(n){return l.Children.toArray(n).filter(e=>l.isValidElement(e))}var O=y(function(e,t){var s;const r=B("FormLabel",e),a=w(e),{className:u,children:g,requiredIndicator:o=i.jsx(le,{}),optionalIndicator:f=null,...p}=a,v=se(),d=(s=v?.getLabelProps(p,t))!=null?s:{ref:t,...p};return i.jsxs(I.label,{...d,className:j("chakra-form__label",a.className),__css:{display:"block",textAlign:"start",...r},children:[g,v?.isRequired?o:f]})});O.displayName="FormLabel";var le=y(function(e,t){const s=se(),r=be();if(!s?.isRequired)return null;const a=j("chakra-form__required-indicator",e.className);return i.jsx(I.span,{...s?.getRequiredIndicatorProps(e,t),__css:r.requiredIndicator,className:a})});le.displayName="RequiredIndicator";var[qe,ze]=_e({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),ue=y(function(e,t){const s=ie("Input",e),{children:r,className:a,...u}=w(e),g=j("chakra-input__group",a),o={},f=ce(r),p=s.field;f.forEach(d=>{var h,k;s&&(p&&d.type.id==="InputLeftElement"&&(o.paddingStart=(h=p.height)!=null?h:p.h),p&&d.type.id==="InputRightElement"&&(o.paddingEnd=(k=p.height)!=null?k:p.h),d.type.id==="InputRightAddon"&&(o.borderEndRadius=0),d.type.id==="InputLeftAddon"&&(o.borderStartRadius=0))});const v=f.map(d=>{var h,k;const C=oe({size:((h=d.props)==null?void 0:h.size)||e.size,variant:((k=d.props)==null?void 0:k.variant)||e.variant});return d.type.id!=="Input"?l.cloneElement(d,C):l.cloneElement(d,Object.assign(C,o,d.props))});return i.jsx(I.div,{className:g,ref:t,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate"},"data-group":!0,...u,children:i.jsx(qe,{value:s,children:v})})});ue.displayName="InputGroup";var De=I("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),q=y(function(e,t){var s,r;const{placement:a="left",...u}=e,g=ze(),o=g.field,p={[a==="left"?"insetStart":"insetEnd"]:"0",width:(s=o?.height)!=null?s:o?.h,height:(r=o?.height)!=null?r:o?.h,fontSize:o?.fontSize,...g.element};return i.jsx(De,{ref:t,__css:p,...u})});q.id="InputElement";q.displayName="InputElement";var de=y(function(e,t){const{className:s,...r}=e,a=j("chakra-input__left-element",s);return i.jsx(q,{ref:t,placement:"left",className:a,...r})});de.id="InputLeftElement";de.displayName="InputLeftElement";var H=y(function(e,t){const{className:s,...r}=e,a=j("chakra-input__right-element",s);return i.jsx(q,{ref:t,placement:"right",className:a,...r})});H.id="InputRightElement";H.displayName="InputRightElement";var M=y(function(e,t){const{htmlSize:s,...r}=e,a=ie("Input",r),u=w(r),g=Ae(u),o=j("chakra-input",e.className);return i.jsx(I.input,{size:s,...g,__css:a.field,ref:t,className:o})});M.displayName="Input";M.id="Input";function he(n,e){return Array.isArray(n)?n.map(t=>t===null?null:e(t)):Ee(n)?Object.keys(n).reduce((t,s)=>(t[s]=e(n[s]),t),{}):n!=null?e(n):null}var me=y(function(e,t){const s=B("Text",e),{className:r,align:a,decoration:u,casing:g,...o}=w(e),f=oe({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return i.jsx(I.p,{ref:t,className:j("chakra-text",e.className),...f,...o,__css:s})});me.displayName="Text";var pe=n=>i.jsx(I.div,{className:"chakra-stack__item",...n,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...n.__css}});pe.displayName="StackItem";var U="& > *:not(style) ~ *:not(style)";function Ge(n){const{spacing:e,direction:t}=n,s={column:{marginTop:e,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:e},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:e,marginStart:0},"row-reverse":{marginTop:0,marginEnd:e,marginBottom:0,marginStart:0}};return{flexDirection:t,[U]:he(t,r=>s[r])}}function We(n){const{spacing:e,direction:t}=n,s={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":he(t,r=>s[r])}}var ge=y((n,e)=>{const{isInline:t,direction:s,align:r,justify:a,spacing:u="0.5rem",wrap:g,children:o,divider:f,className:p,shouldWrapChildren:v,...d}=n,h=t?"row":s??"column",k=l.useMemo(()=>Ge({direction:h,spacing:u}),[h,u]),C=l.useMemo(()=>We({spacing:u,direction:h}),[u,h]),P=!!f,K=!v&&!P,ye=l.useMemo(()=>{const z=ce(o);return K?z:z.map((F,Y)=>{const J=typeof F.key<"u"?F.key:Y,ke=Y+1===z.length,Q=v?i.jsx(pe,{children:F},J):F;if(!P)return Q;const Ie=l.cloneElement(f,{__css:C}),je=ke?null:Ie;return i.jsxs(l.Fragment,{children:[Q,je]},J)})},[f,C,P,K,v,o]),Se=j("chakra-stack",p);return i.jsx(I.div,{ref:e,display:"flex",alignItems:r,justifyContent:a,flexDirection:k.flexDirection,flexWrap:g,className:Se,__css:P?{}:{[U]:k[U]},...d,children:ye})});ge.displayName="Stack";var fe=y((n,e)=>i.jsx(ge,{align:"center",...n,direction:"column",ref:e}));fe.displayName="VStack";var $=y(function(e,t){const s=B("Heading",e),{className:r,...a}=w(e);return i.jsx(I.h2,{ref:t,className:j("chakra-heading",e.className),...a,__css:s})});$.displayName="Heading";var V=y(function(e,t){const{className:s,centerContent:r,...a}=w(e),u=B("Container",e);return i.jsx(I.div,{ref:t,className:j("chakra-container",s),...a,__css:{...u,...r&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});V.displayName="Container";function Oe({doLogin:n,wasLoggedIn:e}){const[t,s]=l.useState(""),[r,a]=l.useState(""),[u,g]=l.useState(!1),[o,f]=l.useState(),[p,v]=l.useState(e),d=h=>{h.preventDefault();const k=n(t,r);f(k||""),v(!1)};return i.jsx(V,{p:5,children:i.jsxs(fe,{as:"form",onSubmit:d,spacing:4,children:[i.jsx($,{as:"h1",textAlign:"center",children:"Login"}),i.jsxs(me,{textAlign:"center",children:["Please enter your user name and password to authenticate.",i.jsx("br",{}),"Note: credentials are ",'"admin"'," / ",'"admin"']}),o&&i.jsxs(Z,{status:"error",children:[i.jsx(ee,{}),i.jsx(Ne,{children:o})]}),p&&i.jsxs(Z,{status:"info",mb:5,children:[i.jsx(ee,{}),i.jsxs(we,{children:["Logout successful.",i.jsx("br",{}),"You can use the form below to log in again."]})]}),i.jsxs(te,{children:[i.jsx(O,{children:"User name"}),i.jsx(M,{placeholder:"User name",value:t,onChange:h=>s(h.target.value),autoComplete:"username"})]}),i.jsxs(te,{children:[i.jsx(O,{children:"Password"}),i.jsxs(ue,{children:[i.jsx(M,{pr:"4.5rem",type:u?"text":"password",placeholder:"Enter password",value:r,onChange:h=>a(h.target.value),autoComplete:"current-password"}),i.jsx(H,{width:"4.5rem",children:i.jsx(W,{h:"1.75rem",size:"sm",onClick:()=>g(!u),children:u?"Hide":"Show"})})]})]}),i.jsx(W,{type:"submit",children:"Login"})]})})}var _,E,L;class Ue extends ae{constructor(){super();b(this,_,{kind:"pending"});b(this,E,void 0);b(this,L,!1);m(this,E,setTimeout(()=>{m(this,_,{kind:"not-authenticated"}),this.emit("changed")},500))}destroy(){clearTimeout(c(this,E)),m(this,E,void 0)}getAuthState(){return c(this,_)}getLoginBehavior(){const t=(r,a)=>{if(r==="admin"&&a==="admin")m(this,_,{kind:"authenticated",sessionInfo:{userId:"admin",userName:"Arnold Administrator"}}),m(this,L,!0),this.emit("changed");else return"Invalid user name or password!"};return{kind:"fallback",Fallback:()=>l.createElement(Oe,{doLogin:t,wasLoggedIn:c(this,L)})}}logout(){(c(this,_).kind==="authenticated"||c(this,_).kind==="pending")&&(m(this,_,{kind:"not-authenticated"}),clearTimeout(c(this,E)),m(this,E,void 0),this.emit("changed"))}}_=new WeakMap,E=new WeakMap,L=new WeakMap;const G=Fe("authentication:AuthService");var A,x,S,N,R,ve;class He extends ae{constructor(t){super();b(this,R);b(this,A,void 0);b(this,x,void 0);b(this,S,void 0);b(this,N,void 0);m(this,A,t.references.plugin),m(this,x,c(this,A).getAuthState()),m(this,N,c(this,A).on?.("changed",()=>X(this,R,ve).call(this))),G.debug(`Constructed with initial auth state '${c(this,x).kind}'`,c(this,x))}destroy(){c(this,S)?.reject(Ce()),m(this,S,void 0),m(this,N,Le(c(this,N)))}getAuthState(){return c(this,x)}getSessionInfo(){return c(this,x).kind!=="pending"?Promise.resolve(ne(c(this,x))):(c(this,S)||m(this,S,Pe()),c(this,S).promise)}getLoginBehavior(){return c(this,A).getLoginBehavior()}logout(){G.debug("Triggering logout"),c(this,A).logout()}}A=new WeakMap,x=new WeakMap,S=new WeakMap,N=new WeakMap,R=new WeakSet,ve=function(){const t=c(this,A).getAuthState();m(this,x,t),t.kind!=="pending"&&c(this,S)&&(c(this,S).resolve(ne(t)),m(this,S,void 0)),G.debug(`Auth state changed to '${c(this,x).kind}'`,c(this,x)),this.emit("changed")};function ne(n){return n.kind==="authenticated"?n.sessionInfo:void 0}const $e={"auth-app":{name:"auth-app",services:{TestAuthPlugin:{name:"TestAuthPlugin",clazz:Ue,provides:[{name:"authentication.AuthPlugin",qualifier:void 0}],references:{}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:He,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/test-utils":{name:"@open-pioneer/test-utils",services:{},ui:{references:[]},properties:{}}},Ve="",Ke=[];function Ye(n){throw new Error(`Unsupported locale: '${n}'`)}const Je=Te(Ve),Qe=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Ye,locales:Ke,packages:$e,styles:Je},Symbol.toStringTag,{value:"Module"})),Xe="@open-pioneer/authentication",Ze=re.bind(void 0,Xe);function xe(n){const e=l.useCallback(r=>{const a=n.on("changed",r);return()=>a.destroy()},[n]),t=l.useCallback(()=>n.getAuthState(),[n]);return l.useSyncExternalStore(e,t)}const et=n=>{const e=Ze("authentication.AuthService"),t=xe(e),s=l.useMemo(()=>{if(t.kind==="not-authenticated")return e.getLoginBehavior()},[e,t.kind]);switch(l.useEffect(()=>{t.kind==="not-authenticated"&&s?.kind==="effect"&&s.login()},[s,t.kind]),t.kind){case"pending":return null;case"not-authenticated":{if(!s||s.kind!=="fallback")return null;const r=s.Fallback;return n.renderFallback?i.jsx(i.Fragment,{children:n.renderFallback(r)}):i.jsx(r,{...n.fallbackProps})}case"authenticated":return i.jsx(i.Fragment,{children:n.children})}},tt="auth-app",nt=re.bind(void 0,tt);function st(){const n=nt("authentication.AuthService"),e=xe(n),t=()=>{n.logout()};return e.kind==="not-authenticated"||e.kind==="pending"?null:i.jsx(W,{colorScheme:"red",onClick:t,children:"Log out"})}function it(){return i.jsx(et,{children:i.jsxs(V,{p:5,children:[i.jsx($,{as:"h1",children:"Authenticated"}),"This is the actual content of the app. Authentication was successful.",i.jsx(Me,{pt:5,flexDirection:"row",justifyContent:"center",children:i.jsx(st,{})})]})})}const rt=Re({component:it,appMetadata:Qe});customElements.define("auth-app",rt);
