var C=(e,n,t)=>{if(!n.has(e))throw TypeError("Cannot "+t)};var r=(e,n,t)=>(C(e,n,"read from private field"),t?t.call(e):n.get(e)),f=(e,n,t)=>{if(n.has(e))throw TypeError("Cannot add the same private member more than once");n instanceof WeakSet?n.add(e):n.set(e,t)},u=(e,n,t,i)=>(C(e,n,"write to private field"),i?i.call(e,t):n.set(e,t),t);var T=(e,n,t)=>(C(e,n,"access private method"),t);import{g as X,f as w,h as Z,o as ee,c as M,s as te,r as h,j as s,b as $,H as D,T as ne,t as G,v as R,w as se,x as ie,n as B,p as q,B as P,y as re,z as ae,D as oe,E as ue,k as ce,G as H,q as le}from"./6bc7d8557ab2.js";import{E as V,F as he}from"./8e37b228a72a.js";import{C as K,I as O}from"./7753e622d080.js";import{V as de}from"./b58bcf735b30.js";import{g as pe}from"./83b1356be596.js";var[me,ge]=X({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),Y=w(function(n,t){const i=Z("Input",n),{children:o,className:c,...I}=ee(n),A=M("chakra-input__group",c),a={},b=pe(o),g=i.field;b.forEach(l=>{var p,k;i&&(g&&l.type.id==="InputLeftElement"&&(a.paddingStart=(p=g.height)!=null?p:g.h),g&&l.type.id==="InputRightElement"&&(a.paddingEnd=(k=g.height)!=null?k:g.h),l.type.id==="InputRightAddon"&&(a.borderEndRadius=0),l.type.id==="InputLeftAddon"&&(a.borderStartRadius=0))});const _=b.map(l=>{var p,k;const z=te({size:((p=l.props)==null?void 0:p.size)||n.size,variant:((k=l.props)==null?void 0:k.variant)||n.variant});return l.type.id!=="Input"?h.cloneElement(l,z):h.cloneElement(l,Object.assign(z,a,l.props))});return s.jsx($.div,{className:A,ref:t,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...i.group},"data-group":!0,...I,children:s.jsx(me,{value:i,children:_})})});Y.displayName="InputGroup";var fe=$("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),L=w(function(n,t){var i,o;const{placement:c="left",...I}=n,A=ge(),a=A.field,g={[c==="left"?"insetStart":"insetEnd"]:"0",width:(i=a?.height)!=null?i:a?.h,height:(o=a?.height)!=null?o:a?.h,fontSize:a?.fontSize,...A.element};return s.jsx(fe,{ref:t,__css:g,...I})});L.id="InputElement";L.displayName="InputElement";var J=w(function(n,t){const{className:i,...o}=n,c=M("chakra-input__left-element",i);return s.jsx(L,{ref:t,placement:"left",className:c,...o})});J.id="InputLeftElement";J.displayName="InputLeftElement";var F=w(function(n,t){const{className:i,...o}=n,c=M("chakra-input__right-element",i);return s.jsx(L,{ref:t,placement:"right",className:c,...o})});F.id="InputRightElement";F.displayName="InputRightElement";function ve({doLogin:e,wasLoggedIn:n}){const[t,i]=h.useState(""),[o,c]=h.useState(""),[I,A]=h.useState(!1),[a,b]=h.useState(),[g,_]=h.useState(n),l=p=>{p.preventDefault();const k=e(t,o);b(k||""),_(!1)};return s.jsx(K,{p:5,children:s.jsxs(de,{as:"form",onSubmit:l,spacing:4,children:[s.jsx(D,{as:"h1",textAlign:"center",children:"Login"}),s.jsxs(ne,{textAlign:"center",children:["Please enter your user name and password to authenticate.",s.jsx("br",{}),"Note: credentials are ",'"admin"'," / ",'"admin"']}),a&&s.jsxs(G,{status:"error",children:[s.jsx(R,{}),s.jsx(se,{children:a})]}),g&&s.jsxs(G,{status:"info",mb:5,children:[s.jsx(R,{}),s.jsxs(ie,{children:["Logout successful.",s.jsx("br",{}),"You can use the form below to log in again."]})]}),s.jsxs(B,{children:[s.jsx(q,{children:"User name"}),s.jsx(O,{placeholder:"User name",value:t,onChange:p=>i(p.target.value),autoComplete:"username"})]}),s.jsxs(B,{children:[s.jsx(q,{children:"Password"}),s.jsxs(Y,{children:[s.jsx(O,{pr:"4.5rem",type:I?"text":"password",placeholder:"Enter password",value:o,onChange:p=>c(p.target.value),autoComplete:"current-password"}),s.jsx(F,{width:"4.5rem",children:s.jsx(P,{h:"1.75rem",size:"sm",onClick:()=>A(!I),children:I?"Hide":"Show"})})]})]}),s.jsx(P,{type:"submit",children:"Login"})]})})}var v,S,E;class xe extends V{constructor(){super();f(this,v,{kind:"pending"});f(this,S,void 0);f(this,E,!1);u(this,S,setTimeout(()=>{u(this,v,{kind:"not-authenticated"}),this.emit("changed")},500))}destroy(){clearTimeout(r(this,S)),u(this,S,void 0)}getAuthState(){return r(this,v)}getLoginBehavior(){const t=(o,c)=>{if(o==="admin"&&c==="admin")u(this,v,{kind:"authenticated",sessionInfo:{userId:"admin",userName:"Arnold Administrator"}}),u(this,E,!0),this.emit("changed");else return"Invalid user name or password!"};return{kind:"fallback",Fallback:()=>h.createElement(ve,{doLogin:t,wasLoggedIn:r(this,E)})}}logout(){(r(this,v).kind==="authenticated"||r(this,v).kind==="pending")&&(u(this,v,{kind:"not-authenticated"}),clearTimeout(r(this,S)),u(this,S,void 0),this.emit("changed"))}}v=new WeakMap,S=new WeakMap,E=new WeakMap;const N=ue("authentication:AuthService");var x,d,m,j,y,Q;class Se extends V{constructor(t){super();f(this,y);f(this,x,void 0);f(this,d,void 0);f(this,m,void 0);f(this,j,void 0);u(this,x,t.references.plugin),u(this,d,r(this,x).getAuthState()),u(this,j,r(this,x).on?.("changed",()=>T(this,y,Q).call(this))),N.debug(`Constructed with initial auth state '${r(this,d).kind}'`,r(this,d))}destroy(){r(this,m)?.reject(re()),u(this,m,void 0),u(this,j,ae(r(this,j)))}getAuthState(){return r(this,d)}getSessionInfo(){return r(this,d).kind!=="pending"?Promise.resolve(U(r(this,d))):(r(this,m)||u(this,m,oe()),r(this,m).promise)}getLoginBehavior(){return r(this,x).getLoginBehavior()}logout(){N.debug("Triggering logout"),r(this,x).logout()}}x=new WeakMap,d=new WeakMap,m=new WeakMap,j=new WeakMap,y=new WeakSet,Q=function(){const t=r(this,x).getAuthState();u(this,d,t),t.kind!=="pending"&&r(this,m)&&(r(this,m).resolve(U(t)),u(this,m,void 0)),N.debug(`Auth state changed to '${r(this,d).kind}'`,r(this,d)),this.emit("changed")};function U(e){return e.kind==="authenticated"?e.sessionInfo:void 0}const Ie={"auth-app":{name:"auth-app",services:{TestAuthPlugin:{name:"TestAuthPlugin",clazz:xe,provides:[{name:"authentication.AuthPlugin",qualifier:void 0}],references:{}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:Se,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/test-utils":{name:"@open-pioneer/test-utils",services:{},ui:{references:[]},properties:{}}},ke="",Ae=[];function je(e){throw new Error(`Unsupported locale: '${e}'`)}const be=ce(ke),Ee=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:je,locales:Ae,packages:Ie,styles:be},Symbol.toStringTag,{value:"Module"})),ye="@open-pioneer/authentication",we=H.bind(void 0,ye);function W(e){const n=h.useCallback(o=>{const c=e.on("changed",o);return()=>c.destroy()},[e]),t=h.useCallback(()=>e.getAuthState(),[e]);return h.useSyncExternalStore(n,t)}const Le=e=>{const n=we("authentication.AuthService"),t=W(n),i=h.useMemo(()=>{if(t.kind==="not-authenticated")return n.getLoginBehavior()},[n,t.kind]);switch(h.useEffect(()=>{t.kind==="not-authenticated"&&i?.kind==="effect"&&i.login()},[i,t.kind]),t.kind){case"pending":return null;case"not-authenticated":{if(!i||i.kind!=="fallback")return null;const o=i.Fallback;return e.renderFallback?s.jsx(s.Fragment,{children:e.renderFallback(o)}):s.jsx(o,{...e.fallbackProps})}case"authenticated":return s.jsx(s.Fragment,{children:e.children})}},_e="auth-app",Ce=H.bind(void 0,_e);function Ne(){const e=Ce("authentication.AuthService"),n=W(e),t=()=>{e.logout()};return n.kind==="not-authenticated"||n.kind==="pending"?null:s.jsx(P,{colorScheme:"red",onClick:t,children:"Log out"})}function Pe(){return s.jsx(Le,{children:s.jsxs(K,{p:5,children:[s.jsx(D,{as:"h1",children:"Authenticated"}),"This is the actual content of the app. Authentication was successful.",s.jsx(he,{pt:5,flexDirection:"row",justifyContent:"center",children:s.jsx(Ne,{})})]})})}const Me=le({component:Pe,appMetadata:Ee});customElements.define("auth-app",Me);
