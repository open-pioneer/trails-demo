var Ho=Object.defineProperty;var Wo=(r,e,t)=>e in r?Ho(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var L=(r,e,t)=>(Wo(r,typeof e!="symbol"?e+"":e,t),t),cr=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var w=(r,e,t)=>(cr(r,e,"read from private field"),t?t.call(r):e.get(r)),R=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},T=(r,e,t,n)=>(cr(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);var q=(r,e,t)=>(cr(r,e,"access private method"),t);import{u as $o,a as qo,r as g,c as Ko,f as nr,b as Nn,o as Vn,d as Gn,j as u,e as ie,g as Yo,l as Zo,i as $t,h as ge,k as Xo,R as Bn,m as zn,E as de,n as Jo,A as ur,p as dr,F as Un,B as or,C as Qo,t as ei,q as Hn,I as ti,s as ri}from"./a804c6ae25fd.js";import{t as ni}from"./86b0ef7fa05f.js";import{b as oe,B as Wn,i as oi,g as ii,a as Yr,t as si,c as ai,d as Or,C as li,r as ci,e as ui,u as di,l as $n,M as qn,o as hi,f as pi,h as Kn,A as gi,T as jr,I as fi,j as mi,k as vi,m as ee,n as yi,p as bi,q as N,V as Yn,S as mt,O as Zn,s as Pe,v as ne,w as Fe,x as Fr,F as nt,P as Si,y as _i,z as wi,D as Xn,E as xi,R as Ei,G as ot,H as Zr,J as We,K as _r,L as hr,N as De,Q as wt,U as Vt,W as Xr,X as pe,Y as re,Z as Le,_ as wr,$ as ki,a0 as Ci,a1 as Mi,a2 as xr,a3 as Pi,a4 as Ai,a5 as Jn,a6 as Li,a7 as Ii,a8 as Jr,a9 as Ri,aa as Qr,ab as Ti,ac as en,ad as Oi,ae as ji,af as Fi,ag as Di,ah as tn,ai as Ni,aj as pr,ak as rn,al as Vi,am as Gi,an as Bi,ao as zi,ap as Ui,aq as Hi,ar as nn,as as ir,at as sr,au as Qn,av as Wi,aw as $i,ax as fe,ay as se,az as J,aA as qi,aB as ut,aC as Ki,aD as Yi,aE as ye,aF as Ft,aG as Ve,aH as Ge,aI as Oe,aJ as te,aK as Zi,aL as eo,aM as Xi,aN as Ji,aO as on,aP as Qi,aQ as sn,aR as es,aS as ht}from"./ae80b20da1a8.js";import{m as V,a as k,X as to,p as B,r as j,b as X,c as Dr,d as Er,e as Me,f as ts,g as rs,W as Dt,P as ro,h as no,i as ns,j as os,k as is,l as ss,n as as,o as ls,q as cs,s as us,t as ds,u as hs}from"./2bdf38bd6190.js";import{o as ps,W as gs}from"./57ac81a28710.js";import{G as Nt,T as fs}from"./4fd4a3dc985d.js";import{T as Se,V as kr,L as oo}from"./81064a1e15a2.js";import{D as io,N as ms,P as vs,S as ys,c as bs,a as Ss,I as _s}from"./830d931026ff.js";import{V as ws,S as xs,I as Es,Z as ks,a as Cs}from"./1082ff337cb4.js";import{M as Ms}from"./5e1f39641cb8.js";import{_ as Cr}from"./a419295615be.js";import{c as so}from"./14997e1cc74a.js";import{S as Ps}from"./a80ff04620c9.js";import{u as ao,F as qt}from"./f413d8ffea52.js";import{F as xt}from"./b816276102a2.js";import{H as Mr}from"./e8bf978be9d7.js";import{G as Nr,F as As}from"./4533599bd8ef.js";import{u as Ne,R as Ls}from"./c7e87faa196a.js";import{L as lo}from"./e10692b36aa4.js";import{c as _e,S as Pr,D as Is}from"./d36378e4fa98.js";import{C as Rs}from"./88ffbff35e76.js";import"./3f67a442b387.js";import"./43de92519f96.js";import"./8feb64e69a5d.js";function Ts(r){const{theme:e}=$o(),t=qo();return g.useMemo(()=>Ko(e.direction,{...t,...r}),[r,e.direction,t])}var ar=nr(function(e,t){const{htmlSize:n,...o}=e,i=Nn("Input",o),s=Vn(o),a=ao(s),l=Gn("chakra-input",e.className);return u.jsx(ie.input,{size:n,...a,__css:i.field,ref:t,className:l})});ar.displayName="Input";ar.id="Input";var co=ie("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});co.displayName="Center";var Os={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};nr(function(e,t){const{axis:n="both",...o}=e;return u.jsx(ie.div,{ref:t,__css:Os[n],...o,position:"absolute"})});var uo=nr(function(e,t){const{children:n,placeholder:o,className:i,...s}=e;return u.jsxs(ie.select,{...s,ref:t,className:Gn("chakra-select",i),children:[o&&u.jsx("option",{value:"",children:o}),n]})});uo.displayName="SelectField";function js(r,e){const t={},n={};for(const[o,i]of Object.entries(r))e.includes(o)?t[o]=i:n[o]=i;return[t,n]}var Vr=nr((r,e)=>{var t;const n=Nn("Select",r),{rootProps:o,placeholder:i,icon:s,color:a,height:l,h:c,minH:d,minHeight:h,iconColor:f,iconSize:p,...y}=Vn(r),[_,M]=js(y,Zo),C=ao(M),F={width:"100%",height:"fit-content",position:"relative",color:a},O={paddingEnd:"2rem",...n.field,_focus:{zIndex:"unset",...(t=n.field)==null?void 0:t._focus}};return u.jsxs(ie.div,{className:"chakra-select__wrapper",__css:F,..._,...o,children:[u.jsx(uo,{ref:e,height:c??l,minH:d??h,placeholder:i,...C,__css:O,children:r.children}),u.jsx(ho,{"data-disabled":Yo(C.disabled),...(f||a)&&{color:f||a},__css:n.icon,...p&&{fontSize:p},children:s})]})});Vr.displayName="Select";var Fs=r=>u.jsx("svg",{viewBox:"0 0 24 24",...r,children:u.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Ds=ie("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),ho=r=>{const{children:e=u.jsx(Fs,{}),...t}=r,n=g.cloneElement(e,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return u.jsx(Ds,{...t,className:"chakra-select__icon-wrapper",children:g.isValidElement(e)?n:null})};ho.displayName="SelectIcon";const Q=[null,"http://www.opengis.net/ows/1.1"],Ns=V(Q,{ServiceIdentification:k(ca),ServiceProvider:k(da),OperationsMetadata:k(aa)});class Vs extends to{constructor(){super()}readFromNode(e){const t=B({},Ns,e,[]);return t||null}}const Gs=V(Q,{DeliveryPoint:k(j),City:k(j),AdministrativeArea:k(j),PostalCode:k(j),Country:k(j),ElectronicMailAddress:k(j)}),Bs=V(Q,{Value:X(ha)}),zs=V(Q,{AllowedValues:k(ea)}),Us=V(Q,{Phone:k(la),Address:k(Qs)}),Hs=V(Q,{HTTP:k(ia)}),Ws=V(Q,{Get:X(oa),Post:void 0}),$s=V(Q,{DCP:k(na)}),qs=V(Q,{Operation:sa}),Ks=V(Q,{Voice:k(j),Facsimile:k(j)}),Ys=V(Q,{Constraint:X(ta)}),Zs=V(Q,{IndividualName:k(j),PositionName:k(j),ContactInfo:k(ra)}),Xs=V(Q,{Abstract:k(j),AccessConstraints:k(j),Fees:k(j),Title:k(j),ServiceTypeVersion:k(j),ServiceType:k(j)}),Js=V(Q,{ProviderName:k(j),ProviderSite:k(Dr),ServiceContact:k(ua)});function Qs(r,e){return B({},Gs,r,e)}function ea(r,e){return B({},Bs,r,e)}function ta(r,e){const t=r.getAttribute("name");if(t)return B({name:t},zs,r,e)}function ra(r,e){return B({},Us,r,e)}function na(r,e){return B({},Hs,r,e)}function oa(r,e){const t=Dr(r);if(t)return B({href:t},Ys,r,e)}function ia(r,e){return B({},Ws,r,e)}function sa(r,e){const t=r.getAttribute("name"),n=B({},$s,r,e);if(!n)return;const o=e[e.length-1];o[t]=n}function aa(r,e){return B({},qs,r,e)}function la(r,e){return B({},Ks,r,e)}function ca(r,e){return B({},Xs,r,e)}function ua(r,e){return B({},Zs,r,e)}function da(r,e){return B({},Js,r,e)}function ha(r,e){return j(r)}const pa=Vs,me=[null,"http://www.opengis.net/wmts/1.0"],dt=[null,"http://www.opengis.net/ows/1.1"],ga=V(me,{Contents:k(ka)});class fa extends to{constructor(){super(),this.owsParser_=new pa}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let n=this.owsParser_.readFromNode(e);return n?(n.version=t,n=B(n,ga,e,[]),n||null):null}}const ma=V(me,{Layer:X(Ca),TileMatrixSet:X(Ma)}),va=V(me,{Style:X(Pa),Format:X(j),TileMatrixSetLink:X(Aa),Dimension:X(La),ResourceURL:X(Ia)},V(dt,{Title:k(j),Abstract:k(j),WGS84BoundingBox:k(go),BoundingBox:X(Ra),Identifier:k(j)})),ya=V(me,{LegendURL:X(Ta)},V(dt,{Title:k(j),Identifier:k(j)})),ba=V(me,{TileMatrixSet:k(j),TileMatrixSetLimits:k(ja)}),Sa=V(me,{TileMatrixLimits:Er(Fa)}),_a=V(me,{TileMatrix:k(j),MinTileRow:k(Me),MaxTileRow:k(Me),MinTileCol:k(Me),MaxTileCol:k(Me)}),wa=V(me,{Default:k(j),Value:X(j)},V(dt,{Identifier:k(j)})),po=V(dt,{LowerCorner:Er(Ar),UpperCorner:Er(Ar)}),xa=V(me,{WellKnownScaleSet:k(j),TileMatrix:X(Oa)},V(dt,{SupportedCRS:k(j),Identifier:k(j),BoundingBox:k(go)})),Ea=V(me,{TopLeftCorner:k(Ar),ScaleDenominator:k(ts),TileWidth:k(Me),TileHeight:k(Me),MatrixWidth:k(Me),MatrixHeight:k(Me)},V(dt,{Identifier:k(j)}));function ka(r,e){return B({},ma,r,e)}function Ca(r,e){return B({},va,r,e)}function Ma(r,e){return B({},xa,r,e)}function Pa(r,e){const t=B({},ya,r,e);if(!t)return;const n=r.getAttribute("isDefault")==="true";return t.isDefault=n,t}function Aa(r,e){return B({},ba,r,e)}function La(r,e){return B({},wa,r,e)}function Ia(r,e){const t=r.getAttribute("format"),n=r.getAttribute("template"),o=r.getAttribute("resourceType"),i={};return t&&(i.format=t),n&&(i.template=n),o&&(i.resourceType=o),i}function go(r,e){const t=B([],po,r,e);if(t.length==2)return oe(t)}function Ra(r,e){const t=r.getAttribute("crs"),n=B([],po,r,e);if(n.length==2)return{extent:oe(n),crs:t}}function Ta(r,e){const t={};return t.format=r.getAttribute("format"),t.href=Dr(r),t}function Ar(r,e){const t=j(r).split(/\s+/);if(!t||t.length!=2)return;const n=+t[0],o=+t[1];if(!(isNaN(n)||isNaN(o)))return[n,o]}function Oa(r,e){return B({},Ea,r,e)}function ja(r,e){return B([],Sa,r,e)}function Fa(r,e){return B({},_a,r,e)}const Da=fa,H={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},Na={ERROR:"error"};class Va extends Or{constructor(e){super(Na.ERROR),this.code=e.code,this.message=e.message}}let Ga=class extends Wn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=oi,this.watchId_=void 0,this.addChangeListener(H.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(H.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=ii(Yr("EPSG:4326"),e),this.position_&&this.set(H.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(H.ACCURACY,t.accuracy),this.set(H.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(H.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(H.HEADING,t.heading===null?void 0:si(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const n=this.transform_(this.position_);this.set(H.POSITION,n.slice()),this.set(H.SPEED,t.speed===null?void 0:t.speed);const o=ai(this.position_,t.accuracy);o.applyTransform(this.transform_),this.set(H.ACCURACY_GEOMETRY,o),this.changed()}positionError_(e){this.dispatchEvent(new Va(e))}getAccuracy(){return this.get(H.ACCURACY)}getAccuracyGeometry(){return this.get(H.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(H.ALTITUDE)}getAltitudeAccuracy(){return this.get(H.ALTITUDE_ACCURACY)}getHeading(){return this.get(H.HEADING)}getPosition(){return this.get(H.POSITION)}getProjection(){return this.get(H.PROJECTION)}getSpeed(){return this.get(H.SPEED)}getTracking(){return this.get(H.TRACKING)}getTrackingOptions(){return this.get(H.TRACKING_OPTIONS)}setProjection(e){this.set(H.PROJECTION,Yr(e))}setTracking(e){this.set(H.TRACKING,e)}setTrackingOptions(e){this.set(H.TRACKING_OPTIONS,e)}};const Ba=Ga,Z={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class za extends Wn{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+li,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Z.ELEMENT,this.handleElementChanged),this.addChangeListener(Z.MAP,this.handleMapChanged),this.addChangeListener(Z.OFFSET,this.handleOffsetChanged),this.addChangeListener(Z.POSITION,this.handlePositionChanged),this.addChangeListener(Z.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(Z.ELEMENT)}getId(){return this.id}getMap(){return this.get(Z.MAP)||null}getOffset(){return this.get(Z.OFFSET)}getPosition(){return this.get(Z.POSITION)}getPositioning(){return this.get(Z.POSITIONING)}handleElementChanged(){ci(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(ui(this.element),di(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=$n(e,qn.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(Z.ELEMENT,e)}setMap(e){this.set(Z.MAP,e)}setOffset(e){this.set(Z.OFFSET,e)}setPosition(e){this.set(Z.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(Z.POSITION))return;const n=this.getRect(t.getTargetElement(),t.getSize()),o=this.getElement(),i=this.getRect(o,[hi(o),pi(o)]);e=e||{};const s=e.margin===void 0?20:e.margin;if(!Kn(n,i)){const a=i[0]-n[0],l=n[2]-i[2],c=i[1]-n[1],d=n[3]-i[3],h=[0,0];if(a<0?h[0]=a-s:l<0&&(h[0]=Math.abs(l)+s),c<0?h[1]=c-s:d<0&&(h[1]=Math.abs(d)+s),h[0]!==0||h[1]!==0){const f=t.getView().getCenterInternal(),p=t.getPixelFromCoordinateInternal(f);if(!p)return;const y=[p[0]+h[0],p[1]+h[1]],_=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(y),duration:_.duration,easing:_.easing})}}}getRect(e,t){const n=e.getBoundingClientRect(),o=n.left+window.pageXOffset,i=n.top+window.pageYOffset;return[o,i,o+t[0],i+t[1]]}setPositioning(e){this.set(Z.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const n=e.getPixelFromCoordinate(t),o=e.getSize();this.updateRenderedPosition(n,o)}updateRenderedPosition(e,t){const n=this.element.style,o=this.getOffset(),i=this.getPositioning();this.setVisible(!0);const s=Math.round(e[0]+o[0])+"px",a=Math.round(e[1]+o[1])+"px";let l="0%",c="0%";i=="bottom-right"||i=="center-right"||i=="top-right"?l="-100%":(i=="bottom-center"||i=="center-center"||i=="top-center")&&(l="-50%"),i=="bottom-left"||i=="bottom-center"||i=="bottom-right"?c="-100%":(i=="center-left"||i=="center-center"||i=="center-right")&&(c="-50%");const d=`translate(${l}, ${c}) translate(${s}, ${a})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,n.transform=d)}getOptions(){return this.options}}const it=za,Ie=ge("map:WMTSLayer");var Ke,Ye,Ze,Xe,Et,kt,Ct,Mt,Zt,fo,Xt,mo;class Ua extends gi{constructor(t){const n=new jr;super({...t,olLayer:n});R(this,Zt);R(this,Xt);R(this,Ke,void 0);R(this,Ye,void 0);R(this,Ze,void 0);R(this,Xe,void 0);R(this,Et,void 0);R(this,kt,void 0);R(this,Ct,void 0);R(this,Mt,new AbortController);T(this,Ke,t.url),T(this,Ye,t.name),T(this,Xe,n),T(this,Ze,t.matrixSet),T(this,Ct,t.sourceOptions)}destroy(){super.destroy(),w(this,Mt).abort()}get legend(){return w(this,kt)}__attach(t){super.__attach(t),q(this,Zt,fo).call(this).then(n=>{const i=new Da().read(n),s=ps(i,{layer:w(this,Ye),matrixSet:w(this,Ze)});if(!s)throw new Error("Layer was not found in capabilities");const a=new gs({...s,...w(this,Ct),tileLoadFunction:(d,h)=>{q(this,Xt,mo).call(this,d,h)}});T(this,Et,a),w(this,Xe).setSource(w(this,Et));const l=a.getStyle(),c=Wa(i,this.name,l);T(this,kt,c),this.__emitChangeEvent("changed:legend")}).catch(n=>{if($t(n)){Ie.error(`Layer ${this.name} has been destroyed before fetching the data`);return}Ie.error(`Failed fetching WMTS capabilities for Layer ${this.name}`,n)})}get layer(){return w(this,Xe)}get url(){return w(this,Ke)}get name(){return w(this,Ye)}get matrixSet(){return w(this,Ze)}get sublayers(){}}Ke=new WeakMap,Ye=new WeakMap,Ze=new WeakMap,Xe=new WeakMap,Et=new WeakMap,kt=new WeakMap,Ct=new WeakMap,Mt=new WeakMap,Zt=new WeakSet,fo=async function(){const t=this.map.__sharedDependencies.httpService;return rs(w(this,Ke),t,w(this,Mt).signal)},Xt=new WeakSet,mo=async function(t,n){const o=this.map.__sharedDependencies.httpService;try{if(!(t instanceof fi))throw new Error("Only 'ImageTile' is supported for now.");const i=t.getImage();if(!Ha(i))throw new Error("Only <img> tags are supported as tiles for now.");const s=await o.fetch(n);if(!s.ok)throw new Error(`Tile request failed with status ${s.status}.`);const a=await s.blob(),l=URL.createObjectURL(a),c=()=>{URL.revokeObjectURL(l),i.removeEventListener("load",c),i.removeEventListener("error",c)};i.addEventListener("load",c),i.addEventListener("error",c),i.src=l}catch(i){t.setState(mi.ERROR),$t(i)||Ie.error("Failed to load tile",i)}};function Ha(r){return r.tagName==="IMG"}function Wa(r,e,t){const o=r?.Contents?.Layer;let i=o?.find(c=>c?.Identifier===e);if(!i&&(Ie.debug("Failed to find the active layer in WMTS layer capabilities."),i=o?.[0],!i)){Ie.debug("No layer in WMTS capabilities - giving up.");return}const s=i.Style;let a=s?.find(c=>c?.Identifier===t);if(!a&&(Ie.debug("Failed to find active style in WMTS layer."),a=s?.[0],!a)){Ie.debug("No style in WMTS layer capabilities - giving up.");return}return a.LegendURL?.[0]?.href}const an=Ua,$a=25.4/.28,qa=39.37;function Gr(r){return Br(r,Ka,Ya)}function Ka(r){return r.getView()}function Ya(r,e){return r.on("change:view",e)}function vo(r){return Gr(r)?.getProjection()}function Za(r){const e=Gr(r);return Br(e,Xa,Ja)}function Xa(r){return r.getResolution()}function Ja(r,e){return r.on("change:resolution",e)}function Qa(r){const e=Gr(r);return Br(e,el,tl)}function el(r){return r.getCenter()}function tl(r,e){return r.on("change:center",e)}function rl(r){const e=Qa(r),t=Za(r),n=vo(r);return g.useMemo(()=>{if(n==null||t==null||e==null)return;const i=vi(n,t,e);return Math.round(i*qa*$a)},[n,t,e])}function Br(r,e,t){const n=g.useCallback(()=>r?e(r):void 0,[r,e]),o=g.useCallback(i=>{if(!r)return()=>{};const s=t(r,i);return()=>ee(s)},[r,t]);return g.useSyncExternalStore(o,n)}const nl=1.2;function ol(r,e=nl){il(r);const t=yi(r),n=bi(r),o=t*e,i=n*e;return[r[0]-(o-t)/2,r[1]-(i-n)/2,r[2]+(o-t)/2,r[3]+(i-n)/2]}function il(r){if(r.length!==4)throw new Error(`Invalid extent (expected length 4, but got length ${r.length}).`)}const sl={height:"25px",width:"25px",borderColor:"#4cb3ff",borderWidth:"3px",borderRadius:"50%",display:"inline-block "};function al(r){return u.jsxs(N,{children:[u.jsx(Se,{children:r.layer.title}),u.jsx(N,{style:sl})]})}const z="main";class ll{mapId=z;vectorSourceFactory;constructor(e){this.vectorSourceFactory=e.references.vectorSourceFactory}async getMapConfig(){const e={Component:al};return{advanced:{view:new Yn({center:[404747,5757920],zoom:13,constrainResolution:!0,projection:"EPSG:25832"})},layers:[new Dt({title:"Linfos",visible:!0,url:"https://www.wms.nrw.de/umwelt/linfos",sublayers:[{name:"SonstigeSchutzgebiete",title:"SonstigeSchutzgebiete"},{name:"SCH_GSG",title:"SCH_GSG"}]}),new an({isBaseLayer:!0,title:"Topplus grau",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_grau",matrixSet:"EPSG_25832_14",visible:!1,sourceOptions:{attributions:`Kartendarstellung und Präsentationsgraphiken: &copy; Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a title="Datenquellen öffnen" aria-label="Datenquellen öffnen" href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html " target="_blank">Datenquellen</a>`}}),new an({isBaseLayer:!0,title:"Topplus farbig",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_col",matrixSet:"EPSG_25832_14",visible:!0,sourceOptions:{attributions:`Kartendarstellung und Präsentationsgraphiken: &copy; Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a title="Datenquellen öffnen" aria-label="Datenquellen öffnen" href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html " target="_blank">Datenquellen</a>`}}),new mt({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new jr({source:new Zn})}),new mt({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:cl(),attributes:{legend:e}}),new mt({id:"ogc_kitas",title:"Kindertagesstätten",visible:!0,olLayer:ul(),attributes:{legend:e,resultListMetadata:[{id:"id",displayName:"ID",width:100,getPropertyValue(t){return t.id}},{propertyName:"pointOfContact.address.postCode",displayName:"PLZ",width:120},{propertyName:"name",displayName:"Name"},{propertyName:"inspireId",displayName:"inspireID"},{displayName:"Gefördert",width:160,getPropertyValue(t){switch(t.properties?.gefoerdert){case"ja":return!0;case"nein":return!1;default:return t.properties?.gefoerdert}}}]}}),new mt({id:"ogc_kataster",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:dl(this.vectorSourceFactory),attributes:{resultListMetadata:[{propertyName:"id",displayName:"ID",width:600,getPropertyValue(t){return t.id}},{displayName:"Aktualit",width:600,getPropertyValue(t){const n=t.properties?.aktualit;return typeof n=="string"&&!isNaN(Date.parse(n))?new Date(n):n}}]}}),gl(this.vectorSourceFactory),fl(),ml(),hl(),pl()]}}}function cl(){const r=new Pe({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new Nt,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new ne({source:r})}function ul(){const r=new Pe({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new Nt,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new ne({source:r,style:new Fe({image:new Fr({fill:new nt({color:"blue"}),radius:4})})})}function dl(r){const e=r.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:`Land NRW (${new Date().getFullYear()}), <a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>, <a href='https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1'>Datenquelle</a>`});return new ne({source:e})}function hl(){return new Dt({title:"Verwaltungsgebiete",visible:!0,url:"https://www.wms.nrw.de/geobasis/wms_nw_dvg",sublayers:[{name:"nw_dvg_bld",title:"NRW"}]})}function pl(){return new Dt({title:"Bodenkarte zur Landwirtschaftlichen Standorterkundung",visible:!0,url:"https://www.wms.nrw.de/gd/bk05l",sublayers:[{name:"Versickerung_und_Stofftransport",title:"Versickerung und Stofftransport",sublayers:[{name:"Sickerwasserrate",title:"Sickerwasserrate",sublayers:[{name:"Szenario_Wald",title:"Szenario Wald",sublayers:[{name:"Sickerwasserrate_Wald",title:"Sickerwasserrate Wald"},{name:"Direktabfluss_Wald",title:"Direktabfluss Wald"}]},{name:"Szenario_Gruenland",title:"Szenario Grünland",sublayers:[{name:"Sickerwasserrate_Gruenland",title:"Sickerwasserrate Grünland"},{name:"Direktabfluss_Gruenland",title:"Direktabfluss Grünland"}]}]}]},{name:"Wasserhaushalt",title:"Wasserhaushalt",sublayers:[{name:"Kapillaraufstieg_von_Grundwasser",title:"Kapillaraufstieg von Grundwasser",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/gd/bk05l?request=GetLegendGraphic%26version=1.3.0%26format=image/png%26layer=Kapillaraufstieg_von_Grundwasser"}}},{name:"Luftkapazitaet_We",title:"Luftkapazitaet (We)",attributes:{legend:{}}}]}]})}function gl(r){const e="https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1",t="governmentalservice",n=r.createVectorSource({baseUrl:e,collectionId:t,limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:`Land NRW (${new Date().getFullYear()}), <a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>, <a href='https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1'>Datenquelle</a>`}),o=new ne({source:n});return new mt({id:"krankenhaus",title:"Krankenhäuser",visible:!0,olLayer:o,attributes:{collectionURL:e+"/collections/"+t}})}function fl(){return new Dt({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW",attributes:{legend:{}}}],sourceOptions:{ratio:1}})}function ml(){return new Dt({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",visible:!0,sublayers:[{name:"1",title:"Verwaltungen",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/legends/wms/strassen_nrw_wms/1.png"}}},{name:"4",title:"Abschnitte und Äste"},{name:"6",title:"Unfälle"}]})}const vl=Symbol(),zr=Symbol(),pt="a",Ht="w";let yl=(r,e)=>new Proxy(r,e);const Lr=Object.getPrototypeOf,Ir=new WeakMap,yo=r=>r&&(Ir.has(r)?Ir.get(r):Lr(r)===Object.prototype||Lr(r)===Array.prototype),ln=r=>typeof r=="object"&&r!==null,bl=r=>{if(Array.isArray(r))return Array.from(r);const e=Object.getOwnPropertyDescriptors(r);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(Lr(r),e)},bo=r=>r[zr]||r,So=(r,e,t,n)=>{if(!yo(r))return r;let o=n&&n.get(r);if(!o){const l=bo(r);o=(c=>Object.values(Object.getOwnPropertyDescriptors(c)).some(d=>!d.configurable&&!d.writable))(l)?[l,bl(l)]:[l],n?.set(r,o)}const[i,s]=o;let a=t&&t.get(i);return a&&a[1].f===!!s||(a=((l,c)=>{const d={f:c};let h=!1;const f=(y,_)=>{if(!h){let M=d[pt].get(l);if(M||(M={},d[pt].set(l,M)),y===Ht)M[Ht]=!0;else{let C=M[y];C||(C=new Set,M[y]=C),C.add(_)}}},p={get:(y,_)=>_===zr?l:(f("k",_),So(Reflect.get(y,_),d[pt],d.c,d.t)),has:(y,_)=>_===vl?(h=!0,d[pt].delete(l),!0):(f("h",_),Reflect.has(y,_)),getOwnPropertyDescriptor:(y,_)=>(f("o",_),Reflect.getOwnPropertyDescriptor(y,_)),ownKeys:y=>(f(Ht),Reflect.ownKeys(y))};return c&&(p.set=p.deleteProperty=()=>!1),[p,d]})(i,!!s),a[1].p=yl(s||i,a[0]),t&&t.set(i,a)),a[1][pt]=e,a[1].c=t,a[1].t=n,a[1].p},_o=(r,e,t,n)=>{if(Object.is(r,e))return!1;if(!ln(r)||!ln(e))return!0;const o=t.get(bo(r));if(!o)return!0;if(n){const s=n.get(r);if(s&&s.n===e)return s.g;n.set(r,{n:e,g:!1})}let i=null;try{for(const s of o.h||[])if(i=Reflect.has(r,s)!==Reflect.has(e,s),i)return i;if(o[Ht]===!0){if(i=((s,a)=>{const l=Reflect.ownKeys(s),c=Reflect.ownKeys(a);return l.length!==c.length||l.some((d,h)=>d!==c[h])})(r,e),i)return i}else for(const s of o.o||[])if(i=!!Reflect.getOwnPropertyDescriptor(r,s)!=!!Reflect.getOwnPropertyDescriptor(e,s),i)return i;for(const s of o.k||[])if(i=_o(r[s],e[s],t,n),i)return i;return i===null&&(i=!0),i}finally{n&&n.set(r,{n:e,g:i})}},Sl=r=>yo(r)&&r[zr]||null,cn=(r,e=!0)=>{Ir.set(r,e)};const gr=r=>typeof r=="object"&&r!==null,xe=new WeakMap,vt=new WeakSet,_l=(r=Object.is,e=(c,d)=>new Proxy(c,d),t=c=>gr(c)&&!vt.has(c)&&(Array.isArray(c)||!(Symbol.iterator in c))&&!(c instanceof WeakMap)&&!(c instanceof WeakSet)&&!(c instanceof Error)&&!(c instanceof Number)&&!(c instanceof Date)&&!(c instanceof String)&&!(c instanceof RegExp)&&!(c instanceof ArrayBuffer),n=c=>{switch(c.status){case"fulfilled":return c.value;case"rejected":throw c.reason;default:throw c}},o=new WeakMap,i=(c,d,h=n)=>{const f=o.get(c);if(f?.[0]===d)return f[1];const p=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c));return cn(p,!0),o.set(c,[d,p]),Reflect.ownKeys(c).forEach(y=>{if(Object.getOwnPropertyDescriptor(p,y))return;const _=Reflect.get(c,y),{enumerable:M}=Reflect.getOwnPropertyDescriptor(c,y),C={value:_,enumerable:M,configurable:!0};if(vt.has(_))cn(_,!1);else if(_ instanceof Promise)delete C.value,C.get=()=>h(_);else if(xe.has(_)){const[F,O]=xe.get(_);C.value=i(F,O(),h)}Object.defineProperty(p,y,C)}),Object.preventExtensions(p)},s=new WeakMap,a=[1,1],l=c=>{if(!gr(c))throw new Error("object required");const d=s.get(c);if(d)return d;let h=a[0];const f=new Set,p=(b,S=++a[0])=>{h!==S&&(h=S,f.forEach(m=>m(b,S)))};let y=a[1];const _=(b=++a[1])=>(y!==b&&!f.size&&(y=b,C.forEach(([S])=>{const m=S[1](b);m>h&&(h=m)})),h),M=b=>(S,m)=>{const x=[...S];x[1]=[b,...x[1]],p(x,m)},C=new Map,F=(b,S)=>{if(f.size){const m=S[3](M(b));C.set(b,[S,m])}else C.set(b,[S])},O=b=>{var S;const m=C.get(b);m&&(C.delete(b),(S=m[1])==null||S.call(m))},Y=b=>(f.add(b),f.size===1&&C.forEach(([m,x],A)=>{const E=m[3](M(A));C.set(A,[m,E])}),()=>{f.delete(b),f.size===0&&C.forEach(([m,x],A)=>{x&&(x(),C.set(A,[m]))})}),W=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c)),$=e(W,{deleteProperty(b,S){const m=Reflect.get(b,S);O(S);const x=Reflect.deleteProperty(b,S);return x&&p(["delete",[S],m]),x},set(b,S,m,x){const A=Reflect.has(b,S),E=Reflect.get(b,S,x);if(A&&(r(E,m)||s.has(m)&&r(E,s.get(m))))return!0;O(S),gr(m)&&(m=Sl(m)||m);let P=m;if(m instanceof Promise)m.then(G=>{m.status="fulfilled",m.value=G,p(["resolve",[S],G])}).catch(G=>{m.status="rejected",m.reason=G,p(["reject",[S],G])});else{!xe.has(m)&&t(m)&&(P=l(m));const G=!vt.has(P)&&xe.get(P);G&&F(S,G)}return Reflect.set(b,S,P,x),p(["set",[S],m,E]),!0}});s.set(c,$);const v=[W,_,i,Y];return xe.set($,v),Reflect.ownKeys(c).forEach(b=>{const S=Object.getOwnPropertyDescriptor(c,b);"value"in S&&($[b]=c[b],delete S.value,delete S.writable),Object.defineProperty(W,b,S)}),$})=>[l,xe,vt,r,e,t,n,o,i,s,a],[wl]=_l();function wo(r={}){return wl(r)}function xl(r,e,t){const n=xe.get(r);let o;const i=[],s=n[3];let a=!1;const c=s(d=>{if(i.push(d),t){e(i.splice(0));return}o||(o=Promise.resolve().then(()=>{o=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,c()}}function un(r,e){const t=xe.get(r),[n,o,i]=t;return i(n,o(),e)}function Be(r){return vt.add(r),r}var xo={exports:{}},Eo={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var st=g;function El(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var kl=typeof Object.is=="function"?Object.is:El,Cl=st.useState,Ml=st.useEffect,Pl=st.useLayoutEffect,Al=st.useDebugValue;function Ll(r,e){var t=e(),n=Cl({inst:{value:t,getSnapshot:e}}),o=n[0].inst,i=n[1];return Pl(function(){o.value=t,o.getSnapshot=e,fr(o)&&i({inst:o})},[r,t,e]),Ml(function(){return fr(o)&&i({inst:o}),r(function(){fr(o)&&i({inst:o})})},[r]),Al(t),t}function fr(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!kl(r,t)}catch{return!0}}function Il(r,e){return e()}var Rl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Il:Ll;Eo.useSyncExternalStore=st.useSyncExternalStore!==void 0?st.useSyncExternalStore:Rl;xo.exports=Eo;var Tl=xo.exports;const Ol=Xo(Tl),{use:dn}=Bn,{useSyncExternalStore:jl}=Ol;const Fl=new WeakMap;function at(r,e){const t=e?.sync,n=g.useRef(),o=g.useRef();let i=!0;const s=jl(g.useCallback(c=>{const d=xl(r,c,t);return c(),d},[r,t]),()=>{const c=un(r,dn);try{if(!i&&n.current&&o.current&&!_o(n.current,c,o.current,new WeakMap))return n.current}catch{}return c},()=>un(r,dn));i=!1;const a=new WeakMap;g.useEffect(()=>{n.current=s,o.current=a});const l=g.useMemo(()=>new WeakMap,[]);return So(s,a,l,Fl)}function Dl(r){const e=wo({data:Array.from(r||[]),has(t){return this.data.some(n=>n[0]===t)},set(t,n){const o=this.data.find(i=>i[0]===t);return o?o[1]=n:this.data.push([t,n]),this},get(t){var n;return(n=this.data.find(o=>o[0]===t))==null?void 0:n[1]},delete(t){const n=this.data.findIndex(o=>o[0]===t);return n===-1?!1:(this.data.splice(n,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(n=>{t(n[1],n[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}class Nl{label;filteredTypes;httpService;constructor(e,t,n){this.label=e,this.filteredTypes=t,this.httpService=n}async search(e,{mapProjection:t,signal:n}){const o=await this.request(e,100,n),i=new Nt({dataProjection:"EPSG:4326",featureProjection:t});return o.features.filter(s=>this.filteredTypes.includes(s.properties.type)).map((s,a)=>{const l=i.readGeometry(s.geometry);return{id:s.properties.osm_id||a,label:this.createLabel(s),geometry:l,properties:s.properties}})}async request(e,t,n){const o=new URL("https://photon.komoot.io/api?");o.searchParams.set("q",e),o.searchParams.set("lang","de"),o.searchParams.set("lat","51.961563"),o.searchParams.set("lon","7.628202"),o.searchParams.set("limit",t.toString());const i=await this.httpService.fetch(o,{signal:n});if(!i.ok)throw new Error("Request failed: "+i.status);return await i.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}}const Vl=ge("ol-app:AppModel");class Gl{_intl;_mapRegistry;_ogcSearchSourceFactory;_vectorSelectionSourceFactory;_httpService;_state;_resources=[];_featureHighlight=void 0;constructor({references:e,intl:t}){this._mapRegistry=e.mapRegistry,this._intl=t,this._ogcSearchSourceFactory=e.ogcSearchSourceFactory,this._vectorSelectionSourceFactory=e.vectorSelectionSourceFactory,this._httpService=e.httpService,this._state=wo({searchSources:[],selectionSources:[],sourceMetadata:Dl(),resultListState:{input:void 0,open:!1,key:0}}),this.initSearchSources(),this.initSelectionSources().catch(n=>{Vl.error("Failed to initialize selection sources",n)})}destroy(){this._resources.forEach(e=>e.destroy())}get state(){return this._state}setResultListInput(e){const t=this._state.resultListState.key;this._state.resultListState={open:!0,key:t+1,input:Be(e)}}setResultListVisibility(e){this._state.resultListState.open=e}highlightAndZoom(e,t){const n=e.olMap.getViewport();this.clearPreviousHighlight(),this._featureHighlight=e.highlightAndZoom(t,{viewPadding:n&&n.offsetWidth<1e3?{top:150,right:75,bottom:50,left:75}:{top:150,right:400,bottom:50,left:400}})}zoom(e,t){const n=e.olMap.getViewport();e.zoom(t,{viewPadding:n&&n.offsetWidth<1e3?{top:150,right:75,bottom:50,left:75}:{top:150,right:400,bottom:50,left:400}})}clearPreviousHighlight(){this._featureHighlight&&(this._featureHighlight.destroy(),this._featureHighlight=void 0)}initSearchSources(){const e=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.lika"}),baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"flurstueck",searchProperty:"flurstid",labelProperty:"objid"}),t=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(o){const i=o?.properties?.name,s=o?.id;return typeof i=="string"?i+" ("+s+")":String(s)},rewriteUrl(o){return o.searchParams.set("properties","name"),o}}),n=new Nl("Photon Geocoder",["city","street"],this._httpService);this._state.searchSources=[Be(e),Be(t),Be(n)]}async initSelectionSources(){const e=["ogc_kitas","ogc_kataster"],n=(await this._mapRegistry.expectMapModel(z)).layers.getOperationalLayers({sortByDisplayOrder:!0});for(const o of n){if(!e.includes(o.id)||!Bl(o.olLayer))continue;const i=this._vectorSelectionSourceFactory.createSelectionSource({vectorLayer:o.olLayer,label:o.title}),s=i.on("changed:status",()=>{i.status!=="available"&&(i.status==="unavailable"||i.status?.kind==="unavailable")&&this.clearPreviousHighlight()});this._resources.push(s,i),this._state.selectionSources.unshift(Be(i)),this._state.sourceMetadata.set(Be(i),o.attributes.resultListMetadata)}}}function Bl(r){return r instanceof ne&&r.getSource()instanceof Pe}const hn=0,St=1,pn=[0,0,0,0],$e=[],mr={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class vr extends Or{constructor(e,t,n){super(e),this.features=t,this.mapBrowserEvent=n}}class zl extends Si{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:_i,this.defaultDeleteCondition_=function(n){return wi(n)&&Xn(n)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:xi,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Ei,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new ne({source:new Pe({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:Hl(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new ot(this.source_.getFeatures()),this.source_.addEventListener(Zr.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Zr.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(We.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(We.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const o=this.SEGMENT_WRITERS_[t.getType()];o&&o(e,t)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),e.addEventListener(_r.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new ot;const n=this.featuresBeingModified_.getArray();for(let o=0,i=t.length;o<i;++o){const s=t[o];for(let a=0,l=s.length;a<l;++a){const c=s[a].feature;c&&!n.includes(c)&&this.featuresBeingModified_.push(c)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new vr(mr.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(_r.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,n=[];t.forEach(function(o){e===o.feature&&n.push(o)});for(let o=n.length-1;o>=0;--o){const i=n[o];for(let s=this.dragSegments_.length-1;s>=0;--s)this.dragSegments_[s][0]===i&&this.dragSegments_.splice(s,1);t.remove(i)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const n=t.getCoordinates(),o={feature:e,geometry:t,segment:[n,n]};this.rBush_.insert(t.getExtent(),o)}writeMultiPointGeometry_(e,t){const n=t.getCoordinates();for(let o=0,i=n.length;o<i;++o){const s=n[o],a={feature:e,geometry:t,depth:[o],index:o,segment:[s,s]};this.rBush_.insert(t.getExtent(),a)}}writeLineStringGeometry_(e,t){const n=t.getCoordinates();for(let o=0,i=n.length-1;o<i;++o){const s=n.slice(o,o+2),a={feature:e,geometry:t,index:o,segment:s};this.rBush_.insert(oe(s),a)}}writeMultiLineStringGeometry_(e,t){const n=t.getCoordinates();for(let o=0,i=n.length;o<i;++o){const s=n[o];for(let a=0,l=s.length-1;a<l;++a){const c=s.slice(a,a+2),d={feature:e,geometry:t,depth:[o],index:a,segment:c};this.rBush_.insert(oe(c),d)}}}writePolygonGeometry_(e,t){const n=t.getCoordinates();for(let o=0,i=n.length;o<i;++o){const s=n[o];for(let a=0,l=s.length-1;a<l;++a){const c=s.slice(a,a+2),d={feature:e,geometry:t,depth:[o],index:a,segment:c};this.rBush_.insert(oe(c),d)}}}writeMultiPolygonGeometry_(e,t){const n=t.getCoordinates();for(let o=0,i=n.length;o<i;++o){const s=n[o];for(let a=0,l=s.length;a<l;++a){const c=s[a];for(let d=0,h=c.length-1;d<h;++d){const f=c.slice(d,d+2),p={feature:e,geometry:t,depth:[a,o],index:d,segment:f};this.rBush_.insert(oe(f),p)}}}}writeCircleGeometry_(e,t){const n=t.getCenter(),o={feature:e,geometry:t,index:hn,segment:[n,n]},i={feature:e,geometry:t,index:St,segment:[n,n]},s=[o,i];o.featureSegments=s,i.featureSegments=s,this.rBush_.insert(hr(n),o);let a=t;this.rBush_.insert(a.getExtent(),i)}writeGeometryCollectionGeometry_(e,t){const n=t.getGeometriesArray();for(let o=0;o<n.length;++o){const i=n[o],s=this.SEGMENT_WRITERS_[i.getType()];s(e,i)}}createOrUpdateVertexFeature_(e,t,n){let o=this.vertexFeature_;return o?o.getGeometry().setCoordinates(e):(o=new De(new wt(e)),this.vertexFeature_=o,this.overlay_.getSource().addFeature(o)),o.set("features",t),o.set("geometries",n),o}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==Vt.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Vt.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==Vt.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],n=[],o=[];for(let i=0,s=this.dragSegments_.length;i<s;++i){const a=this.dragSegments_[i],l=a[0],c=l.feature;n.includes(c)||n.push(c);const d=l.geometry;o.includes(d)||o.push(d);const h=l.depth;let f;const p=l.segment,y=a[1];for(;t.length<d.getStride();)t.push(p[y][t.length]);switch(d.getType()){case"Point":f=t,p[0]=t,p[1]=t;break;case"MultiPoint":f=d.getCoordinates(),f[l.index]=t,p[0]=t,p[1]=t;break;case"LineString":f=d.getCoordinates(),f[l.index+y]=t,p[y]=t;break;case"MultiLineString":f=d.getCoordinates(),f[h[0]][l.index+y]=t,p[y]=t;break;case"Polygon":f=d.getCoordinates(),f[h[0]][l.index+y]=t,p[y]=t;break;case"MultiPolygon":f=d.getCoordinates(),f[h[1]][h[0]][l.index+y]=t,p[y]=t;break;case"Circle":if(p[0]=t,p[1]=t,l.index===hn)this.changingFeature_=!0,d.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let _=Xr(pe(d.getCenter()),pe(t));d.setRadius(_),this.changingFeature_=!1}break}f&&this.setGeometryCoordinates_(d,f)}this.createOrUpdateVertexFeature_(t,n,o)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(n){e.map.getView().getProjection();const o=[],i=n.getGeometry().getCoordinates(),s=oe([i]),a=this.rBush_.getInExtent(s),l={};a.sort(Ul);for(let c=0,d=a.length;c<d;++c){const h=a[c],f=h.segment;let p=re(h.geometry);const y=h.depth;if(y&&(p+="-"+y.join("-")),l[p]||(l[p]=new Array(2)),h.geometry.getType()==="Circle"&&h.index===St){const _=fn(t,h);Le(_,i)&&!l[p][0]&&(this.dragSegments_.push([h,0]),l[p][0]=h);continue}if(Le(f[0],i)&&!l[p][0]){this.dragSegments_.push([h,0]),l[p][0]=h;continue}if(Le(f[1],i)&&!l[p][1]){if(l[p][0]&&l[p][0].index===0){let _=h.geometry.getCoordinates();switch(h.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":_=_[y[1]];case"Polygon":if(h.index!==_[y[0]].length-2)continue;break}}this.dragSegments_.push([h,1]),l[p][1]=h;continue}re(f)in this.vertexSegments_&&!l[p][0]&&!l[p][1]&&this.insertVertexCondition_(e)&&o.push(h)}o.length&&this.willModifyFeatures_(e,[o]);for(let c=o.length-1;c>=0;--c)this.insertVertex_(o[c],i)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const n=this.dragSegments_[t][0],o=n.geometry;if(o.getType()==="Circle"){const i=o.getCenter(),s=n.featureSegments[0],a=n.featureSegments[1];s.segment[0]=i,s.segment[1]=i,a.segment[0]=i,a.segment[1]=i,this.rBush_.update(hr(i),s);let l=o;this.rBush_.update(l.getExtent(),a)}else this.rBush_.update(oe(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new vr(mr.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,n){const o=n||t.getCoordinateFromPixel(e);t.getView().getProjection();const i=function(l,c){return gn(o,l)-gn(o,c)};let s,a;if(this.hitDetection_){const l=typeof this.hitDetection_=="object"?c=>c===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,(c,d,h)=>{h&&h.getType()==="Point"&&(h=new wt(wr(h.getCoordinates())));const f=h||c.getGeometry();if(c instanceof De&&this.features_.getArray().includes(c)){a=f;const p=c.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:c,geometry:a,segment:[p,p]}]}return!0},{layerFilter:l})}if(!s){const l=ki(hr(o,pn)),c=t.getView().getResolution()*this.pixelTolerance_,d=Ci(Mi(l,c,pn));s=this.rBush_.getInExtent(d)}if(s&&s.length>0){const l=s.sort(i)[0],c=l.segment;let d=fn(o,l);const h=t.getPixelFromCoordinate(d);let f=Xr(e,h);if(a||f<=this.pixelTolerance_){const p={};if(p[re(c)]=!0,this.snapToPointer_||(this.delta_[0]=d[0]-o[0],this.delta_[1]=d[1]-o[1]),l.geometry.getType()==="Circle"&&l.index===St)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d,[l.feature],[l.geometry]);else{const y=t.getPixelFromCoordinate(c[0]),_=t.getPixelFromCoordinate(c[1]),M=xr(h,y),C=xr(h,_);f=Math.sqrt(Math.min(M,C)),this.snappedToVertex_=f<=this.pixelTolerance_,this.snappedToVertex_&&(d=M>C?c[1]:c[0]),this.createOrUpdateVertexFeature_(d,[l.feature],[l.geometry]);const F={};F[re(l.geometry)]=!0;for(let O=1,Y=s.length;O<Y;++O){const W=s[O].segment;if(Le(c[0],W[0])&&Le(c[1],W[1])||Le(c[0],W[1])&&Le(c[1],W[0])){const I=re(s[O].geometry);I in F||(F[I]=!0,p[re(W)]=!0)}else break}}this.vertexSegments_=p;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const n=e.segment,o=e.feature,i=e.geometry,s=e.depth,a=e.index;let l;for(;t.length<i.getStride();)t.push(0);switch(i.getType()){case"MultiLineString":l=i.getCoordinates(),l[s[0]].splice(a+1,0,t);break;case"Polygon":l=i.getCoordinates(),l[s[0]].splice(a+1,0,t);break;case"MultiPolygon":l=i.getCoordinates(),l[s[1]][s[0]].splice(a+1,0,t);break;case"LineString":l=i.getCoordinates(),l.splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(i,l);const c=this.rBush_;c.remove(e),this.updateSegmentIndices_(i,a,s,1);const d={segment:[n[0],t],feature:o,geometry:i,depth:s,index:a};c.insert(oe(d.segment),d),this.dragSegments_.push([d,1]);const h={segment:[t,n[1]],feature:o,geometry:i,depth:s,index:a+1};c.insert(oe(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Vt.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);const t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new vr(mr.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){const e=this.dragSegments_,t={};let n=!1,o,i,s,a,l,c,d,h,f,p,y;for(l=e.length-1;l>=0;--l)s=e[l],p=s[0],y=re(p.feature),p.depth&&(y+="-"+p.depth.join("-")),y in t||(t[y]={}),s[1]===0?(t[y].right=p,t[y].index=p.index):s[1]==1&&(t[y].left=p,t[y].index=p.index+1);for(y in t){switch(f=t[y].right,d=t[y].left,c=t[y].index,h=c-1,d!==void 0?p=d:p=f,h<0&&(h=0),a=p.geometry,i=a.getCoordinates(),o=i,n=!1,a.getType()){case"MultiLineString":i[p.depth[0]].length>2&&(i[p.depth[0]].splice(c,1),n=!0);break;case"LineString":i.length>2&&(i.splice(c,1),n=!0);break;case"MultiPolygon":o=o[p.depth[1]];case"Polygon":o=o[p.depth[0]],o.length>4&&(c==o.length-1&&(c=0),o.splice(c,1),n=!0,c===0&&(o.pop(),o.push(o[0]),h=o.length-1));break}if(n){this.setGeometryCoordinates_(a,i);const _=[];if(d!==void 0&&(this.rBush_.remove(d),_.push(d.segment[0])),f!==void 0&&(this.rBush_.remove(f),_.push(f.segment[1])),d!==void 0&&f!==void 0){const M={depth:p.depth,feature:p.feature,geometry:p.geometry,index:h,segment:_};this.rBush_.insert(oe(M.segment),M)}this.updateSegmentIndices_(a,c,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return n}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,n,o){this.rBush_.forEachInExtent(e.getExtent(),function(i){i.geometry===e&&(n===void 0||i.depth===void 0||Pi(i.depth,n))&&i.index>t&&(i.index+=o)})}}function Ul(r,e){return r.index-e.index}function gn(r,e,t){const n=e.geometry;if(n.getType()==="Circle"){let i=n;if(e.index===St){const s=xr(i.getCenter(),pe(r)),a=Math.sqrt(s)-i.getRadius();return a*a}}const o=pe(r);return $e[0]=pe(e.segment[0]),$e[1]=pe(e.segment[1]),Li(o,$e)}function fn(r,e,t){const n=e.geometry;if(n.getType()==="Circle"&&e.index===St)return wr(n.getClosestPoint(pe(r)));const o=pe(r);return $e[0]=pe(e.segment[0]),$e[1]=pe(e.segment[1]),wr(Ai(o,$e))}function Hl(){const r=Jn();return function(e,t){return r.Point}}const Wl=zl,$l={SELECT:"select"};class ql extends Or{constructor(e,t,n,o){super(e),this.selected=t,this.deselected=n,this.mapBrowserEvent=o}}const Gt={};class Ur extends Ii{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:Xn,this.addCondition_=e.addCondition?e.addCondition:Jr,this.removeCondition_=e.removeCondition?e.removeCondition:Jr,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Ri,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:Qr,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:Kl(),this.features_=e.features||new ot;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const n=e.layers;t=function(o){return n.includes(o)}}else t=Qr;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[re(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[re(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(We.ADD,this.boundAddFeature_),this.features_.addEventListener(We.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(We.ADD,this.boundAddFeature_),this.features_.removeEventListener(We.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const n=this.getMap().getAllLayers().find(function(o){if(o instanceof ne&&o.getSource()&&o.getSource().hasFeature(t))return o});n&&this.addFeatureLayerAssociation_(t,n)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=re(e);t in Gt||(Gt[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let o=t.length-1;o>=0;--o){const i=t[o];if(i!==this&&i instanceof Ur&&i.getStyle()&&i.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(i.getStyle());return}}const n=re(e);e.setStyle(Gt[n]),delete Gt[n]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[re(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),n=this.removeCondition_(e),o=this.toggleCondition_(e),i=!t&&!n&&!o,s=e.map,a=this.getFeatures(),l=[],c=[];if(i){Ti(this.featureLayerAssociation_),s.forEachFeatureAtPixel(e.pixel,(d,h)=>{if(!(!(d instanceof De)||!this.filter_(d,h)))return this.addFeatureLayerAssociation_(d,h),c.push(d),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let d=a.getLength()-1;d>=0;--d){const h=a.item(d),f=c.indexOf(h);f>-1?c.splice(f,1):(a.remove(h),l.push(h))}c.length!==0&&a.extend(c)}else{s.forEachFeatureAtPixel(e.pixel,(d,h)=>{if(!(!(d instanceof De)||!this.filter_(d,h)))return(t||o)&&!a.getArray().includes(d)?(this.addFeatureLayerAssociation_(d,h),c.push(d)):(n||o)&&a.getArray().includes(d)&&(l.push(d),this.removeFeatureLayerAssociation_(d)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let d=l.length-1;d>=0;--d)a.remove(l[d]);a.extend(c)}return(c.length>0||l.length>0)&&this.dispatchEvent(new ql($l.SELECT,c,l,e)),!0}}function Kl(){const r=Jn();return en(r.Polygon,r.LineString),en(r.GeometryCollection,r.LineString),function(e){return e.getGeometry()?r[e.getGeometry().getType()]:null}}const Yl=Ur,yr=.75,Bt=.1;let Zl=class extends Oi{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",n=e.tipLabel!==void 0?e.tipLabel:"Overview map",o=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof o=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;const i=e.label!==void 0?e.label:"›";typeof i=="string"?(this.label_=document.createElement("span"),this.label_.textContent=i):this.label_=i;const s=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=n,a.appendChild(s),a.addEventListener(_r.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const l=new ji({view:e.view,controls:new ot,interactions:new ot});this.ovmap_=l,e.layers&&e.layers.forEach(function(F){l.addLayer(F)});const c=document.createElement("div");c.className="ol-overviewmap-box",c.style.boxSizing="border-box",this.boxOverlay_=new it({position:[0,0],positioning:"center-center",element:c}),this.ovmap_.addOverlay(this.boxOverlay_);const d=t+" "+Fi+" "+Di+(this.collapsed_&&this.collapsible_?" "+tn:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=d,h.appendChild(this.ovmapDiv_),h.appendChild(a);const f=this,p=this.boxOverlay_,y=this.boxOverlay_.getElement(),_=function(F){return{clientX:F.clientX,clientY:F.clientY}},M=function(F){const O=_(F),Y=l.getEventCoordinateInternal(O);p.setPosition(Y)},C=function(F){const O=l.getEventCoordinateInternal(F);f.getMap().getView().setCenterInternal(O),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",C)};y.addEventListener("mousedown",function(){window.addEventListener("mousemove",M),window.addEventListener("mouseup",C)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const n=t.getView();n&&this.unbindView_(n),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push($n(e,Ni.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const n=e.getView();n&&(this.bindView_(n),n.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===pr.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const n=this.getMap().getView();this.bindView_(n)}else!this.ovmap_.isRendered()&&(e.key===pr.TARGET||e.key===pr.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new Yn({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(rn.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(rn.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const n=e.getSize(),i=e.getView().calculateExtentInternal(n);if(this.viewExtent_&&Vi(i,this.viewExtent_))return;this.viewExtent_=i;const s=t.getSize(),l=t.getView().calculateExtentInternal(s),c=t.getPixelFromCoordinateInternal(Gi(i)),d=t.getPixelFromCoordinateInternal(Bi(i)),h=Math.abs(c[0]-d[0]),f=Math.abs(c[1]-d[1]),p=s[0],y=s[1];h<p*Bt||f<y*Bt||h>p*yr||f>y*yr?this.resetExtent_():Kn(l,i)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,n=e.getSize(),i=e.getView().calculateExtentInternal(n),s=t.getView(),a=Math.log(yr/Bt)/Math.LN2,l=1/(Math.pow(2,a/2)*Bt);zi(i,l),s.fitInternal(Ui(i))}recenter_(){const e=this.getMap(),t=this.ovmap_,n=e.getView();t.getView().setCenterInternal(n.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const n=e.getSize(),o=e.getView(),i=t.getView(),s=this.rotateWithView_?0:-o.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),c=o.getCenterInternal(),d=o.getResolution(),h=i.getResolution(),f=n[0]*d/h,p=n[1]*d/h;if(a.setPosition(c),l){l.style.width=f+"px",l.style.height=p+"px";const y="rotate("+s+"rad)";l.style.transform=y}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=Hi(this.ovmap_,qn.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(tn),this.collapsed_?nn(this.collapseLabel_,this.label_):nn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const Xl=Zl;async function Jl(r,e,t,n){const i=n.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),s=await r.fetch(e,{method:"POST",body:JSON.stringify({type:"Feature",properties:{},geometry:t}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${i}>`}});if(!s||!s.ok||s.status!==201)throw new Error("Request failed: "+s.status);const a=s.headers.get("location");if(!a)throw new Error("Request failed: no Location response header");const l=a.substring(a.lastIndexOf("/")+1);return Promise.resolve(l)}async function Ql(r,e,t,n,o){const s=o.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),a=new URL(`${e.toString()}/${t}`),l=await r.fetch(a,{method:"PATCH",body:JSON.stringify({type:"Feature",properties:{},geometry:n}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${s}>`}});if(!l||!l.ok||l.status!==204)throw new Error("Request failed: "+l.status);return Promise.resolve(t)}function ko(r,e){const t=document.createElement("div");t.className="editing-tooltip editing-tooltip-hidden",t.textContent=e;const n=new it({element:t,offset:[15,0],positioning:"center-left"}),o=r.on("pointermove",i=>{i.dragging||n.setPosition(i.coordinate)});return r.addOverlay(n),{destroy(){ee(o),r.removeOverlay(n)},setVisible(i){t.classList.toggle("editing-tooltip-hidden",!i)},setText(i){t.textContent=i}}}function Co(r){let e=mn(r.polygon);Array.isArray(e)&&(e=e[0]);let t=mn(r.vertex);Array.isArray(t)&&(t=t[0]);const n=[];return e&&n.push(e),t&&(t.setGeometry(ec),n.push(t)),n}const ec=r=>{if(r){const e=r.getGeometry();if(e&&e.getType()==="Polygon"){const t=e.getCoordinates()[0];if(t)return new Ms(t)}}},mn=r=>{const e=new De,n=new ne({style:r}).getStyleFunction();if(!n)throw new Error("can't retrieve style function");const o=n(e,1);if(!o)throw new Error("can't retrieve styles from feature style function");return Array.isArray(o)&&o.length?o.length>1?o:o[0]:o},tc=ge("editing:EditingCreateWorkflowImpl");var ve;class rc extends ir{constructor(t){super();R(this,ve,void 0);L(this,"_httpService");L(this,"_intl");L(this,"_map");L(this,"_polygonStyle");L(this,"_vertexStyle");L(this,"_state");L(this,"_editLayerURL");L(this,"_featureId");L(this,"_editingSource");L(this,"_editingLayer");L(this,"_drawInteraction");L(this,"_olMap");L(this,"_mapContainer");L(this,"_tooltip");L(this,"_enterHandler");L(this,"_escapeHandler");L(this,"_error");L(this,"_interactionListener");L(this,"_mapListener");this._httpService=t.httpService,this._intl=t.intl,this._polygonStyle=t.polygonStyle,this._vertexStyle=t.vertexStyle,this._map=t.map,this._olMap=t.map.olMap,this._state="active:initialized",this._editLayerURL=t.ogcApiFeatureLayerUrl,this._editingSource=new Pe,this._editingLayer=new ne({source:this._editingSource,zIndex:sr,properties:{name:"editing-layer"}}),this._drawInteraction=new io({source:this._editingSource,type:"Polygon",style:Co({polygon:this._polygonStyle,vertex:this._vertexStyle})}),this._tooltip=ko(this._olMap,this._intl.formatMessage({id:"create.tooltip.begin"})),this._enterHandler=n=>{if((n.code==="Enter"||n.code==="NumpadEnter")&&n.target===this._olMap.getTargetElement()){const o=this._drawInteraction.getOverlay().getSource().getFeatures();o[0]&&o[0].getGeometry().getCoordinates()[0].length>4&&this.triggerSave()}},this._escapeHandler=n=>{n.code==="Escape"&&n.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getDrawInteraction(){return this._drawInteraction}getState(){return this._state}_setState(t){this._state=t,this.emit(t)}_save(t){this._setState("active:saving");const n=this._editLayerURL,o=t.getGeometry();if(!o){this._destroy(),this._error=new Error("no geometry available"),w(this,ve)?.reject(this._error);return}const i=this._olMap.getView().getProjection(),a=new Nt({dataProjection:i}).writeGeometryObject(o,{rightHanded:!0,decimals:10});Jl(this._httpService,n,a,i).then(l=>{this._featureId=l,this._destroy(),w(this,ve)?.resolve({featureId:this._featureId})}).catch(l=>{tc.error(l),this._destroy(),this._error=new Error("Failed to save feature",{cause:l}),w(this,ve)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._drawInteraction),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1)),this._tooltip.setVisible(!0);const t=this._drawInteraction.on("drawstart",()=>{this._setState("active:drawing"),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.continue"}))}),n=this._drawInteraction.on("drawend",i=>{const s=i.feature;if(!s){this._destroy(),this._error=new Error("no feature available"),w(this,ve)?.reject(this._error);return}this._save(s)}),o=this._map.on("changed:container",()=>{this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1))});this._interactionListener.push(t,n),this._mapListener.push(o)}reset(){this._drawInteraction.abortDrawing(),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.begin"})),this._setState("active:initialized")}stop(){this._destroy(),w(this,ve)?.resolve(void 0)}_destroy(){this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._drawInteraction),this._tooltip.destroy(),this._interactionListener.map(t=>{ee(t)}),this._mapListener.map(t=>{t.destroy()}),this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._setState("destroyed")}triggerSave(){this._drawInteraction.finishDrawing()}whenComplete(){return this._state==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(w(this,ve)??T(this,ve,zn())).promise}}ve=new WeakMap;var ae;class nc extends ir{constructor(t){super();R(this,ae,void 0);L(this,"_httpService");L(this,"_intl");L(this,"_map");L(this,"_polygonStyle");L(this,"_vertexStyle");L(this,"_state");L(this,"_editLayerURL");L(this,"_featureId");L(this,"_initialFeature");L(this,"_editFeature");L(this,"_editingSource");L(this,"_editingLayer");L(this,"_modifyInteraction");L(this,"_olMap");L(this,"_mapContainer");L(this,"_tooltip");L(this,"_enterHandler");L(this,"_escapeHandler");L(this,"_error");L(this,"_interactionListener");L(this,"_mapListener");this._httpService=t.httpService,this._intl=t.intl,this._polygonStyle=t.polygonStyle,this._vertexStyle=t.vertexStyle,this._map=t.map,this._olMap=t.map.olMap,this._state="active:initialized",this._editLayerURL=t.ogcApiFeatureLayerUrl,this._initialFeature=t.feature.clone(),this._initialFeature.setId(t.feature.getId()),this._editFeature=t.feature.clone(),this._editFeature.setId(t.feature.getId()),this._editFeature.setStyle(Co({polygon:this._polygonStyle,vertex:this._vertexStyle})),this._editingSource=new Pe({features:new ot([this._editFeature])}),this._editingLayer=new ne({source:this._editingSource,zIndex:sr,properties:{name:"editing-layer"}}),this._modifyInteraction=new Wl({source:this._editingSource}),this._tooltip=ko(this._olMap,this._intl.formatMessage({id:"create.tooltip.deselect"})),this._enterHandler=n=>{if((n.code==="Enter"||n.code==="NumpadEnter")&&n.target===this._olMap.getTargetElement()){const o=this._editingSource.getFeatures()[0];if(!o)throw Error("no updated feature found");this._save(o)}},this._escapeHandler=n=>{n.code==="Escape"&&n.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getModifyInteraction(){return this._modifyInteraction}getState(){return this._state}_setState(t){this._state=t,this.emit(t)}_save(t){this._setState("active:saving");const n=this._editLayerURL;if(this._featureId=t.getId()?.toString(),!this._featureId){this._destroy(),this._error=new Error("no feature id available"),w(this,ae)?.reject(this._error);return}const o=t?.getGeometry();if(!o){this._destroy(),this._error=new Error("no geometry available"),w(this,ae)?.reject(this._error);return}const i=this._olMap.getView().getProjection(),a=new Nt({dataProjection:i}).writeGeometryObject(o,{rightHanded:!0,decimals:10});Ql(this._httpService,n,this._featureId,a,i).then(l=>{this._destroy(),w(this,ae)?.resolve({featureId:l})}).catch(l=>{this._destroy(),this._error=new Error("Failed to save feature",{cause:l}),w(this,ae)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._modifyInteraction);const t=this._editingSource.getFeatures()[0];if(t&&!t.getId()?.toString()){this._destroy(),this._error=new Error("no feature id available"),w(this,ae)?.reject(this._error);return}this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1)),this._tooltip.setVisible(!0);const n=this._map.olMap.on("click",s=>{const a=s.coordinate,l=s.originalEvent.altKey,c=this._editingSource.getFeaturesAtCoordinate(a);l||c.length===0&&this.triggerSave()}),o=this._modifyInteraction.on("modifystart",()=>{this._setState("active:drawing")}),i=this._map.on("changed:container",()=>{this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1))});this._interactionListener.push(n,o),this._mapListener.push(i)}reset(){const t=this._initialFeature.getGeometry()?.clone(),n=this._editingSource.getFeatures()[0];if(!n)throw Error("no updated feature found");n.setGeometry(t),this._setState("active:initialized")}stop(){this._destroy(),w(this,ae)?.resolve(void 0)}_destroy(){this._editingSource.clear(),this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._modifyInteraction),this._tooltip.destroy(),this._interactionListener.map(t=>{ee(t)}),this._mapListener.map(t=>{t.destroy()}),this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._setState("destroyed")}triggerSave(){const t=this._editingSource.getFeatures()[0];if(!t)throw Error("no updated feature found");this._save(t)}whenComplete(){return this._state==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(w(this,ae)??T(this,ae,zn())).promise}}ae=new WeakMap;class oc{_serviceOptions;_workflows;constructor(e){this._serviceOptions=e,this._workflows=new Map}createFeature(e,t){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const n=e.id;let o=this._workflows.get(n);if(o)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return o=new rc({map:e,ogcApiFeatureLayerUrl:t,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(n,o),this._connectToWorkflowDestroyEvent(o,n),o}updateFeature(e,t,n){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const o=e.id;let i=this._workflows.get(o);if(i)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return i=new nc({map:e,ogcApiFeatureLayerUrl:t,feature:n,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(o,i),this._connectToWorkflowDestroyEvent(i,o),i}stop(e){const t=this._workflows.get(e);t&&t.stop()}reset(e){const t=this._workflows.get(e);if(t)t.reset();else throw new Error("No workflow found for mapId: "+e)}_connectToWorkflowDestroyEvent(e,t){e.on("destroyed",()=>{this._workflows.get(t)===e&&this._workflows.delete(t)})}}new wt([407354,5754673]),new wt([404740,5757893]);var Re,Ee,Pt,At,Lt,Rr;class ic extends ir{constructor(t,n,o){super();R(this,Lt);L(this,"label");R(this,Re,{kind:"available"});R(this,Ee,void 0);R(this,Pt,void 0);R(this,At,void 0);this.label=n,T(this,Ee,t),T(this,At,o),q(this,Lt,Rr).call(this),T(this,Pt,w(this,Ee).on("change:visible",()=>{q(this,Lt,Rr).call(this)}))}destroy(){ee(w(this,Pt))}get status(){return w(this,Re)}async select(t,n){if(t.type!=="extent")throw new Error(`Unsupported selection kind: ${t.type}`);if(w(this,Re).kind!=="available"||w(this,Ee).getSource()===null)return[];const o=[];w(this,Ee).getSource().forEachFeatureIntersectingExtent(t.extent,a=>{if(!a.getGeometry())return;const l={...a.getProperties()};delete l.geometries;const c={id:a.getId()?.toString()||Qn(),geometry:a.getGeometry(),properties:l};o.push(c)});const i=o.filter(a=>a!=null);return i.length>n.maxResults?i.slice(0,n.maxResults):i}}Re=new WeakMap,Ee=new WeakMap,Pt=new WeakMap,At=new WeakMap,Lt=new WeakSet,Rr=function(){const n=w(this,Ee).getVisible()?{kind:"available"}:{kind:"unavailable",reason:w(this,At)};n.kind!==w(this,Re).kind&&(T(this,Re,n),this.emit("changed:status"))};var It;class sc{constructor({intl:e}){R(this,It,void 0);T(this,It,e)}createSelectionSource(e){return new ic(e.vectorLayer,e.label,w(this,It).formatMessage({id:"layerNotVisibleReason"}))}}It=new WeakMap;const je=ge("local-storage"),ac=0,he={CORRUPTED_DATA:"local-storage:corrupted-data",INVALID_PATH:"local-storage:invalid-path",INVALID_VALUE:"local-storage:invalid-value",NOT_SUPPORTED:"local-storage:not-supported",INTERNAL:"local-storage:internal-error"};var Je,le,ke,Qe,ce,Jt,Mo,Qt,Po,Te,yt,Ce,Ue,er,Ao;class lc{constructor(e){R(this,Jt);R(this,Qt);R(this,Te);R(this,Ce);R(this,er);R(this,Je,void 0);R(this,le,{});R(this,ke,void 0);R(this,Qe,void 0);R(this,ce,void 0);T(this,Je,hc(e.properties)),T(this,ke,pc()),w(this,ke)&&(q(this,Qt,Po).call(this),T(this,Qe,q(this,er,Ao).call(this)))}destroy(){w(this,ce)&&(clearTimeout(w(this,ce)),T(this,ce,void 0)),w(this,ke)&&q(this,Te,yt).call(this)}get isSupported(){return!!w(this,Qe)}get(e){return q(this,Ce,Ue).call(this).get(e)}set(e,t){return q(this,Ce,Ue).call(this).set(e,t)}remove(e){return q(this,Ce,Ue).call(this).remove(e)}removeAll(){return q(this,Ce,Ue).call(this).removeAll()}getNamespace(e){return q(this,Ce,Ue).call(this).getNamespace(e)}}Je=new WeakMap,le=new WeakMap,ke=new WeakMap,Qe=new WeakMap,ce=new WeakMap,Jt=new WeakSet,Mo=function(){w(this,ce)&&clearTimeout(w(this,ce)),T(this,ce,setTimeout(()=>{T(this,ce,void 0),q(this,Te,yt).call(this)},ac))},Qt=new WeakSet,Po=function(){try{const e=w(this,ke);if(!e)throw new de(he.INTERNAL,"Local storage is not available.");const t=e.getItem(w(this,Je));if(t==null){T(this,le,{}),q(this,Te,yt).call(this);return}try{const n=JSON.parse(t);if(!lt(n))throw new de(he.CORRUPTED_DATA,"Persisted value should be an object.");T(this,le,n)}catch(n){je.warn("Invalid persisted data, reverting to default.",n),T(this,le,{}),q(this,Te,yt).call(this)}}catch(e){je.error("Failed to load from local storage",e)}},Te=new WeakSet,yt=function(){try{const e=w(this,ke);if(!e)throw new de(he.INTERNAL,"Local storage is not available.");const t=JSON.stringify(w(this,le));e.setItem(w(this,Je),t)}catch(e){je.error("Failed to save to local storage",e)}},Ce=new WeakSet,Ue=function(){const e=w(this,Qe);if(!e)throw new de(he.NOT_SUPPORTED,"Local storage is not supported by this browser.");return e},er=new WeakSet,Ao=function(){const e={getByPath:t=>yn(cc(w(this,le),t)),setByPath:(t,n)=>{if(!dc(n))throw new de(he.INVALID_VALUE,"The value is not supported by local storage.");if(n=yn(n),t.length===0){if(!lt(n))throw new de(he.INVALID_VALUE,"The root value must be a plain object.");T(this,le,n)}else uc(w(this,le),t,n);q(this,Jt,Mo).call(this)}};return new Hr([],e)};class Hr{path;access;constructor(e,t){this.path=e,this.access=t}get(e){return this.access.getByPath([...this.path,e])}set(e,t){this.access.setByPath([...this.path,e],t)}remove(e){this.access.setByPath([...this.path,e],void 0)}removeAll(){this.access.setByPath(this.path,{})}getNamespace(e){const t=this.get(e);if(t===void 0)this.set(e,{});else if(!lt(t))throw new de(he.INVALID_PATH,`Cannot use '${e}' as a namespace because it is not associated with an object.`);return new Hr(this.path.concat([e]),this.access)}}const vn="trails-state";function cc(r,e){let t=r;for(const n of e){if(!lt(t))throw new de(he.INVALID_PATH,`Cannot get nested property '${n}' because the parent is no object.`);t=t[n]}return t}function uc(r,e,t){if(!e.length)throw new de(he.INTERNAL,"Path must not be empty.");let n=r;for(let i=0,s=e.length-1;i<s;++i){const a=e[i],l=n[a];if(!lt(l))throw new de(he.INVALID_PATH,`Cannot set property on '${a}' because it is no object.`);n=l}const o=e[e.length-1];n[o]=t}function lt(r){return!!(r&&typeof r=="object"&&!Array.isArray(r))}function dc(r){const e=typeof r;return e==="boolean"||e==="number"||e==="string"||e==="undefined"||r===null||Array.isArray(r)||lt(r)}function hc(r){const e=r.storageId;return!e||typeof e!="string"?(je.warn(`The 'storageId' property of the 'local-storage' package should be set to a valid string to avoid collisions with other applications. Defaulting to '${vn}'.`),vn):e}function pc(){if(typeof Storage>"u"){je.warn("Local storage is not supported by this browser.");return}try{const r=globalThis.localStorage;if(!r){je.warn("Local storage is not supported by this browser.");return}return r}catch(r){je.warn("Local storage is not supported by this browser.",r);return}}function yn(r){return r!=null&&(r=JSON.parse(JSON.stringify(r))),r}const gc={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:ll,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},AppModel:{name:"AppModel",clazz:Gl,provides:[{name:"ol-app.AppModel",qualifier:void 0}],references:{ogcSearchSourceFactory:{name:"ogc-features.SearchSourceFactory",qualifier:void 0,all:!1},vectorSelectionSourceFactory:{name:"selection.VectorSelectionSourceFactory",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1},mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppModel",qualifier:void 0,all:!1},{name:"notifier.NotificationService",qualifier:void 0,all:!1},{name:"editing.EditingService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:Wi,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:ms,provides:[{name:"notifier.NotificationService",qualifier:"notifier.NotificationService"}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:$i,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:ws,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:xs,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/printing":{name:"@open-pioneer/printing",services:{PrintingServiceImpl:{name:"PrintingServiceImpl",clazz:vs,provides:[{name:"printing.PrintingService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1},{name:"printing.PrintingService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/editing":{name:"@open-pioneer/editing",services:{EditingServiceImpl:{name:"EditingServiceImpl",clazz:oc,provides:[{name:"editing.EditingService",qualifier:void 0}],references:{mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{polygonStyle:{value:{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"red","stroke-width":1.25,"circle-radius":3,"circle-fill-color":"red","circle-stroke-width":1.25,"circle-stroke-color":"red"},required:!1},vertexStyle:{value:{"circle-radius":3,"circle-fill-color":"red","circle-stroke-width":1.25,"circle-stroke-color":"red"},required:!1}}},"@open-pioneer/legend":{name:"@open-pioneer/legend",services:{},ui:{references:[]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/result-list":{name:"@open-pioneer/result-list",services:{},ui:{references:[]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/selection":{name:"@open-pioneer/selection",services:{VectorSelectionSourceFactory:{name:"VectorSelectionSourceFactory",clazz:sc,provides:[{name:"selection.VectorSelectionSourceFactory",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:lc,provides:[{name:"local-storage.LocalStorageService",qualifier:"local-storage.LocalStorageService"}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}}},fc=`.search-box{position:absolute;width:500px;max-width:100%;z-index:1}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.printing-overlay{position:absolute;top:0;right:0;bottom:0;left:0;z-index:10000;-webkit-user-select:none;user-select:none;pointer-events:all;cursor:wait;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#b4b4b4cc}.printing-overlay-status{flex:1 1 auto;font-size:1.5em;text-align:center}.editing-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.editing-tooltip-hidden{visibility:hidden}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.selection-drag-box{background-color:#ffffff4d!important;border:3px solid var(--chakra-colors-background_primary)!important}.selection-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.selection .react-select{cursor:default}.map-container .selection-active{cursor:crosshair}.map-container .selection-inactive{cursor:no-drop}.selection-source-value.selection-source-value--disabled{opacity:.4}.selection-source-value.selection-source-value--disabled span{margin:0 6px 0 0}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}.result-list-no-data-message{text-align:center;margin-top:50px;font-weight:700;font-size:larger}.result-list-table th,.result-list-table td{overflow-wrap:break-word}.result-list-table.result-list-table--is-resizing *{cursor:col-resize}.result-list-table thead{position:sticky;top:0;z-index:1;background:var(--chakra-colors-background_body)}.result-list-table th{position:relative;border-right-width:thin}.result-list-table tbody tr:hover{background:var(--chakra-colors-background_light)}.result-list-table .result-list-resizer{position:absolute;top:0;height:100%;right:0;width:8px;background:var(--chakra-colors-trails-100);transform:scaleX(.25);cursor:col-resize;-webkit-user-select:none;user-select:none;touch-action:none;padding-left:0}.result-list-table th:last-child .result-list-resizer{width:8px;transform:translate(50%) scaleX(.25)}.result-list-table th .result-list-resizer.result-list-resizer--is-resizing{background:var(--chakra-colors-trails-500);transform:scale(1)}.result-list-table th .result-list-resizer:hover{transform:scale(1)}
`,mc=["en","de"];function vc(r){switch(r){case"en":return Cr(()=>import("./cb5c62a8d19f.js"),[],import.meta.url).then(e=>e.default);case"de":return Cr(()=>import("./28974dee0275.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${r}'`)}const yc=Jo(fc),bc=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:vc,locales:mc,packages:gc,styles:yc},Symbol.toStringTag,{value:"Module"})),Sc="@open-pioneer/coordinate-viewer",_c=fe.bind(void 0,Sc),wc=4,xc=r=>{const{mapId:e,precision:t,displayProjectionCode:n}=r,{containerProps:o}=se("coordinate-viewer",r),{map:i}=J(e),s=i?.olMap,a=vo(s)?.getCode()??"";let{coordinates:l}=kc(s);l=l&&n?Mc(l,a,n):l;const c=Ec(l,t),d=n||a,h=c?c+" "+d:"";return u.jsx(N,{...o,children:u.jsx(Se,{className:"coordinate-viewer-text",children:h})})};function Ec(r,e){const t=_c();return r?Cc(r,e,t):""}function kc(r){const[e,t]=g.useState();return g.useEffect(()=>{if(!r)return;const n=r.on("pointermove",o=>{t(o.coordinate)});return()=>ee(n)},[r]),{coordinates:e}}function Cc(r,e,t){if(r[0]==null||r[1]==null)return"";const n=e??wc,[o,i]=r,s=t.formatNumber(o,{maximumFractionDigits:n,minimumFractionDigits:n}),a=t.formatNumber(i,{maximumFractionDigits:n,minimumFractionDigits:n});return s+" "+a}function Mc(r,e,t){return qi(r,e,t)}function bn(r){const e=g.useRef(null);return g.useLayoutEffect(()=>{e.current=r}),g.useCallback((...n)=>{const o=e.current;return o(...n)},[])}const Pc="@open-pioneer/notifier",Ac=ut.bind(void 0,Pc);var Lo=so({displayName:"WarningTwoIcon",d:"M23.119,20,13.772,2.15h0a2,2,0,0,0-3.543,0L.881,20a2,2,0,0,0,1.772,2.928H21.347A2,2,0,0,0,23.119,20ZM11,8.423a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Zm1.05,11.51h-.028a1.528,1.528,0,0,1-1.522-1.47,1.476,1.476,0,0,1,1.448-1.53h.028A1.527,1.527,0,0,1,13.5,18.4,1.475,1.475,0,0,1,12.05,19.933Z"}),Lc=so({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const Ic=!1;function Rc(r){const{position:e="top-right"}=r,t=Ts(),n=Ac("notifier.NotificationService"),[o,i]=g.useState(!Ic),s=bn(l=>{const c=l.level==="error"?u.jsx(Lo,{h:"100%",w:"100%"}):void 0;t({position:e,title:l.title,description:l.message||null,status:l.level,isClosable:!0,duration:l.displayDuration??null,icon:c})}),a=bn(()=>{t.closeAll()});return g.useEffect(()=>{const l=n.registerHandler({showNotification:s,closeAll:a});return()=>l.destroy()},[o,n,s,a]),u.jsx(u.Fragment,{})}const Tc=r=>{const{mapId:e,displayMode:t="line"}=r,{containerProps:n}=se("scale-bar",r),{map:o}=J(e),i=g.useRef(null);return g.useEffect(()=>{if(i.current&&o){const s=o.olMap,a=new ys({units:"metric",target:i.current,bar:t==="bar"});return s.addControl(a),()=>{s.removeControl(a)}}},[t,o]),u.jsx(N,{...n,ref:i})},Oc="@open-pioneer/scale-viewer",jc=fe.bind(void 0,Oc),Fc=r=>{const{mapId:e}=r,{containerProps:t}=se("scale-viewer",r),{map:n}=J(e),o=jc(),i=rl(n?.olMap),s=i?o.formatNumber(i):void 0;return u.jsx(N,{...t,children:s&&u.jsxs(Se,{children:["1:",s]})})},Io="ol-map",be=ut.bind(void 0,Io),Ae=fe.bind(void 0,Io);let Dc=0;function Nc(r,e){const t=`atom${++Dc}`,n={toString:()=>t};return typeof r=="function"?n.read=r:(n.init=r,n.read=function(o){return o(this)},n.write=function(o,i,s){return i(this,typeof s=="function"?s(o(this)):s)}),e&&(n.write=e),n}const Sn=r=>"init"in r,_n=r=>!!r.write,Kt=new WeakMap,Vc=(r,e)=>{Kt.set(r,e),r.catch(()=>{}).finally(()=>Kt.delete(r))},wn=(r,e)=>{const t=Kt.get(r);t&&(Kt.delete(r),t(e))},xn=(r,e)=>{r.status="fulfilled",r.value=e},En=(r,e)=>{r.status="rejected",r.reason=e},Gc=r=>typeof r?.then=="function",gt=(r,e)=>!!r&&"v"in r&&"v"in e&&Object.is(r.v,e.v),kn=(r,e)=>!!r&&"e"in r&&"e"in e&&Object.is(r.e,e.e),ze=r=>!!r&&"v"in r&&r.v instanceof Promise,Bc=(r,e)=>"v"in r&&"v"in e&&r.v.orig&&r.v.orig===e.v.orig,zt=r=>{if("e"in r)throw r.e;return r.v},Wr=()=>{const r=new WeakMap,e=new WeakMap,t=new Map;let n,o;const i=v=>r.get(v),s=(v,b)=>{const S=r.get(v);if(r.set(v,b),t.has(v)||t.set(v,S),ze(S)){const m="v"in b?b.v instanceof Promise?b.v:Promise.resolve(b.v):Promise.reject(b.e);S.v!==m&&wn(S.v,m)}},a=(v,b,S)=>{const m=new Map;let x=!1;S.forEach((A,E)=>{!A&&E===v&&(A=b),A&&(m.set(E,A),b.d.get(E)!==A&&(x=!0))}),(x||b.d.size!==m.size)&&(b.d=m)},l=(v,b,S)=>{const m=i(v),x={d:m?.d||new Map,v:b};if(S&&a(v,x,S),gt(m,x)&&m.d===x.d)return m;if(ze(m)&&ze(x)&&Bc(m,x)){if(m.d===x.d)return m;x.v=m.v}return s(v,x),x},c=(v,b,S,m)=>{if(Gc(b)){let x;const A=()=>{const P=i(v);if(!ze(P)||P.v!==E)return;const G=l(v,E,S);e.has(v)&&P.d!==G.d&&W(v,G,P.d)},E=new Promise((P,G)=>{let D=!1;b.then(U=>{D||(D=!0,xn(E,U),P(U),A())},U=>{D||(D=!0,En(E,U),G(U),A())}),x=U=>{D||(D=!0,U.then(K=>xn(E,K),K=>En(E,K)),P(U))}});return E.orig=b,E.status="pending",Vc(E,P=>{P&&x(P),m?.()}),l(v,E,S)}return l(v,b,S)},d=(v,b,S)=>{const m=i(v),x={d:m?.d||new Map,e:b};return S&&a(v,x,S),kn(m,x)&&m.d===x.d?m:(s(v,x),x)},h=(v,b)=>{const S=i(v);if(!b&&S&&(e.has(v)||Array.from(S.d).every(([D,U])=>{if(D===v)return!0;const K=h(D);return K===U||gt(K,U)})))return S;const m=new Map;let x=!0;const A=D=>{if(D===v){const K=i(D);if(K)return m.set(D,K),zt(K);if(Sn(D))return m.set(D,void 0),D.init;throw new Error("no atom init")}const U=h(D);return m.set(D,U),zt(U)};let E,P;const G={get signal(){return E||(E=new AbortController),E.signal},get setSelf(){return!P&&_n(v)&&(P=(...D)=>{if(!x)return F(v,...D)}),P}};try{const D=v.read(A,G);return c(v,D,m,()=>E?.abort())}catch(D){return d(v,D,m)}finally{x=!1}},f=v=>zt(h(v)),p=v=>{let b=e.get(v);return b||(b=O(v)),b},y=(v,b)=>!b.l.size&&(!b.t.size||b.t.size===1&&b.t.has(v)),_=v=>{const b=e.get(v);b&&y(v,b)&&Y(v)},M=v=>{const b=new Map,S=new WeakMap,m=E=>{var P;const G=new Set((P=e.get(E))==null?void 0:P.t);return t.forEach((D,U)=>{var K;(K=i(U))!=null&&K.d.has(E)&&G.add(U)}),G},x=E=>{m(E).forEach(P=>{P!==E&&(b.set(P,(b.get(P)||new Set).add(E)),S.set(P,(S.get(P)||0)+1),x(P))})};x(v);const A=E=>{m(E).forEach(P=>{var G;if(P!==E){let D=S.get(P);if(D&&S.set(P,--D),!D){let U=!!((G=b.get(P))!=null&&G.size);if(U){const K=i(P),Uo=h(P,!0);U=!gt(K,Uo)}U||b.forEach(K=>K.delete(P))}A(P)}})};A(v)},C=(v,...b)=>{let S=!0;const m=E=>zt(h(E)),x=(E,...P)=>{let G;if(E===v){if(!Sn(E))throw new Error("atom not writable");const D=i(E),U=c(E,P[0]);gt(D,U)||M(E)}else G=C(E,...P);if(!S){const D=I()}return G},A=v.write(m,x,...b);return S=!1,A},F=(v,...b)=>{const S=C(v,...b),m=I();return S},O=(v,b,S)=>{var m;const x=S||[];(m=i(v))==null||m.d.forEach((E,P)=>{const G=e.get(P);G?G.t.add(v):P!==v&&O(P,v,x)}),h(v);const A={t:new Set(b&&[b]),l:new Set};if(e.set(v,A),_n(v)&&v.onMount){const{onMount:E}=v;x.push(()=>{const P=E((...G)=>F(v,...G));P&&(A.u=P)})}return S||x.forEach(E=>E()),A},Y=v=>{var b;const S=(b=e.get(v))==null?void 0:b.u;S&&S(),e.delete(v);const m=i(v);m&&(ze(m)&&wn(m.v),m.d.forEach((x,A)=>{if(A!==v){const E=e.get(A);E&&(E.t.delete(v),y(A,E)&&Y(A))}}))},W=(v,b,S)=>{const m=new Set(b.d.keys());S?.forEach((x,A)=>{if(m.has(A)){m.delete(A);return}const E=e.get(A);E&&(E.t.delete(v),y(A,E)&&Y(A))}),m.forEach(x=>{const A=e.get(x);A?A.t.add(v):e.has(v)&&O(x,v)})},I=()=>{let v;for(;t.size;){const b=Array.from(t);t.clear(),b.forEach(([S,m])=>{const x=i(S);if(x){const A=e.get(S);A&&x.d!==m?.d&&W(S,x,m?.d),A&&!(!ze(m)&&(gt(m,x)||kn(m,x)))&&A.l.forEach(E=>E())}})}};return{get:f,set:F,sub:(v,b)=>{const S=p(v),m=I(),x=S.l;return x.add(b),()=>{x.delete(b),_(v)}}}};let br;const zc=()=>(br||(br=Wr()),br),Ro=g.createContext(void 0),Uc=r=>{const e=g.useContext(Ro);return r?.store||e||zc()},Hc=({children:r,store:e})=>{const t=g.useRef();return!e&&!t.current&&(t.current=Wr()),g.createElement(Ro.Provider,{value:e||t.current},r)},Wc=r=>typeof r?.then=="function",$c=Bn.use||(r=>{if(r.status==="pending")throw r;if(r.status==="fulfilled")return r.value;throw r.status==="rejected"?r.reason:(r.status="pending",r.then(e=>{r.status="fulfilled",r.value=e},e=>{r.status="rejected",r.reason=e}),r)});function qc(r,e){const t=Uc(e),[[n,o,i],s]=g.useReducer(c=>{const d=t.get(r);return Object.is(c[0],d)&&c[1]===t&&c[2]===r?c:[d,t,r]},void 0,()=>[t.get(r),t,r]);let a=n;(o!==t||i!==r)&&(s(),a=t.get(r));const l=e?.delay;return g.useEffect(()=>{const c=t.sub(r,()=>{if(typeof l=="number"){setTimeout(s,l);return}s()});return s(),c},[t,r,l]),g.useDebugValue(a),Wc(a)?$c(a):a}const To="@open-pioneer/spatial-bookmarks",Kc=ut.bind(void 0,To),Yc=fe.bind(void 0,To),we=ge("spatial-bookmark:SpatialBookmarkViewModel");class Zc{map;packageNamespace;writableBookmarks=Nc([]);stopBookmarksListener;store;get bookmarks(){return this.writableBookmarks}constructor(e,t){this.map=e,this.packageNamespace=t.getNamespace("spatial-bookmarks"),this.store=Wr(),this.loadState(),this.stopBookmarksListener=this.store.sub(this.bookmarks,()=>{this.saveState()})}destroy(){this.stopBookmarksListener()}createBookmark(e){const t=this.map.olMap,n=t.getView().calculateExtent(),o=t.getView().getProjection().getCode(),i={minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]},s={id:Qn(),title:e,extent:i,projection:o};we.debug("Created a new bookmark",s);const a=this.writableBookmarks;this.store.set(a,[...this.store.get(a),s])}activateBookmark(e){we.debug("Activating bookmark",e);const t=this.getBookmarkExtent(e);we.debug("Attempting to apply extent",t),this.applyExtent(t)}deleteBookmark(e){we.debug("Deleting bookmark",e);const t=this.writableBookmarks;this.store.set(t,[...this.store.get(t).filter(n=>n.id!==e)])}deleteAllBookmarks(){we.debug("Deleting all bookmarks"),this.store.set(this.writableBookmarks,[])}loadState(){we.debug("Restoring bookmarks from local storage");const e=this.packageNamespace.get("bookmarks")??[];try{Xc(e),this.store.set(this.writableBookmarks,e)}catch(t){we.error("Bookmarks data in local storage is invalid, resetting to default value.",t),this.store.set(this.writableBookmarks,[]),this.saveState()}}saveState(){we.debug("Saving bookmarks to local storage"),this.packageNamespace.set("bookmarks",this.store.get(this.bookmarks))}getBookmarkExtent(e){const n=this.map.olMap.getView(),o=e.extent,i=[o.minX,o.minY,o.maxX,o.maxY],s=n.getProjection(),a=e.projection;return Ki(i,a,s)}applyExtent(e){const n=this.map.olMap.getView(),o=Yi(e),i=n.getResolutionForExtent(e);n.setCenter(o),n.setResolution(i)}}function Xc(r){if(!Array.isArray(r))throw new Error("Expected bookmarks from local storage to be an array.");for(const e of r)Jc(e)}function Jc(r){if(!r||typeof r!="object")throw new Error("Expected bookmark from local storage to be an object.");const e=r;if(typeof e.id!="string")throw new Error("Bookmark does not have a valid id.");if(typeof e.title!="string")throw new Error("Bookmark does not have a valid title.");if(Qc(e.extent),typeof e.projection!="string")throw new Error("Bookmark does not have a valid projection value.")}function Qc(r){if(!r||typeof r!="object")throw new Error("Expected bookmark extent from local storage to be an object.");const e=r;if(typeof e.minX!="number"||typeof e.minY!="number"||typeof e.maxX!="number"||typeof e.maxY!="number")throw new Error("Expected bookmark extent from local storage to have valid coordinates.")}const eu=r=>{const{map:e}=J(r.mapId),t=Kc("local-storage.LocalStorageService"),n=au(e,t);return n&&u.jsx(Hc,{store:n.store,children:u.jsx(tu,{...r,viewModel:n})})};function tu(r){const{viewModel:e}=r,t=Yc(),n=g.useRef([]),[o,i]=g.useState(!1),s=qc(e.bookmarks),[a,l]=g.useState(""),c=a.trim().length>0,{containerProps:d}=se("spatial-bookmarks",r),[h,f]=g.useState("list"),p=()=>{e.deleteAllBookmarks(),f("list")},y=()=>{c&&(e.createBookmark(a),f("list"),l(""),i(!0))};g.useEffect(()=>{if(o){const O=n.current;O&&O[s.length-1]?.scrollIntoView?.(),i(!1)}},[s,o]);const _=()=>u.jsxs(kr,{children:[u.jsxs(ur,{rounded:"md",status:"warning",children:[u.jsx(dr,{}),t.formatMessage({id:"bookmark.alert.delete"})]}),u.jsx(iu,{intl:t,onClear:p,onCancel:()=>f("list")})]}),M=()=>u.jsxs(kr,{children:[u.jsxs(ur,{rounded:"md",status:"info",children:[u.jsx(dr,{}),t.formatMessage({id:"bookmark.alert.create"})]}),u.jsx(ar,{"aria-label":t.formatMessage({id:"bookmark.input.label"}),placeholder:t.formatMessage({id:"bookmark.input.placeholder"}),value:a,onChange:O=>{l(O.target.value)},onKeyDown:O=>{O.key==="Enter"&&y()},isRequired:!0,isInvalid:!c,autoFocus:!0}),u.jsx(su,{intl:t,isInvalid:!c,onCancel:()=>{l(""),f("list")},onSave:y})]}),C=()=>u.jsxs(u.Fragment,{children:[s.length?ru(s,e,t,n):u.jsxs(ur,{rounded:"md",status:"info",children:[u.jsx(dr,{}),t.formatMessage({id:"bookmark.alert.noSaved"})]}),u.jsx(ou,{intl:t,bookmarks:s,showCreate:()=>f("create"),showDelete:()=>f("delete")})]}),F=u.jsxs(u.Fragment,{children:[h==="list"&&C(),h==="create"&&M(),h==="delete"&&_()]});return u.jsx(ye,{flexDirection:"column",...d,children:F})}function ru(r,e,t,n){const o=t.formatMessage({id:"bookmark.button.deleteOne"}),i=r.map((s,a)=>u.jsx(nu,{index:a,listItemNodes:n,bookmark:s,onActivate:()=>e.activateBookmark(s),onDelete:()=>e.deleteBookmark(s.id),deleteBtnLabel:o},s.id));return u.jsx(oo,{as:"ul",className:"spatial-bookmark-list",role:"listbox","aria-label":t.formatMessage({id:"bookmark.list.label"}),flexShrink:1,flexGrow:1,p:1,spacing:1,overflowY:"auto",listStyleType:"none",children:i})}const Cn={ArrowDown:1,ArrowUp:-1};function nu(r){const{index:e,listItemNodes:t,bookmark:n,onDelete:o,onActivate:i,deleteBtnLabel:s}=r,a=n.title,l=c=>{const d=c.key;if(d==="Enter"){c.target===c.currentTarget&&i();return}if(Cn[d]!=null){const h=t.current?.length;if(!h)return;let f=(e+Cn[d])%h;f<0&&(f=h-1),t.current[f]?.focus()}};return u.jsx(N,{as:"li",p:1,ref:c=>{if(!c){t.current.splice(e,1);return}t.current[e]=c},className:Ft("spatial-bookmarks-item"),tabIndex:0,rounded:"md",role:"option",cursor:"pointer",outline:0,_hover:{background:"trails.50"},_focusVisible:{boxShadow:"outline"},onKeyDown:l,onClick:i,children:u.jsxs(ye,{width:"100%",flexDirection:"row",align:"center",gap:1,children:[u.jsx(co,{children:u.jsx(ro,{})}),u.jsx(Se,{ps:2,noOfLines:1,children:a}),u.jsx(Ps,{}),u.jsx(Un,{hasArrow:!0,label:s,placement:"right",children:u.jsx(or,{className:"spatial-bookmarks-item-delete","aria-label":s,borderRadius:"full",iconSpacing:0,padding:0,colorScheme:"red",variant:"ghost",leftIcon:u.jsx(no,{}),onClick:c=>{o(),c.stopPropagation()}})},e)]})})}function ou(r){const{intl:e,bookmarks:t,showCreate:n,showDelete:o}=r;return u.jsxs($r,{children:[u.jsx(ct,{isDisabled:t.length===0,colorScheme:"red",width:void 0,iconSpacing:0,leftIcon:u.jsx(no,{}),onClick:o,"aria-label":e.formatMessage({id:"bookmark.button.deleteAll"}),variant:"outline"}),u.jsx(ct,{onClick:n,width:"100%",children:e.formatMessage({id:"bookmark.button.create"})})]})}function iu(r){const{intl:e,onCancel:t,onClear:n}=r;return u.jsxs($r,{children:[u.jsx(ct,{variant:"outline",onClick:t,children:e.formatMessage({id:"bookmark.button.cancelDelete"})}),u.jsx(ct,{onClick:n,children:e.formatMessage({id:"bookmark.button.confirmDelete"})})]})}function su(r){const{intl:e,onCancel:t,onSave:n,isInvalid:o}=r;return u.jsxs($r,{children:[u.jsx(ct,{variant:"outline",onClick:()=>t(),children:e.formatMessage({id:"bookmark.button.cancel"})}),u.jsx(ct,{isDisabled:o,onClick:()=>n(),children:e.formatMessage({id:"bookmark.button.save"})})]})}function $r(r){return u.jsx(ye,{width:"100%",flexDirection:"row",mt:2,gap:1,flexGrow:0,flexShrink:0,children:r.children})}function ct(r){return u.jsx(or,{width:"100%",...r})}function au(r,e){const[t,n]=g.useState();return g.useEffect(()=>{let o;return r?o=new Zc(r,e):o=void 0,n(o),()=>o?.destroy()},[r,e]),t}function lu(){const r=g.useId(),e=Ae();return u.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(N,{role:"dialog","aria-labelledby":r,children:u.jsx(Ve,{title:u.jsx(Ge,{id:r,size:"md",mb:2,children:e.formatMessage({id:"spatialBookmarkTitle"})}),children:u.jsx(eu,{mapId:z})})})})}const Oo="@open-pioneer/printing",Mn=ut.bind(void 0,Oo),cu=fe.bind(void 0,Oo),uu="map";class du{olMap;title="";fileFormat="pdf";i18n;printingService;printMap=void 0;overlay=void 0;constructor(e,t,n){this.olMap=e,this.printingService=t,this.i18n=n}destroy(){this.reset()}setTitle(e){this.title=e}setFileFormat(e){this.fileFormat=e}async handleMapExport(){if(!(!this.olMap||!this.fileFormat))try{this.begin(),this.printMap=await this.printingService.printMap(this.olMap,{blockUserInteraction:!1});const e=this.printMap.getCanvas();if(e)this.fileFormat=="png"?await this.exportMapInPNG(e):await this.exportMapInPDF(e);else throw new Error("Canvas export failed")}finally{this.reset()}}begin(){const e=this.olMap.getTargetElement();e&&(this.overlay=bs(e,this.i18n.overlayText))}reset(){this.overlay?.destroy(),this.overlay=void 0}getTitleAndFileName(){const e=this.title||"",t=this.title||uu;return{title:e,fileName:t}}async exportMapInPNG(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height+50,t.style.backgroundColor="#fff";const n=t.getContext("2d");if(!n)throw new Error("2d canvas rendering context not available");const{title:o,fileName:i}=this.getTitleAndFileName();n.fillStyle="#fff",n.fillRect(0,0,t.width,t.height),n.font="20px bold sans-serif",n.textAlign="center",n.fillStyle="#000";const s=t.width/2;n.fillText(o,s,20),n.drawImage(e,0,50);const a=document.createElement("a");a.setAttribute("download",i+".png");const l=Ss(t);if(!l)throw new Error("Failed to get image data URL");a.href=l,a.click()}async exportMapInPDF(e){const{jsPDF:t}=await Cr(()=>import("./027108e30d33.js"),["./027108e30d33.js","./a419295615be.js","./d36378e4fa98.js","./a804c6ae25fd.js","./ae80b20da1a8.js","./4533599bd8ef.js","./f413d8ffea52.js","./81064a1e15a2.js","./3f67a442b387.js"],import.meta.url),n=new t({orientation:"landscape",unit:"mm",format:"a4"}),o=n.internal.pageSize.getWidth(),i=n.internal.pageSize.getHeight(),s=15,a=20,l=i-a;n.setFontSize(20);const{title:c,fileName:d}=this.getTitleAndFileName();n.text(c,o/2,s,{align:"center"});const h=e.width/e.height;let f=l,p=f*h;p>=o&&(p=o,f=p/h);const y=(o-p)/2,_=a+(l-f)/2;n.addImage(e,"",y,_,p,f),n.save(d+".pdf")}}const hu=ge("printing"),pu=r=>{const e=cu(),{mapId:t}=r,{containerProps:n}=se("printing",r),[o,i]=g.useState("pdf"),[s,a]=g.useState(""),[l,c]=g.useState(!1),d=Mn("printing.PrintingService"),h=Mn("notifier.NotificationService"),{map:f}=J(t),p=gu(f,e,d);g.useEffect(()=>{p?.setFileFormat(o)},[p,o]),g.useEffect(()=>{p?.setTitle(s)},[p,s]);function y(M){(M==="png"||M==="pdf")&&i(M)}function _(){l||!p||(c(!0),p.handleMapExport().catch(M=>{const C=e.formatMessage({id:"printingFailed"});h.notify({level:"error",message:C}),hu.error("Failed to print the map",M)}).finally(()=>{c(!1)}))}return u.jsxs(N,{...n,children:[u.jsxs(qt,{mb:4,alignItems:"center",children:[u.jsxs(Mr,{mb:2,children:[u.jsx(xt,{minWidth:"82",mb:1,children:e.formatMessage({id:"title"})}),u.jsx(ar,{placeholder:e.formatMessage({id:"input.placeholder"}),value:s,onChange:M=>{a(M.target.value)},isRequired:!0,autoFocus:!0})]}),u.jsxs(Mr,{mb:2,children:[u.jsx(xt,{minWidth:"82",mb:1,children:e.formatMessage({id:"fileFormat"})}),u.jsxs(Vr,{value:o,onChange:M=>y(M.target.value),className:"printing-select",children:[u.jsx("option",{value:"png",children:"PNG"}),u.jsx("option",{value:"pdf",children:"PDF"})]})]})]}),u.jsx(or,{isLoading:l,loadingText:e.formatMessage({id:"printingMap"}),disabled:l,padding:2,className:"printing-export-button",onClick:_,width:"100%",children:e.formatMessage({id:"export"})})]})};function gu(r,e,t){const[n,o]=g.useState(void 0);return g.useEffect(()=>{if(!r)return;const i=new du(r.olMap,t,{overlayText:e.formatMessage({id:"printingMap"})});return o(i),()=>{i.destroy(),o(void 0)}},[r,e,t]),n}function fu(){const r=g.useId(),e=Ae();return u.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(N,{role:"dialog","aria-labelledby":r,children:u.jsx(Ve,{title:u.jsx(Ge,{id:r,size:"md",mb:2,children:e.formatMessage({id:"printingTitle"})}),children:u.jsx(pu,{mapId:z})})})})}const mu="@open-pioneer/legend",jo=fe.bind(void 0,mu),vu=r=>{const{mapId:e,showBaseLayers:t=!1}=r,{containerProps:n}=se("legend",r),{map:o}=J(e);return u.jsx(N,{...n,children:o?u.jsx(yu,{map:o,showBaseLayers:t}):null})};function yu(r){const{map:e,showBaseLayers:t}=r,o=_u(e).map(i=>u.jsx(Fo,{layer:i,showBaseLayers:t},i.id));return u.jsx(oo,{as:"ul",className:"legend-layer-list",listStyleType:"none",spacing:2,children:o})}function Fo(r){const{layer:e,showBaseLayers:t}=r,{isVisible:n}=xu(e),o=wu(e);if(!n||!t&&!("parentLayer"in e)&&e.isBaseLayer)return;const i=[];return o?.length&&o.forEach(s=>{i.push(u.jsx(Fo,{layer:s,showBaseLayers:t},s.id))}),u.jsxs(u.Fragment,{children:[u.jsx(bu,{layer:e,showBaseLayers:t}),i]})}function bu(r){const e=jo(),{layer:t,showBaseLayers:n}=r,o=Eu(t),i=Su(t);let s;o?.Component?s=u.jsx(o.Component,{layer:t}):o?.imageUrl?s=u.jsx(Pn,{layer:t,imageUrl:o.imageUrl}):i&&(s=u.jsx(Pn,{layer:t,imageUrl:i}));const a=!("parentLayer"in t)&&t.isBaseLayer;return s?u.jsxs(N,{as:"li",className:Ft("legend-item",`layer-${ku(t.id)}`),children:[n&&a?u.jsx(Se,{as:"b",children:e.formatMessage({id:"basemapLabel"})}):null,s]}):void 0}function Pn(r){const e=jo(),{layer:t,imageUrl:n}=r;return u.jsxs(N,{children:[u.jsx(Se,{children:t.title}),u.jsx(_s,{maxW:"none",maxH:"none",src:n,alt:e.formatMessage({id:"altLabel"},{layerName:t.title}),className:"legend-item__image",fallbackStrategy:"onError",fallback:u.jsx(N,{children:u.jsxs(Se,{children:[u.jsx(Lo,{me:2}),e.formatMessage({id:"fallbackLabel"})]})})})]})}function Su(r){const e=g.useCallback(()=>r.legend,[r]),t=g.useCallback(n=>{const o=r.on("changed:legend",n);return()=>o.destroy()},[r]);return g.useSyncExternalStore(t,e)}function _u(r){const e=g.useCallback(n=>{const o=r.layers.on("changed",n);return()=>o.destroy()},[r]),t=g.useCallback(()=>{let n=r.layers.getAllLayers({sortByDisplayOrder:!0})??[];return n=n.reverse(),n},[r]);return Do(e,t)}function wu(r){const e=g.useCallback(n=>{const o=r.sublayers?.on("changed",n);return()=>o?.destroy()},[r]),t=g.useCallback(()=>{if(!r.sublayers)return;let o=r.sublayers?.getSublayers({sortByDisplayOrder:!0});return o=o.reverse(),o},[r]);return Do(e,t)}function Do(r,e){const t=g.useRef(),n=g.useCallback(i=>{const s=r(()=>{t.current=void 0,i()});return()=>{t.current=void 0,s()}},[r]),o=g.useCallback(()=>{if(t.current)return t.current.value;const i=e();return t.current={value:i},i},[e]);return g.useSyncExternalStore(n,o)}function xu(r){const e=g.useCallback(()=>r.visible,[r]),t=g.useCallback(o=>{const i=r.on("changed:visible",o);return()=>i.destroy()},[r]);return{isVisible:g.useSyncExternalStore(t,e)}}function Eu(r){const[e,t]=g.useState(void 0);return g.useEffect(()=>{t(r.attributes.legend);const n=r.on("changed:attributes",()=>{t(r.attributes.legend)});return()=>n.destroy()},[r]),e}function ku(r){return r.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Cu(){const r=g.useId(),e=Ae();return u.jsx(N,{role:"dialog","aria-labelledby":r,children:u.jsx(Ve,{title:u.jsx(Ge,{id:r,size:"md",mb:2,children:e.formatMessage({id:"legendTitle"})}),children:u.jsx(N,{overflowY:"auto",maxHeight:300,children:u.jsx(vu,{mapId:z,showBaseLayers:!0})})})})}const No="@open-pioneer/geolocation",Mu=ut.bind(void 0,No),Pu=fe.bind(void 0,No);function Au(r){return Nr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(r)}const An=ge("geolocation:GeolocationController"),Ln=17;class Lu extends ir{olMap;positionHighlightLayer;geolocation;maxZoom=Ln;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new De,this.accuracyFeature.setStyle(Rn()),this.positionFeature=new De,this.positionFeature.setStyle(In()),this.positionHighlightLayer=new ne({source:new Pe({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(sr);const n=t||Iu();this.geolocation=new Ba({tracking:!1,trackingOptions:n,projection:e.getView()?.getProjection()}),this.trackingOptions=n,this.geolocation.on("error",o=>this.handleGeolocationError(o))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(n=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const o=this.geolocation.on("change:accuracyGeometry",()=>{const l=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(l),this.accuracyFeature?.getGeometry()!==void 0&&n(),this.isInitialZoom){const c=this?.accuracyFeature?.getGeometry()?.getExtent();if(c){const d=ol(c);if(!d)return;e.getView().fit(d,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),i=this.geolocation.on("change:position",()=>{const l=this.geolocation.getPosition();l&&(l[0]||l[1])!==void 0&&(this.positionFeature?.setGeometry(new wt(l)),this.setMapToPosition&&e.getView().setCenter(l),this.positionFeature?.getGeometry()!==void 0&&n())}),s=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",l=>{l.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(o,i,s,a),e.addLayer(this.positionHighlightLayer)}).catch(n=>{An.error("Failed to determine location",n)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{ee(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??In())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??Rn())}setMaxZoom(e){this.maxZoom=e??Ln}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){An.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const In=()=>new Fe({image:new Fr({radius:6,fill:new nt({color:"#3399CC"}),stroke:new Oe({color:"#fff",width:2})})}),Rn=()=>new Fe({stroke:new Oe({color:"#3399CC",width:3}),fill:new nt({color:"rgba(0, 0, 255, 0.05)"})}),Iu=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),Ru=g.forwardRef(function(e,t){const{mapId:n,maxZoom:o,positionFeatureStyle:i,accuracyFeatureStyle:s,trackingOptions:a}=e,{containerProps:l}=se("geolocation",e),c=!!navigator.geolocation,[d,h]=g.useState(!1),[f,p]=g.useState(!1),{map:y}=J(n),_=Pu(),M=Mu("notifier.NotificationService"),C=Tu(y,o,a,i,s),F=(()=>c?d?_.formatMessage({id:"locateMeEnd"}):_.formatMessage({id:"locateMeStart"}):_.formatMessage({id:"locateNotSupported"}))();g.useEffect(()=>{if(C===void 0)return;const Y=C.on("error",function(W){const I=_.formatMessage({id:"error"}),$=(()=>{switch(W){case"permission-denied":return _.formatMessage({id:"permissionDenied"});case"position-unavailable":return _.formatMessage({id:"positionUnavailable"});case"timeout":return _.formatMessage({id:"timeout"});case"unknown":return _.formatMessage({id:"unknownError"})}})();p(!1),h(!1),M.notify({level:"error",title:I,message:$})});return()=>{Y.destroy()}},[C,_,M]),g.useEffect(()=>{if(!C){p(!1);return}return d&&(p(!0),C.startGeolocation().then(()=>{p(!1)})),()=>{C?.stopGeolocation(),p(!1)}},[C,d]);const O=()=>{y&&h(!d)};return u.jsx(te,{ref:t,label:F,icon:u.jsx(Au,{}),onClick:()=>O(),isActive:d,isLoading:f,isDisabled:!c,...l})});function Tu(r,e,t,n,o){const[i,s]=g.useState();return g.useEffect(()=>{if(!r)return;const a=new Lu(r.olMap,t);return s(a),()=>{a.destroy(),s(void 0)}},[r,t]),g.useEffect(()=>{i?.setPositionFeatureStyle(n)},[i,n]),g.useEffect(()=>{i?.setAccuracyFeatureStyle(o)},[i,o]),g.useEffect(()=>{i?.setMaxZoom(e)},[i,e]),i}function Ou(r){return Nr({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M6.5 9.5l1.546 -1.311"}},{tag:"path",attr:{d:"M14 5.5l3 1.5"}},{tag:"path",attr:{d:"M18.5 10l-1.185 3.318m-1.062 2.972l-.253 .71"}},{tag:"path",attr:{d:"M13.5 17.5l-7 -5"}},{tag:"path",attr:{d:"M3 3l18 18"}}]})(r)}function ju(r){return Nr({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M6.5 9.5l3.5 -3"}},{tag:"path",attr:{d:"M14 5.5l3 1.5"}},{tag:"path",attr:{d:"M18.5 10l-2.5 7"}},{tag:"path",attr:{d:"M13.5 17.5l-7 -5"}}]})(r)}function Fu(r){const{toolState:e,onToolStateChange:t}=r,n=Ae(),o=be("ol-app.AppModel"),i=at(o.state).resultListState,s=i.open,a=be("editing.EditingService"),l=Ne((c,d)=>{t(c,d??!e[c])});return u.jsxs(ye,{role:"toolbar","aria-label":n.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[u.jsx(te,{label:e.editingCreateActive?n.formatMessage({id:"editing.stopTitle"}):n.formatMessage({id:"editing.create.startTitle"}),icon:e.editingCreateActive?u.jsx(Ou,{}):u.jsx(ju,{}),isActive:e.editingCreateActive,onClick:()=>l("editingCreateActive")}),u.jsx(te,{label:e.editingUpdateActive?n.formatMessage({id:"editing.stopTitle"}):n.formatMessage({id:"editing.update.startTitle"}),icon:e.editingUpdateActive?u.jsx(ns,{}):u.jsx(os,{}),isActive:e.editingUpdateActive,onClick:()=>l("editingUpdateActive")}),u.jsx(te,{label:n.formatMessage({id:"editing.resetTitle"}),icon:u.jsx(is,{}),onClick:()=>a.reset(z)}),i.input&&u.jsx(te,{label:n.formatMessage({id:"resultListTitle"}),icon:u.jsx(ss,{}),isActive:i.open,onClick:()=>o.setResultListVisibility(!s)}),u.jsx(te,{label:n.formatMessage({id:"printingTitle"}),icon:u.jsx(as,{}),isActive:e.printingActive,onClick:()=>l("printingActive")}),u.jsx(te,{label:n.formatMessage({id:"spatialBookmarkTitle"}),icon:u.jsx(ls,{}),isActive:e.bookmarksActive,onClick:()=>l("bookmarksActive")}),u.jsx(Ru,{mapId:z}),u.jsx(te,{label:n.formatMessage({id:"tocTitle"}),icon:u.jsx(cs,{}),isActive:e.tocActive,onClick:()=>l("tocActive")}),u.jsx(te,{label:n.formatMessage({id:"legendTitle"}),icon:u.jsx(us,{}),isActive:e.legendActive,onClick:()=>l("legendActive")}),u.jsx(te,{label:n.formatMessage({id:"measurementTitle"}),icon:u.jsx(ds,{}),isActive:e.measurementActive,onClick:()=>l("measurementActive")}),u.jsx(te,{label:n.formatMessage({id:"selectionTitle"}),icon:u.jsx(hs,{}),isActive:e.selectionActive,onClick:()=>l("selectionActive")}),u.jsx(te,{label:n.formatMessage({id:"overviewMapTitle"}),icon:u.jsx(ro,{}),isActive:e.overviewMapActive,onClick:()=>l("overviewMapActive")}),u.jsx(Es,{mapId:z}),u.jsx(ks,{mapId:z}),u.jsx(Cs,{mapId:z})]})}const Du="@open-pioneer/measurement",Nu=fe.bind(void 0,Du);class Vu{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const n=this.source=new Pe;this.layer=new ne({source:n}),this.layer.setZIndex(sr),e.addLayer(this.layer);const o=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){ee(o)}});const i=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",i),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",i)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=Zi(e);this.activeFeatureStyle=(n,...o)=>{const i=n?.getGeometry()?.getType();if(i==="Polygon"||i==="LineString"||i==="Point")return t(n,...o)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",n=this.draw=new io({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(n);let o,i;n.on("drawstart",s=>{o=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=s.feature;if(!a)return;let l;i=a.getGeometry()?.on("change",c=>{const d=c.target,h=this.olMap.getView().getProjection();let f="";d instanceof eo?(f=Bu(d,h,this.messages),l=d.getInteriorPoint().getCoordinates()||null):d instanceof lo&&(f=zu(d,h,this.messages),l=d.getLastCoordinate()||null),o&&(o.element.innerHTML=f,l&&o?.overlay.setPosition(l))})}),n.on("drawend",()=>{if(o){const s=o.element.classList;s.remove("measurement-active-tooltip"),s.remove("printing-hide"),s.add("measurement-finished-tooltip"),o.overlay.setOffset([0,-7]),this.overlayTooltips.push(o),this.measureTooltip=o=void 0}this.sketch=void 0,i&&ee(i)}),n.on("drawabort",()=>{o&&(o.destroy(),this.measureTooltip=o=void 0),this.sketch=void 0,i&&ee(i)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip printing-hide";const t=new it({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),n=this.olMap;return n.addOverlay(t),{overlay:t,element:e,destroy(){n.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip printing-hide hidden";const t=new it({element:e,offset:[15,0],positioning:"center-left"}),n=this.olMap;return n.addOverlay(t),{overlay:t,element:e,destroy(){n.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,n=Gu(this.messages,this.sketch);t.element.textContent=n,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function Gu(r,e){if(e){const t=e.getGeometry();if(t instanceof eo||t instanceof lo)return r.getContinueMessage()}return r.getHelpMessage()}function Bu(r,e,t){const n=Xi(r,{projection:e});let o;return n>=1e6?o=`${t.formatNumber(n/1e6)} km<sup>2</sup>`:o=`${t.formatNumber(n)} m<sup>2</sup>`,o}function zu(r,e,t){const n=Ji(r,{projection:e});let o;return n>=1e3?o=`${t.formatNumber(n/1e3)} km`:o=`${t.formatNumber(n)} m`,o}const Uu=r=>{const e=Nu(),{mapId:t,activeFeatureStyle:n,finishedFeatureStyle:o}=r,{containerProps:i}=se("measurement",r),[s,a]=g.useState("distance"),l=p=>e.formatMessage({id:p}),c=J(t),d=Hu(c.map,e);g.useEffect(()=>{d?.setActiveFeatureStyle(n??Wu())},[d,n]),g.useEffect(()=>{d?.setFinishedFeatureStyle(o??$u())},[d,o]),g.useEffect(()=>{if(d)return d.startMeasurement(s),()=>{d.stopMeasurement()}},[d,s]);function h(p){if(p==="distance"||p==="area")a(p);else throw new Error(`Unexpected measurement type: '${p}'.`)}function f(){d?.clearMeasurements()}return u.jsxs(N,{...i,children:[u.jsx(Se,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),u.jsx(qt,{mb:4,alignItems:"center",children:u.jsxs(Mr,{mb:2,children:[u.jsx(xt,{mb:1,children:l("measurementLabel")}),u.jsxs(Vr,{value:s,onChange:p=>h(p.target.value),className:"measurement-select",children:[u.jsx("option",{value:"distance",children:l("distance")}),u.jsx("option",{value:"area",children:l("area")})]})]})}),u.jsx(or,{padding:2,className:"measurement-delete-button",onClick:f,width:"100%",children:l("deleteMeasurementLabel")})]})};function Hu(r,e){const[t,n]=g.useState(void 0);return g.useEffect(()=>{if(!r)return;const o=new Vu(r.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(i){return e.formatNumber(i,{maximumFractionDigits:2})}});return n(o),()=>{o.destroy(),n(void 0)}},[r,e]),t}function Wu(){return[new Fe({stroke:new Oe({color:"#fff",lineDash:[10,10],width:5})}),new Fe({fill:new nt({color:"rgba(0,0,0,0.15)"}),stroke:new Oe({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new Fr({radius:5,stroke:new Oe({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new nt({color:"rgba(255, 255, 255, 0.2)"})})})]}function $u(){return[new Fe({stroke:new Oe({color:"#fff",width:5})}),new Fe({stroke:new Oe({color:"#0b96fc",width:3}),fill:new nt({color:"rgba(11,150,252,0.15)"})})]}function qu(){const r=g.useId(),e=Ae();return u.jsx(N,{role:"dialog","aria-labelledby":r,children:u.jsx(Ve,{title:u.jsx(Ge,{id:r,size:"md",mb:2,children:e.formatMessage({id:"measurementTitle"})}),children:u.jsx(Uu,{mapId:z})})})}const Ku="200px",Yu="300px",Zu=r=>{const{mapId:e,olLayer:t,height:n=Ku,width:o=Yu}=r,{containerProps:i}=se("overview-map",r),s=g.useRef(null),{map:a}=J(e);return g.useEffect(()=>{if(s.current&&a&&t){const l=a.olMap,c=new Xl({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:s.current});return l.addControl(c),()=>{l.removeControl(c)}}},[a,t]),u.jsx(N,{height:n,width:o,ref:s,...i})};function Xu(){const r=g.useMemo(()=>new jr({source:new Zn}),[]);return u.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:325,children:u.jsx(N,{role:"dialog",children:u.jsx(Zu,{mapId:z,olLayer:r})})})}function Ju(){const r=be("ol-app.AppModel"),e=at(r.state).resultListState,[t,n]=g.useState([]),[o,i]=g.useState([]),s=g.useCallback(a=>{n(a.features),i(a.getFeatureIds())},[]);return g.useEffect(()=>{console.log("Anzahl Features: "+t.length),console.log("SelectedIds: "+o.toString())},[t,o]),e.input&&u.jsx(N,{className:"result-list-container",position:"absolute",visibility:e.open?"visible":"hidden",bottom:"0",backgroundColor:"white",width:"100%",height:"400px",zIndex:1,borderTop:"2px solid",borderBottom:"2px solid",borderColor:"trails.100",children:u.jsx(Ls,{input:e.input,mapId:z,onSelectionChange:s},e.key)})}const Qu="@open-pioneer/search",lr=fe.bind(void 0,Qu);function ed(r){const e=r.selectProps.inputValue.length>0,t={...r,className:Ft(r.className,{"search-invisible":!e})};return u.jsx(_e.Menu,{...t,children:r.children})}function td(r){const t=lr().formatMessage({id:"noOptionsText"});return u.jsx(_e.NoOptionsMessage,{...r,children:u.jsx(ie.span,{className:"search-no-match",children:t})})}function rd(r){const t=lr().formatMessage({id:"loadingText"});return u.jsx(_e.LoadingMessage,{...r,children:u.jsx(ie.span,{className:"search-loading-text",children:t})})}function nd({children:r,...e}){const t={...e,className:Ft(e.className,"search-value-container")};return u.jsxs(_e.ValueContainer,{...t,children:[!!r&&u.jsx(Lc,{style:{position:"absolute",left:8}}),r]})}function od(r){const e={...r,isHidden:!1};return u.jsx(_e.Input,{...e})}function id(r){return null}function sd(r){return u.jsxs(_e.IndicatorsContainer,{...r,children:[r.children,!r.selectProps.isLoading&&r.selectProps.inputValue&&u.jsx(ad,{selectProps:r.selectProps,clearValue:r.clearValue})]})}function ad(r){const t=lr().formatMessage({id:"ariaLabel.clearButton"}),n=o=>{o.preventDefault(),o.stopPropagation(),r.clearValue()};return u.jsx(Qo,{role:"button",size:"md",mr:1,"aria-label":t,onClick:n,onTouchEnd:n,onMouseDown:o=>o.preventDefault()})}function ld(r){return null}function cd(r){const e=r.selectProps.inputValue,t=r.data.label,n={...r,className:Ft(r.className,"search-option")};return u.jsx(_e.Option,{...n,children:u.jsx(ie.div,{className:"search-option-label",children:e.trim().length>0?ud(t,e):t})})}function ud(r,e){const t=r.toLowerCase().indexOf(e.toLowerCase());return t>=0?u.jsxs(u.Fragment,{children:[r.substring(0,t),u.jsx(ie.span,{className:"search-highlighted-match",children:r.substring(t,t+e.length)},"highlighted"),r.substring(t+e.length)]}):r}const Tn=ge("search:SearchController"),On=200,jn=5;var Rt,et,tt,rt,ue,tr,Vo;class dd{constructor(e,t){R(this,tr);R(this,Rt,void 0);R(this,et,[]);R(this,tt,jn);R(this,rt,On);R(this,ue,void 0);T(this,Rt,e),T(this,et,t)}destroy(){w(this,ue)?.abort(),T(this,ue,void 0)}async search(e){if(w(this,ue)?.abort(),T(this,ue,void 0),!e)return[];const t=T(this,ue,new AbortController);try{return await hd(t.signal,w(this,rt)),t.signal.aborted&&(Tn.debug(`search canceled with ${e}`),ei()),(await Promise.all(w(this,et).map(o=>q(this,tr,Vo).call(this,o,e,t.signal)))).filter(o=>o!=null)}finally{w(this,ue)===t&&T(this,ue,void 0)}}get searchTypingDelay(){return w(this,rt)}set searchTypingDelay(e){T(this,rt,e??On)}get maxResultsPerSource(){return w(this,tt)}set maxResultsPerSource(e){T(this,tt,e??jn)}get sources(){return w(this,et)}}Rt=new WeakMap,et=new WeakMap,tt=new WeakMap,rt=new WeakMap,ue=new WeakMap,tr=new WeakSet,Vo=async function(e,t,n){const o=e.label,i=w(this,Rt).olMap.getView().getProjection();try{const s=w(this,tt);let a=await e.search(t,{maxResults:s,signal:n,mapProjection:i});return a.length>s&&(a=a.slice(0,s)),{label:o,source:e,results:a}}catch(s){$t(s)||Tn.error(`search for source ${o} failed`,s);return}};async function hd(r,e){r.aborted||await new Promise(t=>{const n=()=>{r.removeEventListener("abort",n),clearTimeout(o),t()};r.addEventListener("abort",n);const o=setTimeout(n,e)})}const Yt=ge("search:Search"),pd=r=>{const{mapId:e,sources:t,searchTypingDelay:n,maxResultsPerGroup:o,onSelect:i,onClear:s}=r,{containerProps:a}=se("search",r),{map:l}=J(e),c=lr(),d=vd(t,n,o,l),{input:h,search:f,selectedOption:p,onInputChanged:y,onResultConfirmed:_}=yd(d),M=md(),C=gd(c),F=fd(),O=Ne((I,$)=>{$.action==="input-change"&&y(I)}),Y=Ne((I,$)=>{switch($.action){case"select-option":I&&(_(I),i?.({source:I.source,result:I.result}));break;case"clear":y(""),W.current?.blur(),W.current?.focus(),s?.();break;default:Yt.debug(`Unhandled action type '${$.action}'.`);break}}),W=g.useRef(null);return u.jsx(N,{...a,children:u.jsx(Pr,{className:"search-component",classNamePrefix:"react-select",ref:W,inputValue:h,onInputChange:O,"aria-label":c.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:C,colorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:M,isClearable:!0,placeholder:c.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:f.kind==="loading",options:f.kind==="ready"?f.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:F,onChange:Y,value:p,menuPosition:"fixed"})})};function gd(r){return g.useMemo(()=>({onFocus:({focused:i})=>`${i.label} ${r.formatMessage({id:"ariaLabel.searchFocus"})}.`,onChange:({action:i,label:s})=>{let a="";switch(i){case"select-option":a=`${s} ${r.formatMessage({id:"ariaLabel.searchSelect"})}.`;break;case"clear":a=`${s} ${r.formatMessage({id:"ariaLabel.searchClear"})}.`;break}return a},guidance:()=>`${r.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[r])}function fd(){return g.useMemo(()=>({Menu:ed,Input:od,SingleValue:id,Option:cd,NoOptionsMessage:td,LoadingMessage:rd,ValueContainer:nd,IndicatorsContainer:sd,ClearIndicator:ld}),[])}function md(){const[r,e]=Hn("colors",["trails.100","trails.50"],["#d5e5ec","#eaf2f5"]);return g.useMemo(()=>({groupHeading:n=>({...n,backgroundColor:r,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:n=>({...n,backgroundColor:"inherit",_focus:{backgroundColor:e}}),dropdownIndicator:n=>({...n,display:"none"})}),[r,e])}function vd(r,e,t,n){const[o,i]=g.useState(void 0);return g.useEffect(()=>{if(!n)return;const s=new dd(n,r);return i(s),()=>{s.destroy(),i(void 0)}},[n,r]),g.useEffect(()=>{o&&(o.searchTypingDelay=e)},[o,e]),g.useEffect(()=>{o&&(o.maxResultsPerSource=t)},[o,t]),o}function yd(r){const[e,t]=g.useReducer((a,l)=>{switch(l.kind){case"input":return{...a,query:l.query,selectedOption:null};case"select-option":return{...a,selectedOption:l.option,query:l.option.label};case"load-results":return{...a,search:{kind:"loading"}};case"accept-results":return{...a,search:{kind:"ready",results:l.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),n=g.useRef(),o=Ne(a=>{if(!r){n.current=void 0,t({kind:"accept-results",results:[]});return}Yt.isDebug()&&Yt.debug(`Starting new search for query ${JSON.stringify(a)}.`),t({kind:"load-results"});const l=n.current=bd(r,a).then(c=>{n.current===l&&t({kind:"accept-results",results:c})})}),i=g.useCallback(a=>{t({kind:"select-option",option:a})},[]),s=g.useCallback(a=>{t({kind:"input",query:a}),o(a)},[o]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:i,onInputChanged:s}}async function bd(r,e){let t;try{t=await r.search(e)}catch(n){$t(n)||Yt.error("Search failed",n),t=[]}return Sd(t)}function Sd(r){return r.map((t,n)=>({label:t.label,options:t.results.map(o=>({value:`${n}-${o.id}`,label:o.label,source:t.source,result:o}))}))}function _d(){const{map:r}=J(z),e=be("ol-app.AppModel"),t=at(e.state).searchSources;function n(i){if(console.debug("The user selected the following item: ",i.result),!r)return;const s=i.result.geometry;s&&e.highlightAndZoom(r,[s])}function o(){console.debug("The user cleared the search"),e.clearPreviousHighlight()}return u.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-box",children:u.jsx(pd,{mapId:z,sources:t,maxResultsPerGroup:10,onSelect:n,onClear:o})})}const Go="@open-pioneer/selection",wd=ut.bind(void 0,Go),qr=fe.bind(void 0,Go),ft="selection-active",Ut="selection-inactive";class xd{tooltip;interactionResources=[];olMap;isActive=!0;tooltipMessage;tooltipDisabledMessage;constructor(e,t,n,o,i){let s;switch(t){case Kr.extent:default:s=this.initViewport(e),this.interactionResources.push(this.createDragBox(e,i,s,this.interactionResources)),this.interactionResources.push(this.createDrag(e,s,this.interactionResources));break}this.tooltip=this.createHelpTooltip(e,n),this.olMap=e,this.tooltipMessage=n,this.tooltipDisabledMessage=o}initViewport(e){const t=e.getViewport();return t.classList.add(ft),t.oncontextmenu=n=>(n.preventDefault(),!1),t}destroy(){this.tooltip.destroy(),this.interactionResources.forEach(e=>{e.destroy()})}setActive(e){if(this.isActive===e)return;const t=this.olMap.getViewport();e?(this.interactionResources.forEach(n=>this.olMap.addInteraction(n.interaction)),this.tooltip.element.textContent=this.tooltipMessage,t.classList.remove(Ut),t.classList.add(ft),this.isActive=!0):(this.interactionResources.forEach(n=>this.olMap.removeInteraction(n.interaction)),this.tooltip.element.textContent=this.tooltipDisabledMessage,t.classList.remove(ft),t.classList.add(Ut),this.isActive=!1)}createDragBox(e,t,n,o){const i=new on({className:"selection-drag-box",condition:Qi});return e.addInteraction(i),i.on("boxend",function(){t(i.getGeometry())}),{interaction:i,destroy(){e.removeInteraction(i),o.splice(o.indexOf(this)),i.dispose(),n.classList.remove(ft),n.classList.remove(Ut),n.oncontextmenu=null}}}createDrag(e,t,n){const o=function(a){return a.originalEvent.button==2},i=new sn({condition:o});return e.addInteraction(i),{interaction:i,destroy(){e.removeInteraction(i),n.splice(n.indexOf(this)),i.dispose(),t.classList.remove(ft),t.classList.remove(Ut),t.oncontextmenu=null}}}createHelpTooltip(e,t){const n=document.createElement("div");n.className="selection-tooltip printing-hide",n.textContent=t;const o=new it({element:n,offset:[15,0],positioning:"center-left"}),i=e.on("pointermove",s=>{o.setPosition(s.coordinate)});return e.addOverlay(o),{overlay:o,element:n,destroy(){e.removeOverlay(o),o.dispose(),ee(i)}}}getDragboxInteraction(){return this.interactionResources.find(e=>e.interaction instanceof on)}getDragPanInteraction(){return this.interactionResources.find(e=>e.interaction instanceof sn)}}const Sr=ge("selection:SelectionController"),Ed=1e4;var Tt,Ot,jt,rr,Bo;class kd{constructor(e){R(this,rr);R(this,Tt,void 0);R(this,Ot,void 0);R(this,jt,void 0);const{mapModel:t,onError:n,maxResults:o=Ed}=e;T(this,Tt,t),T(this,Ot,o),T(this,jt,n)}destroy(){}async select(e,t){if(t)return await q(this,rr,Bo).call(this,e,t)}}Tt=new WeakMap,Ot=new WeakMap,jt=new WeakMap,rr=new WeakSet,Bo=async function(e,t){const n=w(this,Tt).olMap.getView().getProjection();try{Sr.debug(`Starting selection on source '${e.label}'`);const o=w(this,Ot);let i=await e.select({type:"extent",extent:t},{maxResults:o,mapProjection:n,signal:new AbortController().signal});return i.length>o&&(i=i.slice(0,o)),Sr.debug(`Found ${i.length} results on source '${e.label}'`),{source:e,results:i}}catch(o){Sr.error(`selection from source ${e.label} failed`,o),w(this,jt).call(this);return}};var Kr=(r=>(r.extent="EXTENT",r.polygon="POLYGON",r.free="FREEPOLYGON",r.circle="CIRCLE",r))(Kr||{});const Fn={classNamePrefix:"react-select",menuPosition:"fixed",isSearchable:!1,isClearable:!1},Cd=r=>{const e=qr(),{mapId:t,sources:n,onSelectionComplete:o,onSelectionSourceChanged:i}=r,{containerProps:s}=se("selection",r),[a,l]=g.useState(()=>n.find(I=>(I.status??"available")==="available")),c=J(t),{onExtentSelected:d}=Ad(c.map,n,a,o),h=Rd(),p=g.useCallback(I=>{const $=[];if(I||(I=["EXTENT"]),I.forEach(v=>{Object.values(Kr).includes(v)&&$.push({label:e.formatMessage({id:v}),value:v})}),$.length===0)throw new Error("methods does not contain valid values");return $},[e])(void 0),[y,_]=g.useState(p[0]),M=Ne(I=>{_(I)}),[C,F]=g.useState(!0);Id(c.map,y,e,d,C);const O=g.useMemo(()=>n.map(I=>({label:I.label,value:I})),[n]),Y=g.useMemo(()=>O.find(I=>I.value===a),[O,a]),W=Ne(I=>{l(I?.value),i&&i({source:I?.value})});return g.useEffect(()=>{if(!a){F(!1);return}const I=e.formatMessage({id:"sourceNotAvailable"}),$=()=>a&&Tr(a,I).kind==="available";F($());const v=a.on("changed:status",()=>{F($())});return()=>v.destroy()},[a,F,e]),u.jsxs(kr,{...s,spacing:2,children:[p.length>1&&u.jsxs(qt,{children:[u.jsx(xt,{children:e.formatMessage({id:"selectMethod"})}),u.jsx(Pr,{className:"selection-method react-select",...Fn,options:p,onChange:M,value:y,chakraStyles:h})]}),u.jsxs(qt,{children:[u.jsx(xt,{children:e.formatMessage({id:"selectSource"})}),u.jsx(Pr,{className:"selection-source react-select",...Fn,options:O,placeholder:e.formatMessage({id:"selectionPlaceholder"}),value:Y,onChange:W,components:{Option:Md,SingleValue:Pd},isOptionDisabled:I=>I.value===void 0||I.value.status==="unavailable",getOptionLabel:I=>I.label+(I.value===void 0||I.value.status==="unavailable"?" "+e.formatMessage({id:"sourceNotAvailable"}):""),chakraStyles:h})]})]})};function Md(r){const{value:e}=r.data,{isAvailable:t,content:n}=zo(e,!1);return u.jsx(_e.Option,{...r,isDisabled:!t,className:"selection-source-option",children:n})}function Pd(r){const{value:e}=r.data,{isAvailable:t,content:n}=zo(e,!0),o=t?"selection-source-value":"selection-source-value selection-source-value--disabled";return u.jsx(_e.SingleValue,{...r,isDisabled:!t,className:o,children:n})}function zo(r,e){const t=r?.label,n=Ld(r);return{isAvailable:n.kind==="available",content:u.jsxs(ye,{direction:"row",alignItems:"center",grow:1,children:[!e&&u.jsx(ye,{grow:1,children:t}),n.kind==="unavailable"&&u.jsx(N,{ml:2,children:u.jsx(Un,{label:n.reason,placement:"right",openDelay:500,children:u.jsx(ie.span,{children:u.jsx(ti,{as:As,color:"red",className:"warning-icon","aria-label":n.reason})})})}),e&&t]})}}function Ad(r,e,t,n){const o=wd("notifier.NotificationService"),i=qr(),[s,a]=g.useState(void 0);g.useEffect(()=>{if(!r)return;const c=new kd({mapModel:r,onError(){o.notify({level:"error",message:i.formatMessage({id:"selectionFailed"})})}});return a(c),()=>{c.destroy()}},[r,o,e,i]);const l=Ne(async c=>{if(!s||!t)return;const d=await s.select(t,c.getExtent());d&&n?.(d)});return{controller:s,onExtentSelected:l}}function Tr(r,e){const t=r.status??"available",n=typeof t=="string"?{kind:t}:t;return n.kind==="available"?n:{kind:"unavailable",reason:n.reason??e}}function Ld(r){const e=qr(),[t,n]=g.useState(()=>({kind:"available"}));return g.useEffect(()=>{if(!r){n({kind:"available"});return}const o=e.formatMessage({id:"sourceNotAvailable"});n(Tr(r,o));const i=r.on?.("changed:status",()=>{n(Tr(r,o))});return()=>i?.destroy()},[r,e]),t}function Id(r,e,t,n,o){g.useEffect(()=>{if(!r)return;const i=new xd(r.olMap,e.value,t.formatMessage({id:"tooltip"}),t.formatMessage({id:"disabledTooltip"}),n);return i.setActive(o),()=>{i?.destroy()}},[r,e,t,n,o])}function Rd(){const[r,e]=Hn("colors",["background_body","border"],["#ffffff","#ffffff"]);return g.useMemo(()=>({control:n=>({...n,cursor:"pointer"}),indicatorSeparator:n=>({...n,borderColor:e}),dropdownIndicator:n=>({...n,backgroundColor:r})}),[r,e])}function Td(){const r=Ae(),e=be("notifier.NotificationService"),t=g.useId(),{map:n}=J(z),o=be("ol-app.AppModel"),i=at(o.state).selectionSources,s=at(o.state).sourceMetadata,a={numberOptions:{maximumFractionDigits:3},dateOptions:{dateStyle:"medium",timeStyle:"medium",timeZone:"UTC"}};function l(d){const{source:h,results:f}=d;if(!n){console.debug("Map not ready");return}const p=s.get(h);if(!p){console.warn("Can not show results because no metadata could be found");return}o.setResultListInput({columns:p,data:f,formatOptions:a}),e.notify({level:"info",message:r.formatMessage({id:"foundResults"},{resultsCount:f.length}),displayDuration:4e3})}function c(d){o.clearPreviousHighlight()}return u.jsx(N,{role:"dialog","aria-labelledby":t,children:u.jsx(Ve,{title:u.jsx(Ge,{id:t,size:"md",mb:2,children:r.formatMessage({id:"selectionTitle"})}),children:u.jsx(Cd,{mapId:z,sources:i,onSelectionComplete:l,onSelectionSourceChanged:c})})})}function Od(r){const e=g.useId(),t=Ae();return u.jsx(N,{role:"dialog","aria-labelledby":e,children:u.jsx(Ve,{title:u.jsx(Ge,{id:e,size:"md",mb:2,children:u.jsx(Se,{children:t.formatMessage({id:"tocTitle"})})}),children:u.jsx(N,{overflowY:"auto",maxHeight:r.maxHeight,children:u.jsx(fs,{mapId:z,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})})})}const jd={bookmarksActive:!1,legendActive:!0,overviewMapActive:!0,tocActive:!0,printingActive:!1,editingCreateActive:!1,editingUpdateActive:!1};let bt=!1,He=!1,Wt,qe,_t;function Fd(){const r=be("editing.EditingService"),e=be("notifier.NotificationService"),{map:t}=J(z),n=Ae(),o=be("ol-app.AppModel"),[i,s]=g.useState(),[a,l]=g.useState(jd),c={...a,measurementActive:i==="measurement",selectionActive:i==="selection"},d=(y,_)=>{if(y==="selectionActive"||y==="measurementActive"){let M;switch(y){case"measurementActive":M="measurement";break;case"selectionActive":M="selection";break}M!==i&&_?(s(M),o.clearPreviousHighlight()):M===i&&!_&&(s(void 0),o.clearPreviousHighlight())}else _&&(y==="editingCreateActive"&&c.editingUpdateActive||y==="editingUpdateActive"&&c.editingCreateActive)?e.notify({level:"warning",message:n.formatMessage({id:"editing.toggleNotAllowed"})}):l({...a,[y]:_})},h=at(o.state).resultListState,f=h.input&&h.open,p=[c.tocActive&&u.jsx(Od,{maxHeight:c.legendActive||i?"300px":"75vh"},"toc"),c.legendActive&&u.jsx(Cu,{},"legend"),i==="selection"?u.jsx(Td,{},"selection"):i==="measurement"?u.jsx(qu,{},"measurement"):void 0];return Dd(t,r,e,n,l,a),Nd(t,r,e,n,l,a),u.jsxs(ye,{height:"100%",direction:"column",overflow:"hidden",children:[u.jsx(Rc,{position:"top-right"}),u.jsxs(Ve,{title:u.jsx(N,{role:"region","aria-label":n.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:u.jsx(Ge,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[u.jsx(ye,{flex:"1",direction:"column",position:"relative",children:u.jsxs(es,{mapId:z,role:"main","aria-label":n.formatMessage({id:"ariaLabel.map"}),viewPadding:f?{bottom:400}:void 0,children:[u.jsx(Rs,{centerContent:!0,children:u.jsx(_d,{})}),u.jsx(ht,{position:"top-left",horizontalGap:20,verticalGap:20,children:u.jsx(Vd,{children:p})}),u.jsx(ht,{position:"top-right",horizontalGap:20,verticalGap:20,children:c.overviewMapActive&&u.jsx(Xu,{})}),u.jsx(ht,{horizontalGap:20,position:"bottom-left",children:c.bookmarksActive&&u.jsx(lu,{})}),u.jsx(ht,{horizontalGap:20,position:"bottom-left",children:c.printingActive&&u.jsx(fu,{})}),u.jsx(ht,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:u.jsx(Fu,{toolState:c,onToolStateChange:d})}),u.jsx(Ju,{})]})}),u.jsxs(ye,{role:"region","aria-label":n.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[u.jsx(xc,{mapId:z,precision:2,displayProjectionCode:"EPSG:4326"}),u.jsx(Tc,{mapId:z}),u.jsx(Fc,{mapId:z})]})]})]})}function Dd(r,e,t,n,o,i){g.useEffect(()=>{if(!r)return;i.editingCreateActive&&!bt&&!He?s():!i.editingCreateActive&&bt&&a();function s(){if(!r)throw Error("map is undefined");try{bt=!0;const l=r.layers.getLayerById("krankenhaus"),c=new URL(l.attributes.collectionURL+"/items");e.createFeature(r,c).whenComplete().then(h=>{if(!h)return;t.notify({level:"info",message:n.formatMessage({id:"editing.create.featureCreated"},{featureId:h.featureId})}),(l?.olLayer).getSource()?.refresh()}).catch(h=>{console.error(h)}).finally(()=>{o({...i,editingCreateActive:!1}),bt=!1})}catch(l){console.error(l)}}function a(){e.stop(z)}},[r,e,t,n,o,i])}function Nd(r,e,t,n,o,i){g.useEffect(()=>{if(!r)return;i.editingUpdateActive&&!bt&&!He?a():!i.editingUpdateActive&&He&&(Dn(r),l(),He=!1);function s(c){const d=document.createElement("div");d.className="editing-tooltip editing-tooltip-hidden",d.textContent=n.formatMessage({id:"editing.update.tooltip.select"});const h=new it({element:d,offset:[15,0],positioning:"center-left"}),f=c.on("pointermove",p=>{p.dragging||h.setPosition(p.coordinate)});return c.addOverlay(h),{overlay:h,element:d,destroy(){ee(f),c.removeOverlay(h)}}}function a(){if(!r)throw Error("map is undefined");He=!0,_t=s(r.olMap);try{const c=r.layers.getLayerById("krankenhaus"),d=c?.olLayer;qe=new Yl({layers:[d]}),r.olMap.addInteraction(qe),_t.element.classList.remove("editing-tooltip-hidden");const h=new URL(c.attributes.collectionURL+"/items");Wt=qe.on("select",f=>{const p=f.selected,y=f.deselected;if(p.length===1&&y.length===0){Dn(r);const _=p[0];if(!_)throw Error("feature is undefined");e.updateFeature(r,h,_).whenComplete().then(C=>{C&&(t.notify({level:"info",message:n.formatMessage({id:"editing.update.featureModified"},{featureId:C.featureId})}),d.getSource()?.refresh())}).catch(C=>{console.error(C)}).finally(()=>{o({...i,editingUpdateActive:!1}),He=!1})}})}catch(c){console.error(c)}}function l(){e.stop(z)}},[r,e,t,n,o,i])}function Dn(r){qe&&r.olMap.removeInteraction(qe),Wt&&ee(Wt),_t&&_t.destroy(),qe=void 0,Wt=void 0,_t=void 0}function Vd(r){const e=r.children,t=[];for(const n of e)n&&(t.length&&t.push(u.jsx(Is,{mt:4,mb:4},t.length)),t.push(n));if(t.length!==0)return u.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:t})}const Gd=ri({component:Fd,theme:ni,appMetadata:bc,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(r){const e=r.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",Gd);const Bd=document.getElementsByTagName("body")[0];zd();function zd(){const r=window.location.search,t=new URLSearchParams(r).get("lang"),n=document.createElement("ol-map-app");n.classList.add("full-height"),n.classList.add("app"),n.setAttribute("id","test"),t&&n.setAttribute("forced-locale",t),Bd.appendChild(n)}
