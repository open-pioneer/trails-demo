var gn=Object.defineProperty;var mn=(o,e,t)=>e in o?gn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var Io=(o,e,t)=>(mn(o,typeof e!="symbol"?e+"":e,t),t),qt=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var C=(o,e,t)=>(qt(o,e,"read from private field"),t?t.call(o):e.get(o)),R=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},D=(o,e,t,s)=>(qt(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);var $=(o,e,t)=>(qt(o,e,"access private method"),t);import{f as So,j as c,r as p,u as vn,c as le,i as Lt,a as Se,g as bn,R as ps,E as se,b as Sn,A as Kt,d as Yt,F as gs,B as yo,C as yn,t as wn,e as ms,I as _n,h as xn}from"./426e7955184f.js";import{t as kn}from"./840b85bdda04.js";import{b as vs,B as bs,i as Cn,g as En,a as Oo,t as Pn,c as Mn,d as Ss,S as Tn,e as An,f as Ln,h as Rn,j as In,r as On,C as Dn,k as jn,l as Nn,u as Fn,m as ys,M as ws,o as Vn,n as Bn,p as _s,A as Gn,T as wo,I as Un,q as zn,s as ro,v as be,w as Wn,x as $n,y as St,O as xs,V as Xe,z as Me,D as Pe,E as _o,F as $e,P as Hn,G as qn,H as Kn,J as Do,K as Yn,L as Xn,N as jo,Q as Zn,R as Jn,U as ks,W as de,X as Qn,Y as Cs,Z as we,_ as Oe,$ as No,a0 as er,a1 as zt,a2 as tr,a3 as Es,a4 as or,a5 as sr,a6 as nr,a7 as rr,a8 as J,a9 as Ps,aa as ir,ab as Fo,ac as Ms,ad as ar,ae as Vo,af as lr,ag as Xt,ah as cr,ai as Bo,aj as ur,ak as dr,al as hr,am as fr,an as pr,ao as gr,ap as Go,aq as mr,ar as vr,as as br,at as Sr,au as Ts,av as Ce,aw as yr,ax as wr,ay as _r,az as Uo,aA as xr,aB as zo,aC as kr,aD as yt}from"./02bbd9308d5d.js";import{m as N,a as k,X as As,p as B,r as O,b as Z,c as xo,d as io,e as ve,f as Cr,g as Er,W as vt,P as Ls,h as Rs,i as Pr,j as Mr,k as Tr,l as Ar,n as Lr}from"./0e102de1031a.js";import{o as Rr,W as Ir}from"./fcfb84952840.js";import{u as re,c as bt,T as Ze,S as Je,a as ye}from"./9551c9063157.js";import{G as ko,M as Or,a as Is,b as Os,c as Dr,T as jr}from"./19c64ca2ed43.js";import{T as Q}from"./b7fed899024c.js";import{B as V}from"./decce0e2df72.js";import{N as Nr,W as Fr,u as He,a as Vr}from"./d9902033de59.js";import{V as Br,S as Gr,I as Ur,Z as zr,a as Wr}from"./aea9d3eaeea2.js";import{E as Ds}from"./960f2965a833.js";import{_ as Wo,G as $r,F as Hr}from"./7cba8b0994e1.js";import{u as ce,a as Wt}from"./ce9c2b856218.js";import{F as ae}from"./f5b57cbbad81.js";import{L as js}from"./a8b3dd084ced.js";import{S as qr}from"./4bfba08553df.js";import{V as ao}from"./200f73ece00d.js";import{I as Kr}from"./a1d191a71ee1.js";import{L as De}from"./8c5cf80f8ce6.js";import{F as lo}from"./ab693b4fc282.js";import{F as co}from"./2077928ad913.js";import{H as Yr}from"./b521c1061f29.js";import{S as Xr}from"./91b29420bd67.js";import{c as Zr}from"./c3a02fccc706.js";import{c as ue,S as uo}from"./2aa62055bcbf.js";import{C as Jr}from"./937f234b9f67.js";import{D as Qr}from"./311c8db399b0.js";import"./f0fdbca92ad1.js";import"./a71a718328f4.js";import"./01e6123a9660.js";import"./889126c04a9d.js";import"./816a75328e49.js";var ho=So(function(e,t){const{htmlWidth:s,htmlHeight:n,alt:r,...i}=e;return c.jsx("img",{width:s,height:n,ref:t,alt:r,...i})});ho.displayName="NativeImage";function ei(o){const{loading:e,src:t,srcSet:s,onLoad:n,onError:r,crossOrigin:i,sizes:a,ignoreFallback:u}=o,[l,d]=p.useState("pending");p.useEffect(()=>{d(t?"loading":"pending")},[t]);const h=p.useRef(),v=p.useCallback(()=>{if(!t)return;b();const y=new Image;y.src=t,i&&(y.crossOrigin=i),s&&(y.srcset=s),a&&(y.sizes=a),e&&(y.loading=e),y.onload=w=>{b(),d("loaded"),n?.(w)},y.onerror=w=>{b(),d("failed"),r?.(w)},h.current=y},[t,i,s,a,n,r,e]),b=()=>{h.current&&(h.current.onload=null,h.current.onerror=null,h.current=null)};return vn(()=>{if(!u)return l==="loading"&&v(),()=>{b()}},[l,v,u]),u?"loaded":l}var ti=(o,e)=>o!=="loaded"&&e==="beforeLoadOrError"||o==="failed"&&e==="onError";function oi(o,e=[]){const t=Object.assign({},o);for(const s of e)s in t&&delete t[s];return t}var Ns=So(function(e,t){const{fallbackSrc:s,fallback:n,src:r,srcSet:i,align:a,fit:u,loading:l,ignoreFallback:d,crossOrigin:h,fallbackStrategy:v="beforeLoadOrError",referrerPolicy:b,...y}=e,w=s!==void 0||n!==void 0,A=l!=null||d||!w,P=ei({...e,crossOrigin:h,ignoreFallback:A}),I=ti(P,v),T={ref:t,objectFit:u,objectPosition:a,...A?y:oi(y,["onError","onLoad"])};return I?n||c.jsx(le.img,{as:ho,className:"chakra-image__placeholder",src:s,...T}):c.jsx(le.img,{as:ho,src:r,srcSet:i,crossOrigin:h,loading:l,referrerPolicy:b,className:"chakra-image",...T})});Ns.displayName="Image";var Fs=le("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});Fs.displayName="Center";var si={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};So(function(e,t){const{axis:s="both",...n}=e;return c.jsx(le.div,{ref:t,__css:si[s],...n,position:"absolute"})});const X=[null,"http://www.opengis.net/ows/1.1"],ni=N(X,{ServiceIdentification:k(Ti),ServiceProvider:k(Li),OperationsMetadata:k(Pi)});class ri extends As{constructor(){super()}readFromNode(e){const t=B({},ni,e,[]);return t||null}}const ii=N(X,{DeliveryPoint:k(O),City:k(O),AdministrativeArea:k(O),PostalCode:k(O),Country:k(O),ElectronicMailAddress:k(O)}),ai=N(X,{Value:Z(Ri)}),li=N(X,{AllowedValues:k(yi)}),ci=N(X,{Phone:k(Mi),Address:k(Si)}),ui=N(X,{HTTP:k(Ci)}),di=N(X,{Get:Z(ki),Post:void 0}),hi=N(X,{DCP:k(xi)}),fi=N(X,{Operation:Ei}),pi=N(X,{Voice:k(O),Facsimile:k(O)}),gi=N(X,{Constraint:Z(wi)}),mi=N(X,{IndividualName:k(O),PositionName:k(O),ContactInfo:k(_i)}),vi=N(X,{Abstract:k(O),AccessConstraints:k(O),Fees:k(O),Title:k(O),ServiceTypeVersion:k(O),ServiceType:k(O)}),bi=N(X,{ProviderName:k(O),ProviderSite:k(xo),ServiceContact:k(Ai)});function Si(o,e){return B({},ii,o,e)}function yi(o,e){return B({},ai,o,e)}function wi(o,e){const t=o.getAttribute("name");if(t)return B({name:t},li,o,e)}function _i(o,e){return B({},ci,o,e)}function xi(o,e){return B({},ui,o,e)}function ki(o,e){const t=xo(o);if(t)return B({href:t},gi,o,e)}function Ci(o,e){return B({},di,o,e)}function Ei(o,e){const t=o.getAttribute("name"),s=B({},hi,o,e);if(!s)return;const n=e[e.length-1];n[t]=s}function Pi(o,e){return B({},fi,o,e)}function Mi(o,e){return B({},pi,o,e)}function Ti(o,e){return B({},vi,o,e)}function Ai(o,e){return B({},mi,o,e)}function Li(o,e){return B({},bi,o,e)}function Ri(o,e){return O(o)}const Ii=ri,ie=[null,"http://www.opengis.net/wmts/1.0"],Qe=[null,"http://www.opengis.net/ows/1.1"],Oi=N(ie,{Contents:k(Hi)});class Di extends As{constructor(){super(),this.owsParser_=new Ii}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let s=this.owsParser_.readFromNode(e);return s?(s.version=t,s=B(s,Oi,e,[]),s||null):null}}const ji=N(ie,{Layer:Z(qi),TileMatrixSet:Z(Ki)}),Ni=N(ie,{Style:Z(Yi),Format:Z(O),TileMatrixSetLink:Z(Xi),Dimension:Z(Zi),ResourceURL:Z(Ji)},N(Qe,{Title:k(O),Abstract:k(O),WGS84BoundingBox:k(Vs),Identifier:k(O)})),Fi=N(ie,{LegendURL:Z(Qi)},N(Qe,{Title:k(O),Identifier:k(O)})),Vi=N(ie,{TileMatrixSet:k(O),TileMatrixSetLimits:k(ta)}),Bi=N(ie,{TileMatrixLimits:io(oa)}),Gi=N(ie,{TileMatrix:k(O),MinTileRow:k(ve),MaxTileRow:k(ve),MinTileCol:k(ve),MaxTileCol:k(ve)}),Ui=N(ie,{Default:k(O),Value:Z(O)},N(Qe,{Identifier:k(O)})),zi=N(Qe,{LowerCorner:io(fo),UpperCorner:io(fo)}),Wi=N(ie,{WellKnownScaleSet:k(O),TileMatrix:Z(ea)},N(Qe,{SupportedCRS:k(O),Identifier:k(O),BoundingBox:k(Vs)})),$i=N(ie,{TopLeftCorner:k(fo),ScaleDenominator:k(Cr),TileWidth:k(ve),TileHeight:k(ve),MatrixWidth:k(ve),MatrixHeight:k(ve)},N(Qe,{Identifier:k(O)}));function Hi(o,e){return B({},ji,o,e)}function qi(o,e){return B({},Ni,o,e)}function Ki(o,e){return B({},Wi,o,e)}function Yi(o,e){const t=B({},Fi,o,e);if(!t)return;const s=o.getAttribute("isDefault")==="true";return t.isDefault=s,t}function Xi(o,e){return B({},Vi,o,e)}function Zi(o,e){return B({},Ui,o,e)}function Ji(o,e){const t=o.getAttribute("format"),s=o.getAttribute("template"),n=o.getAttribute("resourceType"),r={};return t&&(r.format=t),s&&(r.template=s),n&&(r.resourceType=n),r}function Vs(o,e){const t=B([],zi,o,e);if(t.length==2)return vs(t)}function Qi(o,e){const t={};return t.format=o.getAttribute("format"),t.href=xo(o),t}function fo(o,e){const t=O(o).split(/\s+/);if(!t||t.length!=2)return;const s=+t[0],n=+t[1];if(!(isNaN(s)||isNaN(n)))return[s,n]}function ea(o,e){return B({},$i,o,e)}function ta(o,e){return B([],Bi,o,e)}function oa(o,e){return B({},Gi,o,e)}const sa=Di,U={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},na={ERROR:"error"};class ra extends Ss{constructor(e){super(na.ERROR),this.code=e.code,this.message=e.message}}let ia=class extends bs{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=Cn,this.watchId_=void 0,this.addChangeListener(U.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(U.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=En(Oo("EPSG:4326"),e),this.position_&&this.set(U.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(U.ACCURACY,t.accuracy),this.set(U.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(U.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(U.HEADING,t.heading===null?void 0:Pn(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const s=this.transform_(this.position_);this.set(U.POSITION,s.slice()),this.set(U.SPEED,t.speed===null?void 0:t.speed);const n=Mn(this.position_,t.accuracy);n.applyTransform(this.transform_),this.set(U.ACCURACY_GEOMETRY,n),this.changed()}positionError_(e){this.dispatchEvent(new ra(e))}getAccuracy(){return this.get(U.ACCURACY)}getAccuracyGeometry(){return this.get(U.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(U.ALTITUDE)}getAltitudeAccuracy(){return this.get(U.ALTITUDE_ACCURACY)}getHeading(){return this.get(U.HEADING)}getPosition(){return this.get(U.POSITION)}getProjection(){return this.get(U.PROJECTION)}getSpeed(){return this.get(U.SPEED)}getTracking(){return this.get(U.TRACKING)}getTrackingOptions(){return this.get(U.TRACKING_OPTIONS)}setProjection(e){this.set(U.PROJECTION,Oo(e))}setTracking(e){this.set(U.TRACKING,e)}setTrackingOptions(e){this.set(U.TRACKING_OPTIONS,e)}};const aa=ia;class $t extends Tn{constructor(e,t,s){super(),s!==void 0&&t===void 0?this.setFlatCoordinates(s,e):(t=t||0,this.setCenterAndRadius(e,t,s))}clone(){const e=new $t(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,s,n){const r=this.flatCoordinates,i=e-r[0],a=t-r[1],u=i*i+a*a;if(u<n){if(u===0)for(let l=0;l<this.stride;++l)s[l]=r[l];else{const l=this.getRadius()/Math.sqrt(u);s[0]=r[0]+l*i,s[1]=r[1]+l*a;for(let d=2;d<this.stride;++d)s[d]=r[d]}return s.length=this.stride,u}return n}containsXY(e,t){const s=this.flatCoordinates,n=e-s[0],r=t-s[1];return n*n+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,s=t[this.stride]-t[0];return An(t[0]-s,t[1]-s,t[0]+s,t[1]+s,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(Ln(e,t)){const s=this.getCenter();return e[0]<=s[0]&&e[2]>=s[0]||e[1]<=s[1]&&e[3]>=s[1]?!0:Rn(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,s=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+s;for(let r=1;r<t;++r)n[t+r]=e[r];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(e,t,s){this.setLayout(s,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let r=In(n,0,e,this.stride);n[r++]=n[0]+t;for(let i=1,a=this.stride;i<a;++i)n[r++]=n[i];n.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const s=this.getCenter(),n=this.getStride();this.setCenter(On(s,0,s.length,n,e,t,s)),this.changed()}}$t.prototype.transform;const la=$t,q={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class ca extends bs{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+Dn,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(q.ELEMENT,this.handleElementChanged),this.addChangeListener(q.MAP,this.handleMapChanged),this.addChangeListener(q.OFFSET,this.handleOffsetChanged),this.addChangeListener(q.POSITION,this.handlePositionChanged),this.addChangeListener(q.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(q.ELEMENT)}getId(){return this.id}getMap(){return this.get(q.MAP)||null}getOffset(){return this.get(q.OFFSET)}getPosition(){return this.get(q.POSITION)}getPositioning(){return this.get(q.POSITIONING)}handleElementChanged(){jn(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(Nn(this.element),Fn(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=ys(e,ws.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(q.ELEMENT,e)}setMap(e){this.set(q.MAP,e)}setOffset(e){this.set(q.OFFSET,e)}setPosition(e){this.set(q.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(q.POSITION))return;const s=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),r=this.getRect(n,[Vn(n),Bn(n)]);e=e||{};const i=e.margin===void 0?20:e.margin;if(!_s(s,r)){const a=r[0]-s[0],u=s[2]-r[2],l=r[1]-s[1],d=s[3]-r[3],h=[0,0];if(a<0?h[0]=a-i:u<0&&(h[0]=Math.abs(u)+i),l<0?h[1]=l-i:d<0&&(h[1]=Math.abs(d)+i),h[0]!==0||h[1]!==0){const v=t.getView().getCenterInternal(),b=t.getPixelFromCoordinateInternal(v);if(!b)return;const y=[b[0]+h[0],b[1]+h[1]],w=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(y),duration:w.duration,easing:w.easing})}}}getRect(e,t){const s=e.getBoundingClientRect(),n=s.left+window.pageXOffset,r=s.top+window.pageYOffset;return[n,r,n+t[0],r+t[1]]}setPositioning(e){this.set(q.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const s=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(s,n)}updateRenderedPosition(e,t){const s=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const i=Math.round(e[0]+n[0])+"px",a=Math.round(e[1]+n[1])+"px";let u="0%",l="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?u="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(u="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?l="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(l="-50%");const d=`translate(${u}, ${l}) translate(${i}, ${a})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,s.transform=d)}getOptions(){return this.options}}const Rt=ca,_e=Se("map:WMTSLayer");var je,Ne,Fe,Dt,Ve,it,at,lt,jt,Bs,Nt,Gs;class ua extends Gn{constructor(t){const s=new wo;super({...t,olLayer:s});R(this,jt);R(this,Nt);R(this,je,void 0);R(this,Ne,void 0);R(this,Fe,void 0);R(this,Dt,void 0);R(this,Ve,void 0);R(this,it,void 0);R(this,at,void 0);R(this,lt,new AbortController);D(this,je,t.url),D(this,Ne,t.name),D(this,Ve,s),D(this,Fe,t.matrixSet)}destroy(){super.destroy(),C(this,lt).abort()}get legend(){return C(this,at)}__attach(t){super.__attach(t),$(this,jt,Bs).call(this).then(s=>{const r=new sa().read(s),i=Rr(r,{layer:C(this,Ne),matrixSet:C(this,Fe)});if(!i)throw new Error("Layer was not found in capabilities");const a=new Ir({...i,tileLoadFunction:(d,h)=>{$(this,Nt,Gs).call(this,d,h)}});D(this,it,a),C(this,Ve).setSource(C(this,it));const u=a.getStyle(),l=ha(r,this.name,u);D(this,at,l),this.__emitChangeEvent("changed:legend")}).catch(s=>{if(Lt(s)){_e.error(`Layer ${this.name} has been destroyed before fetching the data`);return}_e.error(`Failed fetching WMTS capabilities for Layer ${this.name}`,s)})}get layer(){return C(this,Ve)}get url(){return C(this,je)}get name(){return C(this,Ne)}get matrixSet(){return C(this,Fe)}get attributions(){return C(this,Dt)}get sublayers(){}}je=new WeakMap,Ne=new WeakMap,Fe=new WeakMap,Dt=new WeakMap,Ve=new WeakMap,it=new WeakMap,at=new WeakMap,lt=new WeakMap,jt=new WeakSet,Bs=async function(){const t=this.map.__sharedDependencies.httpService;return Er(C(this,je),t,C(this,lt).signal)},Nt=new WeakSet,Gs=async function(t,s){const n=this.map.__sharedDependencies.httpService;try{if(!(t instanceof Un))throw new Error("Only 'ImageTile' is supported for now.");const r=t.getImage();if(!da(r))throw new Error("Only <img> tags are supported as tiles for now.");const i=await n.fetch(s);if(!i.ok)throw new Error(`Tile request failed with status ${i.status}.`);const a=await i.blob(),u=URL.createObjectURL(a),l=()=>{URL.revokeObjectURL(u),r.removeEventListener("load",l),r.removeEventListener("error",l)};r.addEventListener("load",l),r.addEventListener("error",l),r.src=u}catch(r){t.setState(zn.ERROR),Lt(r)||_e.error("Failed to load tile",r)}};function da(o){return o.tagName==="IMG"}function ha(o,e,t){const n=o?.Contents?.Layer;let r=n?.find(l=>l?.Identifier===e);if(!r&&(_e.debug("Failed to find the active layer in WMTS layer capabilities."),r=n?.[0],!r)){_e.debug("No layer in WMTS capabilities - giving up.");return}const i=r.Style;let a=i?.find(l=>l?.Identifier===t);if(!a&&(_e.debug("Failed to find active style in WMTS layer."),a=i?.[0],!a)){_e.debug("No style in WMTS layer capabilities - giving up.");return}return a.LegendURL?.[0]?.href}const $o=ua,fa=25.4/.28,pa=39.37;function Co(o){return Eo(o,ga,ma)}function ga(o){return o.getView()}function ma(o,e){return o.on("change:view",e)}function Us(o){return Co(o)?.getProjection()}function va(o){const e=Co(o);return Eo(e,ba,Sa)}function ba(o){return o.getResolution()}function Sa(o,e){return o.on("change:resolution",e)}function ya(o){const e=Co(o);return Eo(e,wa,_a)}function wa(o){return o.getCenter()}function _a(o,e){return o.on("change:center",e)}function xa(o){const e=ya(o),t=va(o),s=Us(o);return p.useMemo(()=>{if(s==null||t==null||e==null)return;const r=ro(s,t,e);return Math.round(r*pa*fa)},[s,t,e])}function Eo(o,e,t){const s=p.useCallback(()=>o?e(o):void 0,[o,e]),n=p.useCallback(r=>{if(!o)return()=>{};const i=t(o,r);return()=>be(i)},[o,t]);return p.useSyncExternalStore(n,s)}const ka=1.2;function Ca(o,e=ka){Ea(o);const t=Wn(o),s=$n(o),n=t*e,r=s*e;return[o[0]-(n-t)/2,o[1]-(r-s)/2,o[2]+(n-t)/2,o[3]+(r-s)/2]}function Ea(o){if(o.length!==4)throw new Error(`Invalid extent (expected length 4, but got length ${o.length}).`)}const Pa={height:"25px",width:"25px",borderColor:"#4cb3ff",borderWidth:"3px",borderRadius:"50%",display:"inline-block "};function Ma(o){return c.jsxs(V,{children:[c.jsx(Q,{children:o.layer.title}),c.jsx(V,{style:Pa})]})}function Ta(o){return c.jsxs(V,{children:[c.jsx(Q,{as:"b",children:o.layer.title}),c.jsx(Q,{children:"Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."})]})}const z="main";class Aa{mapId=z;vectorSourceFactory;constructor(e){this.vectorSourceFactory=e.references.vectorSourceFactory}async getMapConfig(){const e={Component:Ma};return{initialView:{kind:"position",center:{x:404747,y:5757920},zoom:14},projection:"EPSG:25832",layers:[new vt({title:"Linfos",visible:!0,url:"https://www.wms.nrw.de/umwelt/linfos",sublayers:[{name:"SonstigeSchutzgebiete",title:"SonstigeSchutzgebiete"},{name:"SCH_GSG",title:"SCH_GSG"}]}),new $o({isBaseLayer:!0,title:"Topplus grau",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_grau",matrixSet:"EPSG_25832_14",visible:!1}),new $o({isBaseLayer:!0,title:"Topplus farbig",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_col",matrixSet:"EPSG_25832_14",visible:!1}),new St({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new wo({source:new xs})}),new St({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:La(),attributes:{legend:e}}),new St({id:"ogc_kitas",title:"Kindertagesstätten",visible:!0,olLayer:Ra(),attributes:{legend:e}}),new St({id:"ogc_kataster",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:Ia(this.vectorSourceFactory)}),ja(),Fa(),Oa(),Da()]}}}function La(){const o=new Xe({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new ko,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new Me({source:o})}function Ra(){const o=new Xe({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new ko,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new Me({source:o,style:new Pe({image:new _o({fill:new $e({color:"blue"}),radius:4})})})}function Ia(o){const e=o.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:"<a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>"});return new Me({source:e})}function Oa(){return new vt({title:"Verwaltungsgebiete",visible:!0,url:"https://www.wms.nrw.de/geobasis/wms_nw_dvg",sublayers:[{name:"nw_dvg_bld",title:"NRW"}]})}function Da(){return new vt({title:"Bodenkarte zur Landwirtschaftlichen Standorterkundung",visible:!0,url:"https://www.wms.nrw.de/gd/bk05l",sublayers:[{name:"Versickerung_und_Stofftransport",title:"Versickerung und Stofftransport",sublayers:[{name:"Sickerwasserrate",title:"Sickerwasserrate",sublayers:[{name:"Szenario_Wald",title:"Szenario Wald",sublayers:[{name:"Sickerwasserrate_Wald",title:"Sickerwasserrate Wald"},{name:"Direktabfluss_Wald",title:"Direktabfluss Wald"}]},{name:"Szenario_Gruenland",title:"Szenario Grünland",sublayers:[{name:"Sickerwasserrate_Gruenland",title:"Sickerwasserrate Grünland"},{name:"Direktabfluss_Gruenland",title:"Direktabfluss Grünland"}]}]}]},{name:"Wasserhaushalt",title:"Wasserhaushalt",sublayers:[{name:"Kapillaraufstieg_von_Grundwasser",title:"Kapillaraufstieg von Grundwasser",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/gd/bk05l?request=GetLegendGraphic%26version=1.3.0%26format=image/png%26layer=Kapillaraufstieg_von_Grundwasser"}}},{name:"Luftkapazitaet_We",title:"Luftkapazitaet (We)",attributes:{legend:{imageUrl:"https://avatars.githubusercontent.com/u/121286957?s=200&v=4"}}}]}]})}function ja(){return new vt({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW",attributes:{legend:{imageUrl:"https://avatars.githubusercontent.com/u/121286957?s=200&v=4"}}}],sourceOptions:{ratio:1}})}const Na={Component:Ta};function Fa(){return new vt({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",visible:!0,sublayers:[{name:"1",title:"Verwaltungen",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/legends/wms/strassen_nrw_wms/1.png"}}},{name:"4",title:"Abschnitte und Äste",attributes:{legend:Na}},{name:"6",title:"Unfälle"}]})}const Va=Symbol(),Po=Symbol(),et="a",At="w";let Ba=(o,e)=>new Proxy(o,e);const po=Object.getPrototypeOf,go=new WeakMap,zs=o=>o&&(go.has(o)?go.get(o):po(o)===Object.prototype||po(o)===Array.prototype),Ho=o=>typeof o=="object"&&o!==null,Ga=o=>{if(Array.isArray(o))return Array.from(o);const e=Object.getOwnPropertyDescriptors(o);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(po(o),e)},Ws=o=>o[Po]||o,$s=(o,e,t,s)=>{if(!zs(o))return o;let n=s&&s.get(o);if(!n){const u=Ws(o);n=(l=>Object.values(Object.getOwnPropertyDescriptors(l)).some(d=>!d.configurable&&!d.writable))(u)?[u,Ga(u)]:[u],s?.set(o,n)}const[r,i]=n;let a=t&&t.get(r);return a&&a[1].f===!!i||(a=((u,l)=>{const d={f:l};let h=!1;const v=(y,w)=>{if(!h){let A=d[et].get(u);if(A||(A={},d[et].set(u,A)),y===At)A[At]=!0;else{let P=A[y];P||(P=new Set,A[y]=P),P.add(w)}}},b={get:(y,w)=>w===Po?u:(v("k",w),$s(Reflect.get(y,w),d[et],d.c,d.t)),has:(y,w)=>w===Va?(h=!0,d[et].delete(u),!0):(v("h",w),Reflect.has(y,w)),getOwnPropertyDescriptor:(y,w)=>(v("o",w),Reflect.getOwnPropertyDescriptor(y,w)),ownKeys:y=>(v(At),Reflect.ownKeys(y))};return l&&(b.set=b.deleteProperty=()=>!1),[b,d]})(r,!!i),a[1].p=Ba(i||r,a[0]),t&&t.set(r,a)),a[1][et]=e,a[1].c=t,a[1].t=s,a[1].p},Hs=(o,e,t,s)=>{if(Object.is(o,e))return!1;if(!Ho(o)||!Ho(e))return!0;const n=t.get(Ws(o));if(!n)return!0;if(s){const i=s.get(o);if(i&&i.n===e)return i.g;s.set(o,{n:e,g:!1})}let r=null;try{for(const i of n.h||[])if(r=Reflect.has(o,i)!==Reflect.has(e,i),r)return r;if(n[At]===!0){if(r=((i,a)=>{const u=Reflect.ownKeys(i),l=Reflect.ownKeys(a);return u.length!==l.length||u.some((d,h)=>d!==l[h])})(o,e),r)return r}else for(const i of n.o||[])if(r=!!Reflect.getOwnPropertyDescriptor(o,i)!=!!Reflect.getOwnPropertyDescriptor(e,i),r)return r;for(const i of n.k||[])if(r=Hs(o[i],e[i],t,s),r)return r;return r===null&&(r=!0),r}finally{s&&s.set(o,{n:e,g:r})}},Ua=o=>zs(o)&&o[Po]||null,qo=(o,e=!0)=>{go.set(o,e)};const Zt=o=>typeof o=="object"&&o!==null,fe=new WeakMap,nt=new WeakSet,za=(o=Object.is,e=(l,d)=>new Proxy(l,d),t=l=>Zt(l)&&!nt.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),s=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},n=new WeakMap,r=(l,d,h=s)=>{const v=n.get(l);if(v?.[0]===d)return v[1];const b=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return qo(b,!0),n.set(l,[d,b]),Reflect.ownKeys(l).forEach(y=>{if(Object.getOwnPropertyDescriptor(b,y))return;const w=Reflect.get(l,y),{enumerable:A}=Reflect.getOwnPropertyDescriptor(l,y),P={value:w,enumerable:A,configurable:!0};if(nt.has(w))qo(w,!1);else if(w instanceof Promise)delete P.value,P.get=()=>h(w);else if(fe.has(w)){const[I,T]=fe.get(w);P.value=r(I,T(),h)}Object.defineProperty(b,y,P)}),Object.preventExtensions(b)},i=new WeakMap,a=[1,1],u=l=>{if(!Zt(l))throw new Error("object required");const d=i.get(l);if(d)return d;let h=a[0];const v=new Set,b=(m,S=++a[0])=>{h!==S&&(h=S,v.forEach(f=>f(m,S)))};let y=a[1];const w=(m=++a[1])=>(y!==m&&!v.size&&(y=m,P.forEach(([S])=>{const f=S[1](m);f>h&&(h=f)})),h),A=m=>(S,f)=>{const _=[...S];_[1]=[m,..._[1]],b(_,f)},P=new Map,I=(m,S)=>{if(v.size){const f=S[3](A(m));P.set(m,[S,f])}else P.set(m,[S])},T=m=>{var S;const f=P.get(m);f&&(P.delete(m),(S=f[1])==null||S.call(f))},K=m=>(v.add(m),v.size===1&&P.forEach(([f,_],M)=>{const x=f[3](A(M));P.set(M,[f,x])}),()=>{v.delete(m),v.size===0&&P.forEach(([f,_],M)=>{_&&(_(),P.set(M,[f]))})}),Y=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),W=e(Y,{deleteProperty(m,S){const f=Reflect.get(m,S);T(S);const _=Reflect.deleteProperty(m,S);return _&&b(["delete",[S],f]),_},set(m,S,f,_){const M=Reflect.has(m,S),x=Reflect.get(m,S,_);if(M&&(o(x,f)||i.has(f)&&o(x,i.get(f))))return!0;T(S),Zt(f)&&(f=Ua(f)||f);let E=f;if(f instanceof Promise)f.then(F=>{f.status="fulfilled",f.value=F,b(["resolve",[S],F])}).catch(F=>{f.status="rejected",f.reason=F,b(["reject",[S],F])});else{!fe.has(f)&&t(f)&&(E=u(f));const F=!nt.has(E)&&fe.get(E);F&&I(S,F)}return Reflect.set(m,S,E,_),b(["set",[S],f,x]),!0}});i.set(l,W);const g=[Y,w,r,K];return fe.set(W,g),Reflect.ownKeys(l).forEach(m=>{const S=Object.getOwnPropertyDescriptor(l,m);"value"in S&&(W[m]=l[m],delete S.value,delete S.writable),Object.defineProperty(Y,m,S)}),W})=>[u,fe,nt,o,e,t,s,n,r,i,a],[Wa]=za();function $a(o={}){return Wa(o)}function Ha(o,e,t){const s=fe.get(o);let n;const r=[],i=s[3];let a=!1;const l=i(d=>{if(r.push(d),t){e(r.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,a&&e(r.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Ko(o,e){const t=fe.get(o),[s,n,r]=t;return r(s,n(),e)}function wt(o){return nt.add(o),o}var qs={exports:{}},Ks={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qe=p;function qa(o,e){return o===e&&(o!==0||1/o===1/e)||o!==o&&e!==e}var Ka=typeof Object.is=="function"?Object.is:qa,Ya=qe.useState,Xa=qe.useEffect,Za=qe.useLayoutEffect,Ja=qe.useDebugValue;function Qa(o,e){var t=e(),s=Ya({inst:{value:t,getSnapshot:e}}),n=s[0].inst,r=s[1];return Za(function(){n.value=t,n.getSnapshot=e,Jt(n)&&r({inst:n})},[o,t,e]),Xa(function(){return Jt(n)&&r({inst:n}),o(function(){Jt(n)&&r({inst:n})})},[o]),Ja(t),t}function Jt(o){var e=o.getSnapshot;o=o.value;try{var t=e();return!Ka(o,t)}catch{return!0}}function el(o,e){return e()}var tl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?el:Qa;Ks.useSyncExternalStore=qe.useSyncExternalStore!==void 0?qe.useSyncExternalStore:tl;qs.exports=Ks;var ol=qs.exports;const sl=bn(ol),{use:Yo}=ps,{useSyncExternalStore:nl}=sl;const rl=new WeakMap;function Ys(o,e){const t=e?.sync,s=p.useRef(),n=p.useRef();let r=!0;const i=nl(p.useCallback(l=>{const d=Ha(o,l,t);return l(),d},[o,t]),()=>{const l=Ko(o,Yo);try{if(!r&&s.current&&n.current&&!Hs(s.current,l,n.current,new WeakMap))return s.current}catch{}return l},()=>Ko(o,Yo));r=!1;const a=new WeakMap;p.useEffect(()=>{s.current=i,n.current=a});const u=p.useMemo(()=>new WeakMap,[]);return $s(i,a,u,rl)}class il{label;filteredTypes;httpService;constructor(e,t,s){this.label=e,this.filteredTypes=t,this.httpService=s}async search(e,{mapProjection:t,signal:s}){const n=await this.request(e,100,s),r=new ko({dataProjection:"EPSG:4326",featureProjection:t});return n.features.filter(i=>this.filteredTypes.includes(i.properties.type)).map((i,a)=>{const u=r.readGeometry(i.geometry);return{id:i.properties.osm_id||a,label:this.createLabel(i),geometry:u,properties:i.properties}})}async request(e,t,s){const n=new URL("https://photon.komoot.io/api?");n.searchParams.set("q",e),n.searchParams.set("lang","de"),n.searchParams.set("lat","51.961563"),n.searchParams.set("lon","7.628202"),n.searchParams.set("limit",t.toString());const r=await this.httpService.fetch(n,{signal:s});if(!r.ok)throw new Error("Request failed: "+r.status);return await r.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}}const al=Se("ol-app:AppModel");class ll{_intl;_mapRegistry;_ogcSearchSourceFactory;_vectorSelectionSourceFactory;_httpService;_state;_resources=[];constructor({references:e,intl:t}){this._mapRegistry=e.mapRegistry,this._intl=t,this._ogcSearchSourceFactory=e.ogcSearchSourceFactory,this._vectorSelectionSourceFactory=e.vectorSelectionSourceFactory,this._httpService=e.httpService,this._state=$a({searchSources:[],selectionSources:[]}),this.initSearchSources(),this.initSelectionSources().catch(s=>{al.error("Failed to initialize selection sources",s)})}destroy(){this._resources.forEach(e=>e.destroy())}get state(){return this._state}initSearchSources(){const e=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.lika"}),baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"flurstueck",searchProperty:"flurstid",labelProperty:"objid"}),t=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(n){const r=n?.properties?.name,i=n?.id;return typeof r=="string"?r+" ("+i+")":String(i)},rewriteUrl(n){return n.searchParams.set("properties","name"),n}}),s=new il("Photon Geocoder",["city","street"],this._httpService);this._state.searchSources=[wt(e),wt(t),wt(s)]}async initSelectionSources(){const e=["ogc_kitas","ogc_kataster"],t=await this._mapRegistry.expectMapModel(z),s=t.layers.getOperationalLayers({sortByDisplayOrder:!0});for(const n of s){if(!e.includes(n.id)||!cl(n.olLayer))continue;const r=this._vectorSelectionSourceFactory.createSelectionSource({vectorLayer:n.olLayer,label:n.title}),i=r.on("changed:status",()=>{r.status!=="available"&&(r.status==="unavailable"||r.status?.kind==="unavailable")&&t.removeHighlight()});this._resources.push(i,r),this._state.selectionSources.unshift(wt(r))}}}function cl(o){return o instanceof Me&&o.getSource()instanceof Xe}const _t={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class xt extends Ss{constructor(e,t){super(e),this.feature=t}}function ul(o,e){const t=[];for(let s=0;s<e.length;++s){const r=e[s].getGeometry();Xs(o,r,t)}return t}function kt(o,e){return Es(o[0],o[1],e[0],e[1])}function Re(o,e){const t=o.length;return e<0?o[e+t]:e>=t?o[e-t]:o[e]}function Ct(o,e,t){let s,n;e<t?(s=e,n=t):(s=t,n=e);const r=Math.ceil(s),i=Math.floor(n);if(r>i){const u=Ie(o,s),l=Ie(o,n);return kt(u,l)}let a=0;if(s<r){const u=Ie(o,s),l=Re(o,r);a+=kt(u,l)}if(i<n){const u=Re(o,i),l=Ie(o,n);a+=kt(u,l)}for(let u=r;u<i-1;++u){const l=Re(o,u),d=Re(o,u+1);a+=kt(l,d)}return a}function Xs(o,e,t){if(e instanceof De){Et(o,e.getCoordinates(),!1,t);return}if(e instanceof Is){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n)Et(o,s[n],!1,t);return}if(e instanceof zt){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n)Et(o,s[n],!0,t);return}if(e instanceof Os){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n){const i=s[n];for(let a=0,u=i.length;a<u;++a)Et(o,i[a],!0,t)}return}if(e instanceof Dr){const s=e.getGeometries();for(let n=0;n<s.length;++n)Xs(o,s[n],t);return}}const Qt={index:-1,endIndex:NaN};function dl(o,e,t,s){const n=o[0],r=o[1];let i=1/0,a=-1,u=NaN;for(let h=0;h<e.targets.length;++h){const v=e.targets[h],b=v.coordinates;let y=1/0,w;for(let A=0;A<b.length-1;++A){const P=b[A],I=b[A+1],T=Zs(n,r,P,I);T.squaredDistance<y&&(y=T.squaredDistance,w=A+T.along)}y<i&&(i=y,v.ring&&e.targetIndex===h&&(v.endIndex>v.startIndex?w<v.startIndex&&(w+=b.length):v.endIndex<v.startIndex&&w>v.startIndex&&(w-=b.length)),u=w,a=h)}const l=e.targets[a];let d=l.ring;if(e.targetIndex===a&&d){const h=Ie(l.coordinates,u),v=t.getPixelFromCoordinate(h);Cs(v,e.startPx)>s&&(d=!1)}if(d){const h=l.coordinates,v=h.length,b=l.startIndex,y=u;if(b<y){const w=Ct(h,b,y);Ct(h,b,y-v)<w&&(u-=v)}else{const w=Ct(h,b,y);Ct(h,b,y+v)<w&&(u+=v)}}return Qt.index=a,Qt.endIndex=u,Qt}function Et(o,e,t,s){const n=o[0],r=o[1];for(let i=0,a=e.length-1;i<a;++i){const u=e[i],l=e[i+1],d=Zs(n,r,u,l);if(d.squaredDistance===0){const h=i+d.along;s.push({coordinates:e,ring:t,startIndex:h,endIndex:h});return}}}const eo={along:0,squaredDistance:0};function Zs(o,e,t,s){const n=t[0],r=t[1],i=s[0],a=s[1],u=i-n,l=a-r;let d=0,h=n,v=r;return(u!==0||l!==0)&&(d=sr(((o-n)*u+(e-r)*l)/(u*u+l*l),0,1),h+=u*d,v+=l*d),eo.along=d,eo.squaredDistance=tr(Es(o,e,h,v),10),eo}function Ie(o,e){const t=o.length;let s=Math.floor(e);const n=e-s;s>=t?s-=t:s<0&&(s+=t);let r=s+1;r>=t&&(r-=t);const i=o[s],a=i[0],u=i[1],l=o[r],d=l[0]-a,h=l[1]-u;return[a+d*n,u+h*n]}class hl extends Hn{constructor(e){const t=e;t.stopDown||(t.stopDown=qn),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=pl(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Kn,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let s=e.geometryFunction;if(!s){const n=this.mode_;if(n==="Circle")s=function(r,i,a){const u=i||new la([NaN,NaN]),l=Do(r[0]),d=Yn(l,Do(r[r.length-1]));return u.setCenterAndRadius(l,Math.sqrt(d),this.geometryLayout_),u};else{let r;n==="Point"?r=Oe:n==="LineString"?r=De:n==="Polygon"&&(r=zt),s=function(i,a,u){return a?n==="Polygon"?i[0].length?a.setCoordinates([i[0].concat([i[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(i,this.geometryLayout_):a=new r(i,this.geometryLayout_),a}}}this.geometryFunction_=s,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Me({source:new Xe({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:fl(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Xn,this.freehandCondition_,e.freehand?this.freehandCondition_=jo:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Zn,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Jn.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=jo:t=e:t=or,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===ks.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===de.POINTERMOVE,s=!0;return!this.freehand_&&this.lastDragTime_&&e.type===de.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===de.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),s=!1):this.freehand_&&e.type===de.POINTERDOWN?s=!1:t&&this.getPointerCount()<2?(s=e.type===de.POINTERMOVE,s&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===de.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===de.DBLCLICK&&(s=!1),super.handleEvent(e)&&s}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Qn(de.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),s=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),n=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=vs([s,n]),i=this.traceSource_.getFeaturesInExtent(r);if(i.length===0)return;const a=ul(e.coordinate,i);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const s=e.startIndex<=e.endIndex,n=e.startIndex<=t;s===n?s&&t>e.endIndex||!s&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(s&&t<e.endIndex||!s&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let s=0;if(e<t){const n=Math.ceil(e);let r=Math.floor(t);r===t&&(r-=1),s=r-n+1}else{const n=Math.floor(e);let r=Math.ceil(t);r===t&&(r+=1),s=n-r+1}s>0&&this.removeLastPoints_(s)}addTracedCoordinates_(e,t,s){if(t===s)return;const n=[];if(t<s){const r=Math.ceil(t);let i=Math.floor(s);i===s&&(i-=1);for(let a=r;a<=i;++a)n.push(Re(e.coordinates,a))}else{const r=Math.floor(t);let i=Math.ceil(s);i===s&&(i+=1);for(let a=r;a>=i;--a)n.push(Re(e.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&Cs(t.startPx,e.pixel)<this.snapTolerance_)return;const s=dl(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==s.index){if(t.targetIndex!==-1){const u=t.targets[t.targetIndex];this.removeTracedCoordinates_(u.startIndex,u.endIndex)}const a=t.targets[s.index];this.addTracedCoordinates_(a,a.startIndex,s.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,s.endIndex)}t.targetIndex=s.index;const n=t.targets[t.targetIndex];n.endIndex=s.endIndex;const r=Ie(n.coordinates,n.endIndex),i=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(i[0]),Math.round(i[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const s=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(e.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(e.pixel,s)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,s=e.pixel,n=t[0]-s[0],r=t[1]-s[1],i=n*n+r*r;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let s=!1;if(this.sketchFeature_){let n=!1,r=[this.finishCoordinate_];const i=this.mode_;if(i==="Point")s=!0;else if(i==="Circle")s=this.sketchCoords_.length===2;else if(i==="LineString")n=!t&&this.sketchCoords_.length>this.minPoints_;else if(i==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],t?r=[a[0][0]]:r=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let u=0,l=r.length;u<l;u++){const d=r[u],h=a.getPixelFromCoordinate(d),v=e[0]-h[0],b=e[1]-h[1],y=this.freehand_?1:this.snapTolerance_;if(s=Math.sqrt(v*v+b*b)<=y,s){this.finishCoordinate_=d;break}}}}return s}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new we(new Oe(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new we);const t=e.getLinearRing(0);let s=this.sketchLine_.getGeometry();s?(s.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),s.changed()):(s=new De(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(s))}startDrawing_(e){const t=this.getMap().getView().getProjection(),s=No(this.geometryLayout_);for(;e.length<s;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new we(new De(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new we,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new xt(_t.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),s=this.sketchFeature_.getGeometry(),n=t.getView().getProjection(),r=No(this.geometryLayout_);let i,a;for(;e.length<r;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(i=this.sketchCoords_[0],a=i[i.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(i=this.sketchCoords_,a=i[i.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,s,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),s.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(s):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection();let n,r;const i=this.mode_;i==="LineString"||i==="Circle"?(this.finishCoordinate_=e.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(e.slice()),this.geometryFunction_(r,t,s)):i==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(e.slice()),n&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,t,s)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),n&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection(),n=this.mode_;for(let r=0;r<e;++r){let i;if(n==="LineString"||n==="Circle"){if(i=this.sketchCoords_,i.splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();const a=this.finishCoordinate_.slice();i[i.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(i,t,s),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(n==="Polygon"){i=this.sketchCoords_[0],i.splice(-2,1);const a=this.sketchLine_.getGeometry();if(i.length>=2){const u=i[i.length-2].slice();i[i.length-1]=u,this.createOrUpdateSketchPoint_(u)}a.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,t,s)}if(i.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const s=e.getGeometry(),n=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,s,n)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,s,n),t=s.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Or([t])):this.type_==="MultiLineString"?e.setGeometry(new Is([t])):this.type_==="MultiPolygon"&&e.setGeometry(new Os([t])),this.dispatchEvent(new xt(_t.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new xt(_t.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,s=!this.sketchFeature_;s&&this.startDrawing_(e[0]);let n;if(t==="LineString"||t==="Circle")n=this.sketchCoords_;else if(t==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;s&&n.shift(),n.pop();for(let i=0;i<e.length;i++)this.addToDrawing_(e[i]);const r=e[e.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){const s=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=s.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new we(new Oe(n)),this.updateSketchFeatures_(),this.dispatchEvent(new xt(_t.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function fl(){const o=er();return function(e,t){return o[e.getGeometry().getType()]}}function pl(o){switch(o){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+o)}}const gl=hl;new Oe([407354,5754673]),new Oe([404740,5757893]);var xe,pe,ct,ut,dt,mo;class ml extends Ds{constructor(t,s,n){super();R(this,dt);Io(this,"label");R(this,xe,{kind:"available"});R(this,pe,void 0);R(this,ct,void 0);R(this,ut,void 0);this.label=s,D(this,pe,t),D(this,ut,n),$(this,dt,mo).call(this),D(this,ct,C(this,pe).on("change:visible",()=>{$(this,dt,mo).call(this)}))}destroy(){be(C(this,ct))}get status(){return C(this,xe)}async select(t,s){if(t.type!=="extent")throw new Error(`Unsupported selection kind: ${t.type}`);if(C(this,xe).kind!=="available"||C(this,pe).getSource()===null)return[];const n=[];C(this,pe).getSource().forEachFeatureIntersectingExtent(t.extent,a=>{if(!a.getGeometry())return;const u={id:a.getId()?.toString()||a.getGeometry.toString(),geometry:a.getGeometry()};n.push(u)});const r=n.filter(a=>a!=null);return r.length>s.maxResults?r.slice(0,s.maxResults):r}}xe=new WeakMap,pe=new WeakMap,ct=new WeakMap,ut=new WeakMap,dt=new WeakSet,mo=function(){const s=C(this,pe).getVisible()?{kind:"available"}:{kind:"unavailable",reason:C(this,ut)};s.kind!==C(this,xe).kind&&(D(this,xe,s),this.emit("changed:status"))};var ht;class vl{constructor({intl:e}){R(this,ht,void 0);D(this,ht,e)}createSelectionSource(e){return new ml(e.vectorLayer,e.label,C(this,ht).formatMessage({id:"layerNotVisibleReason"}))}}ht=new WeakMap;const Ee=Se("local-storage"),bl=0,ne={CORRUPTED_DATA:"local-storage:corrupted-data",INVALID_PATH:"local-storage:invalid-path",INVALID_VALUE:"local-storage:invalid-value",NOT_SUPPORTED:"local-storage:not-supported",INTERNAL:"local-storage:internal-error"};var Be,ee,ge,Ge,te,Ft,Js,Vt,Qs,ke,rt,me,Le,Bt,en;class Sl{constructor(e){R(this,Ft);R(this,Vt);R(this,ke);R(this,me);R(this,Bt);R(this,Be,void 0);R(this,ee,{});R(this,ge,void 0);R(this,Ge,void 0);R(this,te,void 0);D(this,Be,xl(e.properties)),D(this,ge,kl()),C(this,ge)&&($(this,Vt,Qs).call(this),D(this,Ge,$(this,Bt,en).call(this)))}destroy(){C(this,te)&&(clearTimeout(C(this,te)),D(this,te,void 0)),C(this,ge)&&$(this,ke,rt).call(this)}get isSupported(){return!!C(this,Ge)}get(e){return $(this,me,Le).call(this).get(e)}set(e,t){return $(this,me,Le).call(this).set(e,t)}remove(e){return $(this,me,Le).call(this).remove(e)}removeAll(){return $(this,me,Le).call(this).removeAll()}getNamespace(e){return $(this,me,Le).call(this).getNamespace(e)}}Be=new WeakMap,ee=new WeakMap,ge=new WeakMap,Ge=new WeakMap,te=new WeakMap,Ft=new WeakSet,Js=function(){C(this,te)&&clearTimeout(C(this,te)),D(this,te,setTimeout(()=>{D(this,te,void 0),$(this,ke,rt).call(this)},bl))},Vt=new WeakSet,Qs=function(){try{const e=C(this,ge);if(!e)throw new se(ne.INTERNAL,"Local storage is not available.");const t=e.getItem(C(this,Be));if(t==null){D(this,ee,{}),$(this,ke,rt).call(this);return}try{const s=JSON.parse(t);if(!Ke(s))throw new se(ne.CORRUPTED_DATA,"Persisted value should be an object.");D(this,ee,s)}catch(s){Ee.warn("Invalid persisted data, reverting to default.",s),D(this,ee,{}),$(this,ke,rt).call(this)}}catch(e){Ee.error("Failed to load from local storage",e)}},ke=new WeakSet,rt=function(){try{const e=C(this,ge);if(!e)throw new se(ne.INTERNAL,"Local storage is not available.");const t=JSON.stringify(C(this,ee));e.setItem(C(this,Be),t)}catch(e){Ee.error("Failed to save to local storage",e)}},me=new WeakSet,Le=function(){const e=C(this,Ge);if(!e)throw new se(ne.NOT_SUPPORTED,"Local storage is not supported by this browser.");return e},Bt=new WeakSet,en=function(){const e={getByPath:t=>Zo(yl(C(this,ee),t)),setByPath:(t,s)=>{if(!_l(s))throw new se(ne.INVALID_VALUE,"The value is not supported by local storage.");if(s=Zo(s),t.length===0){if(!Ke(s))throw new se(ne.INVALID_VALUE,"The root value must be a plain object.");D(this,ee,s)}else wl(C(this,ee),t,s);$(this,Ft,Js).call(this)}};return new Mo([],e)};class Mo{path;access;constructor(e,t){this.path=e,this.access=t}get(e){return this.access.getByPath([...this.path,e])}set(e,t){this.access.setByPath([...this.path,e],t)}remove(e){this.access.setByPath([...this.path,e],void 0)}removeAll(){this.access.setByPath(this.path,{})}getNamespace(e){const t=this.get(e);if(t===void 0)this.set(e,{});else if(!Ke(t))throw new se(ne.INVALID_PATH,`Cannot use '${e}' as a namespace because it is not associated with an object.`);return new Mo(this.path.concat([e]),this.access)}}const Xo="trails-state";function yl(o,e){let t=o;for(const s of e){if(!Ke(t))throw new se(ne.INVALID_PATH,`Cannot get nested property '${s}' because the parent is no object.`);t=t[s]}return t}function wl(o,e,t){if(!e.length)throw new se(ne.INTERNAL,"Path must not be empty.");let s=o;for(let r=0,i=e.length-1;r<i;++r){const a=e[r],u=s[a];if(!Ke(u))throw new se(ne.INVALID_PATH,`Cannot set property on '${a}' because it is no object.`);s=u}const n=e[e.length-1];s[n]=t}function Ke(o){return!!(o&&typeof o=="object"&&!Array.isArray(o))}function _l(o){const e=typeof o;return e==="boolean"||e==="number"||e==="string"||e==="undefined"||o===null||Array.isArray(o)||Ke(o)}function xl(o){const e=o.storageId;return!e||typeof e!="string"?(Ee.warn(`The 'storageId' property of the 'local-storage' package should be set to a valid string to avoid collisions with other applications. Defaulting to '${Xo}'.`),Xo):e}function kl(){if(typeof Storage>"u"){Ee.warn("Local storage is not supported by this browser.");return}try{const o=globalThis.localStorage;if(!o){Ee.warn("Local storage is not supported by this browser.");return}return o}catch(o){Ee.warn("Local storage is not supported by this browser.",o);return}}function Zo(o){return o!=null&&(o=JSON.parse(JSON.stringify(o))),o}const Cl={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:Aa,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},AppModel:{name:"AppModel",clazz:ll,provides:[{name:"ol-app.AppModel",qualifier:void 0}],references:{ogcSearchSourceFactory:{name:"ogc-features.SearchSourceFactory",qualifier:void 0,all:!1},vectorSelectionSourceFactory:{name:"selection.VectorSelectionSourceFactory",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1},mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppModel",qualifier:void 0,all:!1},{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:nr,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Nr,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:rr,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:Br,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:Gr,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/legend":{name:"@open-pioneer/legend",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/selection":{name:"@open-pioneer/selection",services:{VectorSelectionSourceFactory:{name:"VectorSelectionSourceFactory",clazz:vl,provides:[{name:"selection.VectorSelectionSourceFactory",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:Sl,provides:[{name:"local-storage.LocalStorageService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}}},El=`.search-box{position:absolute;width:500px;max-width:100%;z-index:1}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.selection-drag-box{background-color:#ffffff4d!important;border:3px solid var(--chakra-colors-background_primary)!important}.selection-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.selection .react-select{cursor:default}.map-container .selection-active{cursor:crosshair}.map-container .selection-inactive{cursor:no-drop}.selection-source-value.selection-source-value--disabled{opacity:.4}.selection-source-value.selection-source-value--disabled span{margin:0 6px 0 0}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}
`,Pl=["en","de"];function Ml(o){switch(o){case"en":return Wo(()=>import("./ae0086f6f44c.js"),[],import.meta.url).then(e=>e.default);case"de":return Wo(()=>import("./f872a374ee26.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${o}'`)}const Tl=Sn(El),Al=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Ml,locales:Pl,packages:Cl,styles:Tl},Symbol.toStringTag,{value:"Module"})),Ll="@open-pioneer/coordinate-viewer",Rl=ce.bind(void 0,Ll),Il=4,Ol=o=>{const{mapId:e,precision:t}=o,{containerProps:s}=re("coordinate-viewer",o),{map:n}=J(e),r=n?.olMap,{coordinates:i}=jl(r),a=Dl(i,t),u=Us(r)?.getCode()??"",l=a?a+" "+u:"";return c.jsx(V,{...s,children:c.jsx(Q,{className:"coordinate-viewer-text",children:l})})};function Dl(o,e){const t=Rl();return o?Nl(o,e,t):""}function jl(o){const[e,t]=p.useState();return p.useEffect(()=>{if(!o)return;const s=o.on("pointermove",n=>{t(n.coordinate)});return()=>be(s)},[o]),{coordinates:e}}function Nl(o,e,t){if(o[0]==null||o[1]==null)return"";const s=e??Il,[n,r]=o,i=t.formatNumber(n,{maximumFractionDigits:s,minimumFractionDigits:s}),a=t.formatNumber(r,{maximumFractionDigits:s,minimumFractionDigits:s});return i+" "+a}var Fl=Zr({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const to=.75,Pt=.1;let Vl=class extends Ps{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",s=e.tipLabel!==void 0?e.tipLabel:"Overview map",n=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const r=e.label!==void 0?e.label:"›";typeof r=="string"?(this.label_=document.createElement("span"),this.label_.textContent=r):this.label_=r;const i=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=s,a.appendChild(i),a.addEventListener(ks.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const u=new ir({view:e.view,controls:new Fo,interactions:new Fo});this.ovmap_=u,e.layers&&e.layers.forEach(function(I){u.addLayer(I)});const l=document.createElement("div");l.className="ol-overviewmap-box",l.style.boxSizing="border-box",this.boxOverlay_=new Rt({position:[0,0],positioning:"center-center",element:l}),this.ovmap_.addOverlay(this.boxOverlay_);const d=t+" "+Ms+" "+ar+(this.collapsed_&&this.collapsible_?" "+Vo:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=d,h.appendChild(this.ovmapDiv_),h.appendChild(a);const v=this,b=this.boxOverlay_,y=this.boxOverlay_.getElement(),w=function(I){return{clientX:I.clientX,clientY:I.clientY}},A=function(I){const T=w(I),K=u.getEventCoordinateInternal(T);b.setPosition(K)},P=function(I){const T=u.getEventCoordinateInternal(I);v.getMap().getView().setCenterInternal(T),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",P)};y.addEventListener("mousedown",function(){window.addEventListener("mousemove",A),window.addEventListener("mouseup",P)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const s=t.getView();s&&this.unbindView_(s),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(ys(e,lr.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const s=e.getView();s&&(this.bindView_(s),s.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===Xt.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const s=this.getMap().getView();this.bindView_(s)}else!this.ovmap_.isRendered()&&(e.key===Xt.TARGET||e.key===Xt.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new cr({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(Bo.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(Bo.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),r=e.getView().calculateExtentInternal(s);if(this.viewExtent_&&ur(r,this.viewExtent_))return;this.viewExtent_=r;const i=t.getSize(),u=t.getView().calculateExtentInternal(i),l=t.getPixelFromCoordinateInternal(dr(r)),d=t.getPixelFromCoordinateInternal(hr(r)),h=Math.abs(l[0]-d[0]),v=Math.abs(l[1]-d[1]),b=i[0],y=i[1];h<b*Pt||v<y*Pt||h>b*to||v>y*to?this.resetExtent_():_s(u,r)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,s=e.getSize(),r=e.getView().calculateExtentInternal(s),i=t.getView(),a=Math.log(to/Pt)/Math.LN2,u=1/(Math.pow(2,a/2)*Pt);fr(r,u),i.fitInternal(pr(r))}recenter_(){const e=this.getMap(),t=this.ovmap_,s=e.getView();t.getView().setCenterInternal(s.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),n=e.getView(),r=t.getView(),i=this.rotateWithView_?0:-n.getRotation(),a=this.boxOverlay_,u=this.boxOverlay_.getElement(),l=n.getCenterInternal(),d=n.getResolution(),h=r.getResolution(),v=s[0]*d/h,b=s[1]*d/h;if(a.setPosition(l),u){u.style.width=v+"px",u.style.height=b+"px";const y="rotate("+i+"rad)";u.style.transform=y}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=gr(this.ovmap_,ws.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(Vo),this.collapsed_?Go(this.collapseLabel_,this.label_):Go(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const Bl=Vl,oo="units",Gl=[1,2,5],tt=25.4/.28;class Ul extends Ps{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const s=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=s+"-inner",this.element.className=s+" "+Ms,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(oo,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(oo)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(oo,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,s=e.projection,n=this.getUnits(),r=n=="degrees"?"degrees":"m";let i=ro(s,e.resolution,t,r);const a=this.minWidth_*(this.dpi_||tt)/tt,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||tt)/tt:void 0;let l=a*i,d="";if(n=="degrees"){const T=mr.degrees;l*=T,l<T/60?(d="″",i*=3600):l<T?(d="′",i*=60):d="°"}else if(n=="imperial")l<.9144?(d="in",i/=.0254):l<1609.344?(d="ft",i/=.3048):(d="mi",i/=1609.344);else if(n=="nautical")i/=1852,d="NM";else if(n=="metric")l<.001?(d="μm",i*=1e6):l<1?(d="mm",i*=1e3):l<1e3?d="m":(d="km",i/=1e3);else if(n=="us")l<.9144?(d="in",i*=39.37):l<1609.344?(d="ft",i/=.30480061):(d="mi",i/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*i)/Math.log(10)),v,b,y,w,A,P;for(;;){y=Math.floor(h/3);const T=Math.pow(10,y);if(v=Gl[(h%3+3)%3]*T,b=Math.round(v/i),isNaN(b)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&b>=u){v=w,b=A,y=P;break}else if(b>=a)break;w=v,A=b,P=y,++h}const I=this.scaleBar_?this.createScaleBar(b,v,d):v.toFixed(y<0?-y:0)+" "+d;this.renderedHTML_!=I&&(this.innerElement_.innerHTML=I,this.renderedHTML_=I),this.renderedWidth_!=b&&(this.innerElement_.style.width=b+"px",this.renderedWidth_=b),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,s){const n=this.getScaleForResolution(),r=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),i=this.scaleBarSteps_,a=e/i,u=[this.createMarker("absolute")];for(let d=0;d<i;++d){const h=d%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(d%2===0||i===2?this.createStepText(d,e,!1,t,s):"")+"</div>")}return u.push(this.createStepText(i,e,!0,t,s)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+r+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,s,n,r){const a=(e===0?0:Math.round(n/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+r),u=e===0?-3:t/this.scaleBarSteps_*-1,l=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${l}px;left: ${s?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=ro(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||tt,s=1e3/25.4;return e*s*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const zl=Ul,Wl=o=>{const{mapId:e,displayMode:t="line"}=o,{containerProps:s}=re("scale-bar",o),{map:n}=J(e),r=p.useRef(null);return p.useEffect(()=>{if(r.current&&n){const i=n.olMap,a=new zl({units:"metric",target:r.current,bar:t==="bar"});return i.addControl(a),()=>{i.removeControl(a)}}},[t,n]),c.jsx(V,{...s,ref:r})},$l="@open-pioneer/scale-viewer",Hl=ce.bind(void 0,$l),ql=o=>{const{mapId:e}=o,{containerProps:t}=re("scale-viewer",o),{map:s}=J(e),n=Hl(),r=xa(s?.olMap),i=r?n.formatNumber(r):void 0;return c.jsx(V,{...t,children:i&&c.jsxs(Q,{children:["1:",i]})})},tn="ol-map",vo=Wt.bind(void 0,tn),Te=ce.bind(void 0,tn);let Kl=0;function Yl(o,e){const t=`atom${++Kl}`,s={toString:()=>t};return typeof o=="function"?s.read=o:(s.init=o,s.read=function(n){return n(this)},s.write=function(n,r,i){return r(this,typeof i=="function"?i(n(this)):i)}),e&&(s.write=e),s}const Jo=o=>"init"in o,Qo=o=>!!o.write,It=new WeakMap,Xl=(o,e)=>{It.set(o,e),o.catch(()=>{}).finally(()=>It.delete(o))},es=(o,e)=>{const t=It.get(o);t&&(It.delete(o),t(e))},ts=(o,e)=>{o.status="fulfilled",o.value=e},os=(o,e)=>{o.status="rejected",o.reason=e},Zl=o=>typeof o?.then=="function",ot=(o,e)=>!!o&&"v"in o&&"v"in e&&Object.is(o.v,e.v),ss=(o,e)=>!!o&&"e"in o&&"e"in e&&Object.is(o.e,e.e),Ae=o=>!!o&&"v"in o&&o.v instanceof Promise,Jl=(o,e)=>"v"in o&&"v"in e&&o.v.orig&&o.v.orig===e.v.orig,Mt=o=>{if("e"in o)throw o.e;return o.v},To=()=>{const o=new WeakMap,e=new WeakMap,t=new Map;let s,n;const r=g=>o.get(g),i=(g,m)=>{const S=o.get(g);if(o.set(g,m),t.has(g)||t.set(g,S),Ae(S)){const f="v"in m?m.v instanceof Promise?m.v:Promise.resolve(m.v):Promise.reject(m.e);S.v!==f&&es(S.v,f)}},a=(g,m,S)=>{const f=new Map;let _=!1;S.forEach((M,x)=>{!M&&x===g&&(M=m),M&&(f.set(x,M),m.d.get(x)!==M&&(_=!0))}),(_||m.d.size!==f.size)&&(m.d=f)},u=(g,m,S)=>{const f=r(g),_={d:f?.d||new Map,v:m};if(S&&a(g,_,S),ot(f,_)&&f.d===_.d)return f;if(Ae(f)&&Ae(_)&&Jl(f,_)){if(f.d===_.d)return f;_.v=f.v}return i(g,_),_},l=(g,m,S,f)=>{if(Zl(m)){let _;const M=()=>{const E=r(g);if(!Ae(E)||E.v!==x)return;const F=u(g,x,S);e.has(g)&&E.d!==F.d&&Y(g,F,E.d)},x=new Promise((E,F)=>{let j=!1;m.then(G=>{j||(j=!0,ts(x,G),E(G),M())},G=>{j||(j=!0,os(x,G),F(G),M())}),_=G=>{j||(j=!0,G.then(H=>ts(x,H),H=>os(x,H)),E(G))}});return x.orig=m,x.status="pending",Xl(x,E=>{E&&_(E),f?.()}),u(g,x,S)}return u(g,m,S)},d=(g,m,S)=>{const f=r(g),_={d:f?.d||new Map,e:m};return S&&a(g,_,S),ss(f,_)&&f.d===_.d?f:(i(g,_),_)},h=(g,m)=>{const S=r(g);if(!m&&S&&(e.has(g)||Array.from(S.d).every(([j,G])=>{if(j===g)return!0;const H=h(j);return H===G||ot(H,G)})))return S;const f=new Map;let _=!0;const M=j=>{if(j===g){const H=r(j);if(H)return f.set(j,H),Mt(H);if(Jo(j))return f.set(j,void 0),j.init;throw new Error("no atom init")}const G=h(j);return f.set(j,G),Mt(G)};let x,E;const F={get signal(){return x||(x=new AbortController),x.signal},get setSelf(){return!E&&Qo(g)&&(E=(...j)=>{if(!_)return I(g,...j)}),E}};try{const j=g.read(M,F);return l(g,j,f,()=>x?.abort())}catch(j){return d(g,j,f)}finally{_=!1}},v=g=>Mt(h(g)),b=g=>{let m=e.get(g);return m||(m=T(g)),m},y=(g,m)=>!m.l.size&&(!m.t.size||m.t.size===1&&m.t.has(g)),w=g=>{const m=e.get(g);m&&y(g,m)&&K(g)},A=g=>{const m=new Map,S=new WeakMap,f=x=>{var E;const F=new Set((E=e.get(x))==null?void 0:E.t);return t.forEach((j,G)=>{var H;(H=r(G))!=null&&H.d.has(x)&&F.add(G)}),F},_=x=>{f(x).forEach(E=>{E!==x&&(m.set(E,(m.get(E)||new Set).add(x)),S.set(E,(S.get(E)||0)+1),_(E))})};_(g);const M=x=>{f(x).forEach(E=>{var F;if(E!==x){let j=S.get(E);if(j&&S.set(E,--j),!j){let G=!!((F=m.get(E))!=null&&F.size);if(G){const H=r(E),pn=h(E,!0);G=!ot(H,pn)}G||m.forEach(H=>H.delete(E))}M(E)}})};M(g)},P=(g,...m)=>{let S=!0;const f=x=>Mt(h(x)),_=(x,...E)=>{let F;if(x===g){if(!Jo(x))throw new Error("atom not writable");const j=r(x),G=l(x,E[0]);ot(j,G)||A(x)}else F=P(x,...E);if(!S){const j=L()}return F},M=g.write(f,_,...m);return S=!1,M},I=(g,...m)=>{const S=P(g,...m),f=L();return S},T=(g,m,S)=>{var f;const _=S||[];(f=r(g))==null||f.d.forEach((x,E)=>{const F=e.get(E);F?F.t.add(g):E!==g&&T(E,g,_)}),h(g);const M={t:new Set(m&&[m]),l:new Set};if(e.set(g,M),Qo(g)&&g.onMount){const{onMount:x}=g;_.push(()=>{const E=x((...F)=>I(g,...F));E&&(M.u=E)})}return S||_.forEach(x=>x()),M},K=g=>{var m;const S=(m=e.get(g))==null?void 0:m.u;S&&S(),e.delete(g);const f=r(g);f&&(Ae(f)&&es(f.v),f.d.forEach((_,M)=>{if(M!==g){const x=e.get(M);x&&(x.t.delete(g),y(M,x)&&K(M))}}))},Y=(g,m,S)=>{const f=new Set(m.d.keys());S?.forEach((_,M)=>{if(f.has(M)){f.delete(M);return}const x=e.get(M);x&&(x.t.delete(g),y(M,x)&&K(M))}),f.forEach(_=>{const M=e.get(_);M?M.t.add(g):e.has(g)&&T(_,g)})},L=()=>{let g;for(;t.size;){const m=Array.from(t);t.clear(),m.forEach(([S,f])=>{const _=r(S);if(_){const M=e.get(S);M&&_.d!==f?.d&&Y(S,_,f?.d),M&&!(!Ae(f)&&(ot(f,_)||ss(f,_)))&&M.l.forEach(x=>x())}})}};return{get:v,set:I,sub:(g,m)=>{const S=b(g),f=L(),_=S.l;return _.add(m),()=>{_.delete(m),w(g)}}}};let so;const Ql=()=>(so||(so=To()),so),on=p.createContext(void 0),ec=o=>{const e=p.useContext(on);return o?.store||e||Ql()},tc=({children:o,store:e})=>{const t=p.useRef();return!e&&!t.current&&(t.current=To()),p.createElement(on.Provider,{value:e||t.current},o)},oc=o=>typeof o?.then=="function",sc=ps.use||(o=>{if(o.status==="pending")throw o;if(o.status==="fulfilled")return o.value;throw o.status==="rejected"?o.reason:(o.status="pending",o.then(e=>{o.status="fulfilled",o.value=e},e=>{o.status="rejected",o.reason=e}),o)});function nc(o,e){const t=ec(e),[[s,n,r],i]=p.useReducer(l=>{const d=t.get(o);return Object.is(l[0],d)&&l[1]===t&&l[2]===o?l:[d,t,o]},void 0,()=>[t.get(o),t,o]);let a=s;(n!==t||r!==o)&&(i(),a=t.get(o));const u=e?.delay;return p.useEffect(()=>{const l=t.sub(o,()=>{if(typeof u=="number"){setTimeout(i,u);return}i()});return i(),l},[t,o,u]),p.useDebugValue(a),oc(a)?sc(a):a}const sn="@open-pioneer/spatial-bookmarks",rc=Wt.bind(void 0,sn),ic=ce.bind(void 0,sn),he=Se("spatial-bookmark:SpatialBookmarkViewModel");class ac{map;packageNamespace;writableBookmarks=Yl([]);stopBookmarksListener;store;get bookmarks(){return this.writableBookmarks}constructor(e,t){this.map=e,this.packageNamespace=t.getNamespace("spatial-bookmarks"),this.store=To(),this.loadState(),this.stopBookmarksListener=this.store.sub(this.bookmarks,()=>{this.saveState()})}destroy(){this.stopBookmarksListener()}createBookmark(e){const t=this.map.olMap,s=t.getView().calculateExtent(),n=t.getView().getProjection().getCode(),r={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]},i={id:vr(),title:e,extent:r,projection:n};he.debug("Created a new bookmark",i);const a=this.writableBookmarks;this.store.set(a,[...this.store.get(a),i])}activateBookmark(e){he.debug("Activating bookmark",e);const t=this.getBookmarkExtent(e);he.debug("Attempting to apply extent",t),this.applyExtent(t)}deleteBookmark(e){he.debug("Deleting bookmark",e);const t=this.writableBookmarks;this.store.set(t,[...this.store.get(t).filter(s=>s.id!==e)])}deleteAllBookmarks(){he.debug("Deleting all bookmarks"),this.store.set(this.writableBookmarks,[])}loadState(){he.debug("Restoring bookmarks from local storage");const e=this.packageNamespace.get("bookmarks")??[];try{lc(e),this.store.set(this.writableBookmarks,e)}catch(t){he.error("Bookmarks data in local storage is invalid, resetting to default value.",t),this.store.set(this.writableBookmarks,[]),this.saveState()}}saveState(){he.debug("Saving bookmarks to local storage"),this.packageNamespace.set("bookmarks",this.store.get(this.bookmarks))}getBookmarkExtent(e){const s=this.map.olMap.getView(),n=e.extent,r=[n.minX,n.minY,n.maxX,n.maxY],i=s.getProjection(),a=e.projection;return br(r,a,i)}applyExtent(e){const s=this.map.olMap.getView(),n=Sr(e),r=s.getResolutionForExtent(e);s.setCenter(n),s.setResolution(r)}}function lc(o){if(!Array.isArray(o))throw new Error("Expected bookmarks from local storage to be an array.");for(const e of o)cc(e)}function cc(o){if(!o||typeof o!="object")throw new Error("Expected bookmark from local storage to be an object.");const e=o;if(typeof e.id!="string")throw new Error("Bookmark does not have a valid id.");if(typeof e.title!="string")throw new Error("Bookmark does not have a valid title.");if(uc(e.extent),typeof e.projection!="string")throw new Error("Bookmark does not have a valid projection value.")}function uc(o){if(!o||typeof o!="object")throw new Error("Expected bookmark extent from local storage to be an object.");const e=o;if(typeof e.minX!="number"||typeof e.minY!="number"||typeof e.maxX!="number"||typeof e.maxY!="number")throw new Error("Expected bookmark extent from local storage to have valid coordinates.")}const dc=o=>{const{map:e}=J(o.mapId),t=rc("local-storage.LocalStorageService"),s=bc(e,t);return s&&c.jsx(tc,{store:s.store,children:c.jsx(hc,{...o,viewModel:s})})};function hc(o){const{viewModel:e}=o,t=ic(),s=p.useRef([]),[n,r]=p.useState(!1),i=nc(e.bookmarks),[a,u]=p.useState(""),l=a.trim().length>0,{containerProps:d}=re("spatial-bookmarks",o),[h,v]=p.useState("list"),b=()=>{e.deleteAllBookmarks(),v("list")},y=()=>{l&&(e.createBookmark(a),v("list"),u(""),r(!0))};p.useEffect(()=>{if(n){const T=s.current;T&&T[i.length-1]?.scrollIntoView?.(),r(!1)}},[i,n]);const w=()=>c.jsxs(ao,{children:[c.jsxs(Kt,{rounded:"md",status:"warning",children:[c.jsx(Yt,{}),t.formatMessage({id:"bookmark.alert.delete"})]}),c.jsx(mc,{intl:t,onClear:b,onCancel:()=>v("list")})]}),A=()=>c.jsxs(ao,{children:[c.jsxs(Kt,{rounded:"md",status:"info",children:[c.jsx(Yt,{}),t.formatMessage({id:"bookmark.alert.create"})]}),c.jsx(Kr,{"aria-label":t.formatMessage({id:"bookmark.input.label"}),placeholder:t.formatMessage({id:"bookmark.input.placeholder"}),value:a,onChange:T=>{u(T.target.value)},onKeyDown:T=>{T.key==="Enter"&&y()},isRequired:!0,isInvalid:!l,autoFocus:!0}),c.jsx(vc,{intl:t,isInvalid:!l,onCancel:()=>{u(""),v("list")},onSave:y})]}),P=()=>c.jsxs(c.Fragment,{children:[i.length?fc(i,e,t,s):c.jsxs(Kt,{rounded:"md",status:"info",children:[c.jsx(Yt,{}),t.formatMessage({id:"bookmark.alert.noSaved"})]}),c.jsx(gc,{intl:t,bookmarks:i,showCreate:()=>v("create"),showDelete:()=>v("delete")})]}),I=c.jsxs(c.Fragment,{children:[h==="list"&&P(),h==="create"&&A(),h==="delete"&&w()]});return c.jsx(ae,{flexDirection:"column",...d,children:I})}function fc(o,e,t,s){const n=t.formatMessage({id:"bookmark.button.deleteOne"}),r=o.map((i,a)=>c.jsx(pc,{index:a,listItemNodes:s,bookmark:i,onActivate:()=>e.activateBookmark(i),onDelete:()=>e.deleteBookmark(i.id),deleteBtnLabel:n},i.id));return c.jsx(js,{as:"ul",className:"spatial-bookmark-list",role:"listbox","aria-label":t.formatMessage({id:"bookmark.list.label"}),flexShrink:1,flexGrow:1,p:1,spacing:1,overflowY:"auto",listStyleType:"none",children:r})}const ns={ArrowDown:1,ArrowUp:-1};function pc(o){const{index:e,listItemNodes:t,bookmark:s,onDelete:n,onActivate:r,deleteBtnLabel:i}=o,a=s.title,u=l=>{const d=l.key;if(d==="Enter"){l.target===l.currentTarget&&r();return}if(ns[d]!=null){const h=t.current?.length;if(!h)return;let v=(e+ns[d])%h;v<0&&(v=h-1),t.current[v]?.focus()}};return c.jsx(V,{as:"li",p:1,ref:l=>{if(!l){t.current.splice(e,1);return}t.current[e]=l},className:bt("spatial-bookmarks-item"),tabIndex:0,rounded:"md",role:"option",cursor:"pointer",outline:0,_hover:{background:"trails.50"},_focusVisible:{boxShadow:"outline"},onKeyDown:u,onClick:r,children:c.jsxs(ae,{width:"100%",flexDirection:"row",align:"center",gap:1,children:[c.jsx(Fs,{children:c.jsx(Ls,{})}),c.jsx(Q,{ps:2,noOfLines:1,children:a}),c.jsx(qr,{}),c.jsx(gs,{hasArrow:!0,label:i,placement:"right",children:c.jsx(yo,{className:"spatial-bookmarks-item-delete","aria-label":i,borderRadius:"full",iconSpacing:0,padding:0,colorScheme:"red",variant:"ghost",leftIcon:c.jsx(Rs,{}),onClick:l=>{n(),l.stopPropagation()}})},e)]})})}function gc(o){const{intl:e,bookmarks:t,showCreate:s,showDelete:n}=o;return c.jsxs(Ao,{children:[c.jsx(Ye,{isDisabled:t.length===0,colorScheme:"red",width:void 0,iconSpacing:0,leftIcon:c.jsx(Rs,{}),onClick:n,"aria-label":e.formatMessage({id:"bookmark.button.deleteAll"}),variant:"outline"}),c.jsx(Ye,{onClick:s,width:"100%",children:e.formatMessage({id:"bookmark.button.create"})})]})}function mc(o){const{intl:e,onCancel:t,onClear:s}=o;return c.jsxs(Ao,{children:[c.jsx(Ye,{variant:"outline",onClick:t,children:e.formatMessage({id:"bookmark.button.cancelDelete"})}),c.jsx(Ye,{onClick:s,children:e.formatMessage({id:"bookmark.button.confirmDelete"})})]})}function vc(o){const{intl:e,onCancel:t,onSave:s,isInvalid:n}=o;return c.jsxs(Ao,{children:[c.jsx(Ye,{variant:"outline",onClick:()=>t(),children:e.formatMessage({id:"bookmark.button.cancel"})}),c.jsx(Ye,{isDisabled:n,onClick:()=>s(),children:e.formatMessage({id:"bookmark.button.save"})})]})}function Ao(o){return c.jsx(ae,{width:"100%",flexDirection:"row",mt:2,gap:1,flexGrow:0,flexShrink:0,children:o.children})}function Ye(o){return c.jsx(yo,{width:"100%",...o})}function bc(o,e){const[t,s]=p.useState();return p.useEffect(()=>{let n;return o?n=new ac(o,e):n=void 0,s(n),()=>n?.destroy()},[o,e]),t}function Sc(){const o=p.useId(),e=Te();return c.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:c.jsx(V,{role:"dialog","aria-labelledby":o,children:c.jsx(Ze,{title:c.jsx(Je,{id:o,size:"md",mb:2,children:e.formatMessage({id:"spatialBookmarkTitle"})}),children:c.jsx(dc,{mapId:z})})})})}const yc="@open-pioneer/legend",nn=ce.bind(void 0,yc),wc=o=>{const{mapId:e,showBaseLayers:t=!1}=o,{containerProps:s}=re("legend",o),{map:n}=J(e);return c.jsx(V,{...s,children:n?c.jsx(_c,{map:n,showBaseLayers:t}):null})};function _c(o){const{map:e,showBaseLayers:t}=o,n=Cc(e).map(r=>c.jsx(rn,{layer:r,showBaseLayers:t},r.id));return c.jsx(js,{as:"ul",className:"legend-layer-list",listStyleType:"none",spacing:2,children:n})}function rn(o){const{layer:e,showBaseLayers:t}=o,{isVisible:s}=Pc(e),n=Ec(e);if(!s||!t&&!("parentLayer"in e)&&e.isBaseLayer)return;const r=[];return n?.length&&n.forEach(i=>{r.push(c.jsx(rn,{layer:i,showBaseLayers:t},i.id))}),c.jsxs(c.Fragment,{children:[c.jsx(xc,{layer:e,showBaseLayers:t}),r]})}function xc(o){const e=nn(),{layer:t,showBaseLayers:s}=o,n=Mc(t),r=kc(t);let i;n?.Component?i=c.jsx(n.Component,{layer:t}):n?.imageUrl?i=c.jsx(rs,{layer:t,imageUrl:n.imageUrl}):r&&(i=c.jsx(rs,{layer:t,imageUrl:r}));const a=!("parentLayer"in t)&&t.isBaseLayer;return i?c.jsxs(V,{as:"li",className:bt("legend-item",`layer-${Tc(t.id)}`),children:[s&&a?c.jsx(Q,{as:"b",children:e.formatMessage({id:"basemapLabel"})}):null,i]}):void 0}function rs(o){const e=nn(),{layer:t,imageUrl:s}=o;return c.jsxs(V,{children:[c.jsx(Q,{children:t.title}),c.jsx(Ns,{maxW:"none",maxH:"none",src:s,alt:e.formatMessage({id:"altLabel"},{layerName:t.title}),className:"legend-item__image",fallbackStrategy:"onError",fallback:c.jsx(V,{children:c.jsxs(Q,{children:[c.jsx(Fr,{me:2}),e.formatMessage({id:"fallbackLabel"})]})})})]})}function kc(o){const e=p.useCallback(()=>o.legend,[o]),t=p.useCallback(s=>{const n=o.on("changed:legend",s);return()=>n.destroy()},[o]);return p.useSyncExternalStore(t,e)}function Cc(o){const e=p.useCallback(s=>{const n=o.layers.on("changed",s);return()=>n.destroy()},[o]),t=p.useCallback(()=>{let s=o.layers.getAllLayers({sortByDisplayOrder:!0})??[];return s=s.reverse(),s},[o]);return an(e,t)}function Ec(o){const e=p.useCallback(s=>{const n=o.sublayers?.on("changed",s);return()=>n?.destroy()},[o]),t=p.useCallback(()=>{if(!o.sublayers)return;let n=o.sublayers?.getSublayers({sortByDisplayOrder:!0});return n=n.reverse(),n},[o]);return an(e,t)}function an(o,e){const t=p.useRef(),s=p.useCallback(r=>{const i=o(()=>{t.current=void 0,r()});return()=>{t.current=void 0,i()}},[o]),n=p.useCallback(()=>{if(t.current)return t.current.value;const r=e();return t.current={value:r},r},[e]);return p.useSyncExternalStore(s,n)}function Pc(o){const e=p.useCallback(()=>o.visible,[o]),t=p.useCallback(n=>{const r=o.on("changed:visible",n);return()=>r.destroy()},[o]);return{isVisible:p.useSyncExternalStore(t,e)}}function Mc(o){const[e,t]=p.useState(void 0);return p.useEffect(()=>{t(o.attributes.legend);const s=o.on("changed:attributes",()=>{t(o.attributes.legend)});return()=>s.destroy()},[o]),e}function Tc(o){return o.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Ac(){const o=p.useId(),e=Te();return c.jsx(V,{role:"dialog","aria-labelledby":o,children:c.jsx(Ze,{title:c.jsx(Je,{id:o,size:"md",mb:2,children:e.formatMessage({id:"legendTitle"})}),children:c.jsx(V,{overflowY:"auto",maxHeight:300,children:c.jsx(wc,{mapId:z,showBaseLayers:!0})})})})}const ln="@open-pioneer/geolocation",Lc=Wt.bind(void 0,ln),Rc=ce.bind(void 0,ln);function Ic(o){return $r({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(o)}const is=Se("geolocation:GeolocationController"),as=17;class Oc extends Ds{olMap;positionHighlightLayer;geolocation;maxZoom=as;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new we,this.accuracyFeature.setStyle(cs()),this.positionFeature=new we,this.positionFeature.setStyle(ls()),this.positionHighlightLayer=new Me({source:new Xe({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(Ts);const s=t||Dc();this.geolocation=new aa({tracking:!1,trackingOptions:s,projection:e.getView()?.getProjection()}),this.trackingOptions=s,this.geolocation.on("error",n=>this.handleGeolocationError(n))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(s=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const n=this.geolocation.on("change:accuracyGeometry",()=>{const u=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(u),this.accuracyFeature?.getGeometry()!==void 0&&s(),this.isInitialZoom){const l=this?.accuracyFeature?.getGeometry()?.getExtent();if(l){const d=Ca(l);if(!d)return;e.getView().fit(d,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),r=this.geolocation.on("change:position",()=>{const u=this.geolocation.getPosition();u&&(u[0]||u[1])!==void 0&&(this.positionFeature?.setGeometry(new Oe(u)),this.setMapToPosition&&e.getView().setCenter(u),this.positionFeature?.getGeometry()!==void 0&&s())}),i=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",u=>{u.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(n,r,i,a),e.addLayer(this.positionHighlightLayer)}).catch(s=>{is.error("Failed to determine location",s)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{be(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??ls())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??cs())}setMaxZoom(e){this.maxZoom=e??as}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){is.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const ls=()=>new Pe({image:new _o({radius:6,fill:new $e({color:"#3399CC"}),stroke:new Ce({color:"#fff",width:2})})}),cs=()=>new Pe({stroke:new Ce({color:"#3399CC",width:3}),fill:new $e({color:"rgba(0, 0, 255, 0.05)"})}),Dc=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),jc=p.forwardRef(function(e,t){const{mapId:s,maxZoom:n,positionFeatureStyle:r,accuracyFeatureStyle:i,trackingOptions:a}=e,{containerProps:u}=re("geolocation",e),l=!!navigator.geolocation,[d,h]=p.useState(!1),[v,b]=p.useState(!1),{map:y}=J(s),w=Rc(),A=Lc("notifier.NotificationService"),P=Nc(y,n,a,r,i),I=(()=>l?d?w.formatMessage({id:"locateMeEnd"}):w.formatMessage({id:"locateMeStart"}):w.formatMessage({id:"locateNotSupported"}))();p.useEffect(()=>{if(P===void 0)return;const K=P.on("error",function(Y){const L=w.formatMessage({id:"error"}),W=(()=>{switch(Y){case"permission-denied":return w.formatMessage({id:"permissionDenied"});case"position-unavailable":return w.formatMessage({id:"positionUnavailable"});case"timeout":return w.formatMessage({id:"timeout"});case"unknown":return w.formatMessage({id:"unknownError"})}})();b(!1),h(!1),A.notify({level:"error",title:L,message:W})});return()=>{K.destroy()}},[P,w,A]),p.useEffect(()=>{if(!P){b(!1);return}return d&&(b(!0),P.startGeolocation().then(()=>{b(!1)})),()=>{P?.stopGeolocation(),b(!1)}},[P,d]);const T=()=>{y&&h(!d)};return c.jsx(ye,{ref:t,label:I,icon:c.jsx(Ic,{}),onClick:()=>T(),isActive:d,isLoading:v,isDisabled:!l,...u})});function Nc(o,e,t,s,n){const[r,i]=p.useState();return p.useEffect(()=>{if(!o)return;const a=new Oc(o.olMap,t);return i(a),()=>{a.destroy(),i(void 0)}},[o,t]),p.useEffect(()=>{r?.setPositionFeatureStyle(s)},[r,s]),p.useEffect(()=>{r?.setAccuracyFeatureStyle(n)},[r,n]),p.useEffect(()=>{r?.setMaxZoom(e)},[r,e]),r}function Fc(o){const{toolState:e,onToolStateChange:t}=o,s=Te(),n=r=>{t(r,!e[r])};return c.jsxs(ae,{role:"toolbar","aria-label":s.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[c.jsx(ye,{label:s.formatMessage({id:"spatialBookmarkTitle"}),icon:c.jsx(Pr,{}),isActive:e.bookmarksActive,onClick:()=>n("bookmarksActive")}),c.jsx(jc,{mapId:z}),c.jsx(ye,{label:s.formatMessage({id:"tocTitle"}),icon:c.jsx(Mr,{}),isActive:e.tocActive,onClick:()=>n("tocActive")}),c.jsx(ye,{label:s.formatMessage({id:"legendTitle"}),icon:c.jsx(Tr,{}),isActive:e.legendActive,onClick:()=>n("legendActive")}),c.jsx(ye,{label:s.formatMessage({id:"measurementTitle"}),icon:c.jsx(Ar,{}),isActive:e.measurementActive,onClick:()=>n("measurementActive")}),c.jsx(ye,{label:s.formatMessage({id:"selectionTitle"}),icon:c.jsx(Lr,{}),isActive:e.selectionActive,onClick:()=>n("selectionActive")}),c.jsx(ye,{label:s.formatMessage({id:"overviewMapTitle"}),icon:c.jsx(Ls,{}),isActive:e.overviewMapActive,onClick:()=>n("overviewMapActive")}),c.jsx(Ur,{mapId:z}),c.jsx(zr,{mapId:z}),c.jsx(Wr,{mapId:z})]})}const Vc="@open-pioneer/measurement",Bc=ce.bind(void 0,Vc);class Gc{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const s=this.source=new Xe;this.layer=new Me({source:s}),this.layer.setZIndex(Ts),e.addLayer(this.layer);const n=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){be(n)}});const r=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",r),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",r)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=yr(e);this.activeFeatureStyle=(s,...n)=>{const r=s?.getGeometry()?.getType();if(r==="Polygon"||r==="LineString"||r==="Point")return t(s,...n)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",s=this.draw=new gl({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(s);let n,r;s.on("drawstart",i=>{n=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=i.feature;if(!a)return;let u;r=a.getGeometry()?.on("change",l=>{const d=l.target,h=this.olMap.getView().getProjection();let v="";d instanceof zt?(v=zc(d,h,this.messages),u=d.getInteriorPoint().getCoordinates()||null):d instanceof De&&(v=Wc(d,h,this.messages),u=d.getLastCoordinate()||null),n&&(n.element.innerHTML=v,u&&n?.overlay.setPosition(u))})}),s.on("drawend",()=>{if(n){const i=n.element.classList;i.remove("measurement-active-tooltip"),i.add("measurement-finished-tooltip"),n.overlay.setOffset([0,-7]),this.overlayTooltips.push(n),this.measureTooltip=n=void 0}this.sketch=void 0,r&&be(r)}),s.on("drawabort",()=>{n&&(n.destroy(),this.measureTooltip=n=void 0),this.sketch=void 0,r&&be(r)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip";const t=new Rt({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip hidden";const t=new Rt({element:e,offset:[15,0],positioning:"center-left"}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,s=Uc(this.messages,this.sketch);t.element.textContent=s,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function Uc(o,e){if(e){const t=e.getGeometry();if(t instanceof zt||t instanceof De)return o.getContinueMessage()}return o.getHelpMessage()}function zc(o,e,t){const s=wr(o,{projection:e});let n;return s>=1e6?n=`${t.formatNumber(s/1e6)} km<sup>2</sup>`:n=`${t.formatNumber(s)} m<sup>2</sup>`,n}function Wc(o,e,t){const s=_r(o,{projection:e});let n;return s>=1e3?n=`${t.formatNumber(s/1e3)} km`:n=`${t.formatNumber(s)} m`,n}const $c=o=>{const e=Bc(),{mapId:t,activeFeatureStyle:s,finishedFeatureStyle:n}=o,{containerProps:r}=re("measurement",o),[i,a]=p.useState("distance"),u=b=>e.formatMessage({id:b}),l=J(t),d=Hc(l.map,e);p.useEffect(()=>{d?.setActiveFeatureStyle(s??qc())},[d,s]),p.useEffect(()=>{d?.setFinishedFeatureStyle(n??Kc())},[d,n]),p.useEffect(()=>{if(d)return d.startMeasurement(i),()=>{d.stopMeasurement()}},[d,i]);function h(b){if(b==="distance"||b==="area")a(b);else throw new Error(`Unexpected measurement type: '${b}'.`)}function v(){d?.clearMeasurements()}return c.jsxs(V,{...r,children:[c.jsx(Q,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),c.jsx(lo,{mb:4,alignItems:"center",children:c.jsxs(Yr,{mb:2,children:[c.jsx(co,{mb:1,children:u("measurementLabel")}),c.jsxs(Xr,{value:i,onChange:b=>h(b.target.value),className:"measurement-select",children:[c.jsx("option",{value:"distance",children:u("distance")}),c.jsx("option",{value:"area",children:u("area")})]})]})}),c.jsx(yo,{padding:2,className:"measurement-delete-button",onClick:v,width:"100%",children:u("deleteMeasurementLabel")})]})};function Hc(o,e){const[t,s]=p.useState(void 0);return p.useEffect(()=>{if(!o)return;const n=new Gc(o.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(r){return e.formatNumber(r,{maximumFractionDigits:2})}});return s(n),()=>{n.destroy(),s(void 0)}},[o,e]),t}function qc(){return[new Pe({stroke:new Ce({color:"#fff",lineDash:[10,10],width:5})}),new Pe({fill:new $e({color:"rgba(0,0,0,0.15)"}),stroke:new Ce({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new _o({radius:5,stroke:new Ce({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new $e({color:"rgba(255, 255, 255, 0.2)"})})})]}function Kc(){return[new Pe({stroke:new Ce({color:"#fff",width:5})}),new Pe({stroke:new Ce({color:"#0b96fc",width:3}),fill:new $e({color:"rgba(11,150,252,0.15)"})})]}function Yc(){const o=p.useId(),e=Te();return c.jsx(V,{role:"dialog","aria-labelledby":o,children:c.jsx(Ze,{title:c.jsx(Je,{id:o,size:"md",mb:2,children:e.formatMessage({id:"measurementTitle"})}),children:c.jsx($c,{mapId:z})})})}const Xc="200px",Zc="300px",Jc=o=>{const{mapId:e,olLayer:t,height:s=Xc,width:n=Zc}=o,{containerProps:r}=re("overview-map",o),i=p.useRef(null),{map:a}=J(e);return p.useEffect(()=>{if(i.current&&a&&t){const u=a.olMap,l=new Bl({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:i.current});return u.addControl(l),()=>{u.removeControl(l)}}},[a,t]),c.jsx(V,{height:s,width:n,ref:i,...r})};function Qc(){const o=p.useMemo(()=>new wo({source:new xs}),[]);return c.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:325,children:c.jsx(V,{role:"dialog",children:c.jsx(Jc,{mapId:z,olLayer:o})})})}const eu="@open-pioneer/search",Ht=ce.bind(void 0,eu);function tu(o){const e=o.selectProps.inputValue.length>0,t={...o,className:bt(o.className,{"search-invisible":!e})};return c.jsx(ue.Menu,{...t,children:o.children})}function ou(o){const t=Ht().formatMessage({id:"noOptionsText"});return c.jsx(ue.NoOptionsMessage,{...o,children:c.jsx(le.span,{className:"search-no-match",children:t})})}function su(o){const t=Ht().formatMessage({id:"loadingText"});return c.jsx(ue.LoadingMessage,{...o,children:c.jsx(le.span,{className:"search-loading-text",children:t})})}function nu({children:o,...e}){const t={...e,className:bt(e.className,"search-value-container")};return c.jsxs(ue.ValueContainer,{...t,children:[!!o&&c.jsx(Fl,{style:{position:"absolute",left:8}}),o]})}function ru(o){const e={...o,isHidden:!1};return c.jsx(ue.Input,{...e})}function iu(o){return null}function au(o){return c.jsxs(ue.IndicatorsContainer,{...o,children:[o.children,!o.selectProps.isLoading&&o.selectProps.inputValue&&c.jsx(lu,{selectProps:o.selectProps,clearValue:o.clearValue})]})}function lu(o){const t=Ht().formatMessage({id:"ariaLabel.clearButton"}),s=n=>{n.preventDefault(),n.stopPropagation(),o.clearValue()};return c.jsx(yn,{role:"button",size:"md",mr:1,"aria-label":t,onClick:s,onTouchEnd:s,onMouseDown:n=>n.preventDefault()})}function cu(o){return null}function uu(o){const e=o.selectProps.inputValue,t=o.data.label,s={...o,className:bt(o.className,"search-option")};return c.jsx(ue.Option,{...s,children:c.jsx(le.div,{className:"search-option-label",children:e.trim().length>0?du(t,e):t})})}function du(o,e){const t=o.toLowerCase().indexOf(e.toLowerCase());return t>=0?c.jsxs(c.Fragment,{children:[o.substring(0,t),c.jsx(le.span,{className:"search-highlighted-match",children:o.substring(t,t+e.length)},"highlighted"),o.substring(t+e.length)]}):o}const us=Se("search:SearchController"),ds=200,hs=5;var ft,Ue,ze,We,oe,Gt,cn;class hu{constructor(e,t){R(this,Gt);R(this,ft,void 0);R(this,Ue,[]);R(this,ze,hs);R(this,We,ds);R(this,oe,void 0);D(this,ft,e),D(this,Ue,t)}destroy(){C(this,oe)?.abort(),D(this,oe,void 0)}async search(e){if(C(this,oe)?.abort(),D(this,oe,void 0),!e)return[];const t=D(this,oe,new AbortController);try{return await fu(t.signal,C(this,We)),t.signal.aborted&&(us.debug(`search canceled with ${e}`),wn()),(await Promise.all(C(this,Ue).map(n=>$(this,Gt,cn).call(this,n,e,t.signal)))).filter(n=>n!=null)}finally{C(this,oe)===t&&D(this,oe,void 0)}}get searchTypingDelay(){return C(this,We)}set searchTypingDelay(e){D(this,We,e??ds)}get maxResultsPerSource(){return C(this,ze)}set maxResultsPerSource(e){D(this,ze,e??hs)}get sources(){return C(this,Ue)}}ft=new WeakMap,Ue=new WeakMap,ze=new WeakMap,We=new WeakMap,oe=new WeakMap,Gt=new WeakSet,cn=async function(e,t,s){const n=e.label,r=C(this,ft).olMap.getView().getProjection();try{const i=C(this,ze);let a=await e.search(t,{maxResults:i,signal:s,mapProjection:r});return a.length>i&&(a=a.slice(0,i)),{label:n,source:e,results:a}}catch(i){Lt(i)||us.error(`search for source ${n} failed`,i);return}};async function fu(o,e){o.aborted||await new Promise(t=>{const s=()=>{o.removeEventListener("abort",s),clearTimeout(n),t()};o.addEventListener("abort",s);const n=setTimeout(s,e)})}const Ot=Se("search:Search"),pu=o=>{const{mapId:e,sources:t,searchTypingDelay:s,maxResultsPerGroup:n,onSelect:r,onClear:i}=o,{containerProps:a}=re("search",o),{map:u}=J(e),l=Ht(),d=bu(t,s,n,u),{input:h,search:v,selectedOption:b,onInputChanged:y,onResultConfirmed:w}=Su(d),A=vu(),P=gu(l),I=mu(),T=He((L,W)=>{W.action==="input-change"&&y(L)}),K=He((L,W)=>{switch(W.action){case"select-option":L&&(w(L),r?.({source:L.source,result:L.result}));break;case"clear":y(""),Y.current?.blur(),Y.current?.focus(),i?.();break;default:Ot.debug(`Unhandled action type '${W.action}'.`);break}}),Y=p.useRef(null);return c.jsx(V,{...a,children:c.jsx(uo,{className:"search-component",classNamePrefix:"react-select",ref:Y,inputValue:h,onInputChange:T,"aria-label":l.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:P,colorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:A,isClearable:!0,placeholder:l.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:v.kind==="loading",options:v.kind==="ready"?v.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:I,onChange:K,value:b,menuPosition:"fixed"})})};function gu(o){return p.useMemo(()=>({onFocus:({focused:r})=>`${r.label} ${o.formatMessage({id:"ariaLabel.searchFocus"})}.`,onChange:({action:r,label:i})=>{let a="";switch(r){case"select-option":a=`${i} ${o.formatMessage({id:"ariaLabel.searchSelect"})}.`;break;case"clear":a=`${i} ${o.formatMessage({id:"ariaLabel.searchClear"})}.`;break}return a},guidance:()=>`${o.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[o])}function mu(){return p.useMemo(()=>({Menu:tu,Input:ru,SingleValue:iu,Option:uu,NoOptionsMessage:ou,LoadingMessage:su,ValueContainer:nu,IndicatorsContainer:au,ClearIndicator:cu}),[])}function vu(){const[o,e]=ms("colors",["trails.100","trails.50"],["#d5e5ec","#eaf2f5"]);return p.useMemo(()=>({groupHeading:s=>({...s,backgroundColor:o,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:s=>({...s,backgroundColor:"inherit",_focus:{backgroundColor:e}}),dropdownIndicator:s=>({...s,display:"none"})}),[o,e])}function bu(o,e,t,s){const[n,r]=p.useState(void 0);return p.useEffect(()=>{if(!s)return;const i=new hu(s,o);return r(i),()=>{i.destroy(),r(void 0)}},[s,o]),p.useEffect(()=>{n&&(n.searchTypingDelay=e)},[n,e]),p.useEffect(()=>{n&&(n.maxResultsPerSource=t)},[n,t]),n}function Su(o){const[e,t]=p.useReducer((a,u)=>{switch(u.kind){case"input":return{...a,query:u.query,selectedOption:null};case"select-option":return{...a,selectedOption:u.option,query:u.option.label};case"load-results":return{...a,search:{kind:"loading"}};case"accept-results":return{...a,search:{kind:"ready",results:u.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),s=p.useRef(),n=He(a=>{if(!o){s.current=void 0,t({kind:"accept-results",results:[]});return}Ot.isDebug()&&Ot.debug(`Starting new search for query ${JSON.stringify(a)}.`),t({kind:"load-results"});const u=s.current=yu(o,a).then(l=>{s.current===u&&t({kind:"accept-results",results:l})})}),r=p.useCallback(a=>{t({kind:"select-option",option:a})},[]),i=p.useCallback(a=>{t({kind:"input",query:a}),n(a)},[n]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:r,onInputChanged:i}}async function yu(o,e){let t;try{t=await o.search(e)}catch(s){Lt(s)||Ot.error("Search failed",s),t=[]}return wu(t)}function wu(o){return o.map((t,s)=>({label:t.label,options:t.results.map(n=>({value:`${s}-${n.id}`,label:n.label,source:t.source,result:n}))}))}function un(o,e){const t=o.olMap.getViewport();o.highlightAndZoom(e,{viewPadding:t&&t.offsetWidth<1e3?{top:150,right:75,bottom:50,left:75}:{top:150,right:400,bottom:50,left:400}})}function _u(){const{map:o}=J(z),e=vo("ol-app.AppModel"),t=Ys(e.state).searchSources;function s(r){if(console.debug("The user selected the following item: ",r.result),!o)return;const i=r.result.geometry;i&&un(o,[i])}function n(){console.debug("The user cleared the search"),o?.removeHighlight()}return c.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-box",children:c.jsx(pu,{mapId:z,sources:t,maxResultsPerGroup:10,onSelect:s,onClear:n})})}const dn="@open-pioneer/selection",xu=Wt.bind(void 0,dn),Lo=ce.bind(void 0,dn),st="selection-active",Tt="selection-inactive";class ku{tooltip;interactionResources=[];olMap;isActive=!0;tooltipMessage;tooltipDisabledMessage;constructor(e,t,s,n,r){let i;switch(t){case Ro.extent:default:i=this.initViewport(e),this.interactionResources.push(this.createDragBox(e,r,i,this.interactionResources)),this.interactionResources.push(this.createDrag(e,i,this.interactionResources));break}this.tooltip=this.createHelpTooltip(e,s),this.olMap=e,this.tooltipMessage=s,this.tooltipDisabledMessage=n}initViewport(e){const t=e.getViewport();return t.classList.add(st),t.oncontextmenu=s=>(s.preventDefault(),!1),t}destroy(){this.tooltip.destroy(),this.interactionResources.forEach(e=>{e.destroy()})}setActive(e){if(this.isActive===e)return;const t=this.olMap.getViewport();e?(this.interactionResources.forEach(s=>this.olMap.addInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipMessage,t.classList.remove(Tt),t.classList.add(st),this.isActive=!0):(this.interactionResources.forEach(s=>this.olMap.removeInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipDisabledMessage,t.classList.remove(st),t.classList.add(Tt),this.isActive=!1)}createDragBox(e,t,s,n){const r=new Uo({className:"selection-drag-box",condition:xr});return e.addInteraction(r),r.on("boxend",function(){t(r.getGeometry())}),{interaction:r,destroy(){e.removeInteraction(r),n.splice(n.indexOf(this)),r.dispose(),s.classList.remove(st),s.classList.remove(Tt),s.oncontextmenu=null}}}createDrag(e,t,s){const n=function(a){return a.originalEvent.button==2},r=new zo({condition:n});return e.addInteraction(r),{interaction:r,destroy(){e.removeInteraction(r),s.splice(s.indexOf(this)),r.dispose(),t.classList.remove(st),t.classList.remove(Tt),t.oncontextmenu=null}}}createHelpTooltip(e,t){const s=document.createElement("div");s.className="selection-tooltip",s.textContent=t;const n=new Rt({element:s,offset:[15,0],positioning:"center-left"}),r=e.on("pointermove",i=>{n.setPosition(i.coordinate)});return e.addOverlay(n),{overlay:n,element:s,destroy(){e.removeOverlay(n),n.dispose(),be(r)}}}getDragboxInteraction(){return this.interactionResources.find(e=>e.interaction instanceof Uo)}getDragPanInteraction(){return this.interactionResources.find(e=>e.interaction instanceof zo)}}const no=Se("selection:SelectionController"),Cu=1e4;var pt,gt,mt,Ut,hn;class Eu{constructor(e){R(this,Ut);R(this,pt,void 0);R(this,gt,void 0);R(this,mt,void 0);const{mapModel:t,onError:s,maxResults:n=Cu}=e;D(this,pt,t),D(this,gt,n),D(this,mt,s)}destroy(){}async select(e,t){if(t)return await $(this,Ut,hn).call(this,e,t)}}pt=new WeakMap,gt=new WeakMap,mt=new WeakMap,Ut=new WeakSet,hn=async function(e,t){const s=C(this,pt).olMap.getView().getProjection();try{no.debug(`Starting selection on source '${e.label}'`);const n=C(this,gt);let r=await e.select({type:"extent",extent:t},{maxResults:n,mapProjection:s,signal:new AbortController().signal});return r.length>n&&(r=r.slice(0,n)),no.debug(`Found ${r.length} results on source '${e.label}'`),{source:e,results:r}}catch(n){no.error(`selection from source ${e.label} failed`,n),C(this,mt).call(this);return}};var Ro=(o=>(o.extent="EXTENT",o.polygon="POLYGON",o.free="FREEPOLYGON",o.circle="CIRCLE",o))(Ro||{});const fs={classNamePrefix:"react-select",menuPosition:"fixed",isSearchable:!1,isClearable:!1},Pu=o=>{const e=Lo(),{mapId:t,sources:s,onSelectionComplete:n,onSelectionSourceChanged:r}=o,{containerProps:i}=re("selection",o),[a,u]=p.useState(()=>s.find(L=>(L.status??"available")==="available")),l=J(t),{onExtentSelected:d}=Au(l.map,s,a,n),h=Iu(),b=p.useCallback(L=>{const W=[];if(L||(L=["EXTENT"]),L.forEach(g=>{Object.values(Ro).includes(g)&&W.push({label:e.formatMessage({id:g}),value:g})}),W.length===0)throw new Error("methods does not contain valid values");return W},[e])(void 0),[y,w]=p.useState(b[0]),A=He(L=>{w(L)}),[P,I]=p.useState(!0);Ru(l.map,y,e,d,P);const T=p.useMemo(()=>s.map(L=>({label:L.label,value:L})),[s]),K=p.useMemo(()=>T.find(L=>L.value===a),[T,a]),Y=He(L=>{u(L?.value),r&&r({source:L?.value})});return p.useEffect(()=>{if(!a){I(!1);return}const L=e.formatMessage({id:"sourceNotAvailable"}),W=()=>a&&bo(a,L).kind==="available";I(W());const g=a.on("changed:status",()=>{I(W())});return()=>g.destroy()},[a,I,e]),c.jsxs(ao,{...i,spacing:2,children:[b.length>1&&c.jsxs(lo,{children:[c.jsx(co,{children:e.formatMessage({id:"selectMethod"})}),c.jsx(uo,{className:"selection-method react-select",...fs,options:b,onChange:A,value:y,chakraStyles:h})]}),c.jsxs(lo,{children:[c.jsx(co,{children:e.formatMessage({id:"selectSource"})}),c.jsx(uo,{className:"selection-source react-select",...fs,options:T,placeholder:e.formatMessage({id:"selectionPlaceholder"}),value:K,onChange:Y,components:{Option:Mu,SingleValue:Tu},isOptionDisabled:L=>L.value===void 0||L.value.status==="unavailable",getOptionLabel:L=>L.label+(L.value===void 0||L.value.status==="unavailable"?" "+e.formatMessage({id:"sourceNotAvailable"}):""),chakraStyles:h})]})]})};function Mu(o){const{value:e}=o.data,{isAvailable:t,content:s}=fn(e,!1);return c.jsx(ue.Option,{...o,isDisabled:!t,className:"selection-source-option",children:s})}function Tu(o){const{value:e}=o.data,{isAvailable:t,content:s}=fn(e,!0),n=t?"selection-source-value":"selection-source-value selection-source-value--disabled";return c.jsx(ue.SingleValue,{...o,isDisabled:!t,className:n,children:s})}function fn(o,e){const t=o?.label,s=Lu(o);return{isAvailable:s.kind==="available",content:c.jsxs(ae,{direction:"row",alignItems:"center",grow:1,children:[!e&&c.jsx(ae,{grow:1,children:t}),s.kind==="unavailable"&&c.jsx(V,{ml:2,children:c.jsx(gs,{label:s.reason,placement:"right",openDelay:500,children:c.jsx(le.span,{children:c.jsx(_n,{as:Hr,color:"red",className:"warning-icon","aria-label":s.reason})})})}),e&&t]})}}function Au(o,e,t,s){const n=xu("notifier.NotificationService"),r=Lo(),[i,a]=p.useState(void 0);p.useEffect(()=>{if(!o)return;const l=new Eu({mapModel:o,onError(){n.notify({level:"error",message:r.formatMessage({id:"selectionFailed"})})}});return a(l),()=>{l.destroy()}},[o,n,e,r]);const u=He(async l=>{if(!i||!t)return;const d=await i.select(t,l.getExtent());d&&s?.(d)});return{controller:i,onExtentSelected:u}}function bo(o,e){const t=o.status??"available",s=typeof t=="string"?{kind:t}:t;return s.kind==="available"?s:{kind:"unavailable",reason:s.reason??e}}function Lu(o){const e=Lo(),[t,s]=p.useState(()=>({kind:"available"}));return p.useEffect(()=>{if(!o){s({kind:"available"});return}const n=e.formatMessage({id:"sourceNotAvailable"});s(bo(o,n));const r=o.on?.("changed:status",()=>{s(bo(o,n))});return()=>r?.destroy()},[o,e]),t}function Ru(o,e,t,s,n){p.useEffect(()=>{if(!o)return;const r=new ku(o.olMap,e.value,t.formatMessage({id:"tooltip"}),t.formatMessage({id:"disabledTooltip"}),s);return r.setActive(n),()=>{r?.destroy()}},[o,e,t,s,n])}function Iu(){const[o,e]=ms("colors",["background_body","border"],["#ffffff","#ffffff"]);return p.useMemo(()=>({control:s=>({...s,cursor:"pointer"}),indicatorSeparator:s=>({...s,borderColor:e}),dropdownIndicator:s=>({...s,backgroundColor:o})}),[o,e])}function Ou(){const o=Te(),e=vo("notifier.NotificationService"),t=p.useId(),{map:s}=J(z),n=vo("ol-app.AppModel"),r=Ys(n.state).selectionSources;function i(u){const l=u.results;if(!s){console.debug("Map not ready");return}s?.removeHighlight();const d=l.map(h=>h.geometry);d.length>0&&un(s,d),e.notify({level:"info",message:o.formatMessage({id:"foundResults"},{resultsCount:l.length}),displayDuration:4e3})}function a(u){s?.removeHighlight()}return c.jsx(V,{role:"dialog","aria-labelledby":t,children:c.jsx(Ze,{title:c.jsx(Je,{id:t,size:"md",mb:2,children:o.formatMessage({id:"selectionTitle"})}),children:c.jsx(Pu,{mapId:z,sources:r,onSelectionComplete:i,onSelectionSourceChanged:a})})})}function Du(o){const e=p.useId(),t=Te();return c.jsx(V,{role:"dialog","aria-labelledby":e,children:c.jsx(Ze,{title:c.jsx(Je,{id:e,size:"md",mb:2,children:c.jsx(Q,{children:t.formatMessage({id:"tocTitle"})})}),children:c.jsx(V,{overflowY:"auto",maxHeight:o.maxHeight,children:c.jsx(jr,{mapId:z,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})})})}const ju={bookmarksActive:!1,legendActive:!0,overviewMapActive:!0,tocActive:!0};function Nu(){const o=Te(),{map:e}=J(z),[t,s]=p.useState(),[n,r]=p.useState(ju),i={...n,measurementActive:t==="measurement",selectionActive:t==="selection"},a=(l,d)=>{if(l==="selectionActive"||l==="measurementActive"){const h=l==="selectionActive"?"selection":"measurement";h!==t&&d?(s(h),e?.removeHighlight()):h===t&&!d&&(s(void 0),e?.removeHighlight())}else r({...n,[l]:d})},u=[i.tocActive&&c.jsx(Du,{maxHeight:i.legendActive||t?"300px":"75vh"},"toc"),i.legendActive&&c.jsx(Ac,{},"legend"),t==="selection"?c.jsx(Ou,{},"selection"):t==="measurement"?c.jsx(Yc,{},"measurement"):void 0];return c.jsxs(ae,{height:"100%",direction:"column",overflow:"hidden",children:[c.jsx(Vr,{position:"top-right"}),c.jsxs(Ze,{title:c.jsx(V,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:c.jsx(Je,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[c.jsx(ae,{flex:"1",direction:"column",position:"relative",children:c.jsxs(kr,{mapId:z,role:"main","aria-label":o.formatMessage({id:"ariaLabel.map"}),children:[c.jsx(Jr,{centerContent:!0,children:c.jsx(_u,{})}),c.jsx(yt,{position:"top-left",horizontalGap:20,verticalGap:20,children:c.jsx(Fu,{children:u})}),c.jsx(yt,{position:"top-right",horizontalGap:20,verticalGap:20,children:i.overviewMapActive&&c.jsx(Qc,{})}),c.jsx(yt,{horizontalGap:20,position:"bottom-left",children:i.bookmarksActive&&c.jsx(Sc,{})}),c.jsx(yt,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:c.jsx(Fc,{toolState:i,onToolStateChange:a})})]})}),c.jsxs(ae,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[c.jsx(Ol,{mapId:z,precision:2}),c.jsx(Wl,{mapId:z}),c.jsx(ql,{mapId:z})]})]})]})}function Fu(o){const e=o.children,t=[];for(const s of e)s&&(t.length&&t.push(c.jsx(Qr,{mt:4,mb:4},t.length)),t.push(s));if(t.length!==0)return c.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:t})}const Vu=xn({component:Nu,theme:kn,appMetadata:Al,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(o){const e=o.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",Vu);const Bu=document.getElementsByTagName("body")[0];Gu();function Gu(){const o=window.location.search,t=new URLSearchParams(o).get("lang"),s=document.createElement("ol-map-app");s.classList.add("full-height"),s.classList.add("app"),s.setAttribute("id","test"),t&&s.setAttribute("forced-locale",t),Bu.appendChild(s)}
