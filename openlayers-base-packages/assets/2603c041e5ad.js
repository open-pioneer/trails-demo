var ee=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var h=(s,e,t)=>(ee(s,e,"read from private field"),t?t.call(s):e.get(s)),d=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},g=(s,e,t,r)=>(ee(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var Y=(s,e,t)=>(ee(s,e,"access private method"),t);import{a as Pe}from"./cf33be65345b.js";import{be as De,bo as Fe,aF as _e,bp as ce,aE as le,bq as fe,br as m,aK as He,bs as Ce,bt as P,bu as D,bv as ue,bw as Ge,bx as Ne,i as Ve,_ as se,by as ye,at as Ie,bz as pe,bA as We,bB as Ue,W as Be,E as Ee,U as Ze,bC as ke,bg as Ye,bD as $e,bj as he,ak as qe,bE as $,bF as be,B as Ke,J as K,bG as Re,bH as ge,bI as de,bJ as Xe,bK as ze,bL as Qe}from"./0fda7ba7cdd5.js";import{b as Se}from"./10f858e9c271.js";import{E as Je}from"./960f2965a833.js";import{G as N}from"./adb0df4d3ebc.js";function Le(s,e){const t=(""+s).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(t.length,r.length);i++){const a=parseInt(t[i]||"0",10),n=parseInt(r[i]||"0",10);if(a>n)return 1;if(n>a)return-1}return 0}class et extends De{constructor(e){e=e||{},super(e)}}const tt=et;class st extends Fe{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,a=i.resolution,n=this.getLayer().getSource(),o=e.viewHints;let c=e.extent;if(t.extent!==void 0&&(c=_e(c,ce(t.extent,i.projection))),!o[le.ANIMATING]&&!o[le.INTERACTING]&&!fe(c))if(n){const u=i.projection,l=n.getImage(c,a,r,u);l&&(this.loadImage(l)?this.image_=l:l.getState()===m.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),i=He(t.pixelToCoordinateTransform,e.slice()),a=r.getExtent();if(a&&!Ce(a,i))return null;const n=this.image_.getExtent(),o=this.image_.getImage(),c=P(n),u=Math.floor(o.width*((i[0]-n[0])/c));if(u<0||u>=o.width)return null;const l=D(n),_=Math.floor(o.height*((n[3]-i[1])/l));return _<0||_>=o.height?null:this.getImageData(o,u,_)}renderFrame(e,t){const r=this.image_,i=r.getExtent(),a=r.getResolution(),[n,o]=Array.isArray(a)?a:[a,a],c=r.getPixelRatio(),u=e.layerStatesArray[e.layerIndex],l=e.pixelRatio,_=e.viewState,x=_.center,V=_.resolution,W=l*n/(V*c),U=l*o/(V*c),E=e.extent,B=_.resolution,Z=_.rotation,O=Math.round(P(E)/B*l),M=Math.round(D(E)/B*l);ue(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,Z,-O/2,-M/2),Ge(this.inversePixelTransform,this.pixelTransform);const X=Ne(this.pixelTransform);this.useContainer(t,X,this.getBackground(e));const f=this.context,R=f.canvas;R.width!=O||R.height!=M?(R.width=O,R.height=M):this.containerReused||f.clearRect(0,0,O,M);let z=!1,Q=!0;if(u.extent){const j=ce(u.extent,_.projection);Q=Ve(j,e.extent),z=Q&&!se(j,e.extent),z&&this.clipUnrotated(f,e,j)}const T=r.getImage(),k=ue(this.tempTransform,O/2,M/2,W,U,0,c*(i[0]-x[0])/n,c*(x[1]-i[3])/o);this.renderedResolution=o*l/c;const ae=T.width*k[0],ne=T.height*k[3];if(this.getLayer().getSource().getInterpolate()||(f.imageSmoothingEnabled=!1),this.preRender(f,e),Q&&ae>=.5&&ne>=.5){const j=k[4],je=k[5],J=u.opacity;let oe;J!==1&&(oe=f.globalAlpha,f.globalAlpha=J),f.drawImage(T,0,0,+T.width,+T.height,j,je,ae,ne),J!==1&&(f.globalAlpha=oe)}return this.postRender(f,e),z&&f.restore(),f.imageSmoothingEnabled=!0,X!==R.style.transform&&(R.style.transform=X),this.container}}const rt=st;class it extends tt{constructor(e){super(e)}createRenderer(){return new rt(this)}getData(e){return super.getData(e)}}const at=it;function re(s){return Array.isArray(s)?Math.min(...s):s}class nt extends ye{constructor(e,t,r,i,a,n,o){let c=e.getExtent();c&&e.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);let u=t.getExtent();u&&t.canWrapX()&&(u=u.slice(),u[0]=-1/0,u[2]=1/0);const l=u?_e(r,u):r,_=Ie(l),x=pe(e,t,_,i),V=ke,W=new We(e,t,l,c,x*V,i),U=W.calculateSourceExtent(),E=fe(U)?null:n(U,x,a),B=E?m.IDLE:m.EMPTY,Z=E?E.getPixelRatio():1;super(r,i,Z,B),this.targetProj_=t,this.maxSourceExtent_=c,this.triangulation_=W,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=E,this.sourcePixelRatio_=Z,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==m.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==m.LOADED){const t=P(this.targetExtent_)/this.targetResolution_,r=D(this.targetExtent_)/this.targetResolution_;this.canvas_=Ue(t,r,this.sourcePixelRatio_,re(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==m.IDLE){this.state=m.LOADING,this.changed();const e=this.sourceImage_.getState();e==m.LOADED||e==m.ERROR?this.reproject_():(this.sourceListenerKey_=Be(this.sourceImage_,Ee.CHANGE,function(t){const r=this.sourceImage_.getState();(r==m.LOADED||r==m.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){Ze(this.sourceListenerKey_),this.sourceListenerKey_=null}}const ot=nt,p=4,te={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ct extends Ke{constructor(e,t){super(e),this.image=t}}class lt extends Ye{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=$e(t,e,0);e=t[r]}return e}getImage(e,t,r,i){const a=this.getProjection();if(!a||!i||he(a,i))return a&&(i=a),this.getImageInternal(e,t,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&he(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==t&&qe(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new ot(a,i,e,t,r,(n,o,c)=>this.getImageInternal(n,o,c,a),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,i){if(this.loader){const a=Ae(e,t,r,1),n=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&se(this.wantedExtent_,a)||se(this.image.getExtent(),a))&&(this.wantedResolution_&&re(this.wantedResolution_)===n||re(this.image.getResolution())===n)))return this.image;this.wantedProjection_=i,this.wantedExtent_=a,this.wantedResolution_=n,this.image=new ye(a,n,r,this.loader),this.image.addEventListener(Ee.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case m.LOADING:this.loading=!0,r=te.IMAGELOADSTART;break;case m.LOADED:this.loading=!1,r=te.IMAGELOADEND;break;case m.ERROR:this.loading=!1,r=te.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new ct(r,t))}}function ut(s,e){s.getImage().src=e}function Ae(s,e,t,r){const i=e/t,a=Ie(s),n=$(P(s)/i,p),o=$(D(s)/i,p),c=$((r-1)*n/2,p),u=n+2*c,l=$((r-1)*o/2,p),_=o+2*l;return be(a,i,0,[u,_])}const ht=lt,ve="1.3.0",me=[101,101];function we(s,e,t,r,i){i.WIDTH=t[0],i.HEIGHT=t[1];const a=r.getAxisOrientation();let n;const o=Le(i.VERSION,"1.3")>=0;return i[o?"CRS":"SRS"]=r.getCode(),o&&a.substr(0,2)=="ne"?n=[e[1],e[0],e[3],e[2]]:n=e,i.BBOX=n.join(","),Se(s,i)}function gt(s,e,t,r,i,a,n){a=Object.assign({REQUEST:"GetMap"},a);const o=e/t,c=[de(P(s)/o,p),de(D(s)/o,p)];if(t!=1)switch(n){case"geoserver":const l=90*t+.5|0;"FORMAT_OPTIONS"in a?a.FORMAT_OPTIONS+=";dpi:"+l:a.FORMAT_OPTIONS="dpi:"+l;break;case"mapserver":a.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":a.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return we(i,s,c,r,a)}function xe(s,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:ve,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}function dt(s){const e=s.hidpi===void 0?!0:s.hidpi,t=K(s.projection||"EPSG:3857"),r=s.ratio||1.5,i=s.load||Re;return(a,n,o)=>{a=Ae(a,n,o,r),o!=1&&(!e||s.serverType===void 0)&&(o=1);const c=gt(a,n,o,t,s.url,xe(s.params,"GetMap"),s.serverType),u=new Image;return s.crossOrigin!==null&&(u.crossOrigin=s.crossOrigin),i(u,c).then(l=>({image:l,extent:a,pixelRatio:o}))}}function mt(s,e,t){if(s.url===void 0)return;const r=K(s.projection||"EPSG:3857"),i=be(e,t,0,me),a={QUERY_LAYERS:s.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(a,xe(s.params,"GetFeatureInfo"),s.params);const n=ge((e[0]-i[0])/t,p),o=ge((i[3]-e[1])/t,p),c=Le(a.VERSION,"1.3")>=0;return a[c?"I":"X"]=n,a[c?"J":"Y"]=o,we(s.url,i,me,r,a)}function _t(s,e){if(s.url===void 0)return;const t={SERVICE:"WMS",VERSION:ve,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(s.params===void 0||s.params.LAYER===void 0){const r=s.params.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;t.LAYER=r}if(e!==void 0){const r=K(s.projection||"EPSG:3857").getMetersPerUnit()||1,i=28e-5;t.SCALE=e*r/i}return Object.assign(t,s.params),Se(s.url,t)}class ft extends ht{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:ut,this.params_=e.params,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,t,r,i){const a=K(r),n=this.getProjection();n&&n!==a&&(t=pe(n,a,e,t),e=Xe(e,a,n));const o={url:this.url_,params:{...this.params_,...i},projection:n||a};return mt(o,e,t)}getLegendUrl(e,t){return _t({url:this.url_,params:{...this.params_,...t}},e)}getParams(){return this.params_}getImageInternal(e,t,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=dt({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(a,n)=>(this.image.setImage(a),this.imageLoadFunction_(this.image,n),Re(a))})),super.getImageInternal(e,t,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const yt=ft;function It(s){let e=!1,t=setTimeout(()=>{e=!0,t=void 0,s()});return{reschedule(){return!e},cancel(){t&&clearTimeout(t)}}}var y;class Oe extends Je{constructor(t){super();d(this,y,void 0);g(this,y,t)}destroy(){for(const t of h(this,y))t.destroy();g(this,y,[])}getSublayers(t){return h(this,y).slice()}__getRawSublayers(){return h(this,y)}}y=new WeakMap;const pt=Pe("map:WMSLayer");var F,S,L,A,v,H,ie,q,Me;class Et extends ze{constructor(t){const r=new at;super({...t,olLayer:r});d(this,H);d(this,q);d(this,F,void 0);d(this,S,void 0);d(this,L,void 0);d(this,A,void 0);d(this,v,void 0);const i=new yt({...t.sourceOptions,url:t.url,params:{...t.sourceOptions?.params}});g(this,F,t.url),g(this,v,i),g(this,A,r),g(this,S,new Oe(Te(t.sublayers))),Y(this,H,ie).call(this)}get url(){return h(this,F)}get sublayers(){return h(this,S)}__attach(t){super.__attach(t);for(const r of h(this,S).getSublayers())r.__attach(t,this,this)}__updateSublayerVisibility(){h(this,L)?.reschedule()||g(this,L,It(()=>{try{Y(this,H,ie).call(this),g(this,L,void 0)}catch(t){pt.error(`Failed to update sublayer visibility on WMS layer '${this.id}'.`,t)}}))}}F=new WeakMap,S=new WeakMap,L=new WeakMap,A=new WeakMap,v=new WeakMap,H=new WeakSet,ie=function(){const t=Y(this,q,Me).call(this);h(this,v).updateParams({LAYERS:t});const r=t.length===0?null:h(this,v);h(this,A).getSource()!==r&&h(this,A).setSource(r)},q=new WeakSet,Me=function(){const t=[],r=i=>{if(!i.visible)return;const a=i.sublayers.__getRawSublayers();if(a.length)for(const n of a)r(n);else t.push(i.name)};for(const i of this.sublayers.__getRawSublayers())r(i);return t};var b,I,C,G,w;class bt extends Qe{constructor(t){super(t);d(this,b,void 0);d(this,I,void 0);d(this,C,void 0);d(this,G,void 0);d(this,w,void 0);g(this,C,t.name),g(this,w,t.visible??!0),g(this,G,new Oe(Te(t.sublayers)))}get name(){return h(this,C)}get sublayers(){return h(this,G)}get parent(){const t=h(this,b);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}get parentLayer(){const t=h(this,I);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}__attach(t,r,i){if(super.__attachToMap(t),h(this,b))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent '${h(this,b).id}'`);if(g(this,b,i),h(this,I))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent layer '${h(this,I).id}'`);g(this,I,r);for(const a of this.sublayers.__getRawSublayers())a.__attach(t,r,this)}get visible(){return h(this,w)}setVisible(t){this.visible!==t&&(g(this,w,t),h(this,I)?.__updateSublayerVisibility(),this.__emitChangeEvent("changed:visible"))}}b=new WeakMap,I=new WeakMap,C=new WeakMap,G=new WeakMap,w=new WeakMap;function Te(s=[]){const e=[];try{for(const t of s)e.push(new bt(t));return e}catch(t){for(;e.length;)e.pop()?.destroy();throw new Error("Failed to construct sublayers.",{cause:t})}}const xt=Et;function Ot(s){return N({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,56H60A20,20,0,0,0,40,76V228a12,12,0,0,0,19,9.76l49-35,49,35A12,12,0,0,0,176,228V76A20,20,0,0,0,156,56Zm-4,148.68-37-26.45a12,12,0,0,0-14,0L64,204.68V80h88ZM216,36V188a12,12,0,0,1-24,0V40H92a12,12,0,0,1,0-24H196A20,20,0,0,1,216,36Z"}}]})(s)}function Mt(s){return N({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128ZM40,70H216a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12ZM216,186H40a6,6,0,0,0,0,12H216a6,6,0,0,0,0-12Z"}}]})(s)}function Tt(s){return N({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M233.91,74.79,181.22,22.1a14,14,0,0,0-19.8,0L22.09,161.41a14,14,0,0,0,0,19.8L74.78,233.9a14,14,0,0,0,19.8,0L233.91,94.59A14,14,0,0,0,233.91,74.79ZM225.42,86.1,86.1,225.41h0a2,2,0,0,1-2.83,0L30.58,172.73a2,2,0,0,1,0-2.83L64,136.48l27.76,27.76a6,6,0,1,0,8.48-8.48L72.48,128,96,104.48l27.76,27.76a6,6,0,0,0,8.48-8.48L104.48,96,128,72.49l27.76,27.75a6,6,0,0,0,8.48-8.48L136.49,64,169.9,30.59a2,2,0,0,1,2.83,0l52.69,52.68A2,2,0,0,1,225.42,86.1Z"}}]})(s)}function jt(s){return N({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,50H40a6,6,0,0,0,0,12H50V208a14,14,0,0,0,14,14H192a14,14,0,0,0,14-14V62h10a6,6,0,0,0,0-12ZM194,208a2,2,0,0,1-2,2H64a2,2,0,0,1-2-2V62H194ZM82,24a6,6,0,0,1,6-6h80a6,6,0,0,1,0,12H88A6,6,0,0,1,82,24Z"}}]})(s)}function Pt(s){return N({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM104,52.94l48,24V203.06l-48-24ZM40,62.25l48-12v127.5l-48,12Zm176,131.5-48,12V78.25l48-12Z"}}]})(s)}export{Pt as P,xt as W,jt as a,Ot as b,Mt as c,Tt as d};
