var De=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var w=(o,e,t)=>(De(o,e,"read from private field"),t?t.call(o):e.get(o)),I=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},E=(o,e,t,i)=>(De(o,e,"write to private field"),i?i.call(o,t):e.set(o,t),t);var fe=(o,e,t)=>(De(o,e,"access private method"),t);import{f as di,j as g,c as Et,r as _,a as ui,B as gi,b as pi,t as mi}from"./0332efd8fd89.js";import{L as fi,C as _i,g as Tt,f as ot,V as rt,i as It,I as P,a as vi,c as yi,b as Z,d as X,e as at,m as wi,t as bi,h as Pt,j as re,k as Mt,l as Lt,n as kt,T as xi,r as Ci,o as Ze,E as Pe,u as Rt,p as Si,S as Ei,q as Ti,s as lt,v as Ot,w as _e,x as At,B as Xe,y as J,z as Dt,A as ct,D as ht,F as Ii,G as Pi,H as Mi,J as $e,K as W,M as Li,N as ki,O as Ri,P as Oi,Q as Ai,R as V,U as Je,W as Ft,X as Di,Y as Fi,Z as Ni,_ as dt,$ as ji,a0 as Gi,a1 as ut,a2 as Vi,a3 as zi,a4 as O,a5 as Hi,a6 as Wi,a7 as Nt,a8 as Ee,a9 as gt,aa as Me,ab as Ui,ac as jt,ad as Bi,ae as $i,af as qi,ag as pt,ah as ee,ai as Gt,aj as Ki,ak as Yi,al as Zi,am as Vt,an as Xi,ao as Ji,ap as zt,aq as Qi,ar as es,as as Ht,at as ts,au as mt,av as Wt,aw as is,ax as ft,ay as ss,az as Fe,aA as ns,aB as _t,aC as os,aD as rs,aE as as,aF as ls,aG as cs,aH as vt,aI as hs,aJ as ds,aK as us,aL as gs,aM as ps,aN as ms,aO as Ne}from"./73684d7e79ee.js";import{a as Ut,W as fs,b as _s}from"./6b97cf6d030b.js";import{E as Bt}from"./960f2965a833.js";import{u as te,T as Te,a as je,S as Ge}from"./65588d8ab43d.js";import{V as ue,G as $t,a as ge,F as N,L as U,M as vs,b as qt,c as Kt,d as ys,e as ws,t as bs,S as Q,f as G,g as ae,C as Yt,T as xs,I as Cs,Z as Ss,h as Es}from"./f126d61f2a53.js";import{N as Ts,a as Is}from"./4fe5d570f021.js";import{u as pe,a as Ps}from"./088f293e13c9.js";import{T as Qe}from"./e08b4c03724c.js";import{B as L}from"./accd18d3093e.js";import{F as Ms}from"./037895c55d7d.js";import{F as Ls}from"./c1ce15bc9d6a.js";import{S as ks}from"./bdf02206a6c4.js";import{S as Rs}from"./bdfc1fdda0de.js";import{G as Le}from"./cf32a427ea79.js";import{D as Os}from"./e395d37bab2f.js";import{F as ve}from"./a1ffb7223131.js";import"./db509020f0cf.js";import"./cbd7f052144d.js";import"./70037156f899.js";var Zt=di((o,e)=>g.jsx(ks,{align:"center",...o,direction:"row",ref:e}));Zt.displayName="HStack";function Xt(o,e){const t=(""+o).split("."),i=(""+e).split(".");for(let s=0;s<Math.max(t.length,i.length);s++){const n=parseInt(t[s]||"0",10),r=parseInt(i[s]||"0",10);if(n>r)return 1;if(r>n)return-1}return 0}class As extends fi{constructor(e){e=e||{},super(e)}}const Ds=As;class Fs extends _i{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],i=e.pixelRatio,s=e.viewState,n=s.resolution,r=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=Tt(l,ot(t.extent,s.projection))),!a[rt.ANIMATING]&&!a[rt.INTERACTING]&&!It(l))if(r){const h=s.projection,c=r.getImage(l,n,i,h);c&&(this.loadImage(c)?this.image_=c:c.getState()===P.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),s=vi(t.pixelToCoordinateTransform,e.slice()),n=i.getExtent();if(n&&!yi(n,s))return null;const r=this.image_.getExtent(),a=this.image_.getImage(),l=Z(r),h=Math.floor(a.width*((s[0]-r[0])/l));if(h<0||h>=a.width)return null;const c=X(r),d=Math.floor(a.height*((r[3]-s[1])/c));return d<0||d>=a.height?null:this.getImageData(a,h,d)}renderFrame(e,t){const i=this.image_,s=i.getExtent(),n=i.getResolution(),[r,a]=Array.isArray(n)?n:[n,n],l=i.getPixelRatio(),h=e.layerStatesArray[e.layerIndex],c=e.pixelRatio,d=e.viewState,p=d.center,u=d.resolution,m=c*r/(u*l),f=c*a/(u*l),v=e.extent,C=d.resolution,b=d.rotation,x=Math.round(Z(v)/C*c),k=Math.round(X(v)/C*c);at(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/c,1/c,b,-x/2,-k/2),wi(this.inversePixelTransform,this.pixelTransform);const ie=bi(this.pixelTransform);this.useContainer(t,ie,this.getBackground(e));const T=this.context,R=T.canvas;R.width!=x||R.height!=k?(R.width=x,R.height=k):this.containerReused||T.clearRect(0,0,x,k);let Re=!1,Oe=!0;if(h.extent){const ne=ot(h.extent,d.projection);Oe=Pt(ne,e.extent),Re=Oe&&!re(ne,e.extent),Re&&this.clipUnrotated(T,e,ne)}const se=i.getImage(),me=at(this.tempTransform,x/2,k/2,m,f,0,l*(s[0]-p[0])/r,l*(p[1]-s[3])/a);this.renderedResolution=a*c/l;const it=se.width*me[0],st=se.height*me[3];if(this.getLayer().getSource().getInterpolate()||(T.imageSmoothingEnabled=!1),this.preRender(T,e),Oe&&it>=.5&&st>=.5){const ne=me[4],hi=me[5],Ae=h.opacity;let nt;Ae!==1&&(nt=T.globalAlpha,T.globalAlpha=Ae),T.drawImage(se,0,0,+se.width,+se.height,ne,hi,it,st),Ae!==1&&(T.globalAlpha=nt)}return this.postRender(T,e),Re&&T.restore(),T.imageSmoothingEnabled=!0,ie!==R.style.transform&&(R.style.transform=ie),this.container}}const Ns=Fs;class js extends Ds{constructor(e){super(e)}createRenderer(){return new Ns(this)}getData(e){return super.getData(e)}}const Gs=js;function qe(o){return Array.isArray(o)?Math.min(...o):o}class Vs extends Mt{constructor(e,t,i,s,n,r,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let h=t.getExtent();h&&t.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const c=h?Tt(i,h):i,d=Lt(c),p=kt(e,t,d,s),u=Si,m=new xi(e,t,c,l,p*u,s),f=m.calculateSourceExtent(),v=It(f)?null:r(f,p,n),C=v?P.IDLE:P.EMPTY,b=v?v.getPixelRatio():1;super(i,s,b,C),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=m,this.targetResolution_=s,this.targetExtent_=i,this.sourceImage_=v,this.sourcePixelRatio_=b,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==P.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==P.LOADED){const t=Z(this.targetExtent_)/this.targetResolution_,i=X(this.targetExtent_)/this.targetResolution_;this.canvas_=Ci(t,i,this.sourcePixelRatio_,qe(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==P.IDLE){this.state=P.LOADING,this.changed();const e=this.sourceImage_.getState();e==P.LOADED||e==P.ERROR?this.reproject_():(this.sourceListenerKey_=Ze(this.sourceImage_,Pe.CHANGE,function(t){const i=this.sourceImage_.getState();(i==P.LOADED||i==P.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){Rt(this.sourceListenerKey_),this.sourceListenerKey_=null}}const zs=Vs,F=4,Ve={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class Hs extends Xe{constructor(e,t){super(e),this.image=t}}class Ws extends Ei{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=Ti(t,e,0);e=t[i]}return e}getImage(e,t,i,s){const n=this.getProjection();if(!n||!s||lt(n,s))return n&&(s=n),this.getImageInternal(e,t,i,s);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&lt(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==t&&Ot(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new zs(n,s,e,t,i,(r,a,l)=>this.getImageInternal(r,a,l,n),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,s){if(this.loader){const n=Jt(e,t,i,1),r=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===s&&(this.wantedExtent_&&re(this.wantedExtent_,n)||re(this.image.getExtent(),n))&&(this.wantedResolution_&&qe(this.wantedResolution_)===r||qe(this.image.getResolution())===r)))return this.image;this.wantedProjection_=s,this.wantedExtent_=n,this.wantedResolution_=r,this.image=new Mt(n,r,i,this.loader),this.image.addEventListener(Pe.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case P.LOADING:this.loading=!0,i=Ve.IMAGELOADSTART;break;case P.LOADED:this.loading=!1,i=Ve.IMAGELOADEND;break;case P.ERROR:this.loading=!1,i=Ve.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new Hs(i,t))}}function Us(o,e){o.getImage().src=e}function Jt(o,e,t,i){const s=e/t,n=Lt(o),r=_e(Z(o)/s,F),a=_e(X(o)/s,F),l=_e((i-1)*r/2,F),h=r+2*l,c=_e((i-1)*a/2,F),d=a+2*c;return At(n,s,0,[h,d])}const Bs=Ws,Qt="1.3.0",yt=[101,101];function ei(o,e,t,i,s){s.WIDTH=t[0],s.HEIGHT=t[1];const n=i.getAxisOrientation();let r;const a=Xt(s.VERSION,"1.3")>=0;return s[a?"CRS":"SRS"]=i.getCode(),a&&n.substr(0,2)=="ne"?r=[e[1],e[0],e[3],e[2]]:r=e,s.BBOX=r.join(","),Ut(o,s)}function $s(o,e,t,i,s,n,r){n=Object.assign({REQUEST:"GetMap"},n);const a=e/t,l=[ht(Z(o)/a,F),ht(X(o)/a,F)];if(t!=1)switch(r){case"geoserver":const c=90*t+.5|0;"FORMAT_OPTIONS"in n?n.FORMAT_OPTIONS+=";dpi:"+c:n.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":n.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":n.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return ei(s,o,l,i,n)}function ti(o,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Qt,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},o)}function qs(o){const e=o.hidpi===void 0?!0:o.hidpi,t=J(o.projection||"EPSG:3857"),i=o.ratio||1.5,s=o.load||Dt;return(n,r,a)=>{n=Jt(n,r,a,i),a!=1&&(!e||o.serverType===void 0)&&(a=1);const l=$s(n,r,a,t,o.url,ti(o.params,"GetMap"),o.serverType),h=new Image;return o.crossOrigin!==null&&(h.crossOrigin=o.crossOrigin),s(h,l).then(c=>({image:c,extent:n,pixelRatio:a}))}}function Ks(o,e,t){if(o.url===void 0)return;const i=J(o.projection||"EPSG:3857"),s=At(e,t,0,yt),n={QUERY_LAYERS:o.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(n,ti(o.params,"GetFeatureInfo"),o.params);const r=ct((e[0]-s[0])/t,F),a=ct((s[3]-e[1])/t,F),l=Xt(n.VERSION,"1.3")>=0;return n[l?"I":"X"]=r,n[l?"J":"Y"]=a,ei(o.url,s,yt,i,n)}function Ys(o,e){if(o.url===void 0)return;const t={SERVICE:"WMS",VERSION:Qt,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(o.params===void 0||o.params.LAYER===void 0){const i=o.params.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;t.LAYER=i}if(e!==void 0){const i=J(o.projection||"EPSG:3857").getMetersPerUnit()||1,s=28e-5;t.SCALE=e*i/s}return Object.assign(t,o.params),Ut(o.url,t)}class Zs extends Bs{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:Us,this.params_=e.params,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,t,i,s){const n=J(i),r=this.getProjection();r&&r!==n&&(t=kt(r,n,e,t),e=Ii(e,n,r));const a={url:this.url_,params:{...this.params_,...s},projection:r||n};return Ks(a,e,t)}getLegendUrl(e,t){return Ys({url:this.url_,params:{...this.params_,...t}},e)}getParams(){return this.params_}getImageInternal(e,t,i,s){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==s)&&(this.loaderProjection_=s,this.loader=qs({crossOrigin:this.crossOrigin_,params:this.params_,projection:s,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(n,r)=>(this.image.setImage(n),this.imageLoadFunction_(this.image,r),Dt(n))})),super.getImageInternal(e,t,i,s))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const Xs=Zs;function Js(o){let e=!1,t=setTimeout(()=>{e=!0,t=void 0,o()});return{reschedule(){return!e},cancel(){t&&clearTimeout(t)}}}var A;class ii extends Bt{constructor(t){super();I(this,A,void 0);E(this,A,t)}destroy(){for(const t of w(this,A))t.destroy();E(this,A,[])}getSublayers(t){return w(this,A).slice()}__getRawSublayers(){return w(this,A)}}A=new WeakMap;const Qs=Et("map:WMSLayer");var le,B,$,q,K,ce,Ke,Ie,si;class en extends Pi{constructor(t){const i=new Gs;super({...t,olLayer:i});I(this,ce);I(this,Ie);I(this,le,void 0);I(this,B,void 0);I(this,$,void 0);I(this,q,void 0);I(this,K,void 0);const s=new Xs({...t.sourceOptions,url:t.url,params:{...t.sourceOptions?.params}});E(this,le,t.url),E(this,K,s),E(this,q,i),E(this,B,new ii(ni(t.sublayers))),fe(this,ce,Ke).call(this)}get url(){return w(this,le)}get sublayers(){return w(this,B)}__attach(t){super.__attach(t);for(const i of w(this,B).getSublayers())i.__attach(t,this,this)}__updateSublayerVisibility(){w(this,$)?.reschedule()||E(this,$,Js(()=>{try{fe(this,ce,Ke).call(this),E(this,$,void 0)}catch(t){Qs.error(`Failed to update sublayer visibility on WMS layer '${this.id}'.`,t)}}))}}le=new WeakMap,B=new WeakMap,$=new WeakMap,q=new WeakMap,K=new WeakMap,ce=new WeakSet,Ke=function(){const t=fe(this,Ie,si).call(this);w(this,K).updateParams({LAYERS:t});const i=t.length===0?null:w(this,K);w(this,q).getSource()!==i&&w(this,q).setSource(i)},Ie=new WeakSet,si=function(){const t=[],i=s=>{if(!s.visible)return;const n=s.sublayers.__getRawSublayers();if(n.length)for(const r of n)i(r);else t.push(s.name)};for(const s of this.sublayers.__getRawSublayers())i(s);return t};var j,D,he,de,Y;class tn extends Mi{constructor(t){super(t);I(this,j,void 0);I(this,D,void 0);I(this,he,void 0);I(this,de,void 0);I(this,Y,void 0);E(this,he,t.name),E(this,Y,t.visible??!0),E(this,de,new ii(ni(t.sublayers)))}get name(){return w(this,he)}get sublayers(){return w(this,de)}get parent(){const t=w(this,j);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}get parentLayer(){const t=w(this,D);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}__attach(t,i,s){if(super.__attachToMap(t),w(this,j))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent '${w(this,j).id}'`);if(E(this,j,s),w(this,D))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent layer '${w(this,D).id}'`);E(this,D,i);for(const n of this.sublayers.__getRawSublayers())n.__attach(t,i,this)}get visible(){return w(this,Y)}setVisible(t){this.visible!==t&&(E(this,Y,t),w(this,D)?.__updateSublayerVisibility(),this.__emitChangeEvent("changed:visible"))}}j=new WeakMap,D=new WeakMap,he=new WeakMap,de=new WeakMap,Y=new WeakMap;function ni(o=[]){const e=[];try{for(const t of o)e.push(new tn(t));return e}catch(t){for(;e.length;)e.pop()?.destroy();throw new Error("Failed to construct sublayers.",{cause:t})}}const oi=en,sn=25.4/.28,nn=39.37;function et(o){return tt(o,on,rn)}function on(o){return o.getView()}function rn(o,e){return o.on("change:view",e)}function ri(o){return et(o)?.getProjection()}function an(o){const e=et(o);return tt(e,ln,cn)}function ln(o){return o.getResolution()}function cn(o,e){return o.on("change:resolution",e)}function hn(o){const e=et(o);return tt(e,dn,un)}function dn(o){return o.getCenter()}function un(o,e){return o.on("change:center",e)}function gn(o){const e=hn(o),t=an(o),i=ri(o);return _.useMemo(()=>{if(i==null||t==null||e==null)return;const n=$e(i,t,e);return Math.round(n*nn*sn)},[i,t,e])}function tt(o,e,t){const i=_.useCallback(()=>o?e(o):void 0,[o,e]),s=_.useCallback(n=>{if(!o)return()=>{};const r=t(o,n);return()=>W(r)},[o,t]);return _.useSyncExternalStore(s,i)}class ke extends Li{constructor(e,t,i){super(),i!==void 0&&t===void 0?this.setFlatCoordinates(i,e):(t=t||0,this.setCenterAndRadius(e,t,i))}clone(){const e=new ke(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,s){const n=this.flatCoordinates,r=e-n[0],a=t-n[1],l=r*r+a*a;if(l<s){if(l===0)for(let h=0;h<this.stride;++h)i[h]=n[h];else{const h=this.getRadius()/Math.sqrt(l);i[0]=n[0]+h*r,i[1]=n[1]+h*a;for(let c=2;c<this.stride;++c)i[c]=n[c]}return i.length=this.stride,l}return s}containsXY(e,t){const i=this.flatCoordinates,s=e-i[0],n=t-i[1];return s*s+n*n<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,i=t[this.stride]-t[0];return ki(t[0]-i,t[1]-i,t[0]+i,t[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(Pt(e,t)){const i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]?!0:Ri(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,i=this.flatCoordinates[t]-this.flatCoordinates[0],s=e.slice();s[t]=s[0]+i;for(let n=1;n<t;++n)s[t+n]=e[n];this.setFlatCoordinates(this.layout,s),this.changed()}setCenterAndRadius(e,t,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const s=this.flatCoordinates;let n=Oi(s,0,e,this.stride);s[n++]=s[0]+t;for(let r=1,a=this.stride;r<a;++r)s[n++]=s[r];s.length=n,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const i=this.getCenter(),s=this.getStride();this.setCenter(Ai(i,0,i.length,s,e,t,i)),this.changed()}}ke.prototype.transform;const pn=ke,M="main";class mn{mapId=M;async getMapConfig(){return{initialView:{kind:"position",center:{x:404747,y:5757920},zoom:14},projection:"EPSG:25832",layers:[new V({id:"topplus_open",title:"TopPlus Open",isBaseLayer:!0,visible:!0,olLayer:ze("web")}),new V({id:"topplus_open_grau",title:"TopPlus Open (Grau)",isBaseLayer:!0,visible:!1,olLayer:ze("web_grau")}),new V({id:"topplus_open_light",title:"TopPlus Open (Light)",isBaseLayer:!0,visible:!1,olLayer:ze("web_light")}),new V({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new Je({source:new Ft})}),new V({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:fn()}),new V({title:"Kindertagesstätten",visible:!0,olLayer:_n()}),vn(),yn()]}}}function ze(o){const e=[-380316598427299e-8,880590808284866e-8],t=[4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.874056570353,76.4370282851763,38.2185141425881,19.1092570712941,9.55462853564703,4.77731426782352,2.38865713391176,1.19432856695588,.59716428347794],i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=n;const s=new fs({url:`https://sgx.geodatenzentrum.de/wmts_topplus_open/tile/1.0.0/${o}/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png`,layer:"web_grau",matrixSet:"EU_EPSG_25832_TOPPLUS",format:"image/png",projection:"EPSG:25832",requestEncoding:"REST",tileGrid:new _s({origin:e,resolutions:t,matrixIds:i}),style:"default",attributions:`Kartendarstellung und Präsentationsgraphiken: © Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html" target="_blank">Datenquellen</a>`});return new Je({source:s})}function fn(){const o=new ue({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new $t,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new ge({source:o})}function _n(){const o=new ue({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new $t,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new ge({source:o})}function vn(){return new oi({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW"}],sourceOptions:{ratio:1}})}function yn(){return new oi({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",sublayers:[{name:"1",title:"Verwaltungen"},{name:"4",title:"Abschnitte und Äste"},{name:"6",title:"Unfälle"}]})}const ye={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class we extends Xe{constructor(e,t){super(e),this.feature=t}}function wn(o,e){const t=[];for(let i=0;i<e.length;++i){const n=e[i].getGeometry();ai(o,n,t)}return t}function be(o,e){return jt(o[0],o[1],e[0],e[1])}function z(o,e){const t=o.length;return e<0?o[e+t]:e>=t?o[e-t]:o[e]}function xe(o,e,t){let i,s;e<t?(i=e,s=t):(i=t,s=e);const n=Math.ceil(i),r=Math.floor(s);if(n>r){const l=H(o,i),h=H(o,s);return be(l,h)}let a=0;if(i<n){const l=H(o,i),h=z(o,n);a+=be(l,h)}if(r<s){const l=z(o,r),h=H(o,s);a+=be(l,h)}for(let l=n;l<r-1;++l){const h=z(o,l),c=z(o,l+1);a+=be(h,c)}return a}function ai(o,e,t){if(e instanceof U){Ce(o,e.getCoordinates(),!1,t);return}if(e instanceof qt){const i=e.getCoordinates();for(let s=0,n=i.length;s<n;++s)Ce(o,i[s],!1,t);return}if(e instanceof Me){const i=e.getCoordinates();for(let s=0,n=i.length;s<n;++s)Ce(o,i[s],!0,t);return}if(e instanceof Kt){const i=e.getCoordinates();for(let s=0,n=i.length;s<n;++s){const r=i[s];for(let a=0,l=r.length;a<l;++a)Ce(o,r[a],!0,t)}return}if(e instanceof ws){const i=e.getGeometries();for(let s=0;s<i.length;++s)ai(o,i[s],t);return}}const He={index:-1,endIndex:NaN};function bn(o,e,t,i){const s=o[0],n=o[1];let r=1/0,a=-1,l=NaN;for(let d=0;d<e.targets.length;++d){const p=e.targets[d],u=p.coordinates;let m=1/0,f;for(let v=0;v<u.length-1;++v){const C=u[v],b=u[v+1],x=li(s,n,C,b);x.squaredDistance<m&&(m=x.squaredDistance,f=v+x.along)}m<r&&(r=m,p.ring&&e.targetIndex===d&&(p.endIndex>p.startIndex?f<p.startIndex&&(f+=u.length):p.endIndex<p.startIndex&&f>p.startIndex&&(f-=u.length)),l=f,a=d)}const h=e.targets[a];let c=h.ring;if(e.targetIndex===a&&c){const d=H(h.coordinates,l),p=t.getPixelFromCoordinate(d);Nt(p,e.startPx)>i&&(c=!1)}if(c){const d=h.coordinates,p=d.length,u=h.startIndex,m=l;if(u<m){const f=xe(d,u,m);xe(d,u,m-p)<f&&(l-=p)}else{const f=xe(d,u,m);xe(d,u,m+p)<f&&(l+=p)}}return He.index=a,He.endIndex=l,He}function Ce(o,e,t,i){const s=o[0],n=o[1];for(let r=0,a=e.length-1;r<a;++r){const l=e[r],h=e[r+1],c=li(s,n,l,h);if(c.squaredDistance===0){const d=r+c.along;i.push({coordinates:e,ring:t,startIndex:d,endIndex:d});return}}}const We={along:0,squaredDistance:0};function li(o,e,t,i){const s=t[0],n=t[1],r=i[0],a=i[1],l=r-s,h=a-n;let c=0,d=s,p=n;return(l!==0||h!==0)&&(c=$i(((o-s)*l+(e-n)*h)/(l*l+h*h),0,1),d+=l*c,p+=h*c),We.along=c,We.squaredDistance=Ui(jt(o,e,d,p),10),We}function H(o,e){const t=o.length;let i=Math.floor(e);const s=e-i;i>=t?i-=t:i<0&&(i+=t);let n=i+1;n>=t&&(n-=t);const r=o[i],a=r[0],l=r[1],h=o[n],c=h[0]-a,d=h[1]-l;return[a+c*s,l+d*s]}class xn extends Di{constructor(e){const t=e;t.stopDown||(t.stopDown=Fi),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=Sn(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Ni,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let i=e.geometryFunction;if(!i){const s=this.mode_;if(s==="Circle")i=function(n,r,a){const l=r||new pn([NaN,NaN]),h=dt(n[0]),c=ji(h,dt(n[n.length-1]));return l.setCenterAndRadius(h,Math.sqrt(c),this.geometryLayout_),l};else{let n;s==="Point"?n=Ee:s==="LineString"?n=U:s==="Polygon"&&(n=Me),i=function(r,a,l){return a?s==="Polygon"?r[0].length?a.setCoordinates([r[0].concat([r[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(r,this.geometryLayout_):a=new n(r,this.geometryLayout_),a}}}this.geometryFunction_=i,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new ge({source:new ue({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:Cn(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Gi,this.freehandCondition_,e.freehand?this.freehandCondition_=ut:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Vi,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(zi.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=ut:t=e:t=Bi,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===Pe.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===O.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===O.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===O.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===O.POINTERDOWN?i=!1:t&&this.getPointerCount()<2?(i=e.type===O.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===O.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===O.DBLCLICK&&(i=!1),super.handleEvent(e)&&i}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new Hi(O.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),i=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),s=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),n=Wi([i,s]),r=this.traceSource_.getFeaturesInExtent(n);if(r.length===0)return;const a=wn(e.coordinate,r);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const i=e.startIndex<=e.endIndex,s=e.startIndex<=t;i===s?i&&t>e.endIndex||!i&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(i&&t<e.endIndex||!i&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let i=0;if(e<t){const s=Math.ceil(e);let n=Math.floor(t);n===t&&(n-=1),i=n-s+1}else{const s=Math.floor(e);let n=Math.ceil(t);n===t&&(n+=1),i=s-n+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(e,t,i){if(t===i)return;const s=[];if(t<i){const n=Math.ceil(t);let r=Math.floor(i);r===i&&(r-=1);for(let a=n;a<=r;++a)s.push(z(e.coordinates,a))}else{const n=Math.floor(t);let r=Math.ceil(i);r===i&&(r+=1);for(let a=n;a>=r;--a)s.push(z(e.coordinates,a))}s.length&&this.appendCoordinates(s)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&Nt(t.startPx,e.pixel)<this.snapTolerance_)return;const i=bn(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==i.index){if(t.targetIndex!==-1){const l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=t.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,i.endIndex)}t.targetIndex=i.index;const s=t.targets[t.targetIndex];s.endIndex=i.endIndex;const n=H(s.coordinates,s.endIndex),r=this.getMap().getPixelFromCoordinate(n);e.coordinate=n,e.pixel=[Math.round(r[0]),Math.round(r[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const i=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const s=!this.finishCoordinate_;s&&this.startDrawing_(e.coordinate),!s&&this.freehand_?this.finishDrawing():!this.freehand_&&(!s||this.mode_==="Point")&&(this.atFinish_(e.pixel,i)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,i=e.pixel,s=t[0]-i[0],n=t[1]-i[1],r=s*s+n*n;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let i=!1;if(this.sketchFeature_){let s=!1,n=[this.finishCoordinate_];const r=this.mode_;if(r==="Point")i=!0;else if(r==="Circle")i=this.sketchCoords_.length===2;else if(r==="LineString")s=!t&&this.sketchCoords_.length>this.minPoints_;else if(r==="Polygon"){const a=this.sketchCoords_;s=a[0].length>this.minPoints_,n=[a[0][0],a[0][a[0].length-2]],t?n=[a[0][0]]:n=[a[0][0],a[0][a[0].length-2]]}if(s){const a=this.getMap();for(let l=0,h=n.length;l<h;l++){const c=n[l],d=a.getPixelFromCoordinate(c),p=e[0]-d[0],u=e[1]-d[1],m=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(p*p+u*u)<=m,i){this.finishCoordinate_=c;break}}}}return i}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new N(new Ee(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new N);const t=e.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),i.changed()):(i=new U(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(e){const t=this.getMap().getView().getProjection(),i=gt(this.geometryLayout_);for(;e.length<i;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new N(new U(this.sketchLineCoords_)));const s=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new N,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(s),this.updateSketchFeatures_(),this.dispatchEvent(new we(ye.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),i=this.sketchFeature_.getGeometry(),s=t.getView().getProjection(),n=gt(this.geometryLayout_);let r,a;for(;e.length<n;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(r=this.sketchCoords_[0],a=r[r.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(r=this.sketchCoords_,a=r[r.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let s,n;const r=this.mode_;r==="LineString"||r==="Circle"?(this.finishCoordinate_=e.slice(),n=this.sketchCoords_,n.length>=this.maxPoints_&&(this.freehand_?n.pop():s=!0),n.push(e.slice()),this.geometryFunction_(n,t,i)):r==="Polygon"&&(n=this.sketchCoords_[0],n.length>=this.maxPoints_&&(this.freehand_?n.pop():s=!0),n.push(e.slice()),s&&(this.finishCoordinate_=n[0]),this.geometryFunction_(this.sketchCoords_,t,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),s&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),s=this.mode_;for(let n=0;n<e;++n){let r;if(s==="LineString"||s==="Circle"){if(r=this.sketchCoords_,r.splice(-2,1),r.length>=2){this.finishCoordinate_=r[r.length-2].slice();const a=this.finishCoordinate_.slice();r[r.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(r,t,i),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(s==="Polygon"){r=this.sketchCoords_[0],r.splice(-2,1);const a=this.sketchLine_.getGeometry();if(r.length>=2){const l=r[r.length-2].slice();r[r.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(r),this.geometryFunction_(this.sketchCoords_,t,i)}if(r.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const i=e.getGeometry(),s=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,i,s)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,i,s),t=i.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new vs([t])):this.type_==="MultiLineString"?e.setGeometry(new qt([t])):this.type_==="MultiPolygon"&&e.setGeometry(new Kt([t])),this.dispatchEvent(new we(ye.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new we(ye.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,i=!this.sketchFeature_;i&&this.startDrawing_(e[0]);let s;if(t==="LineString"||t==="Circle")s=this.sketchCoords_;else if(t==="Polygon")s=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;i&&s.shift(),s.pop();for(let r=0;r<e.length;r++)this.addToDrawing_(e[r]);const n=e[e.length-1];this.addToDrawing_(n),this.modifyDrawing_(n)}extend(e){const i=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=i.getCoordinates();const s=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=s.slice(),this.sketchCoords_.push(s.slice()),this.sketchPoint_=new N(new Ee(s)),this.updateSketchFeatures_(),this.dispatchEvent(new we(ye.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function Cn(){const o=ys();return function(e,t){return o[e.getGeometry().getType()]}}function Sn(o){switch(o){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+o)}}const En=xn;class Tn{constructor({properties:e}){const t=e.logLevel;console.debug("Log Service created with log level",t)}destroy(){console.debug("Log Service destroyed")}log(e){console.info("LOG: "+e)}}const In={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:mn,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{}}},ui:{references:[{name:"map-sample-logging.LogService",qualifier:void 0,all:!1},{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Ts,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:qi,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"map-sample-logging":{name:"map-sample-logging",services:{LogService:{name:"LogService",clazz:Tn,provides:[{name:"map-sample-logging.LogService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{logLevel:{value:"INFO",required:!1}}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{},ui:{references:[]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/test-utils":{name:"@open-pioneer/test-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-test-utils":{name:"@open-pioneer/map-test-utils",services:{},ui:{references:[]},properties:{}}},Pn=`:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}
`,Mn=["en","de"];function Ln(o){switch(o){case"en":return pt(()=>import("./e7d27b504978.js"),[],import.meta.url).then(e=>e.default);case"de":return pt(()=>import("./f506bfd0aeb5.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${o}'`)}const kn=ui(Pn),Rn=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Ln,locales:Mn,packages:In,styles:kn},Symbol.toStringTag,{value:"Module"})),On="@open-pioneer/coordinate-viewer",An=pe.bind(void 0,On),Dn=4,Fn=o=>{const{mapId:e,precision:t}=o,{containerProps:i}=te("coordinate-viewer",o),{map:s}=ee(e),n=s?.olMap,{coordinates:r}=jn(n),a=Nn(r,t),l=ri(n)?.getCode()??"",h=a?a+" "+l:"";return g.jsx(L,{...i,children:g.jsx(Qe,{className:"coordinate-viewer-text",children:h})})};function Nn(o,e){const t=An();return o?Gn(o,e,t):""}function jn(o){const[e,t]=_.useState();return _.useEffect(()=>{if(!o)return;const i=o.on("pointermove",s=>{t(s.coordinate)});return()=>W(i)},[o]),{coordinates:e}}function Gn(o,e,t){if(o[0]==null||o[1]==null)return"";const i=e??Dn,[s,n]=o,r=t.formatNumber(s,{maximumFractionDigits:i,minimumFractionDigits:i}),a=t.formatNumber(n,{maximumFractionDigits:i,minimumFractionDigits:i});return r+" "+a}const Vn="@open-pioneer/measurement",zn=pe.bind(void 0,Vn),S={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Hn extends Gt{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+Ki,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(S.ELEMENT,this.handleElementChanged),this.addChangeListener(S.MAP,this.handleMapChanged),this.addChangeListener(S.OFFSET,this.handleOffsetChanged),this.addChangeListener(S.POSITION,this.handlePositionChanged),this.addChangeListener(S.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(S.ELEMENT)}getId(){return this.id}getMap(){return this.get(S.MAP)||null}getOffset(){return this.get(S.OFFSET)}getPosition(){return this.get(S.POSITION)}getPositioning(){return this.get(S.POSITIONING)}handleElementChanged(){Yi(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(Zi(this.element),Rt(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Ze(e,Vt.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(S.ELEMENT,e)}setMap(e){this.set(S.MAP,e)}setOffset(e){this.set(S.OFFSET,e)}setPosition(e){this.set(S.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(S.POSITION))return;const i=this.getRect(t.getTargetElement(),t.getSize()),s=this.getElement(),n=this.getRect(s,[Xi(s),Ji(s)]);e=e||{};const r=e.margin===void 0?20:e.margin;if(!re(i,n)){const a=n[0]-i[0],l=i[2]-n[2],h=n[1]-i[1],c=i[3]-n[3],d=[0,0];if(a<0?d[0]=a-r:l<0&&(d[0]=Math.abs(l)+r),h<0?d[1]=h-r:c<0&&(d[1]=Math.abs(c)+r),d[0]!==0||d[1]!==0){const p=t.getView().getCenterInternal(),u=t.getPixelFromCoordinateInternal(p);if(!u)return;const m=[u[0]+d[0],u[1]+d[1]],f=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(m),duration:f.duration,easing:f.easing})}}}getRect(e,t){const i=e.getBoundingClientRect(),s=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[s,n,s+t[0],n+t[1]]}setPositioning(e){this.set(S.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(t),s=e.getSize();this.updateRenderedPosition(i,s)}updateRenderedPosition(e,t){const i=this.element.style,s=this.getOffset(),n=this.getPositioning();this.setVisible(!0);const r=Math.round(e[0]+s[0])+"px",a=Math.round(e[1]+s[1])+"px";let l="0%",h="0%";n=="bottom-right"||n=="center-right"||n=="top-right"?l="-100%":(n=="bottom-center"||n=="center-center"||n=="top-center")&&(l="-50%"),n=="bottom-left"||n=="bottom-center"||n=="bottom-right"?h="-100%":(n=="center-left"||n=="center-center"||n=="center-right")&&(h="-50%");const c=`translate(${l}, ${h}) translate(${r}, ${a})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,i.transform=c)}getOptions(){return this.options}}const Ye=Hn;class Wn{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const i=this.source=new ue;this.layer=new ge({source:i}),this.layer.setZIndex(zt),e.addLayer(this.layer);const s=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){W(s)}});const n=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",n),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",n)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=bs(e);this.activeFeatureStyle=(i,...s)=>{const n=i?.getGeometry()?.getType();if(n==="Polygon"||n==="LineString"||n==="Point")return t(i,...s)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",i=this.draw=new En({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(i);let s,n;i.on("drawstart",r=>{s=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=r.feature;if(!a)return;let l;n=a.getGeometry()?.on("change",h=>{const c=h.target,d=this.olMap.getView().getProjection();let p="";c instanceof Me?(p=Bn(c,d,this.messages),l=c.getInteriorPoint().getCoordinates()||null):c instanceof U&&(p=$n(c,d,this.messages),l=c.getLastCoordinate()||null),s&&(s.element.innerHTML=p,l&&s?.overlay.setPosition(l))})}),i.on("drawend",()=>{if(s){const r=s.element.classList;r.remove("measurement-active-tooltip"),r.add("measurement-finished-tooltip"),s.overlay.setOffset([0,-7]),this.overlayTooltips.push(s),this.measureTooltip=s=void 0}this.sketch=void 0,n&&W(n)}),i.on("drawabort",()=>{s&&(s.destroy(),this.measureTooltip=s=void 0),this.sketch=void 0,n&&W(n)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip";const t=new Ye({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),i=this.olMap;return i.addOverlay(t),{overlay:t,element:e,destroy(){i.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip hidden";const t=new Ye({element:e,offset:[15,0],positioning:"center-left"}),i=this.olMap;return i.addOverlay(t),{overlay:t,element:e,destroy(){i.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,i=Un(this.messages,this.sketch);t.element.textContent=i,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function Un(o,e){if(e){const t=e.getGeometry();if(t instanceof Me||t instanceof U)return o.getContinueMessage()}return o.getHelpMessage()}function Bn(o,e,t){const i=Qi(o,{projection:e});let s;return i>=1e6?s=`${t.formatNumber(i/1e6)} km<sup>2</sup>`:s=`${t.formatNumber(i)} m<sup>2</sup>`,s}function $n(o,e,t){const i=es(o,{projection:e});let s;return i>=1e3?s=`${t.formatNumber(i/1e3)} km`:s=`${t.formatNumber(i)} m`,s}const qn=o=>{const e=zn(),{mapId:t,activeFeatureStyle:i,finishedFeatureStyle:s}=o,{containerProps:n}=te("measurement",o),[r,a]=_.useState("distance"),l=u=>e.formatMessage({id:u}),h=ee(t),c=Kn(h.map,e);_.useEffect(()=>{c?.setActiveFeatureStyle(i??Yn())},[c,i]),_.useEffect(()=>{c?.setFinishedFeatureStyle(s??Zn())},[c,s]),_.useEffect(()=>{if(c)return c.startMeasurement(r),()=>{c.stopMeasurement()}},[c,r]);function d(u){if(u==="distance"||u==="area")a(u);else throw new Error(`Unexpected measurement type: '${u}'.`)}function p(){c?.clearMeasurements()}return g.jsxs(L,{...n,children:[g.jsx(Qe,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),g.jsx(Ms,{mb:4,alignItems:"center",children:g.jsxs(Zt,{mb:2,children:[g.jsx(Ls,{mb:1,children:l("measurementLabel")}),g.jsxs(Rs,{value:r,onChange:u=>d(u.target.value),className:"measurement-select",children:[g.jsx("option",{value:"distance",children:l("distance")}),g.jsx("option",{value:"area",children:l("area")})]})]})}),g.jsx(gi,{padding:2,className:"measurement-delete-button",onClick:p,width:"100%",children:l("deleteMeasurementLabel")})]})};function Kn(o,e){const[t,i]=_.useState(void 0);return _.useEffect(()=>{if(!o)return;const s=new Wn(o.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(n){return e.formatNumber(n,{maximumFractionDigits:2})}});return i(s),()=>{s.destroy(),i(void 0)}},[o,e]),t}function Yn(){return[new Q({stroke:new G({color:"#fff",lineDash:[10,10],width:5})}),new Q({fill:new ae({color:"rgba(0,0,0,0.15)"}),stroke:new G({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new Yt({radius:5,stroke:new G({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new ae({color:"rgba(255, 255, 255, 0.2)"})})})]}function Zn(){return[new Q({stroke:new G({color:"#fff",width:5})}),new Q({stroke:new G({color:"#0b96fc",width:3}),fill:new ae({color:"rgba(11,150,252,0.15)"})})]}const Ue=.75,Se=.1;let Xn=class extends Ht{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",i=e.tipLabel!==void 0?e.tipLabel:"Overview map",s=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s):this.collapseLabel_=s;const n=e.label!==void 0?e.label:"›";typeof n=="string"?(this.label_=document.createElement("span"),this.label_.textContent=n):this.label_=n;const r=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=i,a.appendChild(r),a.addEventListener(Pe.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const l=new ts({view:e.view,controls:new mt,interactions:new mt});this.ovmap_=l,e.layers&&e.layers.forEach(function(b){l.addLayer(b)});const h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",this.boxOverlay_=new Ye({position:[0,0],positioning:"center-center",element:h}),this.ovmap_.addOverlay(this.boxOverlay_);const c=t+" "+Wt+" "+is+(this.collapsed_&&this.collapsible_?" "+ft:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=c,d.appendChild(this.ovmapDiv_),d.appendChild(a);const p=this,u=this.boxOverlay_,m=this.boxOverlay_.getElement(),f=function(b){return{clientX:b.clientX,clientY:b.clientY}},v=function(b){const x=f(b),k=l.getEventCoordinateInternal(x);u.setPosition(k)},C=function(b){const x=l.getEventCoordinateInternal(b);p.getMap().getView().setCenterInternal(x),window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",C)};m.addEventListener("mousedown",function(){window.addEventListener("mousemove",v),window.addEventListener("mouseup",C)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const i=t.getView();i&&this.unbindView_(i),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(Ze(e,ss.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const i=e.getView();i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===Fe.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const i=this.getMap().getView();this.bindView_(i)}else!this.ovmap_.isRendered()&&(e.key===Fe.TARGET||e.key===Fe.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new ns({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(_t.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(_t.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),n=e.getView().calculateExtentInternal(i);if(this.viewExtent_&&Ot(n,this.viewExtent_))return;this.viewExtent_=n;const r=t.getSize(),l=t.getView().calculateExtentInternal(r),h=t.getPixelFromCoordinateInternal(os(n)),c=t.getPixelFromCoordinateInternal(rs(n)),d=Math.abs(h[0]-c[0]),p=Math.abs(h[1]-c[1]),u=r[0],m=r[1];d<u*Se||p<m*Se||d>u*Ue||p>m*Ue?this.resetExtent_():re(l,n)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,i=e.getSize(),n=e.getView().calculateExtentInternal(i),r=t.getView(),a=Math.log(Ue/Se)/Math.LN2,l=1/(Math.pow(2,a/2)*Se);as(n,l),r.fitInternal(ls(n))}recenter_(){const e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),s=e.getView(),n=t.getView(),r=this.rotateWithView_?0:-s.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),h=s.getCenterInternal(),c=s.getResolution(),d=n.getResolution(),p=i[0]*c/d,u=i[1]*c/d;if(a.setPosition(h),l){l.style.width=p+"px",l.style.height=u+"px";const m="rotate("+r+"rad)";l.style.transform=m}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=cs(this.ovmap_,Vt.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(ft),this.collapsed_?vt(this.collapseLabel_,this.label_):vt(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const Jn=Xn,Be="units",Qn=[1,2,5],oe=25.4/.28;class eo extends Ht{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Wt,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(Be,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(Be)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(Be,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,i=e.projection,s=this.getUnits(),n=s=="degrees"?"degrees":"m";let r=$e(i,e.resolution,t,n);const a=this.minWidth_*(this.dpi_||oe)/oe,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||oe)/oe:void 0;let h=a*r,c="";if(s=="degrees"){const x=hs.degrees;h*=x,h<x/60?(c="″",r*=3600):h<x?(c="′",r*=60):c="°"}else if(s=="imperial")h<.9144?(c="in",r/=.0254):h<1609.344?(c="ft",r/=.3048):(c="mi",r/=1609.344);else if(s=="nautical")r/=1852,c="NM";else if(s=="metric")h<.001?(c="μm",r*=1e6):h<1?(c="mm",r*=1e3):h<1e3?c="m":(c="km",r/=1e3);else if(s=="us")h<.9144?(c="in",r*=39.37):h<1609.344?(c="ft",r/=.30480061):(c="mi",r/=1609.3472);else throw new Error("Invalid units");let d=3*Math.floor(Math.log(a*r)/Math.log(10)),p,u,m,f,v,C;for(;;){m=Math.floor(d/3);const x=Math.pow(10,m);if(p=Qn[(d%3+3)%3]*x,u=Math.round(p/r),isNaN(u)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&u>=l){p=f,u=v,m=C;break}else if(u>=a)break;f=p,v=u,C=m,++d}const b=this.scaleBar_?this.createScaleBar(u,p,c):p.toFixed(m<0?-m:0)+" "+c;this.renderedHTML_!=b&&(this.innerElement_.innerHTML=b,this.renderedHTML_=b),this.renderedWidth_!=u&&(this.innerElement_.style.width=u+"px",this.renderedWidth_=u),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,i){const s=this.getScaleForResolution(),n=s<1?Math.round(1/s).toLocaleString()+" : 1":"1 : "+Math.round(s).toLocaleString(),r=this.scaleBarSteps_,a=e/r,l=[this.createMarker("absolute")];for(let c=0;c<r;++c){const d=c%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${d}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(c%2===0||r===2?this.createStepText(c,e,!1,t,i):"")+"</div>")}return l.push(this.createStepText(r,e,!0,t,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+n+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,i,s,n){const a=(e===0?0:Math.round(s/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+n),l=e===0?-3:t/this.scaleBarSteps_*-1,h=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${h}px;left: ${i?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=$e(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||oe,i=1e3/25.4;return e*i*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const to=eo,io="200px",so="300px",no=o=>{const{mapId:e,olLayer:t,height:i=io,width:s=so}=o,{containerProps:n}=te("overview-map",o),r=_.useRef(null),{map:a}=ee(e);return _.useEffect(()=>{if(r.current&&a&&t){const l=a.olMap,h=new Jn({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:r.current});return l.addControl(h),()=>{l.removeControl(h)}}},[a,t]),g.jsx(L,{height:i,width:s,ref:r,...n})},oo="@open-pioneer/scale-viewer",ro=pe.bind(void 0,oo),ao=o=>{const{mapId:e}=o,{containerProps:t}=te("scale-viewer",o),{map:i}=ee(e),s=ro(),n=gn(i?.olMap),r=n?s.formatNumber(n):void 0;return g.jsx(L,{...t,children:r&&g.jsxs(Qe,{children:["1:",r]})})},lo=o=>{const{mapId:e,displayMode:t="line"}=o,{containerProps:i}=te("scale-bar",o),{map:s}=ee(e),n=_.useRef(null);return _.useEffect(()=>{if(n.current&&s){const r=s.olMap,a=new to({units:"metric",target:n.current,bar:t==="bar"});return r.addControl(a),()=>{r.removeControl(a)}}},[t,s]),g.jsx(L,{...i,ref:n})},co="ol-map",ho=pe.bind(void 0,co);function uo(o){return Le({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128ZM40,70H216a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12ZM216,186H40a6,6,0,0,0,0,12H216a6,6,0,0,0,0-12Z"}}]})(o)}function go(o){return Le({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M233.91,74.79,181.22,22.1a14,14,0,0,0-19.8,0L22.09,161.41a14,14,0,0,0,0,19.8L74.78,233.9a14,14,0,0,0,19.8,0L233.91,94.59A14,14,0,0,0,233.91,74.79ZM225.42,86.1,86.1,225.41h0a2,2,0,0,1-2.83,0L30.58,172.73a2,2,0,0,1,0-2.83L64,136.48l27.76,27.76a6,6,0,1,0,8.48-8.48L72.48,128,96,104.48l27.76,27.76a6,6,0,0,0,8.48-8.48L104.48,96,128,72.49l27.76,27.75a6,6,0,0,0,8.48-8.48L136.49,64,169.9,30.59a2,2,0,0,1,2.83,0l52.69,52.68A2,2,0,0,1,225.42,86.1Z"}}]})(o)}function po(o){return Le({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM104,52.94l48,24V203.06l-48-24ZM40,62.25l48-12v127.5l-48,12Zm176,131.5-48,12V78.25l48-12Z"}}]})(o)}const ci="@open-pioneer/geolocation",mo=Ps.bind(void 0,ci),fo=pe.bind(void 0,ci);function _o(o){return Le({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(o)}const y={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},vo={ERROR:"error"};class yo extends Xe{constructor(e){super(vo.ERROR),this.code=e.code,this.message=e.message}}let wo=class extends Gt{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=ds,this.watchId_=void 0,this.addChangeListener(y.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(y.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=us(J("EPSG:4326"),e),this.position_&&this.set(y.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(y.ACCURACY,t.accuracy),this.set(y.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(y.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(y.HEADING,t.heading===null?void 0:gs(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const i=this.transform_(this.position_);this.set(y.POSITION,i.slice()),this.set(y.SPEED,t.speed===null?void 0:t.speed);const s=ps(this.position_,t.accuracy);s.applyTransform(this.transform_),this.set(y.ACCURACY_GEOMETRY,s),this.changed()}positionError_(e){this.dispatchEvent(new yo(e))}getAccuracy(){return this.get(y.ACCURACY)}getAccuracyGeometry(){return this.get(y.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(y.ALTITUDE)}getAltitudeAccuracy(){return this.get(y.ALTITUDE_ACCURACY)}getHeading(){return this.get(y.HEADING)}getPosition(){return this.get(y.POSITION)}getProjection(){return this.get(y.PROJECTION)}getSpeed(){return this.get(y.SPEED)}getTracking(){return this.get(y.TRACKING)}getTrackingOptions(){return this.get(y.TRACKING_OPTIONS)}setProjection(e){this.set(y.PROJECTION,J(e))}setTracking(e){this.set(y.TRACKING,e)}setTrackingOptions(e){this.set(y.TRACKING_OPTIONS,e)}};const bo=wo,wt=Et("geolocation:GeolocationController"),bt=1.2,xt=17;class xo extends Bt{olMap;positionHighlightLayer;geolocation;maxZoom=xt;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new N,this.accuracyFeature.setStyle(St()),this.positionFeature=new N,this.positionFeature.setStyle(Ct()),this.positionHighlightLayer=new ge({source:new ue({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(zt);const i=t||Co();this.geolocation=new bo({tracking:!1,trackingOptions:i,projection:e.getView()?.getProjection()}),this.trackingOptions=i,this.geolocation.on("error",s=>this.handleGeolocationError(s))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(i=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const s=this.geolocation.on("change:accuracyGeometry",()=>{const l=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(l),this.accuracyFeature?.getGeometry()!==void 0&&i(),this.isInitialZoom){const h=this?.accuracyFeature?.getGeometry()?.getExtent();if(h){const c=this.calculateBufferedExtent(h);if(!c)return;e.getView().fit(c,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),n=this.geolocation.on("change:position",()=>{const l=this.geolocation.getPosition();l&&(l[0]||l[1])!==void 0&&(this.positionFeature?.setGeometry(new Ee(l)),this.setMapToPosition&&e.getView().setCenter(l),this.positionFeature?.getGeometry()!==void 0&&i())}),r=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",l=>{l.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(s,n,r,a),e.addLayer(this.positionHighlightLayer)}).catch(i=>{wt.error("Failed to determine location",i)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{W(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??Ct())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??St())}setMaxZoom(e){this.maxZoom=e??xt}calculateBufferedExtent(e){let t;if(e&&e[0]!=null&&e[1]!=null&&e[2]!=null&&e[3]!=null){const i=X(e),s=Z(e),n=i*bt,r=s*bt;t=[e[0]-(n-i)/2,e[1]-(r-s)/2,e[2]+(n-i)/2,e[3]+(r-s)/2]}return t}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){wt.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const Ct=()=>new Q({image:new Yt({radius:6,fill:new ae({color:"#3399CC"}),stroke:new G({color:"#fff",width:2})})}),St=()=>new Q({stroke:new G({color:"#3399CC",width:3}),fill:new ae({color:"rgba(0, 0, 255, 0.05)"})}),Co=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),So=_.forwardRef(function(e,t){const{mapId:i,maxZoom:s,positionFeatureStyle:n,accuracyFeatureStyle:r,trackingOptions:a}=e,{containerProps:l}=te("geolocation",e),h=!!navigator.geolocation,[c,d]=_.useState(!1),[p,u]=_.useState(!1),{map:m}=ee(i),f=fo(),v=mo("notifier.NotificationService"),C=Eo(m,s,a,n,r),b=(()=>h?c?f.formatMessage({id:"locateMeEnd"}):f.formatMessage({id:"locateMeStart"}):f.formatMessage({id:"locateNotSupported"}))();_.useEffect(()=>{if(C===void 0)return;const k=C.on("error",function(ie){const T=f.formatMessage({id:"error"}),R=(()=>{switch(ie){case"permission-denied":return f.formatMessage({id:"permissionDenied"});case"position-unavailable":return f.formatMessage({id:"positionUnavailable"});case"timeout":return f.formatMessage({id:"timeout"});case"unknown":return f.formatMessage({id:"unknownError"})}})();u(!1),d(!1),v.notify({level:"error",title:T,message:R})});return()=>{k.destroy()}},[C,f,v]),_.useEffect(()=>{if(!C){u(!1);return}return c&&(u(!0),C.startGeolocation().then(()=>{u(!1)})),()=>{C?.stopGeolocation(),u(!1)}},[C,c]);const x=()=>{m&&d(!c)};return g.jsx(Te,{ref:t,label:b,icon:g.jsx(_o,{}),onClick:()=>x(),isActive:c,isLoading:p,isDisabled:!h,...l})});function Eo(o,e,t,i,s){const[n,r]=_.useState();return _.useEffect(()=>{if(!o)return;const a=new xo(o.olMap,t);return r(a),()=>{a.destroy(),r(void 0)}},[o,t]),_.useEffect(()=>{n?.setPositionFeatureStyle(i)},[n,i]),_.useEffect(()=>{n?.setAccuracyFeatureStyle(s)},[n,s]),_.useEffect(()=>{n?.setMaxZoom(e)},[n,e]),n}function To(){const o=ho(),e=_.useId(),t=_.useId(),[i,s]=_.useState(!1),[n,r]=_.useState(!0),[a,l]=_.useState(!0);function h(){s(!i)}function c(){r(!n)}function d(){l(!a)}const p=_.useMemo(()=>new Je({source:new Ft}),[]);return g.jsxs(ve,{height:"100%",direction:"column",overflow:"hidden",children:[g.jsx(Is,{position:"top-right"}),g.jsxs(je,{title:g.jsx(L,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:g.jsx(Ge,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[g.jsx(ve,{flex:"1",direction:"column",position:"relative",children:g.jsxs(ms,{mapId:M,role:"main","aria-label":o.formatMessage({id:"ariaLabel.map"}),children:[g.jsx(Ne,{position:"top-left",horizontalGap:10,verticalGap:10,children:(a||i)&&g.jsxs(L,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:350,children:[a&&g.jsx(L,{role:"dialog","aria-labelledby":e,children:g.jsx(je,{title:g.jsx(Ge,{id:e,size:"md",mb:2,children:o.formatMessage({id:"tocTitle"})}),children:g.jsx(xs,{mapId:M,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})}),a&&i&&g.jsx(Os,{mt:4,mb:4}),i&&g.jsx(L,{role:"dialog","aria-labelledby":t,children:g.jsx(je,{title:g.jsx(Ge,{id:t,size:"md",mb:2,children:o.formatMessage({id:"measurementTitle"})}),children:g.jsx(qn,{mapId:M})})})]})}),g.jsx(Ne,{position:"top-right",horizontalGap:10,verticalGap:10,children:n&&g.jsx(L,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",children:g.jsx(no,{mapId:M,olLayer:p})})}),g.jsx(Ne,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:g.jsxs(ve,{role:"toolbar","aria-label":o.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[g.jsx(So,{mapId:M}),g.jsx(Te,{label:o.formatMessage({id:"tocTitle"}),icon:g.jsx(uo,{}),isActive:a,onClick:d}),g.jsx(Te,{label:o.formatMessage({id:"measurementTitle"}),icon:g.jsx(go,{}),isActive:i,onClick:h}),g.jsx(Te,{label:o.formatMessage({id:"overviewMapTitle"}),icon:g.jsx(po,{}),isActive:n,onClick:c}),g.jsx(Cs,{mapId:M}),g.jsx(Ss,{mapId:M}),g.jsx(Es,{mapId:M})]})})]})}),g.jsxs(ve,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[g.jsx(Fn,{mapId:M,precision:2}),g.jsx(lo,{mapId:M}),g.jsx(ao,{mapId:M})]})]})]})}const Io=pi({component:To,theme:mi,appMetadata:Rn,openShadowRoot:!0,async resolveConfig(o){const e=o.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",Io);const Po=document.getElementsByTagName("body")[0];Mo();function Mo(){const o=window.location.search,t=new URLSearchParams(o).get("lang"),i=document.createElement("ol-map-app");i.classList.add("full-height"),i.classList.add("app"),i.setAttribute("id","test"),t&&i.setAttribute("forced-locale",t),Po.appendChild(i)}
