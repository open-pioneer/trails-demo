var N=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var r=(n,t,e)=>(N(n,t,"read from private field"),e?e.call(n):t.get(n)),f=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)},c=(n,t,e,i)=>(N(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e);var G=(n,t,e)=>(N(n,t,"access private method"),e);import{g as ee,f as b,h as te,o as ne,c as F,t as se,r as d,j as s,b as D,T as ie,v as R,w as B,x as re,y as ae,z as O,B as M,D as oe,E as ue,G as ce,k as le,l as de,p as H,s as he}from"./9cb5cf737792.js";import{g as pe,S as me,C as V,H as K,F as U,I as q}from"./41aa5224fb6e.js";import{F as ge}from"./2fe635663a07.js";const w=Symbol("EventEmitterState");class Y{[w]=new fe;on(t,e){return this[w].on(t,{listener:e})}once(t,e){return this[w].on(t,{listener:e,once:!0})}emit(t,...e){this[w].emit(t,e[0])}}class fe{handlers=new Map;on(t,e){let i=this.handlers.get(t);return i||(i=new Set,this.handlers.set(t,i)),i.add(e),{destroy(){e.removed=!0,i?.delete(e),i=void 0}}}emit(t,e){const i=this.handlers.get(t);if(!i)return;const a=[...i];for(const o of a)o.removed||(o.once&&(o.removed=!0,i.delete(o)),o.listener(e))}}var[ve,Se]=ee({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),J=b(function(t,e){const i=te("Input",t),{children:a,className:o,...k}=ne(t),j=F("chakra-input__group",o),u={},E=pe(a),g=i.field;E.forEach(l=>{var p,I;i&&(g&&l.type.id==="InputLeftElement"&&(u.paddingStart=(p=g.height)!=null?p:g.h),g&&l.type.id==="InputRightElement"&&(u.paddingEnd=(I=g.height)!=null?I:g.h),l.type.id==="InputRightAddon"&&(u.borderEndRadius=0),l.type.id==="InputLeftAddon"&&(u.borderStartRadius=0))});const C=E.map(l=>{var p,I;const T=se({size:((p=l.props)==null?void 0:p.size)||t.size,variant:((I=l.props)==null?void 0:I.variant)||t.variant});return l.type.id!=="Input"?d.cloneElement(l,T):d.cloneElement(l,Object.assign(T,u,l.props))});return s.jsx(D.div,{className:j,ref:e,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...i.group},"data-group":!0,...k,children:s.jsx(ve,{value:i,children:C})})});J.displayName="InputGroup";var xe=D("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),_=b(function(t,e){var i,a;const{placement:o="left",...k}=t,j=Se(),u=j.field,g={[o==="left"?"insetStart":"insetEnd"]:"0",width:(i=u?.height)!=null?i:u?.h,height:(a=u?.height)!=null?a:u?.h,fontSize:u?.fontSize,...j.element};return s.jsx(xe,{ref:e,__css:g,...k})});_.id="InputElement";_.displayName="InputElement";var Q=b(function(t,e){const{className:i,...a}=t,o=F("chakra-input__left-element",i);return s.jsx(_,{ref:e,placement:"left",className:o,...a})});Q.id="InputLeftElement";Q.displayName="InputLeftElement";var z=b(function(t,e){const{className:i,...a}=t,o=F("chakra-input__right-element",i);return s.jsx(_,{ref:e,placement:"right",className:o,...a})});z.id="InputRightElement";z.displayName="InputRightElement";var W=b((n,t)=>s.jsx(me,{align:"center",...n,direction:"column",ref:t}));W.displayName="VStack";function ke({doLogin:n,wasLoggedIn:t}){const[e,i]=d.useState(""),[a,o]=d.useState(""),[k,j]=d.useState(!1),[u,E]=d.useState(),[g,C]=d.useState(t),l=p=>{p.preventDefault();const I=n(e,a);E(I||""),C(!1)};return s.jsx(V,{p:5,children:s.jsxs(W,{as:"form",onSubmit:l,spacing:4,children:[s.jsx(K,{as:"h1",textAlign:"center",children:"Login"}),s.jsxs(ie,{textAlign:"center",children:["Please enter your user name and password to authenticate.",s.jsx("br",{}),"Note: credentials are ",'"admin"'," / ",'"admin"']}),u&&s.jsxs(R,{status:"error",children:[s.jsx(B,{}),s.jsx(re,{children:u})]}),g&&s.jsxs(R,{status:"info",mb:5,children:[s.jsx(B,{}),s.jsxs(ae,{children:["Logout successful.",s.jsx("br",{}),"You can use the form below to log in again."]})]}),s.jsxs(O,{children:[s.jsx(U,{children:"User name"}),s.jsx(q,{placeholder:"User name",value:e,onChange:p=>i(p.target.value),autoComplete:"username"})]}),s.jsxs(O,{children:[s.jsx(U,{children:"Password"}),s.jsxs(J,{children:[s.jsx(q,{pr:"4.5rem",type:k?"text":"password",placeholder:"Enter password",value:a,onChange:p=>o(p.target.value),autoComplete:"current-password"}),s.jsx(z,{width:"4.5rem",children:s.jsx(M,{h:"1.75rem",size:"sm",onClick:()=>j(!k),children:k?"Hide":"Show"})})]})]}),s.jsx(M,{type:"submit",children:"Login"})]})})}var v,x,y;class Ie extends Y{constructor(){super();f(this,v,{kind:"pending"});f(this,x,void 0);f(this,y,!1);c(this,x,setTimeout(()=>{c(this,v,{kind:"not-authenticated"}),this.emit("changed")},500))}destroy(){clearTimeout(r(this,x)),c(this,x,void 0)}getAuthState(){return r(this,v)}getLoginBehavior(){const e=(a,o)=>{if(a==="admin"&&o==="admin")c(this,v,{kind:"authenticated",sessionInfo:{userId:"admin",userName:"Arnold Administrator"}}),c(this,y,!0),this.emit("changed");else return"Invalid user name or password!"};return{kind:"fallback",Fallback:()=>d.createElement(ke,{doLogin:e,wasLoggedIn:r(this,y)})}}logout(){(r(this,v).kind==="authenticated"||r(this,v).kind==="pending")&&(c(this,v,{kind:"not-authenticated"}),clearTimeout(r(this,x)),c(this,x,void 0),this.emit("changed"))}}v=new WeakMap,x=new WeakMap,y=new WeakMap;const P=le("authentication:AuthService");var S,h,m,A,L,X;class je extends Y{constructor(e){super();f(this,L);f(this,S,void 0);f(this,h,void 0);f(this,m,void 0);f(this,A,void 0);c(this,S,e.references.plugin),c(this,h,r(this,S).getAuthState()),c(this,A,r(this,S).on?.("changed",()=>G(this,L,X).call(this))),P.debug(`Constructed with initial auth state '${r(this,h).kind}'`,r(this,h))}destroy(){r(this,m)?.reject(oe()),c(this,m,void 0),c(this,A,ue(r(this,A)))}getAuthState(){return r(this,h)}getSessionInfo(){return r(this,h).kind!=="pending"?Promise.resolve($(r(this,h))):(r(this,m)||c(this,m,ce()),r(this,m).promise)}getLoginBehavior(){return r(this,S).getLoginBehavior()}logout(){P.debug("Triggering logout"),r(this,S).logout()}}S=new WeakMap,h=new WeakMap,m=new WeakMap,A=new WeakMap,L=new WeakSet,X=function(){const e=r(this,S).getAuthState();c(this,h,e),e.kind!=="pending"&&r(this,m)&&(r(this,m).resolve($(e)),c(this,m,void 0)),P.debug(`Auth state changed to '${r(this,h).kind}'`,r(this,h)),this.emit("changed")};function $(n){return n.kind==="authenticated"?n.sessionInfo:void 0}const Ae={"auth-app":{name:"auth-app",services:{TestAuthPlugin:{name:"TestAuthPlugin",clazz:Ie,provides:[{name:"authentication.AuthPlugin",qualifier:void 0}],references:{}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:je,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/test-utils":{name:"@open-pioneer/test-utils",services:{},ui:{references:[]},properties:{}}},Ee="",ye=[];function be(n){throw new Error(`Unsupported locale: '${n}'`)}const we=de(Ee),Le=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:be,locales:ye,packages:Ae,styles:we},Symbol.toStringTag,{value:"Module"})),_e="@open-pioneer/authentication",Ce=H.bind(void 0,_e);function Z(n){const t=d.useCallback(a=>{const o=n.on("changed",a);return()=>o.destroy()},[n]),e=d.useCallback(()=>n.getAuthState(),[n]);return d.useSyncExternalStore(t,e)}const Ne=n=>{const t=Ce("authentication.AuthService"),e=Z(t),i=d.useMemo(()=>{if(e.kind==="not-authenticated")return t.getLoginBehavior()},[t,e.kind]);switch(d.useEffect(()=>{e.kind==="not-authenticated"&&i?.kind==="effect"&&i.login()},[i,e.kind]),e.kind){case"pending":return null;case"not-authenticated":{if(!i||i.kind!=="fallback")return null;const a=i.Fallback;return n.renderFallback?s.jsx(s.Fragment,{children:n.renderFallback(a)}):s.jsx(a,{...n.fallbackProps})}case"authenticated":return s.jsx(s.Fragment,{children:n.children})}},Pe="auth-app",Me=H.bind(void 0,Pe);function Fe(){const n=Me("authentication.AuthService"),t=Z(n),e=()=>{n.logout()};return t.kind==="not-authenticated"||t.kind==="pending"?null:s.jsx(M,{colorScheme:"red",onClick:e,children:"Log out"})}function ze(){return s.jsx(Ne,{children:s.jsxs(V,{p:5,children:[s.jsx(K,{as:"h1",children:"Authenticated"}),"This is the actual content of the app. Authentication was successful.",s.jsx(ge,{pt:5,flexDirection:"row",justifyContent:"center",children:s.jsx(Fe,{})})]})})}const Te=he({component:ze,appMetadata:Le});customElements.define("auth-app",Te);
