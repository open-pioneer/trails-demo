var mn=Object.defineProperty;var vn=(o,e,t)=>e in o?mn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var Io=(o,e,t)=>(vn(o,typeof e!="symbol"?e+"":e,t),t),Ht=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var C=(o,e,t)=>(Ht(o,e,"read from private field"),t?t.call(o):e.get(o)),I=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},D=(o,e,t,s)=>(Ht(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);var $=(o,e,t)=>(Ht(o,e,"access private method"),t);import{f as bo,j as c,r as f,u as bn,c as le,i as Tt,a as Se,g as Sn,R as ms,E as se,b as yn,B as So,C as wn,t as _n,d as vs,F as bs,I as xn,A as qt,e as Kt,h as kn}from"./9e25cf6915c1.js";import{t as Cn}from"./33a6c44c8f8e.js";import{b as Ss,B as ys,i as En,g as Pn,a as Oo,t as Mn,c as Ln,d as ws,S as Tn,e as Rn,f as An,h as In,j as On,r as Dn,C as jn,k as Nn,l as Fn,u as Vn,m as _s,M as xs,o as Bn,n as Gn,p as ks,A as Un,T as yo,I as zn,q as Wn,s as no,v as be,w as $n,x as Hn,y as St,O as Cs,V as Ze,z as Te,D as Le,E as wo,F as He,P as qn,G as Kn,H as Yn,J as Do,K as Xn,L as Zn,N as jo,Q as Jn,R as Qn,U as Es,W as de,X as er,Y as Ps,Z as we,_ as De,$ as No,a0 as tr,a1 as Ut,a2 as or,a3 as Ms,a4 as sr,a5 as nr,a6 as rr,a7 as ir,a8 as J,a9 as Ls,aa as Pe,ab as ar,ac as lr,ad as cr,ae as Ts,af as ur,ag as Fo,ah as Rs,ai as dr,aj as Vo,ak as hr,al as Yt,am as fr,an as Bo,ao as pr,ap as gr,aq as mr,ar as vr,as as br,at as Sr,au as Go,av as yr,aw as Uo,ax as wr,ay as zo,az as _r,aA as xr,aB as kr,aC as Cr,aD as Qe}from"./c8e5ac35263a.js";import{m as F,a as k,X as As,p as B,r as O,b as Z,c as _o,d as ro,e as ve,f as Er,g as Pr,W as vt,P as Is,h as Os,i as Mr,j as Lr,k as Tr,l as Rr,n as Ar}from"./4dfc4791279c.js";import{o as Ir,W as Or}from"./c57dbcbb1234.js";import{u as re,T as ye,c as bt,a as _e,S as xe}from"./eaa918f6bce8.js";import{G as xo,M as Dr,a as Ds,b as js,c as jr,T as Nr}from"./d273aff8a7f8.js";import{T as Q}from"./27bd7bdd1d70.js";import{B as N}from"./5bcdd8386145.js";import{N as Fr,u as qe,W as Vr,a as Br}from"./c6d4100b07de.js";import{V as Gr,S as Ur,I as zr,Z as Wr,a as $r}from"./7e2d1ece5239.js";import{E as Ns}from"./960f2965a833.js";import{_ as Wo,G as Hr,F as qr}from"./aa3041179d97.js";import{u as ce,a as zt}from"./4e9b8a7f116d.js";import{L as je}from"./d4494efbd796.js";import{F as io}from"./3d0ea6afb17c.js";import{F as ao}from"./4b9c487761b5.js";import{H as Kr}from"./29097a8b984e.js";import{S as Yr}from"./dd00a1de8dab.js";import{c as Xr}from"./4ecec26c6ba8.js";import{c as ue,S as lo}from"./27f115ed382e.js";import{V as co}from"./6d6cfa1351f8.js";import{F as ae}from"./257ea9ecc56a.js";import{I as Zr}from"./ae11f8aa10a4.js";import{L as Fs}from"./83cf8a3ea1be.js";import{S as Jr}from"./5891291c7e5e.js";import{C as Qr}from"./e799993b6a7a.js";import{D as $o}from"./94d7dc331a8e.js";import"./1b28fd444011.js";import"./67250e93fdd7.js";import"./1c523be404f9.js";import"./3dad0dbdc6e5.js";import"./aafde4165c12.js";var uo=bo(function(e,t){const{htmlWidth:s,htmlHeight:n,alt:r,...i}=e;return c.jsx("img",{width:s,height:n,ref:t,alt:r,...i})});uo.displayName="NativeImage";function ei(o){const{loading:e,src:t,srcSet:s,onLoad:n,onError:r,crossOrigin:i,sizes:a,ignoreFallback:u}=o,[l,d]=f.useState("pending");f.useEffect(()=>{d(t?"loading":"pending")},[t]);const h=f.useRef(),m=f.useCallback(()=>{if(!t)return;b();const S=new Image;S.src=t,i&&(S.crossOrigin=i),s&&(S.srcset=s),a&&(S.sizes=a),e&&(S.loading=e),S.onload=w=>{b(),d("loaded"),n?.(w)},S.onerror=w=>{b(),d("failed"),r?.(w)},h.current=S},[t,i,s,a,n,r,e]),b=()=>{h.current&&(h.current.onload=null,h.current.onerror=null,h.current=null)};return bn(()=>{if(!u)return l==="loading"&&m(),()=>{b()}},[l,m,u]),u?"loaded":l}var ti=(o,e)=>o!=="loaded"&&e==="beforeLoadOrError"||o==="failed"&&e==="onError";function oi(o,e=[]){const t=Object.assign({},o);for(const s of e)s in t&&delete t[s];return t}var Vs=bo(function(e,t){const{fallbackSrc:s,fallback:n,src:r,srcSet:i,align:a,fit:u,loading:l,ignoreFallback:d,crossOrigin:h,fallbackStrategy:m="beforeLoadOrError",referrerPolicy:b,...S}=e,w=s!==void 0||n!==void 0,L=l!=null||d||!w,E=ei({...e,crossOrigin:h,ignoreFallback:L}),A=ti(E,m),T={ref:t,objectFit:u,objectPosition:a,...L?S:oi(S,["onError","onLoad"])};return A?n||c.jsx(le.img,{as:uo,className:"chakra-image__placeholder",src:s,...T}):c.jsx(le.img,{as:uo,src:r,srcSet:i,crossOrigin:h,loading:l,referrerPolicy:b,className:"chakra-image",...T})});Vs.displayName="Image";var Bs=le("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});Bs.displayName="Center";var si={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};bo(function(e,t){const{axis:s="both",...n}=e;return c.jsx(le.div,{ref:t,__css:si[s],...n,position:"absolute"})});const X=[null,"http://www.opengis.net/ows/1.1"],ni=F(X,{ServiceIdentification:k(Li),ServiceProvider:k(Ri),OperationsMetadata:k(Pi)});class ri extends As{constructor(){super()}readFromNode(e){const t=B({},ni,e,[]);return t||null}}const ii=F(X,{DeliveryPoint:k(O),City:k(O),AdministrativeArea:k(O),PostalCode:k(O),Country:k(O),ElectronicMailAddress:k(O)}),ai=F(X,{Value:Z(Ai)}),li=F(X,{AllowedValues:k(yi)}),ci=F(X,{Phone:k(Mi),Address:k(Si)}),ui=F(X,{HTTP:k(Ci)}),di=F(X,{Get:Z(ki),Post:void 0}),hi=F(X,{DCP:k(xi)}),fi=F(X,{Operation:Ei}),pi=F(X,{Voice:k(O),Facsimile:k(O)}),gi=F(X,{Constraint:Z(wi)}),mi=F(X,{IndividualName:k(O),PositionName:k(O),ContactInfo:k(_i)}),vi=F(X,{Abstract:k(O),AccessConstraints:k(O),Fees:k(O),Title:k(O),ServiceTypeVersion:k(O),ServiceType:k(O)}),bi=F(X,{ProviderName:k(O),ProviderSite:k(_o),ServiceContact:k(Ti)});function Si(o,e){return B({},ii,o,e)}function yi(o,e){return B({},ai,o,e)}function wi(o,e){const t=o.getAttribute("name");if(t)return B({name:t},li,o,e)}function _i(o,e){return B({},ci,o,e)}function xi(o,e){return B({},ui,o,e)}function ki(o,e){const t=_o(o);if(t)return B({href:t},gi,o,e)}function Ci(o,e){return B({},di,o,e)}function Ei(o,e){const t=o.getAttribute("name"),s=B({},hi,o,e);if(!s)return;const n=e[e.length-1];n[t]=s}function Pi(o,e){return B({},fi,o,e)}function Mi(o,e){return B({},pi,o,e)}function Li(o,e){return B({},vi,o,e)}function Ti(o,e){return B({},mi,o,e)}function Ri(o,e){return B({},bi,o,e)}function Ai(o,e){return O(o)}const Ii=ri,ie=[null,"http://www.opengis.net/wmts/1.0"],Je=[null,"http://www.opengis.net/ows/1.1"],Oi=F(ie,{Contents:k(Hi)});class Di extends As{constructor(){super(),this.owsParser_=new Ii}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let s=this.owsParser_.readFromNode(e);return s?(s.version=t,s=B(s,Oi,e,[]),s||null):null}}const ji=F(ie,{Layer:Z(qi),TileMatrixSet:Z(Ki)}),Ni=F(ie,{Style:Z(Yi),Format:Z(O),TileMatrixSetLink:Z(Xi),Dimension:Z(Zi),ResourceURL:Z(Ji)},F(Je,{Title:k(O),Abstract:k(O),WGS84BoundingBox:k(Gs),Identifier:k(O)})),Fi=F(ie,{LegendURL:Z(Qi)},F(Je,{Title:k(O),Identifier:k(O)})),Vi=F(ie,{TileMatrixSet:k(O),TileMatrixSetLimits:k(ta)}),Bi=F(ie,{TileMatrixLimits:ro(oa)}),Gi=F(ie,{TileMatrix:k(O),MinTileRow:k(ve),MaxTileRow:k(ve),MinTileCol:k(ve),MaxTileCol:k(ve)}),Ui=F(ie,{Default:k(O),Value:Z(O)},F(Je,{Identifier:k(O)})),zi=F(Je,{LowerCorner:ro(ho),UpperCorner:ro(ho)}),Wi=F(ie,{WellKnownScaleSet:k(O),TileMatrix:Z(ea)},F(Je,{SupportedCRS:k(O),Identifier:k(O),BoundingBox:k(Gs)})),$i=F(ie,{TopLeftCorner:k(ho),ScaleDenominator:k(Er),TileWidth:k(ve),TileHeight:k(ve),MatrixWidth:k(ve),MatrixHeight:k(ve)},F(Je,{Identifier:k(O)}));function Hi(o,e){return B({},ji,o,e)}function qi(o,e){return B({},Ni,o,e)}function Ki(o,e){return B({},Wi,o,e)}function Yi(o,e){const t=B({},Fi,o,e);if(!t)return;const s=o.getAttribute("isDefault")==="true";return t.isDefault=s,t}function Xi(o,e){return B({},Vi,o,e)}function Zi(o,e){return B({},Ui,o,e)}function Ji(o,e){const t=o.getAttribute("format"),s=o.getAttribute("template"),n=o.getAttribute("resourceType"),r={};return t&&(r.format=t),s&&(r.template=s),n&&(r.resourceType=n),r}function Gs(o,e){const t=B([],zi,o,e);if(t.length==2)return Ss(t)}function Qi(o,e){const t={};return t.format=o.getAttribute("format"),t.href=_o(o),t}function ho(o,e){const t=O(o).split(/\s+/);if(!t||t.length!=2)return;const s=+t[0],n=+t[1];if(!(isNaN(s)||isNaN(n)))return[s,n]}function ea(o,e){return B({},$i,o,e)}function ta(o,e){return B([],Bi,o,e)}function oa(o,e){return B({},Gi,o,e)}const sa=Di,U={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},na={ERROR:"error"};class ra extends ws{constructor(e){super(na.ERROR),this.code=e.code,this.message=e.message}}let ia=class extends ys{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=En,this.watchId_=void 0,this.addChangeListener(U.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(U.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=Pn(Oo("EPSG:4326"),e),this.position_&&this.set(U.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(U.ACCURACY,t.accuracy),this.set(U.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(U.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(U.HEADING,t.heading===null?void 0:Mn(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const s=this.transform_(this.position_);this.set(U.POSITION,s.slice()),this.set(U.SPEED,t.speed===null?void 0:t.speed);const n=Ln(this.position_,t.accuracy);n.applyTransform(this.transform_),this.set(U.ACCURACY_GEOMETRY,n),this.changed()}positionError_(e){this.dispatchEvent(new ra(e))}getAccuracy(){return this.get(U.ACCURACY)}getAccuracyGeometry(){return this.get(U.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(U.ALTITUDE)}getAltitudeAccuracy(){return this.get(U.ALTITUDE_ACCURACY)}getHeading(){return this.get(U.HEADING)}getPosition(){return this.get(U.POSITION)}getProjection(){return this.get(U.PROJECTION)}getSpeed(){return this.get(U.SPEED)}getTracking(){return this.get(U.TRACKING)}getTrackingOptions(){return this.get(U.TRACKING_OPTIONS)}setProjection(e){this.set(U.PROJECTION,Oo(e))}setTracking(e){this.set(U.TRACKING,e)}setTrackingOptions(e){this.set(U.TRACKING_OPTIONS,e)}};const aa=ia;class Wt extends Tn{constructor(e,t,s){super(),s!==void 0&&t===void 0?this.setFlatCoordinates(s,e):(t=t||0,this.setCenterAndRadius(e,t,s))}clone(){const e=new Wt(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,s,n){const r=this.flatCoordinates,i=e-r[0],a=t-r[1],u=i*i+a*a;if(u<n){if(u===0)for(let l=0;l<this.stride;++l)s[l]=r[l];else{const l=this.getRadius()/Math.sqrt(u);s[0]=r[0]+l*i,s[1]=r[1]+l*a;for(let d=2;d<this.stride;++d)s[d]=r[d]}return s.length=this.stride,u}return n}containsXY(e,t){const s=this.flatCoordinates,n=e-s[0],r=t-s[1];return n*n+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,s=t[this.stride]-t[0];return Rn(t[0]-s,t[1]-s,t[0]+s,t[1]+s,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if(An(e,t)){const s=this.getCenter();return e[0]<=s[0]&&e[2]>=s[0]||e[1]<=s[1]&&e[3]>=s[1]?!0:In(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,s=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+s;for(let r=1;r<t;++r)n[t+r]=e[r];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(e,t,s){this.setLayout(s,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let r=On(n,0,e,this.stride);n[r++]=n[0]+t;for(let i=1,a=this.stride;i<a;++i)n[r++]=n[i];n.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const s=this.getCenter(),n=this.getStride();this.setCenter(Dn(s,0,s.length,n,e,t,s)),this.changed()}}Wt.prototype.transform;const la=Wt,Y={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class ca extends ys{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+jn,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Y.ELEMENT,this.handleElementChanged),this.addChangeListener(Y.MAP,this.handleMapChanged),this.addChangeListener(Y.OFFSET,this.handleOffsetChanged),this.addChangeListener(Y.POSITION,this.handlePositionChanged),this.addChangeListener(Y.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(Y.ELEMENT)}getId(){return this.id}getMap(){return this.get(Y.MAP)||null}getOffset(){return this.get(Y.OFFSET)}getPosition(){return this.get(Y.POSITION)}getPositioning(){return this.get(Y.POSITIONING)}handleElementChanged(){Nn(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(Fn(this.element),Vn(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=_s(e,xs.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(Y.ELEMENT,e)}setMap(e){this.set(Y.MAP,e)}setOffset(e){this.set(Y.OFFSET,e)}setPosition(e){this.set(Y.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(Y.POSITION))return;const s=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),r=this.getRect(n,[Bn(n),Gn(n)]);e=e||{};const i=e.margin===void 0?20:e.margin;if(!ks(s,r)){const a=r[0]-s[0],u=s[2]-r[2],l=r[1]-s[1],d=s[3]-r[3],h=[0,0];if(a<0?h[0]=a-i:u<0&&(h[0]=Math.abs(u)+i),l<0?h[1]=l-i:d<0&&(h[1]=Math.abs(d)+i),h[0]!==0||h[1]!==0){const m=t.getView().getCenterInternal(),b=t.getPixelFromCoordinateInternal(m);if(!b)return;const S=[b[0]+h[0],b[1]+h[1]],w=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(S),duration:w.duration,easing:w.easing})}}}getRect(e,t){const s=e.getBoundingClientRect(),n=s.left+window.pageXOffset,r=s.top+window.pageYOffset;return[n,r,n+t[0],r+t[1]]}setPositioning(e){this.set(Y.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const s=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(s,n)}updateRenderedPosition(e,t){const s=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const i=Math.round(e[0]+n[0])+"px",a=Math.round(e[1]+n[1])+"px";let u="0%",l="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?u="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(u="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?l="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(l="-50%");const d=`translate(${u}, ${l}) translate(${i}, ${a})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,s.transform=d)}getOptions(){return this.options}}const Rt=ca,ke=Se("map:WMTSLayer");var Ne,Fe,Ve,Ot,Be,it,at,lt,Dt,Us,jt,zs;class ua extends Un{constructor(t){const s=new yo;super({...t,olLayer:s});I(this,Dt);I(this,jt);I(this,Ne,void 0);I(this,Fe,void 0);I(this,Ve,void 0);I(this,Ot,void 0);I(this,Be,void 0);I(this,it,void 0);I(this,at,void 0);I(this,lt,new AbortController);D(this,Ne,t.url),D(this,Fe,t.name),D(this,Be,s),D(this,Ve,t.matrixSet)}destroy(){super.destroy(),C(this,lt).abort()}get legend(){return C(this,at)}__attach(t){super.__attach(t),$(this,Dt,Us).call(this).then(s=>{const r=new sa().read(s),i=Ir(r,{layer:C(this,Fe),matrixSet:C(this,Ve)});if(!i)throw new Error("Layer was not found in capabilities");const a=new Or({...i,tileLoadFunction:(d,h)=>{$(this,jt,zs).call(this,d,h)}});D(this,it,a),C(this,Be).setSource(C(this,it));const u=a.getStyle(),l=ha(r,this.name,u);D(this,at,l),this.__emitChangeEvent("changed:legend")}).catch(s=>{if(Tt(s)){ke.error(`Layer ${this.name} has been destroyed before fetching the data`);return}ke.error(`Failed fetching WMTS capabilities for Layer ${this.name}`,s)})}get layer(){return C(this,Be)}get url(){return C(this,Ne)}get name(){return C(this,Fe)}get matrixSet(){return C(this,Ve)}get attributions(){return C(this,Ot)}get sublayers(){}}Ne=new WeakMap,Fe=new WeakMap,Ve=new WeakMap,Ot=new WeakMap,Be=new WeakMap,it=new WeakMap,at=new WeakMap,lt=new WeakMap,Dt=new WeakSet,Us=async function(){const t=this.map.__sharedDependencies.httpService;return Pr(C(this,Ne),t,C(this,lt).signal)},jt=new WeakSet,zs=async function(t,s){const n=this.map.__sharedDependencies.httpService;try{if(!(t instanceof zn))throw new Error("Only 'ImageTile' is supported for now.");const r=t.getImage();if(!da(r))throw new Error("Only <img> tags are supported as tiles for now.");const i=await n.fetch(s);if(!i.ok)throw new Error(`Tile request failed with status ${i.status}.`);const a=await i.blob(),u=URL.createObjectURL(a),l=()=>{URL.revokeObjectURL(u),r.removeEventListener("load",l),r.removeEventListener("error",l)};r.addEventListener("load",l),r.addEventListener("error",l),r.src=u}catch(r){t.setState(Wn.ERROR),Tt(r)||ke.error("Failed to load tile",r)}};function da(o){return o.tagName==="IMG"}function ha(o,e,t){const n=o?.Contents?.Layer;let r=n?.find(l=>l?.Identifier===e);if(!r&&(ke.debug("Failed to find the active layer in WMTS layer capabilities."),r=n?.[0],!r)){ke.debug("No layer in WMTS capabilities - giving up.");return}const i=r.Style;let a=i?.find(l=>l?.Identifier===t);if(!a&&(ke.debug("Failed to find active style in WMTS layer."),a=i?.[0],!a)){ke.debug("No style in WMTS layer capabilities - giving up.");return}return a.LegendURL?.[0]?.href}const Ho=ua,fa=25.4/.28,pa=39.37;function ko(o){return Co(o,ga,ma)}function ga(o){return o.getView()}function ma(o,e){return o.on("change:view",e)}function Ws(o){return ko(o)?.getProjection()}function va(o){const e=ko(o);return Co(e,ba,Sa)}function ba(o){return o.getResolution()}function Sa(o,e){return o.on("change:resolution",e)}function ya(o){const e=ko(o);return Co(e,wa,_a)}function wa(o){return o.getCenter()}function _a(o,e){return o.on("change:center",e)}function xa(o){const e=ya(o),t=va(o),s=Ws(o);return f.useMemo(()=>{if(s==null||t==null||e==null)return;const r=no(s,t,e);return Math.round(r*pa*fa)},[s,t,e])}function Co(o,e,t){const s=f.useCallback(()=>o?e(o):void 0,[o,e]),n=f.useCallback(r=>{if(!o)return()=>{};const i=t(o,r);return()=>be(i)},[o,t]);return f.useSyncExternalStore(n,s)}const ka=1.2;function Ca(o,e=ka){Ea(o);const t=$n(o),s=Hn(o),n=t*e,r=s*e;return[o[0]-(n-t)/2,o[1]-(r-s)/2,o[2]+(n-t)/2,o[3]+(r-s)/2]}function Ea(o){if(o.length!==4)throw new Error(`Invalid extent (expected length 4, but got length ${o.length}).`)}const Pa={height:"25px",width:"25px",borderColor:"#4cb3ff",borderWidth:"3px",borderRadius:"50%",display:"inline-block "};function Ma(o){return c.jsxs(N,{children:[c.jsx(Q,{children:o.layer.title}),c.jsx(N,{style:Pa})]})}function La(o){return c.jsxs(N,{children:[c.jsx(Q,{as:"b",children:o.layer.title}),c.jsx(Q,{children:"Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet."})]})}const W="main";class Ta{mapId=W;vectorSourceFactory;constructor(e){this.vectorSourceFactory=e.references.vectorSourceFactory}async getMapConfig(){const e={Component:Ma};return{initialView:{kind:"position",center:{x:404747,y:5757920},zoom:14},projection:"EPSG:25832",layers:[new vt({title:"Linfos",visible:!0,url:"https://www.wms.nrw.de/umwelt/linfos",sublayers:[{name:"SonstigeSchutzgebiete",title:"SonstigeSchutzgebiete"},{name:"SCH_GSG",title:"SCH_GSG"}]}),new Ho({isBaseLayer:!0,title:"Topplus grau",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_grau",matrixSet:"EPSG_25832_14",visible:!1}),new Ho({isBaseLayer:!0,title:"Topplus farbig",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_col",matrixSet:"EPSG_25832_14",visible:!1}),new St({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new yo({source:new Cs})}),new St({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:Ra(),attributes:{legend:e}}),new St({id:"ogc_kitas",title:"Kindertagesstätten",visible:!0,olLayer:Aa(),attributes:{legend:e}}),new St({id:"ogc_kataster",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:Ia(this.vectorSourceFactory)}),ja(),Fa(),Oa(),Da()]}}}function Ra(){const o=new Ze({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new xo,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new Te({source:o})}function Aa(){const o=new Ze({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new xo,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new Te({source:o,style:new Le({image:new wo({fill:new He({color:"blue"}),radius:4})})})}function Ia(o){const e=o.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:"<a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>"});return new Te({source:e})}function Oa(){return new vt({title:"Verwaltungsgebiete",visible:!0,url:"https://www.wms.nrw.de/geobasis/wms_nw_dvg",sublayers:[{name:"nw_dvg_bld",title:"NRW"}]})}function Da(){return new vt({title:"Bodenkarte zur Landwirtschaftlichen Standorterkundung",visible:!0,url:"https://www.wms.nrw.de/gd/bk05l",sublayers:[{name:"Versickerung_und_Stofftransport",title:"Versickerung und Stofftransport",sublayers:[{name:"Sickerwasserrate",title:"Sickerwasserrate",sublayers:[{name:"Szenario_Wald",title:"Szenario Wald",sublayers:[{name:"Sickerwasserrate_Wald",title:"Sickerwasserrate Wald"},{name:"Direktabfluss_Wald",title:"Direktabfluss Wald"}]},{name:"Szenario_Gruenland",title:"Szenario Grünland",sublayers:[{name:"Sickerwasserrate_Gruenland",title:"Sickerwasserrate Grünland"},{name:"Direktabfluss_Gruenland",title:"Direktabfluss Grünland"}]}]}]},{name:"Wasserhaushalt",title:"Wasserhaushalt",sublayers:[{name:"Kapillaraufstieg_von_Grundwasser",title:"Kapillaraufstieg von Grundwasser",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/gd/bk05l?request=GetLegendGraphic%26version=1.3.0%26format=image/png%26layer=Kapillaraufstieg_von_Grundwasser"}}},{name:"Luftkapazitaet_We",title:"Luftkapazitaet (We)",attributes:{legend:{imageUrl:"https://avatars.githubusercontent.com/u/121286957?s=200&v=4"}}}]}]})}function ja(){return new vt({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW",attributes:{legend:{imageUrl:"https://avatars.githubusercontent.com/u/121286957?s=200&v=4"}}}],sourceOptions:{ratio:1}})}const Na={Component:La};function Fa(){return new vt({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",visible:!0,sublayers:[{name:"1",title:"Verwaltungen",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/legends/wms/strassen_nrw_wms/1.png"}}},{name:"4",title:"Abschnitte und Äste",attributes:{legend:Na}},{name:"6",title:"Unfälle"}]})}class Va{label;filteredTypes;httpService;constructor(e,t,s){this.label=e,this.filteredTypes=t,this.httpService=s}async request(e,t,s){const n=new URL("https://photon.komoot.io/api?");n.searchParams.set("q",e),n.searchParams.set("lang","de"),n.searchParams.set("lat","51.961563"),n.searchParams.set("lon","7.628202"),n.searchParams.set("limit",t.toString());const r=await this.httpService.fetch(n,{signal:s});if(!r.ok)throw new Error("Request failed: "+r.status);return await r.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}async search(e,{mapProjection:t,signal:s}){const n=await this.request(e,100,s),r=new xo({dataProjection:"EPSG:4326",featureProjection:t});return n.features.filter(i=>this.filteredTypes.includes(i.properties.type)).map((i,a)=>{const u=r.readGeometry(i.geometry);return{id:i.properties.osm_id||a,label:this.createLabel(i),geometry:u,properties:i.properties}})}}const Ba=Symbol(),Eo=Symbol(),et="a",Lt="w";let Ga=(o,e)=>new Proxy(o,e);const fo=Object.getPrototypeOf,po=new WeakMap,$s=o=>o&&(po.has(o)?po.get(o):fo(o)===Object.prototype||fo(o)===Array.prototype),qo=o=>typeof o=="object"&&o!==null,Ua=o=>{if(Array.isArray(o))return Array.from(o);const e=Object.getOwnPropertyDescriptors(o);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(fo(o),e)},Hs=o=>o[Eo]||o,qs=(o,e,t,s)=>{if(!$s(o))return o;let n=s&&s.get(o);if(!n){const u=Hs(o);n=(l=>Object.values(Object.getOwnPropertyDescriptors(l)).some(d=>!d.configurable&&!d.writable))(u)?[u,Ua(u)]:[u],s?.set(o,n)}const[r,i]=n;let a=t&&t.get(r);return a&&a[1].f===!!i||(a=((u,l)=>{const d={f:l};let h=!1;const m=(S,w)=>{if(!h){let L=d[et].get(u);if(L||(L={},d[et].set(u,L)),S===Lt)L[Lt]=!0;else{let E=L[S];E||(E=new Set,L[S]=E),E.add(w)}}},b={get:(S,w)=>w===Eo?u:(m("k",w),qs(Reflect.get(S,w),d[et],d.c,d.t)),has:(S,w)=>w===Ba?(h=!0,d[et].delete(u),!0):(m("h",w),Reflect.has(S,w)),getOwnPropertyDescriptor:(S,w)=>(m("o",w),Reflect.getOwnPropertyDescriptor(S,w)),ownKeys:S=>(m(Lt),Reflect.ownKeys(S))};return l&&(b.set=b.deleteProperty=()=>!1),[b,d]})(r,!!i),a[1].p=Ga(i||r,a[0]),t&&t.set(r,a)),a[1][et]=e,a[1].c=t,a[1].t=s,a[1].p},Ks=(o,e,t,s)=>{if(Object.is(o,e))return!1;if(!qo(o)||!qo(e))return!0;const n=t.get(Hs(o));if(!n)return!0;if(s){const i=s.get(o);if(i&&i.n===e)return i.g;s.set(o,{n:e,g:!1})}let r=null;try{for(const i of n.h||[])if(r=Reflect.has(o,i)!==Reflect.has(e,i),r)return r;if(n[Lt]===!0){if(r=((i,a)=>{const u=Reflect.ownKeys(i),l=Reflect.ownKeys(a);return u.length!==l.length||u.some((d,h)=>d!==l[h])})(o,e),r)return r}else for(const i of n.o||[])if(r=!!Reflect.getOwnPropertyDescriptor(o,i)!=!!Reflect.getOwnPropertyDescriptor(e,i),r)return r;for(const i of n.k||[])if(r=Ks(o[i],e[i],t,s),r)return r;return r===null&&(r=!0),r}finally{s&&s.set(o,{n:e,g:r})}},za=o=>$s(o)&&o[Eo]||null,Ko=(o,e=!0)=>{po.set(o,e)};const Xt=o=>typeof o=="object"&&o!==null,fe=new WeakMap,nt=new WeakSet,Wa=(o=Object.is,e=(l,d)=>new Proxy(l,d),t=l=>Xt(l)&&!nt.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),s=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},n=new WeakMap,r=(l,d,h=s)=>{const m=n.get(l);if(m?.[0]===d)return m[1];const b=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return Ko(b,!0),n.set(l,[d,b]),Reflect.ownKeys(l).forEach(S=>{if(Object.getOwnPropertyDescriptor(b,S))return;const w=Reflect.get(l,S),{enumerable:L}=Reflect.getOwnPropertyDescriptor(l,S),E={value:w,enumerable:L,configurable:!0};if(nt.has(w))Ko(w,!1);else if(w instanceof Promise)delete E.value,E.get=()=>h(w);else if(fe.has(w)){const[A,T]=fe.get(w);E.value=r(A,T(),h)}Object.defineProperty(b,S,E)}),Object.preventExtensions(b)},i=new WeakMap,a=[1,1],u=l=>{if(!Xt(l))throw new Error("object required");const d=i.get(l);if(d)return d;let h=a[0];const m=new Set,b=(v,y=++a[0])=>{h!==y&&(h=y,m.forEach(p=>p(v,y)))};let S=a[1];const w=(v=++a[1])=>(S!==v&&!m.size&&(S=v,E.forEach(([y])=>{const p=y[1](v);p>h&&(h=p)})),h),L=v=>(y,p)=>{const _=[...y];_[1]=[v,..._[1]],b(_,p)},E=new Map,A=(v,y)=>{if(m.size){const p=y[3](L(v));E.set(v,[y,p])}else E.set(v,[y])},T=v=>{var y;const p=E.get(v);p&&(E.delete(v),(y=p[1])==null||y.call(p))},q=v=>(m.add(v),m.size===1&&E.forEach(([p,_],M)=>{const x=p[3](L(M));E.set(M,[p,x])}),()=>{m.delete(v),m.size===0&&E.forEach(([p,_],M)=>{_&&(_(),E.set(M,[p]))})}),K=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),z=e(K,{deleteProperty(v,y){const p=Reflect.get(v,y);T(y);const _=Reflect.deleteProperty(v,y);return _&&b(["delete",[y],p]),_},set(v,y,p,_){const M=Reflect.has(v,y),x=Reflect.get(v,y,_);if(M&&(o(x,p)||i.has(p)&&o(x,i.get(p))))return!0;T(y),Xt(p)&&(p=za(p)||p);let P=p;if(p instanceof Promise)p.then(V=>{p.status="fulfilled",p.value=V,b(["resolve",[y],V])}).catch(V=>{p.status="rejected",p.reason=V,b(["reject",[y],V])});else{!fe.has(p)&&t(p)&&(P=u(p));const V=!nt.has(P)&&fe.get(P);V&&A(y,V)}return Reflect.set(v,y,P,_),b(["set",[y],p,x]),!0}});i.set(l,z);const g=[K,w,r,q];return fe.set(z,g),Reflect.ownKeys(l).forEach(v=>{const y=Object.getOwnPropertyDescriptor(l,v);"value"in y&&(z[v]=l[v],delete y.value,delete y.writable),Object.defineProperty(K,v,y)}),z})=>[u,fe,nt,o,e,t,s,n,r,i,a],[$a]=Wa();function Ha(o={}){return $a(o)}function qa(o,e,t){const s=fe.get(o);let n;const r=[],i=s[3];let a=!1;const l=i(d=>{if(r.push(d),t){e(r.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,a&&e(r.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Yo(o,e){const t=fe.get(o),[s,n,r]=t;return r(s,n(),e)}function yt(o){return nt.add(o),o}var Ys={exports:{}},Xs={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke=f;function Ka(o,e){return o===e&&(o!==0||1/o===1/e)||o!==o&&e!==e}var Ya=typeof Object.is=="function"?Object.is:Ka,Xa=Ke.useState,Za=Ke.useEffect,Ja=Ke.useLayoutEffect,Qa=Ke.useDebugValue;function el(o,e){var t=e(),s=Xa({inst:{value:t,getSnapshot:e}}),n=s[0].inst,r=s[1];return Ja(function(){n.value=t,n.getSnapshot=e,Zt(n)&&r({inst:n})},[o,t,e]),Za(function(){return Zt(n)&&r({inst:n}),o(function(){Zt(n)&&r({inst:n})})},[o]),Qa(t),t}function Zt(o){var e=o.getSnapshot;o=o.value;try{var t=e();return!Ya(o,t)}catch{return!0}}function tl(o,e){return e()}var ol=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?tl:el;Xs.useSyncExternalStore=Ke.useSyncExternalStore!==void 0?Ke.useSyncExternalStore:ol;Ys.exports=Xs;var sl=Ys.exports;const nl=Sn(sl),{use:Xo}=ms,{useSyncExternalStore:rl}=nl;const il=new WeakMap;function Zs(o,e){const t=e?.sync,s=f.useRef(),n=f.useRef();let r=!0;const i=rl(f.useCallback(l=>{const d=qa(o,l,t);return l(),d},[o,t]),()=>{const l=Yo(o,Xo);try{if(!r&&s.current&&n.current&&!Ks(s.current,l,n.current,new WeakMap))return s.current}catch{}return l},()=>Yo(o,Xo));r=!1;const a=new WeakMap;f.useEffect(()=>{s.current=i,n.current=a});const u=f.useMemo(()=>new WeakMap,[]);return qs(i,a,u,il)}const al=Se("ol-app:AppConfig"),ll=["ogc_kitas","ogc_kataster"];class cl{_intl;_mapRegistry;_ogcSearchSourceFactory;_vectorSelectionSourceFactory;_httpService;_state;_resources=[];constructor({references:e,intl:t}){this._mapRegistry=e.mapRegistry,this._intl=t,this._ogcSearchSourceFactory=e.ogcSearchSourceFactory,this._vectorSelectionSourceFactory=e.vectorSelectionSourceFactory,this._httpService=e.httpService,this._state=Ha({searchSources:[],selectionSources:[]}),this.initSearchSources(),this.initSelectionSources().catch(s=>{al.error("Failed to initialize selection sources",s)})}destroy(){this._resources.forEach(e=>e.destroy())}get state(){return this._state}initSearchSources(){const e=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.lika"}),baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"flurstueck",searchProperty:"flurstid",labelProperty:"objid"}),t=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(n){const r=n?.properties?.name,i=n?.id;return typeof r=="string"?r+" ("+i+")":String(i)},rewriteUrl(n){return n.searchParams.set("properties","name"),n}}),s=new Va("Photon Geocoder",["city","street"],this._httpService);this._state.searchSources=[yt(e),yt(t),yt(s)]}async initSelectionSources(){const e=await this._mapRegistry.expectMapModel(W),t=e.layers.getOperationalLayers({sortByDisplayOrder:!0});for(const s of t){if(!s||!ll.includes(s.id)||!ul(s.olLayer))continue;const n=this._vectorSelectionSourceFactory.createSelectionSource({vectorLayer:s.olLayer,label:s.title}),r=n.on("changed:status",()=>{n.status!=="available"&&(n.status==="unavailable"||n.status?.kind==="unavailable")&&e.removeHighlight()});this._resources.push(r,n),this._state.selectionSources.unshift(yt(n))}}}function ul(o){return o instanceof Te&&o.getSource()instanceof Ze}const wt={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class _t extends ws{constructor(e,t){super(e),this.feature=t}}function dl(o,e){const t=[];for(let s=0;s<e.length;++s){const r=e[s].getGeometry();Js(o,r,t)}return t}function xt(o,e){return Ms(o[0],o[1],e[0],e[1])}function Ie(o,e){const t=o.length;return e<0?o[e+t]:e>=t?o[e-t]:o[e]}function kt(o,e,t){let s,n;e<t?(s=e,n=t):(s=t,n=e);const r=Math.ceil(s),i=Math.floor(n);if(r>i){const u=Oe(o,s),l=Oe(o,n);return xt(u,l)}let a=0;if(s<r){const u=Oe(o,s),l=Ie(o,r);a+=xt(u,l)}if(i<n){const u=Ie(o,i),l=Oe(o,n);a+=xt(u,l)}for(let u=r;u<i-1;++u){const l=Ie(o,u),d=Ie(o,u+1);a+=xt(l,d)}return a}function Js(o,e,t){if(e instanceof je){Ct(o,e.getCoordinates(),!1,t);return}if(e instanceof Ds){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n)Ct(o,s[n],!1,t);return}if(e instanceof Ut){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n)Ct(o,s[n],!0,t);return}if(e instanceof js){const s=e.getCoordinates();for(let n=0,r=s.length;n<r;++n){const i=s[n];for(let a=0,u=i.length;a<u;++a)Ct(o,i[a],!0,t)}return}if(e instanceof jr){const s=e.getGeometries();for(let n=0;n<s.length;++n)Js(o,s[n],t);return}}const Jt={index:-1,endIndex:NaN};function hl(o,e,t,s){const n=o[0],r=o[1];let i=1/0,a=-1,u=NaN;for(let h=0;h<e.targets.length;++h){const m=e.targets[h],b=m.coordinates;let S=1/0,w;for(let L=0;L<b.length-1;++L){const E=b[L],A=b[L+1],T=Qs(n,r,E,A);T.squaredDistance<S&&(S=T.squaredDistance,w=L+T.along)}S<i&&(i=S,m.ring&&e.targetIndex===h&&(m.endIndex>m.startIndex?w<m.startIndex&&(w+=b.length):m.endIndex<m.startIndex&&w>m.startIndex&&(w-=b.length)),u=w,a=h)}const l=e.targets[a];let d=l.ring;if(e.targetIndex===a&&d){const h=Oe(l.coordinates,u),m=t.getPixelFromCoordinate(h);Ps(m,e.startPx)>s&&(d=!1)}if(d){const h=l.coordinates,m=h.length,b=l.startIndex,S=u;if(b<S){const w=kt(h,b,S);kt(h,b,S-m)<w&&(u-=m)}else{const w=kt(h,b,S);kt(h,b,S+m)<w&&(u+=m)}}return Jt.index=a,Jt.endIndex=u,Jt}function Ct(o,e,t,s){const n=o[0],r=o[1];for(let i=0,a=e.length-1;i<a;++i){const u=e[i],l=e[i+1],d=Qs(n,r,u,l);if(d.squaredDistance===0){const h=i+d.along;s.push({coordinates:e,ring:t,startIndex:h,endIndex:h});return}}}const Qt={along:0,squaredDistance:0};function Qs(o,e,t,s){const n=t[0],r=t[1],i=s[0],a=s[1],u=i-n,l=a-r;let d=0,h=n,m=r;return(u!==0||l!==0)&&(d=nr(((o-n)*u+(e-r)*l)/(u*u+l*l),0,1),h+=u*d,m+=l*d),Qt.along=d,Qt.squaredDistance=or(Ms(o,e,h,m),10),Qt}function Oe(o,e){const t=o.length;let s=Math.floor(e);const n=e-s;s>=t?s-=t:s<0&&(s+=t);let r=s+1;r>=t&&(r-=t);const i=o[s],a=i[0],u=i[1],l=o[r],d=l[0]-a,h=l[1]-u;return[a+d*n,u+h*n]}class fl extends qn{constructor(e){const t=e;t.stopDown||(t.stopDown=Kn),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=gl(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Yn,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let s=e.geometryFunction;if(!s){const n=this.mode_;if(n==="Circle")s=function(r,i,a){const u=i||new la([NaN,NaN]),l=Do(r[0]),d=Xn(l,Do(r[r.length-1]));return u.setCenterAndRadius(l,Math.sqrt(d),this.geometryLayout_),u};else{let r;n==="Point"?r=De:n==="LineString"?r=je:n==="Polygon"&&(r=Ut),s=function(i,a,u){return a?n==="Polygon"?i[0].length?a.setCoordinates([i[0].concat([i[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(i,this.geometryLayout_):a=new r(i,this.geometryLayout_),a}}}this.geometryFunction_=s,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Te({source:new Ze({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:pl(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Zn,this.freehandCondition_,e.freehand?this.freehandCondition_=jo:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Jn,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Qn.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=jo:t=e:t=sr,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===Es.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===de.POINTERMOVE,s=!0;return!this.freehand_&&this.lastDragTime_&&e.type===de.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===de.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),s=!1):this.freehand_&&e.type===de.POINTERDOWN?s=!1:t&&this.getPointerCount()<2?(s=e.type===de.POINTERMOVE,s&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===de.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===de.DBLCLICK&&(s=!1),super.handleEvent(e)&&s}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new er(de.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),s=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),n=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=Ss([s,n]),i=this.traceSource_.getFeaturesInExtent(r);if(i.length===0)return;const a=dl(e.coordinate,i);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const s=e.startIndex<=e.endIndex,n=e.startIndex<=t;s===n?s&&t>e.endIndex||!s&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(s&&t<e.endIndex||!s&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let s=0;if(e<t){const n=Math.ceil(e);let r=Math.floor(t);r===t&&(r-=1),s=r-n+1}else{const n=Math.floor(e);let r=Math.ceil(t);r===t&&(r+=1),s=n-r+1}s>0&&this.removeLastPoints_(s)}addTracedCoordinates_(e,t,s){if(t===s)return;const n=[];if(t<s){const r=Math.ceil(t);let i=Math.floor(s);i===s&&(i-=1);for(let a=r;a<=i;++a)n.push(Ie(e.coordinates,a))}else{const r=Math.floor(t);let i=Math.ceil(s);i===s&&(i+=1);for(let a=r;a>=i;--a)n.push(Ie(e.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&Ps(t.startPx,e.pixel)<this.snapTolerance_)return;const s=hl(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==s.index){if(t.targetIndex!==-1){const u=t.targets[t.targetIndex];this.removeTracedCoordinates_(u.startIndex,u.endIndex)}const a=t.targets[s.index];this.addTracedCoordinates_(a,a.startIndex,s.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,s.endIndex)}t.targetIndex=s.index;const n=t.targets[t.targetIndex];n.endIndex=s.endIndex;const r=Oe(n.coordinates,n.endIndex),i=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(i[0]),Math.round(i[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const s=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(e.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(e.pixel,s)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,s=e.pixel,n=t[0]-s[0],r=t[1]-s[1],i=n*n+r*r;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let s=!1;if(this.sketchFeature_){let n=!1,r=[this.finishCoordinate_];const i=this.mode_;if(i==="Point")s=!0;else if(i==="Circle")s=this.sketchCoords_.length===2;else if(i==="LineString")n=!t&&this.sketchCoords_.length>this.minPoints_;else if(i==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],t?r=[a[0][0]]:r=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let u=0,l=r.length;u<l;u++){const d=r[u],h=a.getPixelFromCoordinate(d),m=e[0]-h[0],b=e[1]-h[1],S=this.freehand_?1:this.snapTolerance_;if(s=Math.sqrt(m*m+b*b)<=S,s){this.finishCoordinate_=d;break}}}}return s}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new we(new De(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new we);const t=e.getLinearRing(0);let s=this.sketchLine_.getGeometry();s?(s.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),s.changed()):(s=new je(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(s))}startDrawing_(e){const t=this.getMap().getView().getProjection(),s=No(this.geometryLayout_);for(;e.length<s;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new we(new je(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new we,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new _t(wt.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),s=this.sketchFeature_.getGeometry(),n=t.getView().getProjection(),r=No(this.geometryLayout_);let i,a;for(;e.length<r;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(i=this.sketchCoords_[0],a=i[i.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(i=this.sketchCoords_,a=i[i.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,s,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),s.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(s):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection();let n,r;const i=this.mode_;i==="LineString"||i==="Circle"?(this.finishCoordinate_=e.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(e.slice()),this.geometryFunction_(r,t,s)):i==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(e.slice()),n&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,t,s)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),n&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection(),n=this.mode_;for(let r=0;r<e;++r){let i;if(n==="LineString"||n==="Circle"){if(i=this.sketchCoords_,i.splice(-2,1),i.length>=2){this.finishCoordinate_=i[i.length-2].slice();const a=this.finishCoordinate_.slice();i[i.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(i,t,s),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(n==="Polygon"){i=this.sketchCoords_[0],i.splice(-2,1);const a=this.sketchLine_.getGeometry();if(i.length>=2){const u=i[i.length-2].slice();i[i.length-1]=u,this.createOrUpdateSketchPoint_(u)}a.setCoordinates(i),this.geometryFunction_(this.sketchCoords_,t,s)}if(i.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const s=e.getGeometry(),n=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,s,n)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,s,n),t=s.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Dr([t])):this.type_==="MultiLineString"?e.setGeometry(new Ds([t])):this.type_==="MultiPolygon"&&e.setGeometry(new js([t])),this.dispatchEvent(new _t(wt.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new _t(wt.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,s=!this.sketchFeature_;s&&this.startDrawing_(e[0]);let n;if(t==="LineString"||t==="Circle")n=this.sketchCoords_;else if(t==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;s&&n.shift(),n.pop();for(let i=0;i<e.length;i++)this.addToDrawing_(e[i]);const r=e[e.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){const s=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=s.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new we(new De(n)),this.updateSketchFeatures_(),this.dispatchEvent(new _t(wt.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function pl(){const o=tr();return function(e,t){return o[e.getGeometry().getType()]}}function gl(o){switch(o){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+o)}}const ml=fl;class vl{constructor({properties:e}){const t=e.logLevel;console.debug("Log Service created with log level",t)}destroy(){console.debug("Log Service destroyed")}log(e){console.info("LOG: "+e)}}new De([407354,5754673]),new De([404740,5757893]);var Ce,pe,ct,ut,dt,go;class bl extends Ns{constructor(t,s,n){super();I(this,dt);Io(this,"label");I(this,Ce,{kind:"available"});I(this,pe,void 0);I(this,ct,void 0);I(this,ut,void 0);this.label=s,D(this,pe,t),D(this,ut,n),$(this,dt,go).call(this),D(this,ct,C(this,pe).on("change:visible",()=>{$(this,dt,go).call(this)}))}destroy(){be(C(this,ct))}get status(){return C(this,Ce)}async select(t,s){if(t.type!=="extent")throw new Error(`Unsupported selection kind: ${t.type}`);if(C(this,Ce).kind!=="available"||C(this,pe).getSource()===null)return[];const n=[];C(this,pe).getSource().forEachFeatureIntersectingExtent(t.extent,a=>{if(!a.getGeometry())return;const u={id:a.getId()?.toString()||a.getGeometry.toString(),geometry:a.getGeometry()};n.push(u)});const r=n.filter(a=>a!=null);return r.length>s.maxResults?r.slice(0,s.maxResults):r}}Ce=new WeakMap,pe=new WeakMap,ct=new WeakMap,ut=new WeakMap,dt=new WeakSet,go=function(){const s=C(this,pe).getVisible()?{kind:"available"}:{kind:"unavailable",reason:C(this,ut)};s.kind!==C(this,Ce).kind&&(D(this,Ce,s),this.emit("changed:status"))};var ht;class Sl{constructor({intl:e}){I(this,ht,void 0);D(this,ht,e)}createSelectionSource(e){return new bl(e.vectorLayer,e.label,C(this,ht).formatMessage({id:"layerNotVisibleReason"}))}}ht=new WeakMap;const Me=Se("local-storage"),yl=0,ne={CORRUPTED_DATA:"local-storage:corrupted-data",INVALID_PATH:"local-storage:invalid-path",INVALID_VALUE:"local-storage:invalid-value",NOT_SUPPORTED:"local-storage:not-supported",INTERNAL:"local-storage:internal-error"};var Ge,ee,ge,Ue,te,Nt,en,Ft,tn,Ee,rt,me,Ae,Vt,on;class wl{constructor(e){I(this,Nt);I(this,Ft);I(this,Ee);I(this,me);I(this,Vt);I(this,Ge,void 0);I(this,ee,{});I(this,ge,void 0);I(this,Ue,void 0);I(this,te,void 0);D(this,Ge,Cl(e.properties)),D(this,ge,El()),C(this,ge)&&($(this,Ft,tn).call(this),D(this,Ue,$(this,Vt,on).call(this)))}destroy(){C(this,te)&&(clearTimeout(C(this,te)),D(this,te,void 0)),C(this,ge)&&$(this,Ee,rt).call(this)}get isSupported(){return!!C(this,Ue)}get(e){return $(this,me,Ae).call(this).get(e)}set(e,t){return $(this,me,Ae).call(this).set(e,t)}remove(e){return $(this,me,Ae).call(this).remove(e)}removeAll(){return $(this,me,Ae).call(this).removeAll()}getNamespace(e){return $(this,me,Ae).call(this).getNamespace(e)}}Ge=new WeakMap,ee=new WeakMap,ge=new WeakMap,Ue=new WeakMap,te=new WeakMap,Nt=new WeakSet,en=function(){C(this,te)&&clearTimeout(C(this,te)),D(this,te,setTimeout(()=>{D(this,te,void 0),$(this,Ee,rt).call(this)},yl))},Ft=new WeakSet,tn=function(){try{const e=C(this,ge);if(!e)throw new se(ne.INTERNAL,"Local storage is not available.");const t=e.getItem(C(this,Ge));if(t==null){D(this,ee,{}),$(this,Ee,rt).call(this);return}try{const s=JSON.parse(t);if(!Ye(s))throw new se(ne.CORRUPTED_DATA,"Persisted value should be an object.");D(this,ee,s)}catch(s){Me.warn("Invalid persisted data, reverting to default.",s),D(this,ee,{}),$(this,Ee,rt).call(this)}}catch(e){Me.error("Failed to load from local storage",e)}},Ee=new WeakSet,rt=function(){try{const e=C(this,ge);if(!e)throw new se(ne.INTERNAL,"Local storage is not available.");const t=JSON.stringify(C(this,ee));e.setItem(C(this,Ge),t)}catch(e){Me.error("Failed to save to local storage",e)}},me=new WeakSet,Ae=function(){const e=C(this,Ue);if(!e)throw new se(ne.NOT_SUPPORTED,"Local storage is not supported by this browser.");return e},Vt=new WeakSet,on=function(){const e={getByPath:t=>Jo(_l(C(this,ee),t)),setByPath:(t,s)=>{if(!kl(s))throw new se(ne.INVALID_VALUE,"The value is not supported by local storage.");if(s=Jo(s),t.length===0){if(!Ye(s))throw new se(ne.INVALID_VALUE,"The root value must be a plain object.");D(this,ee,s)}else xl(C(this,ee),t,s);$(this,Nt,en).call(this)}};return new Po([],e)};class Po{path;access;constructor(e,t){this.path=e,this.access=t}get(e){return this.access.getByPath([...this.path,e])}set(e,t){this.access.setByPath([...this.path,e],t)}remove(e){this.access.setByPath([...this.path,e],void 0)}removeAll(){this.access.setByPath(this.path,{})}getNamespace(e){const t=this.get(e);if(t===void 0)this.set(e,{});else if(!Ye(t))throw new se(ne.INVALID_PATH,`Cannot use '${e}' as a namespace because it is not associated with an object.`);return new Po(this.path.concat([e]),this.access)}}const Zo="trails-state";function _l(o,e){let t=o;for(const s of e){if(!Ye(t))throw new se(ne.INVALID_PATH,`Cannot get nested property '${s}' because the parent is no object.`);t=t[s]}return t}function xl(o,e,t){if(!e.length)throw new se(ne.INTERNAL,"Path must not be empty.");let s=o;for(let r=0,i=e.length-1;r<i;++r){const a=e[r],u=s[a];if(!Ye(u))throw new se(ne.INVALID_PATH,`Cannot set property on '${a}' because it is no object.`);s=u}const n=e[e.length-1];s[n]=t}function Ye(o){return!!(o&&typeof o=="object"&&!Array.isArray(o))}function kl(o){const e=typeof o;return e==="boolean"||e==="number"||e==="string"||e==="undefined"||o===null||Array.isArray(o)||Ye(o)}function Cl(o){const e=o.storageId;return!e||typeof e!="string"?(Me.warn(`The 'storageId' property of the 'local-storage' package should be set to a valid string to avoid collisions with other applications. Defaulting to '${Zo}'.`),Zo):e}function El(){if(typeof Storage>"u"){Me.warn("Local storage is not supported by this browser.");return}try{const o=globalThis.localStorage;if(!o){Me.warn("Local storage is not supported by this browser.");return}return o}catch(o){Me.warn("Local storage is not supported by this browser.",o);return}}function Jo(o){return o!=null&&(o=JSON.parse(JSON.stringify(o))),o}const Pl={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:Ta,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},AppConfig:{name:"AppConfig",clazz:cl,provides:[{name:"ol-app.AppConfig",qualifier:void 0}],references:{ogcSearchSourceFactory:{name:"ogc-features.SearchSourceFactory",qualifier:void 0,all:!1},vectorSelectionSourceFactory:{name:"selection.VectorSelectionSourceFactory",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1},mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map-sample-logging.LogService",qualifier:void 0,all:!1},{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppConfig",qualifier:void 0,all:!1},{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:rr,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:ir,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Fr,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:Gr,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:Ur,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"map-sample-logging":{name:"map-sample-logging",services:{LogService:{name:"LogService",clazz:vl,provides:[{name:"map-sample-logging.LogService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{logLevel:{value:"INFO",required:!1}}},"@open-pioneer/selection":{name:"@open-pioneer/selection",services:{VectorSelectionSourceFactory:{name:"VectorSelectionSourceFactory",clazz:Sl,provides:[{name:"selection.VectorSelectionSourceFactory",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/legend":{name:"@open-pioneer/legend",services:{},ui:{references:[]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:wl,provides:[{name:"local-storage.LocalStorageService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}}},Ml=`.search-box{position:absolute;width:500px;max-width:100%;z-index:1}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.selection-drag-box{background-color:#ffffff4d!important;border:3px solid var(--chakra-colors-background_primary)!important}.selection-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.selection .react-select{cursor:default}.map-container .selection-active{cursor:crosshair}.map-container .selection-inactive{cursor:no-drop}.selection-source-value.selection-source-value--disabled{opacity:.4}.selection-source-value.selection-source-value--disabled span{margin:0 6px 0 0}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}
`,Ll=["en","de"];function Tl(o){switch(o){case"en":return Wo(()=>import("./2b4f9033925d.js"),[],import.meta.url).then(e=>e.default);case"de":return Wo(()=>import("./95397c0eecb3.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${o}'`)}const Rl=yn(Ml),Al=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Tl,locales:Ll,packages:Pl,styles:Rl},Symbol.toStringTag,{value:"Module"})),Il="@open-pioneer/coordinate-viewer",Ol=ce.bind(void 0,Il),Dl=4,jl=o=>{const{mapId:e,precision:t}=o,{containerProps:s}=re("coordinate-viewer",o),{map:n}=J(e),r=n?.olMap,{coordinates:i}=Fl(r),a=Nl(i,t),u=Ws(r)?.getCode()??"",l=a?a+" "+u:"";return c.jsx(N,{...s,children:c.jsx(Q,{className:"coordinate-viewer-text",children:l})})};function Nl(o,e){const t=Ol();return o?Vl(o,e,t):""}function Fl(o){const[e,t]=f.useState();return f.useEffect(()=>{if(!o)return;const s=o.on("pointermove",n=>{t(n.coordinate)});return()=>be(s)},[o]),{coordinates:e}}function Vl(o,e,t){if(o[0]==null||o[1]==null)return"";const s=e??Dl,[n,r]=o,i=t.formatNumber(n,{maximumFractionDigits:s,minimumFractionDigits:s}),a=t.formatNumber(r,{maximumFractionDigits:s,minimumFractionDigits:s});return i+" "+a}const sn="@open-pioneer/geolocation",Bl=zt.bind(void 0,sn),Gl=ce.bind(void 0,sn);function Ul(o){return Hr({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(o)}const Qo=Se("geolocation:GeolocationController"),es=17;class zl extends Ns{olMap;positionHighlightLayer;geolocation;maxZoom=es;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new we,this.accuracyFeature.setStyle(os()),this.positionFeature=new we,this.positionFeature.setStyle(ts()),this.positionHighlightLayer=new Te({source:new Ze({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(Ls);const s=t||Wl();this.geolocation=new aa({tracking:!1,trackingOptions:s,projection:e.getView()?.getProjection()}),this.trackingOptions=s,this.geolocation.on("error",n=>this.handleGeolocationError(n))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(s=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const n=this.geolocation.on("change:accuracyGeometry",()=>{const u=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(u),this.accuracyFeature?.getGeometry()!==void 0&&s(),this.isInitialZoom){const l=this?.accuracyFeature?.getGeometry()?.getExtent();if(l){const d=Ca(l);if(!d)return;e.getView().fit(d,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),r=this.geolocation.on("change:position",()=>{const u=this.geolocation.getPosition();u&&(u[0]||u[1])!==void 0&&(this.positionFeature?.setGeometry(new De(u)),this.setMapToPosition&&e.getView().setCenter(u),this.positionFeature?.getGeometry()!==void 0&&s())}),i=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",u=>{u.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(n,r,i,a),e.addLayer(this.positionHighlightLayer)}).catch(s=>{Qo.error("Failed to determine location",s)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{be(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??ts())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??os())}setMaxZoom(e){this.maxZoom=e??es}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){Qo.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const ts=()=>new Le({image:new wo({radius:6,fill:new He({color:"#3399CC"}),stroke:new Pe({color:"#fff",width:2})})}),os=()=>new Le({stroke:new Pe({color:"#3399CC",width:3}),fill:new He({color:"rgba(0, 0, 255, 0.05)"})}),Wl=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),$l=f.forwardRef(function(e,t){const{mapId:s,maxZoom:n,positionFeatureStyle:r,accuracyFeatureStyle:i,trackingOptions:a}=e,{containerProps:u}=re("geolocation",e),l=!!navigator.geolocation,[d,h]=f.useState(!1),[m,b]=f.useState(!1),{map:S}=J(s),w=Gl(),L=Bl("notifier.NotificationService"),E=Hl(S,n,a,r,i),A=(()=>l?d?w.formatMessage({id:"locateMeEnd"}):w.formatMessage({id:"locateMeStart"}):w.formatMessage({id:"locateNotSupported"}))();f.useEffect(()=>{if(E===void 0)return;const q=E.on("error",function(K){const R=w.formatMessage({id:"error"}),z=(()=>{switch(K){case"permission-denied":return w.formatMessage({id:"permissionDenied"});case"position-unavailable":return w.formatMessage({id:"positionUnavailable"});case"timeout":return w.formatMessage({id:"timeout"});case"unknown":return w.formatMessage({id:"unknownError"})}})();b(!1),h(!1),L.notify({level:"error",title:R,message:z})});return()=>{q.destroy()}},[E,w,L]),f.useEffect(()=>{if(!E){b(!1);return}return d&&(b(!0),E.startGeolocation().then(()=>{b(!1)})),()=>{E?.stopGeolocation(),b(!1)}},[E,d]);const T=()=>{S&&h(!d)};return c.jsx(ye,{ref:t,label:A,icon:c.jsx(Ul,{}),onClick:()=>T(),isActive:d,isLoading:m,isDisabled:!l,...u})});function Hl(o,e,t,s,n){const[r,i]=f.useState();return f.useEffect(()=>{if(!o)return;const a=new zl(o.olMap,t);return i(a),()=>{a.destroy(),i(void 0)}},[o,t]),f.useEffect(()=>{r?.setPositionFeatureStyle(s)},[r,s]),f.useEffect(()=>{r?.setAccuracyFeatureStyle(n)},[r,n]),f.useEffect(()=>{r?.setMaxZoom(e)},[r,e]),r}const ql="@open-pioneer/measurement",Kl=ce.bind(void 0,ql);class Yl{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const s=this.source=new Ze;this.layer=new Te({source:s}),this.layer.setZIndex(Ls),e.addLayer(this.layer);const n=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){be(n)}});const r=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",r),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",r)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=ar(e);this.activeFeatureStyle=(s,...n)=>{const r=s?.getGeometry()?.getType();if(r==="Polygon"||r==="LineString"||r==="Point")return t(s,...n)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",s=this.draw=new ml({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(s);let n,r;s.on("drawstart",i=>{n=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=i.feature;if(!a)return;let u;r=a.getGeometry()?.on("change",l=>{const d=l.target,h=this.olMap.getView().getProjection();let m="";d instanceof Ut?(m=Zl(d,h,this.messages),u=d.getInteriorPoint().getCoordinates()||null):d instanceof je&&(m=Jl(d,h,this.messages),u=d.getLastCoordinate()||null),n&&(n.element.innerHTML=m,u&&n?.overlay.setPosition(u))})}),s.on("drawend",()=>{if(n){const i=n.element.classList;i.remove("measurement-active-tooltip"),i.add("measurement-finished-tooltip"),n.overlay.setOffset([0,-7]),this.overlayTooltips.push(n),this.measureTooltip=n=void 0}this.sketch=void 0,r&&be(r)}),s.on("drawabort",()=>{n&&(n.destroy(),this.measureTooltip=n=void 0),this.sketch=void 0,r&&be(r)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip";const t=new Rt({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip hidden";const t=new Rt({element:e,offset:[15,0],positioning:"center-left"}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,s=Xl(this.messages,this.sketch);t.element.textContent=s,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function Xl(o,e){if(e){const t=e.getGeometry();if(t instanceof Ut||t instanceof je)return o.getContinueMessage()}return o.getHelpMessage()}function Zl(o,e,t){const s=lr(o,{projection:e});let n;return s>=1e6?n=`${t.formatNumber(s/1e6)} km<sup>2</sup>`:n=`${t.formatNumber(s)} m<sup>2</sup>`,n}function Jl(o,e,t){const s=cr(o,{projection:e});let n;return s>=1e3?n=`${t.formatNumber(s/1e3)} km`:n=`${t.formatNumber(s)} m`,n}const Ql=o=>{const e=Kl(),{mapId:t,activeFeatureStyle:s,finishedFeatureStyle:n}=o,{containerProps:r}=re("measurement",o),[i,a]=f.useState("distance"),u=b=>e.formatMessage({id:b}),l=J(t),d=ec(l.map,e);f.useEffect(()=>{d?.setActiveFeatureStyle(s??tc())},[d,s]),f.useEffect(()=>{d?.setFinishedFeatureStyle(n??oc())},[d,n]),f.useEffect(()=>{if(d)return d.startMeasurement(i),()=>{d.stopMeasurement()}},[d,i]);function h(b){if(b==="distance"||b==="area")a(b);else throw new Error(`Unexpected measurement type: '${b}'.`)}function m(){d?.clearMeasurements()}return c.jsxs(N,{...r,children:[c.jsx(Q,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),c.jsx(io,{mb:4,alignItems:"center",children:c.jsxs(Kr,{mb:2,children:[c.jsx(ao,{mb:1,children:u("measurementLabel")}),c.jsxs(Yr,{value:i,onChange:b=>h(b.target.value),className:"measurement-select",children:[c.jsx("option",{value:"distance",children:u("distance")}),c.jsx("option",{value:"area",children:u("area")})]})]})}),c.jsx(So,{padding:2,className:"measurement-delete-button",onClick:m,width:"100%",children:u("deleteMeasurementLabel")})]})};function ec(o,e){const[t,s]=f.useState(void 0);return f.useEffect(()=>{if(!o)return;const n=new Yl(o.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(r){return e.formatNumber(r,{maximumFractionDigits:2})}});return s(n),()=>{n.destroy(),s(void 0)}},[o,e]),t}function tc(){return[new Le({stroke:new Pe({color:"#fff",lineDash:[10,10],width:5})}),new Le({fill:new He({color:"rgba(0,0,0,0.15)"}),stroke:new Pe({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new wo({radius:5,stroke:new Pe({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new He({color:"rgba(255, 255, 255, 0.2)"})})})]}function oc(){return[new Le({stroke:new Pe({color:"#fff",width:5})}),new Le({stroke:new Pe({color:"#0b96fc",width:3}),fill:new He({color:"rgba(11,150,252,0.15)"})})]}var sc=Xr({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const eo=.75,Et=.1;let nc=class extends Ts{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",s=e.tipLabel!==void 0?e.tipLabel:"Overview map",n=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const r=e.label!==void 0?e.label:"›";typeof r=="string"?(this.label_=document.createElement("span"),this.label_.textContent=r):this.label_=r;const i=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=s,a.appendChild(i),a.addEventListener(Es.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const u=new ur({view:e.view,controls:new Fo,interactions:new Fo});this.ovmap_=u,e.layers&&e.layers.forEach(function(A){u.addLayer(A)});const l=document.createElement("div");l.className="ol-overviewmap-box",l.style.boxSizing="border-box",this.boxOverlay_=new Rt({position:[0,0],positioning:"center-center",element:l}),this.ovmap_.addOverlay(this.boxOverlay_);const d=t+" "+Rs+" "+dr+(this.collapsed_&&this.collapsible_?" "+Vo:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=d,h.appendChild(this.ovmapDiv_),h.appendChild(a);const m=this,b=this.boxOverlay_,S=this.boxOverlay_.getElement(),w=function(A){return{clientX:A.clientX,clientY:A.clientY}},L=function(A){const T=w(A),q=u.getEventCoordinateInternal(T);b.setPosition(q)},E=function(A){const T=u.getEventCoordinateInternal(A);m.getMap().getView().setCenterInternal(T),window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",E)};S.addEventListener("mousedown",function(){window.addEventListener("mousemove",L),window.addEventListener("mouseup",E)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const s=t.getView();s&&this.unbindView_(s),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(_s(e,hr.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const s=e.getView();s&&(this.bindView_(s),s.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===Yt.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const s=this.getMap().getView();this.bindView_(s)}else!this.ovmap_.isRendered()&&(e.key===Yt.TARGET||e.key===Yt.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new fr({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(Bo.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(Bo.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),r=e.getView().calculateExtentInternal(s);if(this.viewExtent_&&pr(r,this.viewExtent_))return;this.viewExtent_=r;const i=t.getSize(),u=t.getView().calculateExtentInternal(i),l=t.getPixelFromCoordinateInternal(gr(r)),d=t.getPixelFromCoordinateInternal(mr(r)),h=Math.abs(l[0]-d[0]),m=Math.abs(l[1]-d[1]),b=i[0],S=i[1];h<b*Et||m<S*Et||h>b*eo||m>S*eo?this.resetExtent_():ks(u,r)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,s=e.getSize(),r=e.getView().calculateExtentInternal(s),i=t.getView(),a=Math.log(eo/Et)/Math.LN2,u=1/(Math.pow(2,a/2)*Et);vr(r,u),i.fitInternal(br(r))}recenter_(){const e=this.getMap(),t=this.ovmap_,s=e.getView();t.getView().setCenterInternal(s.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),n=e.getView(),r=t.getView(),i=this.rotateWithView_?0:-n.getRotation(),a=this.boxOverlay_,u=this.boxOverlay_.getElement(),l=n.getCenterInternal(),d=n.getResolution(),h=r.getResolution(),m=s[0]*d/h,b=s[1]*d/h;if(a.setPosition(l),u){u.style.width=m+"px",u.style.height=b+"px";const S="rotate("+i+"rad)";u.style.transform=S}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=Sr(this.ovmap_,xs.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(Vo),this.collapsed_?Go(this.collapseLabel_,this.label_):Go(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const rc=nc,to="units",ic=[1,2,5],tt=25.4/.28;class ac extends Ts{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const s=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=s+"-inner",this.element.className=s+" "+Rs,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(to,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(to)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(to,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,s=e.projection,n=this.getUnits(),r=n=="degrees"?"degrees":"m";let i=no(s,e.resolution,t,r);const a=this.minWidth_*(this.dpi_||tt)/tt,u=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||tt)/tt:void 0;let l=a*i,d="";if(n=="degrees"){const T=yr.degrees;l*=T,l<T/60?(d="″",i*=3600):l<T?(d="′",i*=60):d="°"}else if(n=="imperial")l<.9144?(d="in",i/=.0254):l<1609.344?(d="ft",i/=.3048):(d="mi",i/=1609.344);else if(n=="nautical")i/=1852,d="NM";else if(n=="metric")l<.001?(d="μm",i*=1e6):l<1?(d="mm",i*=1e3):l<1e3?d="m":(d="km",i/=1e3);else if(n=="us")l<.9144?(d="in",i*=39.37):l<1609.344?(d="ft",i/=.30480061):(d="mi",i/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*i)/Math.log(10)),m,b,S,w,L,E;for(;;){S=Math.floor(h/3);const T=Math.pow(10,S);if(m=ic[(h%3+3)%3]*T,b=Math.round(m/i),isNaN(b)){this.element.style.display="none",this.renderedVisible_=!1;return}if(u!==void 0&&b>=u){m=w,b=L,S=E;break}else if(b>=a)break;w=m,L=b,E=S,++h}const A=this.scaleBar_?this.createScaleBar(b,m,d):m.toFixed(S<0?-S:0)+" "+d;this.renderedHTML_!=A&&(this.innerElement_.innerHTML=A,this.renderedHTML_=A),this.renderedWidth_!=b&&(this.innerElement_.style.width=b+"px",this.renderedWidth_=b),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,s){const n=this.getScaleForResolution(),r=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),i=this.scaleBarSteps_,a=e/i,u=[this.createMarker("absolute")];for(let d=0;d<i;++d){const h=d%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";u.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(d%2===0||i===2?this.createStepText(d,e,!1,t,s):"")+"</div>")}return u.push(this.createStepText(i,e,!0,t,s)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+r+"</div>":"")+u.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,s,n,r){const a=(e===0?0:Math.round(n/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+r),u=e===0?-3:t/this.scaleBarSteps_*-1,l=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${u}px;text-align: ${e===0?"left":"center"};min-width: ${l}px;left: ${s?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=no(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||tt,s=1e3/25.4;return e*s*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const lc=ac,cc="200px",uc="300px",dc=o=>{const{mapId:e,olLayer:t,height:s=cc,width:n=uc}=o,{containerProps:r}=re("overview-map",o),i=f.useRef(null),{map:a}=J(e);return f.useEffect(()=>{if(i.current&&a&&t){const u=a.olMap,l=new rc({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:i.current});return u.addControl(l),()=>{u.removeControl(l)}}},[a,t]),c.jsx(N,{height:s,width:n,ref:i,...r})},hc=o=>{const{mapId:e,displayMode:t="line"}=o,{containerProps:s}=re("scale-bar",o),{map:n}=J(e),r=f.useRef(null);return f.useEffect(()=>{if(r.current&&n){const i=n.olMap,a=new lc({units:"metric",target:r.current,bar:t==="bar"});return i.addControl(a),()=>{i.removeControl(a)}}},[t,n]),c.jsx(N,{...s,ref:r})},fc="@open-pioneer/scale-viewer",pc=ce.bind(void 0,fc),gc=o=>{const{mapId:e}=o,{containerProps:t}=re("scale-viewer",o),{map:s}=J(e),n=pc(),r=xa(s?.olMap),i=r?n.formatNumber(r):void 0;return c.jsx(N,{...t,children:i&&c.jsxs(Q,{children:["1:",i]})})},mc="@open-pioneer/search",$t=ce.bind(void 0,mc);function vc(o){const e=o.selectProps.inputValue.length>0,t={...o,className:bt(o.className,{"search-invisible":!e})};return c.jsx(ue.Menu,{...t,children:o.children})}function bc(o){const t=$t().formatMessage({id:"noOptionsText"});return c.jsx(ue.NoOptionsMessage,{...o,children:c.jsx(le.span,{className:"search-no-match",children:t})})}function Sc(o){const t=$t().formatMessage({id:"loadingText"});return c.jsx(ue.LoadingMessage,{...o,children:c.jsx(le.span,{className:"search-loading-text",children:t})})}function yc({children:o,...e}){const t={...e,className:bt(e.className,"search-value-container")};return c.jsxs(ue.ValueContainer,{...t,children:[!!o&&c.jsx(sc,{style:{position:"absolute",left:8}}),o]})}function wc(o){const e={...o,isHidden:!1};return c.jsx(ue.Input,{...e})}function _c(o){return null}function xc(o){return c.jsxs(ue.IndicatorsContainer,{...o,children:[o.children,!o.selectProps.isLoading&&o.selectProps.inputValue&&c.jsx(kc,{selectProps:o.selectProps,clearValue:o.clearValue})]})}function kc(o){const t=$t().formatMessage({id:"ariaLabel.clearButton"}),s=n=>{n.preventDefault(),n.stopPropagation(),o.clearValue()};return c.jsx(wn,{role:"button",size:"md",mr:1,"aria-label":t,onClick:s,onTouchEnd:s,onMouseDown:n=>n.preventDefault()})}function Cc(o){return null}function Ec(o){const e=o.selectProps.inputValue,t=o.data.label,s={...o,className:bt(o.className,"search-option")};return c.jsx(ue.Option,{...s,children:c.jsx(le.div,{className:"search-option-label",children:e.trim().length>0?Pc(t,e):t})})}function Pc(o,e){const t=o.toLowerCase().indexOf(e.toLowerCase());return t>=0?c.jsxs(c.Fragment,{children:[o.substring(0,t),c.jsx(le.span,{className:"search-highlighted-match",children:o.substring(t,t+e.length)},"highlighted"),o.substring(t+e.length)]}):o}const ss=Se("search:SearchController"),ns=200,rs=5;var ft,ze,We,$e,oe,Bt,nn;class Mc{constructor(e,t){I(this,Bt);I(this,ft,void 0);I(this,ze,[]);I(this,We,rs);I(this,$e,ns);I(this,oe,void 0);D(this,ft,e),D(this,ze,t)}destroy(){C(this,oe)?.abort(),D(this,oe,void 0)}async search(e){if(C(this,oe)?.abort(),D(this,oe,void 0),!e)return[];const t=D(this,oe,new AbortController);try{return await Lc(t.signal,C(this,$e)),t.signal.aborted&&(ss.debug(`search canceled with ${e}`),_n()),(await Promise.all(C(this,ze).map(n=>$(this,Bt,nn).call(this,n,e,t.signal)))).filter(n=>n!=null)}finally{C(this,oe)===t&&D(this,oe,void 0)}}get searchTypingDelay(){return C(this,$e)}set searchTypingDelay(e){D(this,$e,e??ns)}get maxResultsPerSource(){return C(this,We)}set maxResultsPerSource(e){D(this,We,e??rs)}get sources(){return C(this,ze)}}ft=new WeakMap,ze=new WeakMap,We=new WeakMap,$e=new WeakMap,oe=new WeakMap,Bt=new WeakSet,nn=async function(e,t,s){const n=e.label,r=C(this,ft).olMap.getView().getProjection();try{const i=C(this,We);let a=await e.search(t,{maxResults:i,signal:s,mapProjection:r});return a.length>i&&(a=a.slice(0,i)),{label:n,source:e,results:a}}catch(i){Tt(i)||ss.error(`search for source ${n} failed`,i);return}};async function Lc(o,e){o.aborted||await new Promise(t=>{const s=()=>{o.removeEventListener("abort",s),clearTimeout(n),t()};o.addEventListener("abort",s);const n=setTimeout(s,e)})}const At=Se("search:Search"),Tc=o=>{const{mapId:e,sources:t,searchTypingDelay:s,maxResultsPerGroup:n,onSelect:r,onClear:i}=o,{containerProps:a}=re("search",o),{map:u}=J(e),l=$t(),d=Oc(t,s,n,u),{input:h,search:m,selectedOption:b,onInputChanged:S,onResultConfirmed:w}=Dc(d),L=Ic(),E=Rc(l),A=Ac(),T=qe((R,z)=>{z.action==="input-change"&&S(R)}),q=qe((R,z)=>{switch(z.action){case"select-option":R&&(w(R),r?.({source:R.source,result:R.result}));break;case"clear":S(""),K.current?.blur(),K.current?.focus(),i?.();break;default:At.debug(`Unhandled action type '${z.action}'.`);break}}),K=f.useRef(null);return c.jsx(N,{...a,children:c.jsx(lo,{className:"search-component",classNamePrefix:"react-select",ref:K,inputValue:h,onInputChange:T,"aria-label":l.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:E,colorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:L,isClearable:!0,placeholder:l.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:m.kind==="loading",options:m.kind==="ready"?m.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:A,onChange:q,value:b,menuPosition:"fixed"})})};function Rc(o){return f.useMemo(()=>({onFocus:({focused:r})=>`${r.label} ${o.formatMessage({id:"ariaLabel.searchFocus"})}.`,onChange:({action:r,label:i})=>{let a="";switch(r){case"select-option":a=`${i} ${o.formatMessage({id:"ariaLabel.searchSelect"})}.`;break;case"clear":a=`${i} ${o.formatMessage({id:"ariaLabel.searchClear"})}.`;break}return a},guidance:()=>`${o.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[o])}function Ac(){return f.useMemo(()=>({Menu:vc,Input:wc,SingleValue:_c,Option:Ec,NoOptionsMessage:bc,LoadingMessage:Sc,ValueContainer:yc,IndicatorsContainer:xc,ClearIndicator:Cc}),[])}function Ic(){const[o,e]=vs("colors",["trails.100","trails.50"],["#d5e5ec","#eaf2f5"]);return f.useMemo(()=>({groupHeading:s=>({...s,backgroundColor:o,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:s=>({...s,backgroundColor:"inherit",_focus:{backgroundColor:e}}),dropdownIndicator:s=>({...s,display:"none"})}),[o,e])}function Oc(o,e,t,s){const[n,r]=f.useState(void 0);return f.useEffect(()=>{if(!s)return;const i=new Mc(s,o);return r(i),()=>{i.destroy(),r(void 0)}},[s,o]),f.useEffect(()=>{n&&(n.searchTypingDelay=e)},[n,e]),f.useEffect(()=>{n&&(n.maxResultsPerSource=t)},[n,t]),n}function Dc(o){const[e,t]=f.useReducer((a,u)=>{switch(u.kind){case"input":return{...a,query:u.query,selectedOption:null};case"select-option":return{...a,selectedOption:u.option,query:u.option.label};case"load-results":return{...a,search:{kind:"loading"}};case"accept-results":return{...a,search:{kind:"ready",results:u.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),s=f.useRef(),n=qe(a=>{if(!o){s.current=void 0,t({kind:"accept-results",results:[]});return}At.isDebug()&&At.debug(`Starting new search for query ${JSON.stringify(a)}.`),t({kind:"load-results"});const u=s.current=jc(o,a).then(l=>{s.current===u&&t({kind:"accept-results",results:l})})}),r=f.useCallback(a=>{t({kind:"select-option",option:a})},[]),i=f.useCallback(a=>{t({kind:"input",query:a}),n(a)},[n]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:r,onInputChanged:i}}async function jc(o,e){let t;try{t=await o.search(e)}catch(s){Tt(s)||At.error("Search failed",s),t=[]}return Nc(t)}function Nc(o){return o.map((t,s)=>({label:t.label,options:t.results.map(n=>({value:`${s}-${n.id}`,label:n.label,source:t.source,result:n}))}))}const rn="@open-pioneer/selection",Fc=zt.bind(void 0,rn),Mo=ce.bind(void 0,rn),ot="selection-active",Pt="selection-inactive";class Vc{tooltip;interactionResources=[];olMap;isActive=!0;tooltipMessage;tooltipDisabledMessage;constructor(e,t,s,n,r){let i;switch(t){case Lo.extent:default:i=this.initViewport(e),this.interactionResources.push(this.createDragBox(e,r,i,this.interactionResources)),this.interactionResources.push(this.createDrag(e,i,this.interactionResources));break}this.tooltip=this.createHelpTooltip(e,s),this.olMap=e,this.tooltipMessage=s,this.tooltipDisabledMessage=n}initViewport(e){const t=e.getViewport();return t.classList.add(ot),t.oncontextmenu=s=>(s.preventDefault(),!1),t}destroy(){this.tooltip.destroy(),this.interactionResources.forEach(e=>{e.destroy()})}setActive(e){if(this.isActive===e)return;const t=this.olMap.getViewport();e?(this.interactionResources.forEach(s=>this.olMap.addInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipMessage,t.classList.remove(Pt),t.classList.add(ot),this.isActive=!0):(this.interactionResources.forEach(s=>this.olMap.removeInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipDisabledMessage,t.classList.remove(ot),t.classList.add(Pt),this.isActive=!1)}createDragBox(e,t,s,n){const r=new Uo({className:"selection-drag-box",condition:wr});return e.addInteraction(r),r.on("boxend",function(){t(r.getGeometry())}),{interaction:r,destroy(){e.removeInteraction(r),n.splice(n.indexOf(this)),r.dispose(),s.classList.remove(ot),s.classList.remove(Pt),s.oncontextmenu=null}}}createDrag(e,t,s){const n=function(a){return a.originalEvent.button==2},r=new zo({condition:n});return e.addInteraction(r),{interaction:r,destroy(){e.removeInteraction(r),s.splice(s.indexOf(this)),r.dispose(),t.classList.remove(ot),t.classList.remove(Pt),t.oncontextmenu=null}}}createHelpTooltip(e,t){const s=document.createElement("div");s.className="selection-tooltip",s.textContent=t;const n=new Rt({element:s,offset:[15,0],positioning:"center-left"}),r=e.on("pointermove",i=>{n.setPosition(i.coordinate)});return e.addOverlay(n),{overlay:n,element:s,destroy(){e.removeOverlay(n),n.dispose(),be(r)}}}getDragboxInteraction(){return this.interactionResources.find(e=>e.interaction instanceof Uo)}getDragPanInteraction(){return this.interactionResources.find(e=>e.interaction instanceof zo)}}const oo=Se("selection:SelectionController"),Bc=1e4;var pt,gt,mt,Gt,an;class Gc{constructor(e){I(this,Gt);I(this,pt,void 0);I(this,gt,void 0);I(this,mt,void 0);const{mapModel:t,onError:s,maxResults:n=Bc}=e;D(this,pt,t),D(this,gt,n),D(this,mt,s)}destroy(){}async select(e,t){if(t)return await $(this,Gt,an).call(this,e,t)}}pt=new WeakMap,gt=new WeakMap,mt=new WeakMap,Gt=new WeakSet,an=async function(e,t){const s=C(this,pt).olMap.getView().getProjection();try{oo.debug(`Starting selection on source '${e.label}'`);const n=C(this,gt);let r=await e.select({type:"extent",extent:t},{maxResults:n,mapProjection:s,signal:new AbortController().signal});return r.length>n&&(r=r.slice(0,n)),oo.debug(`Found ${r.length} results on source '${e.label}'`),{source:e,results:r}}catch(n){oo.error(`selection from source ${e.label} failed`,n),C(this,mt).call(this);return}};var Lo=(o=>(o.extent="EXTENT",o.polygon="POLYGON",o.free="FREEPOLYGON",o.circle="CIRCLE",o))(Lo||{});const is={classNamePrefix:"react-select",menuPosition:"fixed",isSearchable:!1,isClearable:!1},Uc=o=>{const e=Mo(),{mapId:t,sources:s,onSelectionComplete:n,onSelectionSourceChanged:r}=o,{containerProps:i}=re("selection",o),[a,u]=f.useState(()=>s.find(R=>(R.status??"available")==="available")),l=J(t),{onExtentSelected:d}=$c(l.map,s,a,n),h=Kc(),b=f.useCallback(R=>{const z=[];if(R||(R=["EXTENT"]),R.forEach(g=>{Object.values(Lo).includes(g)&&z.push({label:e.formatMessage({id:g}),value:g})}),z.length===0)throw new Error("methods does not contain valid values");return z},[e])(void 0),[S,w]=f.useState(b[0]),L=qe(R=>{w(R)}),[E,A]=f.useState(!0);qc(l.map,S,e,d,E);const T=f.useMemo(()=>s.map(R=>({label:R.label,value:R})),[s]),q=f.useMemo(()=>T.find(R=>R.value===a),[T,a]),K=qe(R=>{u(R?.value),r&&r({source:R?.value})});return f.useEffect(()=>{if(!a){A(!1);return}const R=e.formatMessage({id:"sourceNotAvailable"}),z=()=>a&&mo(a,R).kind==="available";A(z());const g=a.on("changed:status",()=>{A(z())});return()=>g.destroy()},[a,A,e]),c.jsxs(co,{...i,spacing:2,children:[b.length>1&&c.jsxs(io,{children:[c.jsx(ao,{children:e.formatMessage({id:"selectMethod"})}),c.jsx(lo,{className:"selection-method react-select",...is,options:b,onChange:L,value:S,chakraStyles:h})]}),c.jsxs(io,{children:[c.jsx(ao,{children:e.formatMessage({id:"selectSource"})}),c.jsx(lo,{className:"selection-source react-select",...is,options:T,placeholder:e.formatMessage({id:"selectionPlaceholder"}),value:q,onChange:K,components:{Option:zc,SingleValue:Wc},isOptionDisabled:R=>R.value===void 0||R.value.status==="unavailable",getOptionLabel:R=>R.label+(R.value===void 0||R.value.status==="unavailable"?" "+e.formatMessage({id:"sourceNotAvailable"}):""),chakraStyles:h})]})]})};function zc(o){const{value:e}=o.data,{isAvailable:t,content:s}=ln(e,!1);return c.jsx(ue.Option,{...o,isDisabled:!t,className:"selection-source-option",children:s})}function Wc(o){const{value:e}=o.data,{isAvailable:t,content:s}=ln(e,!0),n=t?"selection-source-value":"selection-source-value selection-source-value--disabled";return c.jsx(ue.SingleValue,{...o,isDisabled:!t,className:n,children:s})}function ln(o,e){const t=o?.label,s=Hc(o);return{isAvailable:s.kind==="available",content:c.jsxs(ae,{direction:"row",alignItems:"center",grow:1,children:[!e&&c.jsx(ae,{grow:1,children:t}),s.kind==="unavailable"&&c.jsx(N,{ml:2,children:c.jsx(bs,{label:s.reason,placement:"right",openDelay:500,children:c.jsx(le.span,{children:c.jsx(xn,{as:qr,color:"red",className:"warning-icon","aria-label":s.reason})})})}),e&&t]})}}function $c(o,e,t,s){const n=Fc("notifier.NotificationService"),r=Mo(),[i,a]=f.useState(void 0);f.useEffect(()=>{if(!o)return;const l=new Gc({mapModel:o,onError(){n.notify({level:"error",message:r.formatMessage({id:"selectionFailed"})})}});return a(l),()=>{l.destroy()}},[o,n,e,r]);const u=qe(async l=>{if(!i||!t)return;const d=await i.select(t,l.getExtent());d&&s?.(d)});return{controller:i,onExtentSelected:u}}function mo(o,e){const t=o.status??"available",s=typeof t=="string"?{kind:t}:t;return s.kind==="available"?s:{kind:"unavailable",reason:s.reason??e}}function Hc(o){const e=Mo(),[t,s]=f.useState(()=>({kind:"available"}));return f.useEffect(()=>{if(!o){s({kind:"available"});return}const n=e.formatMessage({id:"sourceNotAvailable"});s(mo(o,n));const r=o.on?.("changed:status",()=>{s(mo(o,n))});return()=>r?.destroy()},[o,e]),t}function qc(o,e,t,s,n){f.useEffect(()=>{if(!o)return;const r=new Vc(o.olMap,e.value,t.formatMessage({id:"tooltip"}),t.formatMessage({id:"disabledTooltip"}),s);return r.setActive(n),()=>{r?.destroy()}},[o,e,t,s,n])}function Kc(){const[o,e]=vs("colors",["background_body","border"],["#ffffff","#ffffff"]);return f.useMemo(()=>({control:s=>({...s,cursor:"pointer"}),indicatorSeparator:s=>({...s,borderColor:e}),dropdownIndicator:s=>({...s,backgroundColor:o})}),[o,e])}let Yc=0;function Xc(o,e){const t=`atom${++Yc}`,s={toString:()=>t};return typeof o=="function"?s.read=o:(s.init=o,s.read=function(n){return n(this)},s.write=function(n,r,i){return r(this,typeof i=="function"?i(n(this)):i)}),e&&(s.write=e),s}const as=o=>"init"in o,ls=o=>!!o.write,It=new WeakMap,Zc=(o,e)=>{It.set(o,e),o.catch(()=>{}).finally(()=>It.delete(o))},cs=(o,e)=>{const t=It.get(o);t&&(It.delete(o),t(e))},us=(o,e)=>{o.status="fulfilled",o.value=e},ds=(o,e)=>{o.status="rejected",o.reason=e},Jc=o=>typeof o?.then=="function",st=(o,e)=>!!o&&"v"in o&&"v"in e&&Object.is(o.v,e.v),hs=(o,e)=>!!o&&"e"in o&&"e"in e&&Object.is(o.e,e.e),Re=o=>!!o&&"v"in o&&o.v instanceof Promise,Qc=(o,e)=>"v"in o&&"v"in e&&o.v.orig&&o.v.orig===e.v.orig,Mt=o=>{if("e"in o)throw o.e;return o.v},To=()=>{const o=new WeakMap,e=new WeakMap,t=new Map;let s,n;const r=g=>o.get(g),i=(g,v)=>{const y=o.get(g);if(o.set(g,v),t.has(g)||t.set(g,y),Re(y)){const p="v"in v?v.v instanceof Promise?v.v:Promise.resolve(v.v):Promise.reject(v.e);y.v!==p&&cs(y.v,p)}},a=(g,v,y)=>{const p=new Map;let _=!1;y.forEach((M,x)=>{!M&&x===g&&(M=v),M&&(p.set(x,M),v.d.get(x)!==M&&(_=!0))}),(_||v.d.size!==p.size)&&(v.d=p)},u=(g,v,y)=>{const p=r(g),_={d:p?.d||new Map,v};if(y&&a(g,_,y),st(p,_)&&p.d===_.d)return p;if(Re(p)&&Re(_)&&Qc(p,_)){if(p.d===_.d)return p;_.v=p.v}return i(g,_),_},l=(g,v,y,p)=>{if(Jc(v)){let _;const M=()=>{const P=r(g);if(!Re(P)||P.v!==x)return;const V=u(g,x,y);e.has(g)&&P.d!==V.d&&K(g,V,P.d)},x=new Promise((P,V)=>{let j=!1;v.then(G=>{j||(j=!0,us(x,G),P(G),M())},G=>{j||(j=!0,ds(x,G),V(G),M())}),_=G=>{j||(j=!0,G.then(H=>us(x,H),H=>ds(x,H)),P(G))}});return x.orig=v,x.status="pending",Zc(x,P=>{P&&_(P),p?.()}),u(g,x,y)}return u(g,v,y)},d=(g,v,y)=>{const p=r(g),_={d:p?.d||new Map,e:v};return y&&a(g,_,y),hs(p,_)&&p.d===_.d?p:(i(g,_),_)},h=(g,v)=>{const y=r(g);if(!v&&y&&(e.has(g)||Array.from(y.d).every(([j,G])=>{if(j===g)return!0;const H=h(j);return H===G||st(H,G)})))return y;const p=new Map;let _=!0;const M=j=>{if(j===g){const H=r(j);if(H)return p.set(j,H),Mt(H);if(as(j))return p.set(j,void 0),j.init;throw new Error("no atom init")}const G=h(j);return p.set(j,G),Mt(G)};let x,P;const V={get signal(){return x||(x=new AbortController),x.signal},get setSelf(){return!P&&ls(g)&&(P=(...j)=>{if(!_)return A(g,...j)}),P}};try{const j=g.read(M,V);return l(g,j,p,()=>x?.abort())}catch(j){return d(g,j,p)}finally{_=!1}},m=g=>Mt(h(g)),b=g=>{let v=e.get(g);return v||(v=T(g)),v},S=(g,v)=>!v.l.size&&(!v.t.size||v.t.size===1&&v.t.has(g)),w=g=>{const v=e.get(g);v&&S(g,v)&&q(g)},L=g=>{const v=new Map,y=new WeakMap,p=x=>{var P;const V=new Set((P=e.get(x))==null?void 0:P.t);return t.forEach((j,G)=>{var H;(H=r(G))!=null&&H.d.has(x)&&V.add(G)}),V},_=x=>{p(x).forEach(P=>{P!==x&&(v.set(P,(v.get(P)||new Set).add(x)),y.set(P,(y.get(P)||0)+1),_(P))})};_(g);const M=x=>{p(x).forEach(P=>{var V;if(P!==x){let j=y.get(P);if(j&&y.set(P,--j),!j){let G=!!((V=v.get(P))!=null&&V.size);if(G){const H=r(P),gn=h(P,!0);G=!st(H,gn)}G||v.forEach(H=>H.delete(P))}M(P)}})};M(g)},E=(g,...v)=>{let y=!0;const p=x=>Mt(h(x)),_=(x,...P)=>{let V;if(x===g){if(!as(x))throw new Error("atom not writable");const j=r(x),G=l(x,P[0]);st(j,G)||L(x)}else V=E(x,...P);if(!y){const j=R()}return V},M=g.write(p,_,...v);return y=!1,M},A=(g,...v)=>{const y=E(g,...v),p=R();return y},T=(g,v,y)=>{var p;const _=y||[];(p=r(g))==null||p.d.forEach((x,P)=>{const V=e.get(P);V?V.t.add(g):P!==g&&T(P,g,_)}),h(g);const M={t:new Set(v&&[v]),l:new Set};if(e.set(g,M),ls(g)&&g.onMount){const{onMount:x}=g;_.push(()=>{const P=x((...V)=>A(g,...V));P&&(M.u=P)})}return y||_.forEach(x=>x()),M},q=g=>{var v;const y=(v=e.get(g))==null?void 0:v.u;y&&y(),e.delete(g);const p=r(g);p&&(Re(p)&&cs(p.v),p.d.forEach((_,M)=>{if(M!==g){const x=e.get(M);x&&(x.t.delete(g),S(M,x)&&q(M))}}))},K=(g,v,y)=>{const p=new Set(v.d.keys());y?.forEach((_,M)=>{if(p.has(M)){p.delete(M);return}const x=e.get(M);x&&(x.t.delete(g),S(M,x)&&q(M))}),p.forEach(_=>{const M=e.get(_);M?M.t.add(g):e.has(g)&&T(_,g)})},R=()=>{let g;for(;t.size;){const v=Array.from(t);t.clear(),v.forEach(([y,p])=>{const _=r(y);if(_){const M=e.get(y);M&&_.d!==p?.d&&K(y,_,p?.d),M&&!(!Re(p)&&(st(p,_)||hs(p,_)))&&M.l.forEach(x=>x())}})}};return{get:m,set:A,sub:(g,v)=>{const y=b(g),p=R(),_=y.l;return _.add(v),()=>{_.delete(v),w(g)}}}};let so;const eu=()=>(so||(so=To()),so),cn=f.createContext(void 0),tu=o=>{const e=f.useContext(cn);return o?.store||e||eu()},ou=({children:o,store:e})=>{const t=f.useRef();return!e&&!t.current&&(t.current=To()),f.createElement(cn.Provider,{value:e||t.current},o)},su=o=>typeof o?.then=="function",nu=ms.use||(o=>{if(o.status==="pending")throw o;if(o.status==="fulfilled")return o.value;throw o.status==="rejected"?o.reason:(o.status="pending",o.then(e=>{o.status="fulfilled",o.value=e},e=>{o.status="rejected",o.reason=e}),o)});function ru(o,e){const t=tu(e),[[s,n,r],i]=f.useReducer(l=>{const d=t.get(o);return Object.is(l[0],d)&&l[1]===t&&l[2]===o?l:[d,t,o]},void 0,()=>[t.get(o),t,o]);let a=s;(n!==t||r!==o)&&(i(),a=t.get(o));const u=e?.delay;return f.useEffect(()=>{const l=t.sub(o,()=>{if(typeof u=="number"){setTimeout(i,u);return}i()});return i(),l},[t,o,u]),f.useDebugValue(a),su(a)?nu(a):a}const un="@open-pioneer/spatial-bookmarks",iu=zt.bind(void 0,un),au=ce.bind(void 0,un),he=Se("spatial-bookmark:SpatialBookmarkViewModel");class lu{map;packageNamespace;writableBookmarks=Xc([]);stopBookmarksListener;store;get bookmarks(){return this.writableBookmarks}constructor(e,t){this.map=e,this.packageNamespace=t.getNamespace("spatial-bookmarks"),this.store=To(),this.loadState(),this.stopBookmarksListener=this.store.sub(this.bookmarks,()=>{this.saveState()})}destroy(){this.stopBookmarksListener()}createBookmark(e){const t=this.map.olMap,s=t.getView().calculateExtent(),n=t.getView().getProjection().getCode(),r={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]},i={id:_r(),title:e,extent:r,projection:n};he.debug("Created a new bookmark",i);const a=this.writableBookmarks;this.store.set(a,[...this.store.get(a),i])}activateBookmark(e){he.debug("Activating bookmark",e);const t=this.getBookmarkExtent(e);he.debug("Attempting to apply extent",t),this.applyExtent(t)}deleteBookmark(e){he.debug("Deleting bookmark",e);const t=this.writableBookmarks;this.store.set(t,[...this.store.get(t).filter(s=>s.id!==e)])}deleteAllBookmarks(){he.debug("Deleting all bookmarks"),this.store.set(this.writableBookmarks,[])}loadState(){he.debug("Restoring bookmarks from local storage");const e=this.packageNamespace.get("bookmarks")??[];try{cu(e),this.store.set(this.writableBookmarks,e)}catch(t){he.error("Bookmarks data in local storage is invalid, resetting to default value.",t),this.store.set(this.writableBookmarks,[]),this.saveState()}}saveState(){he.debug("Saving bookmarks to local storage"),this.packageNamespace.set("bookmarks",this.store.get(this.bookmarks))}getBookmarkExtent(e){const s=this.map.olMap.getView(),n=e.extent,r=[n.minX,n.minY,n.maxX,n.maxY],i=s.getProjection(),a=e.projection;return xr(r,a,i)}applyExtent(e){const s=this.map.olMap.getView(),n=kr(e),r=s.getResolutionForExtent(e);s.setCenter(n),s.setResolution(r)}}function cu(o){if(!Array.isArray(o))throw new Error("Expected bookmarks from local storage to be an array.");for(const e of o)uu(e)}function uu(o){if(!o||typeof o!="object")throw new Error("Expected bookmark from local storage to be an object.");const e=o;if(typeof e.id!="string")throw new Error("Bookmark does not have a valid id.");if(typeof e.title!="string")throw new Error("Bookmark does not have a valid title.");if(du(e.extent),typeof e.projection!="string")throw new Error("Bookmark does not have a valid projection value.")}function du(o){if(!o||typeof o!="object")throw new Error("Expected bookmark extent from local storage to be an object.");const e=o;if(typeof e.minX!="number"||typeof e.minY!="number"||typeof e.maxX!="number"||typeof e.maxY!="number")throw new Error("Expected bookmark extent from local storage to have valid coordinates.")}const fs=o=>{const{map:e}=J(o.mapId),t=iu("local-storage.LocalStorageService"),s=bu(e,t);return s&&c.jsx(ou,{store:s.store,children:c.jsx(hu,{...o,viewModel:s})})};function hu(o){const{viewModel:e}=o,t=au(),s=f.useRef([]),[n,r]=f.useState(!1),i=ru(e.bookmarks),[a,u]=f.useState(""),l=a.trim().length>0,{containerProps:d}=re("spatial-bookmarks",o),[h,m]=f.useState("list"),b=()=>{e.deleteAllBookmarks(),m("list")},S=()=>{l&&(e.createBookmark(a),m("list"),u(""),r(!0))};f.useEffect(()=>{if(n){const T=s.current;T&&T[i.length-1]?.scrollIntoView?.(),r(!1)}},[i,n]);const w=()=>c.jsxs(co,{children:[c.jsxs(qt,{rounded:"md",status:"warning",children:[c.jsx(Kt,{}),t.formatMessage({id:"bookmark.alert.delete"})]}),c.jsx(mu,{intl:t,onClear:b,onCancel:()=>m("list")})]}),L=()=>c.jsxs(co,{children:[c.jsxs(qt,{rounded:"md",status:"info",children:[c.jsx(Kt,{}),t.formatMessage({id:"bookmark.alert.create"})]}),c.jsx(Zr,{"aria-label":t.formatMessage({id:"bookmark.input.label"}),placeholder:t.formatMessage({id:"bookmark.input.placeholder"}),value:a,onChange:T=>{u(T.target.value)},onKeyDown:T=>{T.key==="Enter"&&S()},isRequired:!0,isInvalid:!l,autoFocus:!0}),c.jsx(vu,{intl:t,isInvalid:!l,onCancel:()=>{u(""),m("list")},onSave:S})]}),E=()=>c.jsxs(c.Fragment,{children:[i.length?fu(i,e,t,s):c.jsxs(qt,{rounded:"md",status:"info",children:[c.jsx(Kt,{}),t.formatMessage({id:"bookmark.alert.noSaved"})]}),c.jsx(gu,{intl:t,bookmarks:i,showCreate:()=>m("create"),showDelete:()=>m("delete")})]}),A=c.jsxs(c.Fragment,{children:[h==="list"&&E(),h==="create"&&L(),h==="delete"&&w()]});return c.jsx(ae,{flexDirection:"column",...d,children:A})}function fu(o,e,t,s){const n=t.formatMessage({id:"bookmark.button.deleteOne"}),r=o.map((i,a)=>c.jsx(pu,{index:a,listItemNodes:s,bookmark:i,onActivate:()=>e.activateBookmark(i),onDelete:()=>e.deleteBookmark(i.id),deleteBtnLabel:n},i.id));return c.jsx(Fs,{as:"ul",className:"spatial-bookmark-list",role:"listbox","aria-label":t.formatMessage({id:"bookmark.list.label"}),flexShrink:1,flexGrow:1,p:1,spacing:1,overflowY:"auto",listStyleType:"none",children:r})}const ps={ArrowDown:1,ArrowUp:-1};function pu(o){const{index:e,listItemNodes:t,bookmark:s,onDelete:n,onActivate:r,deleteBtnLabel:i}=o,a=s.title,u=l=>{const d=l.key;if(d==="Enter"){l.target===l.currentTarget&&r();return}if(ps[d]!=null){const h=t.current?.length;if(!h)return;let m=(e+ps[d])%h;m<0&&(m=h-1),t.current[m]?.focus()}};return c.jsx(N,{as:"li",p:1,ref:l=>{if(!l){t.current.splice(e,1);return}t.current[e]=l},className:bt("spatial-bookmarks-item"),tabIndex:0,rounded:"md",role:"option",cursor:"pointer",outline:0,_hover:{background:"trails.50"},_focusVisible:{boxShadow:"outline"},onKeyDown:u,onClick:r,children:c.jsxs(ae,{width:"100%",flexDirection:"row",align:"center",gap:1,children:[c.jsx(Bs,{children:c.jsx(Is,{})}),c.jsx(Q,{ps:2,noOfLines:1,children:a}),c.jsx(Jr,{}),c.jsx(bs,{hasArrow:!0,label:i,placement:"right",children:c.jsx(So,{className:"spatial-bookmarks-item-delete","aria-label":i,borderRadius:"full",iconSpacing:0,padding:0,colorScheme:"red",variant:"ghost",leftIcon:c.jsx(Os,{}),onClick:l=>{n(),l.stopPropagation()}})},e)]})})}function gu(o){const{intl:e,bookmarks:t,showCreate:s,showDelete:n}=o;return c.jsxs(Ro,{children:[c.jsx(Xe,{isDisabled:t.length===0,colorScheme:"red",width:void 0,iconSpacing:0,leftIcon:c.jsx(Os,{}),onClick:n,"aria-label":e.formatMessage({id:"bookmark.button.deleteAll"}),variant:"outline"}),c.jsx(Xe,{onClick:s,width:"100%",children:e.formatMessage({id:"bookmark.button.create"})})]})}function mu(o){const{intl:e,onCancel:t,onClear:s}=o;return c.jsxs(Ro,{children:[c.jsx(Xe,{variant:"outline",onClick:t,children:e.formatMessage({id:"bookmark.button.cancelDelete"})}),c.jsx(Xe,{onClick:s,children:e.formatMessage({id:"bookmark.button.confirmDelete"})})]})}function vu(o){const{intl:e,onCancel:t,onSave:s,isInvalid:n}=o;return c.jsxs(Ro,{children:[c.jsx(Xe,{variant:"outline",onClick:()=>t(),children:e.formatMessage({id:"bookmark.button.cancel"})}),c.jsx(Xe,{isDisabled:n,onClick:()=>s(),children:e.formatMessage({id:"bookmark.button.save"})})]})}function Ro(o){return c.jsx(ae,{width:"100%",flexDirection:"row",mt:2,gap:1,flexGrow:0,flexShrink:0,children:o.children})}function Xe(o){return c.jsx(So,{width:"100%",...o})}function bu(o,e){const[t,s]=f.useState();return f.useEffect(()=>{let n;return o?n=new lu(o,e):n=void 0,s(n),()=>n?.destroy()},[o,e]),t}const dn="ol-map",vo=zt.bind(void 0,dn),Ao=ce.bind(void 0,dn),Su="@open-pioneer/legend",hn=ce.bind(void 0,Su),yu=o=>{const{mapId:e,showBaseLayers:t=!1}=o,{containerProps:s}=re("legend",o),{map:n}=J(e);return c.jsx(N,{...s,children:n?c.jsx(wu,{map:n,showBaseLayers:t}):null})};function wu(o){const{map:e,showBaseLayers:t}=o,n=ku(e).map(r=>c.jsx(fn,{layer:r,showBaseLayers:t},r.id));return c.jsx(Fs,{as:"ul",className:"legend-layer-list",listStyleType:"none",spacing:2,children:n})}function fn(o){const{layer:e,showBaseLayers:t}=o,{isVisible:s}=Eu(e),n=Cu(e);if(!s||!t&&!("parentLayer"in e)&&e.isBaseLayer)return;const r=[];return n?.length&&n.forEach(i=>{r.push(c.jsx(fn,{layer:i,showBaseLayers:t},i.id))}),c.jsxs(c.Fragment,{children:[c.jsx(_u,{layer:e,showBaseLayers:t}),r]})}function _u(o){const e=hn(),{layer:t,showBaseLayers:s}=o,n=Pu(t),r=xu(t);let i;n?.Component?i=c.jsx(n.Component,{layer:t}):n?.imageUrl?i=c.jsx(gs,{layer:t,imageUrl:n.imageUrl}):r&&(i=c.jsx(gs,{layer:t,imageUrl:r}));const a=!("parentLayer"in t)&&t.isBaseLayer;return i?c.jsxs(N,{as:"li",className:bt("legend-item",`layer-${Mu(t.id)}`),children:[s&&a?c.jsx(Q,{as:"b",children:e.formatMessage({id:"basemapLabel"})}):null,i]}):void 0}function gs(o){const e=hn(),{layer:t,imageUrl:s}=o;return c.jsxs(N,{children:[c.jsx(Q,{children:t.title}),c.jsx(Vs,{maxW:"none",maxH:"none",src:s,alt:e.formatMessage({id:"altLabel"},{layerName:t.title}),className:"legend-item__image",fallbackStrategy:"onError",fallback:c.jsx(N,{children:c.jsxs(Q,{children:[c.jsx(Vr,{me:2}),e.formatMessage({id:"fallbackLabel"})]})})})]})}function xu(o){const e=f.useCallback(()=>o.legend,[o]),t=f.useCallback(s=>{const n=o.on("changed:legend",s);return()=>n.destroy()},[o]);return f.useSyncExternalStore(t,e)}function ku(o){const e=f.useCallback(s=>{const n=o.layers.on("changed",s);return()=>n.destroy()},[o]),t=f.useCallback(()=>{let s=o.layers.getAllLayers({sortByDisplayOrder:!0})??[];return s=s.reverse(),s},[o]);return pn(e,t)}function Cu(o){const e=f.useCallback(s=>{const n=o.sublayers?.on("changed",s);return()=>n?.destroy()},[o]),t=f.useCallback(()=>{if(!o.sublayers)return;let n=o.sublayers?.getSublayers({sortByDisplayOrder:!0});return n=n.reverse(),n},[o]);return pn(e,t)}function pn(o,e){const t=f.useRef(),s=f.useCallback(r=>{const i=o(()=>{t.current=void 0,r()});return()=>{t.current=void 0,i()}},[o]),n=f.useCallback(()=>{if(t.current)return t.current.value;const r=e();return t.current={value:r},r},[e]);return f.useSyncExternalStore(s,n)}function Eu(o){const e=f.useCallback(()=>o.visible,[o]),t=f.useCallback(n=>{const r=o.on("changed:visible",n);return()=>r.destroy()},[o]);return{isVisible:f.useSyncExternalStore(t,e)}}function Pu(o){const[e,t]=f.useState(void 0);return f.useEffect(()=>{t(o.attributes.legend);const s=o.on("changed:attributes",()=>{t(o.attributes.legend)});return()=>s.destroy()},[o]),e}function Mu(o){return o.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Lu(){const o=Ao(),e=f.useId(),t=f.useId(),s=f.useId(),[n,r]=f.useState(!0),{map:i}=J(W),[a,u]=f.useState(!0),[l,d]=f.useState(!1);function h(){d(!l)}const[m,b]=f.useState(!0),[S,w]=f.useState();function L(v){w(v===S?void 0:v),i?.removeHighlight()}const[E,A]=f.useState(void 0);f.useEffect(()=>{A(n||S?"300px":"75vh")},[m,n,S]);function T(){r(!n)}function q(){L("measurement")}function K(){L("selection")}function R(){u(!a)}function z(){b(!m)}let g=null;switch(S){case"selection":g=c.jsx(Ru,{});break;case"measurement":g=c.jsx(Au,{});break}return c.jsxs(ae,{height:"100%",direction:"column",overflow:"hidden",children:[c.jsx(Br,{position:"top-right"}),c.jsxs(_e,{title:c.jsx(N,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:c.jsx(xe,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[c.jsx(ae,{flex:"1",direction:"column",position:"relative",children:c.jsxs(Cr,{mapId:W,role:"main","aria-label":o.formatMessage({id:"ariaLabel.map"}),children:[c.jsx(Qr,{centerContent:!0,children:c.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-box",children:c.jsx(Tu,{})})}),c.jsx(Qe,{position:"top-left",horizontalGap:20,verticalGap:20,children:(m||n||S)&&c.jsxs(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:[m&&c.jsx(N,{role:"dialog","aria-labelledby":e,children:c.jsx(_e,{title:c.jsx(xe,{id:e,size:"md",mb:2,children:c.jsx(Q,{children:o.formatMessage({id:"tocTitle"})})}),children:c.jsx(N,{overflowY:"auto",maxHeight:E,children:c.jsx(Nr,{mapId:W,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})})}),m&&n&&c.jsx($o,{mt:4,mb:4}),n&&c.jsx(N,{role:"dialog","aria-labelledby":t,children:c.jsx(_e,{title:c.jsx(xe,{id:t,size:"md",mb:2,children:o.formatMessage({id:"legendTitle"})}),children:c.jsx(N,{overflowY:"auto",maxHeight:300,children:c.jsx(yu,{mapId:W,showBaseLayers:!0})})})}),(m||n)&&S&&c.jsx($o,{mt:4,mb:4}),g]})}),c.jsx(Qe,{position:"top-right",horizontalGap:20,verticalGap:20,children:a&&c.jsx(Iu,{})}),c.jsx(Qe,{horizontalGap:20,position:"bottom-left",children:l&&c.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:c.jsx(N,{role:"dialog","aria-labelledby":s,children:c.jsx(_e,{title:c.jsx(xe,{id:s,size:"md",mb:2,children:o.formatMessage({id:"spatialBookmarkTitle"})}),children:c.jsx(fs,{mapId:W})})})})}),c.jsx(Qe,{horizontalGap:20,position:"bottom-left",children:l&&c.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:c.jsx(N,{role:"dialog","aria-labelledby":s,children:c.jsx(_e,{title:c.jsx(xe,{id:s,size:"md",mb:2,children:o.formatMessage({id:"spatialBookmarkTitle"})}),children:c.jsx(fs,{mapId:W})})})})}),c.jsx(Qe,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:c.jsxs(ae,{role:"toolbar","aria-label":o.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[c.jsx(ye,{label:o.formatMessage({id:"spatialBookmarkTitle"}),icon:c.jsx(Mr,{}),isActive:l,onClick:h}),c.jsx($l,{mapId:W}),c.jsx(ye,{label:o.formatMessage({id:"tocTitle"}),icon:c.jsx(Lr,{}),isActive:m,onClick:z}),c.jsx(ye,{label:o.formatMessage({id:"legendTitle"}),icon:c.jsx(Tr,{}),isActive:n,onClick:T}),c.jsx(ye,{label:o.formatMessage({id:"measurementTitle"}),icon:c.jsx(Rr,{}),isActive:S==="measurement",onClick:q}),c.jsx(ye,{label:o.formatMessage({id:"selectionTitle"}),icon:c.jsx(Ar,{}),isActive:S==="selection",onClick:K}),c.jsx(ye,{label:o.formatMessage({id:"overviewMapTitle"}),icon:c.jsx(Is,{}),isActive:a,onClick:R}),c.jsx(zr,{mapId:W}),c.jsx(Wr,{mapId:W}),c.jsx($r,{mapId:W})]})})]})}),c.jsxs(ae,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[c.jsx(jl,{mapId:W,precision:2}),c.jsx(hc,{mapId:W}),c.jsx(gc,{mapId:W})]})]})]})}function Tu(){const{map:o}=J(W),e=vo("ol-app.AppConfig"),t=Zs(e.state).searchSources;function s(r){if(console.debug("The user selected the following item: ",r.result),!o)return;const i=r.result.geometry;i&&o.highlightAndZoom([i],{viewPadding:{top:150,right:50,bottom:50,left:50}})}function n(){console.debug("The user cleared the search"),o?.removeHighlight()}return c.jsx(Tc,{mapId:W,sources:t,maxResultsPerGroup:10,onSelect:s,onClear:n})}function Ru(){const o=Ao(),e=vo("notifier.NotificationService"),t=f.useId(),{map:s}=J(W),n=vo("ol-app.AppConfig"),r=Zs(n.state).selectionSources;function i(u){const l=u.results;if(!s){console.debug("Map not ready");return}s?.removeHighlight();const d=l.map(h=>h.geometry);d.length>0&&s.highlightAndZoom(d,{viewPadding:{top:150,right:50,bottom:50,left:50}}),e.notify({level:"info",message:o.formatMessage({id:"foundResults"},{resultsCount:l.length}),displayDuration:4e3})}function a(u){s?.removeHighlight()}return c.jsx(N,{role:"dialog","aria-labelledby":t,children:c.jsx(_e,{title:c.jsx(xe,{id:t,size:"md",mb:2,children:o.formatMessage({id:"selectionTitle"})}),children:c.jsx(Uc,{mapId:W,sources:r,onSelectionComplete:i,onSelectionSourceChanged:a})})})}function Au(){const o=f.useId(),e=Ao();return c.jsx(N,{role:"dialog","aria-labelledby":o,children:c.jsx(_e,{title:c.jsx(xe,{id:o,size:"md",mb:2,children:e.formatMessage({id:"measurementTitle"})}),children:c.jsx(Ql,{mapId:W})})})}function Iu(){const o=f.useMemo(()=>new yo({source:new Cs}),[]);return c.jsx(N,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:325,children:c.jsx(N,{role:"dialog",children:c.jsx(dc,{mapId:W,olLayer:o})})})}const Ou=kn({component:Lu,theme:Cn,appMetadata:Al,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(o){const e=o.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",Ou);const Du=document.getElementsByTagName("body")[0];ju();function ju(){const o=window.location.search,t=new URLSearchParams(o).get("lang"),s=document.createElement("ol-map-app");s.classList.add("full-height"),s.classList.add("app"),s.setAttribute("id","test"),t&&s.setAttribute("forced-locale",t),Du.appendChild(s)}
