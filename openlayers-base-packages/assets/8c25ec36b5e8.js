var As=Object.defineProperty;var Is=(o,e,t)=>e in o?As(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var ro=(o,e,t)=>(Is(o,typeof e!="symbol"?e+"":e,t),t),kt=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var M=(o,e,t)=>(kt(o,e,"read from private field"),t?t.call(o):e.get(o)),D=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},O=(o,e,t,s)=>(kt(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);var z=(o,e,t)=>(kt(o,e,"access private method"),t);import{c as me,f as Ds,j as u,r as y,g as Os,R as Go,a as ve,E as Z,b as js,B as qt,C as Ns,t as Fs,i as zo,u as Uo,F as $o,I as Vs,A as Ct,d as Et,e as Bs}from"./632b1064413a.js";import{t as Gs}from"./e52a8701814b.js";import{g as Nt,u as ae,S as zs,c as Us,i as $s,f as Hs,d as Ws,r as qs,a as ce,T as Kt,O as Ho,V as Fe,b as be,e as ge,C as Yt,F as Ie,P as Ks,h as Ys,j as Zs,k as ao,s as Xs,n as Js,l as lo,m as Qs,I as en,E as Wo,M as te,o as tn,p as on,q as qo,t as ue,v as Ee,w as co,x as sn,B as Ko,y as yt,z as nn,A as Yo,D as rn,G as an,H as Zo,J as ln,K as cn,L as uo,N as un,Q as dn,R as hn,U as fn,W as pn,X as gn,Y as Xo,Z as Jo,_ as mn,$ as vn,a0 as Qo,a1 as bn,a2 as yn,a3 as W,a4 as es,a5 as wn,a6 as fe,a7 as Sn,a8 as _n,a9 as xn,aa as ts,ab as kn,ac as ho,ad as os,ae as Cn,af as fo,ag as En,ah as Pt,ai as Pn,aj as po,ak as Mn,al as Tn,am as Ln,an as Rn,ao as An,ap as In,aq as go,ar as Dn,as as mo,at as On,au as vo,av as jn,aw as Nn,ax as Fn,ay as Vn,az as Ve}from"./2a1d2fbd68a3.js";import{W as ss,P as ns,a as is,b as Bn,c as Gn,d as zn,e as Un}from"./66b0b21cbb75.js";import{W as $n,a as Hn}from"./2dba105bb984.js";import{u as Q,T as we,c as wt,a as _e,S as xe}from"./d8a5401cb67e.js";import{G as Zt,M as Wn,a as rs,b as as,c as qn,T as Kn}from"./2922e932e8c6.js";import{N as Yn,u as De,a as Zn}from"./8afe81c55fa7.js";import{V as Xn,S as Jn,I as Qn,Z as ei,a as ti}from"./c9505fea4ec3.js";import{E as ls}from"./960f2965a833.js";import{_ as bo,G as oi,F as si}from"./e6c16a5c3a19.js";import{u as le,a as St}from"./c97be5b4da53.js";import{T as et}from"./d0757a2a1156.js";import{B as V}from"./91174f89edc1.js";import{L as Pe}from"./ba55ac343cfa.js";import{F as Ft}from"./3f1b7889774c.js";import{F as Vt}from"./3795b421db1b.js";import{H as ni}from"./118aaed17917.js";import{S as ii}from"./fb2333b41970.js";import{c as ri}from"./abfcf39bcd3c.js";import{c as ee,S as Bt}from"./52ca773d7d7d.js";import{V as Gt}from"./ce35834e2d03.js";import{F as J}from"./df4a50c13949.js";import{I as ai}from"./28d82ebccc09.js";import{L as li}from"./34f5fb5b1025.js";import{S as ci}from"./bb6df83e4817.js";import{C as ui}from"./09d25f4e68a2.js";import{D as di}from"./d124647b4123.js";import"./803b5d4c4df8.js";import"./f7401db60429.js";import"./786f05430f0c.js";import"./6006c1fc1042.js";import"./824647296726.js";var cs=me("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center"}});cs.displayName="Center";var hi={horizontal:{insetStart:"50%",transform:"translateX(-50%)"},vertical:{top:"50%",transform:"translateY(-50%)"},both:{insetStart:"50%",top:"50%",transform:"translate(-50%, -50%)"}};Ds(function(e,t){const{axis:s="both",...n}=e;return u.jsx(me.div,{ref:t,__css:hi[s],...n,position:"absolute"})});const fi=25.4/.28,pi=39.37;function Xt(o){return Jt(o,gi,mi)}function gi(o){return o.getView()}function mi(o,e){return o.on("change:view",e)}function us(o){return Xt(o)?.getProjection()}function vi(o){const e=Xt(o);return Jt(e,bi,yi)}function bi(o){return o.getResolution()}function yi(o,e){return o.on("change:resolution",e)}function wi(o){const e=Xt(o);return Jt(e,Si,_i)}function Si(o){return o.getCenter()}function _i(o,e){return o.on("change:center",e)}function xi(o){const e=wi(o),t=vi(o),s=us(o);return y.useMemo(()=>{if(s==null||t==null||e==null)return;const i=Nt(s,t,e);return Math.round(i*pi*fi)},[s,t,e])}function Jt(o,e,t){const s=y.useCallback(()=>o?e(o):void 0,[o,e]),n=y.useCallback(i=>{if(!o)return()=>{};const r=t(o,i);return()=>ae(r)},[o,t]);return y.useSyncExternalStore(n,s)}class _t extends zs{constructor(e,t,s){super(),s!==void 0&&t===void 0?this.setFlatCoordinates(s,e):(t=t||0,this.setCenterAndRadius(e,t,s))}clone(){const e=new _t(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,s,n){const i=this.flatCoordinates,r=e-i[0],a=t-i[1],c=r*r+a*a;if(c<n){if(c===0)for(let l=0;l<this.stride;++l)s[l]=i[l];else{const l=this.getRadius()/Math.sqrt(c);s[0]=i[0]+l*r,s[1]=i[1]+l*a;for(let d=2;d<this.stride;++d)s[d]=i[d]}return s.length=this.stride,c}return n}containsXY(e,t){const s=this.flatCoordinates,n=e-s[0],i=t-s[1];return n*n+i*i<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,s=t[this.stride]-t[0];return Us(t[0]-s,t[1]-s,t[0]+s,t[1]+s,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if($s(e,t)){const s=this.getCenter();return e[0]<=s[0]&&e[2]>=s[0]||e[1]<=s[1]&&e[3]>=s[1]?!0:Hs(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const t=this.stride,s=this.flatCoordinates[t]-this.flatCoordinates[0],n=e.slice();n[t]=n[0]+s;for(let i=1;i<t;++i)n[t+i]=e[i];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(e,t,s){this.setLayout(s,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let i=Ws(n,0,e,this.stride);n[i++]=n[0]+t;for(let r=1,a=this.stride;r<a;++r)n[i++]=n[r];n.length=i,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const s=this.getCenter(),n=this.getStride();this.setCenter(qs(s,0,s.length,n,e,t,s)),this.changed()}}_t.prototype.transform;const ki=_t,F="main";class Ci{mapId=F;vectorSourceFactory;constructor(e){this.vectorSourceFactory=e.references.vectorSourceFactory}async getMapConfig(){return{initialView:{kind:"position",center:{x:404747,y:5757920},zoom:14},projection:"EPSG:25832",layers:[new ce({id:"topplus_open",title:"TopPlus Open",isBaseLayer:!0,visible:!0,healthCheck:"https://sgx.geodatenzentrum.de/wmts_topplus_open/1.0.0/WMTSCapabilities.xml",olLayer:Mt("web")}),new ce({id:"topplus_open_grau",title:"TopPlus Open (Grau)",isBaseLayer:!0,visible:!1,olLayer:Mt("web_grau")}),new ce({id:"topplus_open_light",title:"TopPlus Open (Light)",isBaseLayer:!0,visible:!1,olLayer:Mt("web_light")}),new ce({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new Kt({source:new Ho})}),new ce({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:Ei()}),new ce({id:"ogc_kitas",title:"Kindertagesstätten",visible:!0,olLayer:Pi()}),new ce({id:"ogc_kataster",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:Mi(this.vectorSourceFactory)}),Ti(),Li()]}}}function Mt(o){const e=[-380316598427299e-8,880590808284866e-8],t=[4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.874056570353,76.4370282851763,38.2185141425881,19.1092570712941,9.55462853564703,4.77731426782352,2.38865713391176,1.19432856695588,.59716428347794],s=new Array(t.length);for(let i=0;i<t.length;i++)s[i]=i;const n=new $n({url:`https://sgx.geodatenzentrum.de/wmts_topplus_open/tile/1.0.0/${o}/{Style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}.png`,layer:"web_grau",matrixSet:"EU_EPSG_25832_TOPPLUS",format:"image/png",projection:"EPSG:25832",requestEncoding:"REST",tileGrid:new Hn({origin:e,resolutions:t,matrixIds:s}),style:"default",attributions:`Kartendarstellung und Präsentationsgraphiken: © Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html" target="_blank">Datenquellen</a>`});return new Kt({source:n})}function Ei(){const o=new Fe({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new Zt,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new be({source:o})}function Pi(){const o=new Fe({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new Zt,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new be({source:o,style:new ge({image:new Yt({fill:new Ie({color:"blue"}),radius:4})})})}function Mi(o){const e=o.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:"<a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>"});return new be({source:e})}function Ti(){return new ss({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW"}],sourceOptions:{ratio:1}})}function Li(){return new ss({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",sublayers:[{name:"1",title:"Verwaltungen"},{name:"4",title:"Abschnitte und Äste"},{name:"6",title:"Unfälle"}]})}class Ri{label;filteredTypes;httpService;constructor(e,t,s){this.label=e,this.filteredTypes=t,this.httpService=s}async request(e,t,s){const n=new URL("https://photon.komoot.io/api?");n.searchParams.set("q",e),n.searchParams.set("lang","de"),n.searchParams.set("lat","51.961563"),n.searchParams.set("lon","7.628202"),n.searchParams.set("limit",t.toString());const i=await this.httpService.fetch(n,{signal:s});if(!i.ok)throw new Error("Request failed: "+i.status);return await i.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}async search(e,{mapProjection:t,signal:s}){const n=await this.request(e,100,s),i=new Zt({dataProjection:"EPSG:4326",featureProjection:t});return n.features.filter(r=>this.filteredTypes.includes(r.properties.type)).map((r,a)=>{const c=i.readGeometry(r.geometry);return{id:r.properties.osm_id||a,label:this.createLabel(r),geometry:c,properties:r.properties}})}}const Ai=Symbol(),Qt=Symbol(),Be="a",ut="w";let Ii=(o,e)=>new Proxy(o,e);const zt=Object.getPrototypeOf,Ut=new WeakMap,ds=o=>o&&(Ut.has(o)?Ut.get(o):zt(o)===Object.prototype||zt(o)===Array.prototype),yo=o=>typeof o=="object"&&o!==null,Di=o=>{if(Array.isArray(o))return Array.from(o);const e=Object.getOwnPropertyDescriptors(o);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(zt(o),e)},hs=o=>o[Qt]||o,fs=(o,e,t,s)=>{if(!ds(o))return o;let n=s&&s.get(o);if(!n){const c=hs(o);n=(l=>Object.values(Object.getOwnPropertyDescriptors(l)).some(d=>!d.configurable&&!d.writable))(c)?[c,Di(c)]:[c],s?.set(o,n)}const[i,r]=n;let a=t&&t.get(i);return a&&a[1].f===!!r||(a=((c,l)=>{const d={f:l};let h=!1;const m=(w,_)=>{if(!h){let T=d[Be].get(c);if(T||(T={},d[Be].set(c,T)),w===ut)T[ut]=!0;else{let C=T[w];C||(C=new Set,T[w]=C),C.add(_)}}},b={get:(w,_)=>_===Qt?c:(m("k",_),fs(Reflect.get(w,_),d[Be],d.c,d.t)),has:(w,_)=>_===Ai?(h=!0,d[Be].delete(c),!0):(m("h",_),Reflect.has(w,_)),getOwnPropertyDescriptor:(w,_)=>(m("o",_),Reflect.getOwnPropertyDescriptor(w,_)),ownKeys:w=>(m(ut),Reflect.ownKeys(w))};return l&&(b.set=b.deleteProperty=()=>!1),[b,d]})(i,!!r),a[1].p=Ii(r||i,a[0]),t&&t.set(i,a)),a[1][Be]=e,a[1].c=t,a[1].t=s,a[1].p},ps=(o,e,t,s)=>{if(Object.is(o,e))return!1;if(!yo(o)||!yo(e))return!0;const n=t.get(hs(o));if(!n)return!0;if(s){const r=s.get(o);if(r&&r.n===e)return r.g;s.set(o,{n:e,g:!1})}let i=null;try{for(const r of n.h||[])if(i=Reflect.has(o,r)!==Reflect.has(e,r),i)return i;if(n[ut]===!0){if(i=((r,a)=>{const c=Reflect.ownKeys(r),l=Reflect.ownKeys(a);return c.length!==l.length||c.some((d,h)=>d!==l[h])})(o,e),i)return i}else for(const r of n.o||[])if(i=!!Reflect.getOwnPropertyDescriptor(o,r)!=!!Reflect.getOwnPropertyDescriptor(e,r),i)return i;for(const r of n.k||[])if(i=ps(o[r],e[r],t,s),i)return i;return i===null&&(i=!0),i}finally{s&&s.set(o,{n:e,g:i})}},Oi=o=>ds(o)&&o[Qt]||null,wo=(o,e=!0)=>{Ut.set(o,e)};const Tt=o=>typeof o=="object"&&o!==null,se=new WeakMap,$e=new WeakSet,ji=(o=Object.is,e=(l,d)=>new Proxy(l,d),t=l=>Tt(l)&&!$e.has(l)&&(Array.isArray(l)||!(Symbol.iterator in l))&&!(l instanceof WeakMap)&&!(l instanceof WeakSet)&&!(l instanceof Error)&&!(l instanceof Number)&&!(l instanceof Date)&&!(l instanceof String)&&!(l instanceof RegExp)&&!(l instanceof ArrayBuffer),s=l=>{switch(l.status){case"fulfilled":return l.value;case"rejected":throw l.reason;default:throw l}},n=new WeakMap,i=(l,d,h=s)=>{const m=n.get(l);if(m?.[0]===d)return m[1];const b=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l));return wo(b,!0),n.set(l,[d,b]),Reflect.ownKeys(l).forEach(w=>{if(Object.getOwnPropertyDescriptor(b,w))return;const _=Reflect.get(l,w),{enumerable:T}=Reflect.getOwnPropertyDescriptor(l,w),C={value:_,enumerable:T,configurable:!0};if($e.has(_))wo(_,!1);else if(_ instanceof Promise)delete C.value,C.get=()=>h(_);else if(se.has(_)){const[R,P]=se.get(_);C.value=i(R,P(),h)}Object.defineProperty(b,w,C)}),Object.preventExtensions(b)},r=new WeakMap,a=[1,1],c=l=>{if(!Tt(l))throw new Error("object required");const d=r.get(l);if(d)return d;let h=a[0];const m=new Set,b=(g,v=++a[0])=>{h!==v&&(h=v,m.forEach(f=>f(g,v)))};let w=a[1];const _=(g=++a[1])=>(w!==g&&!m.size&&(w=g,C.forEach(([v])=>{const f=v[1](g);f>h&&(h=f)})),h),T=g=>(v,f)=>{const S=[...v];S[1]=[g,...S[1]],b(S,f)},C=new Map,R=(g,v)=>{if(m.size){const f=v[3](T(g));C.set(g,[v,f])}else C.set(g,[v])},P=g=>{var v;const f=C.get(g);f&&(C.delete(g),(v=f[1])==null||v.call(f))},$=g=>(m.add(g),m.size===1&&C.forEach(([f,S],E)=>{const x=f[3](T(E));C.set(E,[f,x])}),()=>{m.delete(g),m.size===0&&C.forEach(([f,S],E)=>{S&&(S(),C.set(E,[f]))})}),H=Array.isArray(l)?[]:Object.create(Object.getPrototypeOf(l)),B=e(H,{deleteProperty(g,v){const f=Reflect.get(g,v);P(v);const S=Reflect.deleteProperty(g,v);return S&&b(["delete",[v],f]),S},set(g,v,f,S){const E=Reflect.has(g,v),x=Reflect.get(g,v,S);if(E&&(o(x,f)||r.has(f)&&o(x,r.get(f))))return!0;P(v),Tt(f)&&(f=Oi(f)||f);let k=f;if(f instanceof Promise)f.then(I=>{f.status="fulfilled",f.value=I,b(["resolve",[v],I])}).catch(I=>{f.status="rejected",f.reason=I,b(["reject",[v],I])});else{!se.has(f)&&t(f)&&(k=c(f));const I=!$e.has(k)&&se.get(k);I&&R(v,I)}return Reflect.set(g,v,k,S),b(["set",[v],f,x]),!0}});r.set(l,B);const p=[H,_,i,$];return se.set(B,p),Reflect.ownKeys(l).forEach(g=>{const v=Object.getOwnPropertyDescriptor(l,g);"value"in v&&(B[g]=l[g],delete v.value,delete v.writable),Object.defineProperty(H,g,v)}),B})=>[c,se,$e,o,e,t,s,n,i,r,a],[Ni]=ji();function Fi(o={}){return Ni(o)}function Vi(o,e,t){const s=se.get(o);let n;const i=[],r=s[3];let a=!1;const l=r(d=>{if(i.push(d),t){e(i.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function So(o,e){const t=se.get(o),[s,n,i]=t;return i(s,n(),e)}function tt(o){return $e.add(o),o}var gs={exports:{}},ms={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oe=y;function Bi(o,e){return o===e&&(o!==0||1/o===1/e)||o!==o&&e!==e}var Gi=typeof Object.is=="function"?Object.is:Bi,zi=Oe.useState,Ui=Oe.useEffect,$i=Oe.useLayoutEffect,Hi=Oe.useDebugValue;function Wi(o,e){var t=e(),s=zi({inst:{value:t,getSnapshot:e}}),n=s[0].inst,i=s[1];return $i(function(){n.value=t,n.getSnapshot=e,Lt(n)&&i({inst:n})},[o,t,e]),Ui(function(){return Lt(n)&&i({inst:n}),o(function(){Lt(n)&&i({inst:n})})},[o]),Hi(t),t}function Lt(o){var e=o.getSnapshot;o=o.value;try{var t=e();return!Gi(o,t)}catch{return!0}}function qi(o,e){return e()}var Ki=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?qi:Wi;ms.useSyncExternalStore=Oe.useSyncExternalStore!==void 0?Oe.useSyncExternalStore:Ki;gs.exports=ms;var Yi=gs.exports;const Zi=Os(Yi),{use:_o}=Go,{useSyncExternalStore:Xi}=Zi;const Ji=new WeakMap;function vs(o,e){const t=e?.sync,s=y.useRef(),n=y.useRef();let i=!0;const r=Xi(y.useCallback(l=>{const d=Vi(o,l,t);return l(),d},[o,t]),()=>{const l=So(o,_o);try{if(!i&&s.current&&n.current&&!ps(s.current,l,n.current,new WeakMap))return s.current}catch{}return l},()=>So(o,_o));i=!1;const a=new WeakMap;y.useEffect(()=>{s.current=r,n.current=a});const c=y.useMemo(()=>new WeakMap,[]);return fs(r,a,c,Ji)}const Qi=ve("ol-app:AppConfig"),er=["ogc_kitas","ogc_kataster"];class tr{_intl;_mapRegistry;_ogcSearchSourceFactory;_selectionSourceFactory;_httpService;_state;_resources=[];constructor({references:e,intl:t}){this._mapRegistry=e.mapRegistry,this._intl=t,this._ogcSearchSourceFactory=e.ogcSearchSourceFactory,this._selectionSourceFactory=e.selectionSourceFactory,this._httpService=e.httpService,this._state=Fi({searchSources:[],selectionSources:[]}),this.initSearchSources(),this.initSelectionSources().catch(s=>{Qi.error("Failed to initialize selection sources",s)})}destroy(){this._resources.forEach(e=>e.destroy())}get state(){return this._state}initSearchSources(){const e=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.lika"}),baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"flurstueck",searchProperty:"flurstid",labelProperty:"objid"}),t=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(n){const i=n?.properties?.name,r=n?.id;return typeof i=="string"?i+" ("+r+")":String(r)},rewriteUrl(n){return n.searchParams.set("properties","name"),n}}),s=new Ri("Photon Geocoder",["city","street"],this._httpService);this._state.searchSources=[tt(e),tt(t),tt(s)]}async initSelectionSources(){const e=await this._mapRegistry.expectMapModel(F),t=e.layers.getOperationalLayers({sortByDisplayOrder:!0});for(const s of t){if(!s||!er.includes(s.id)||!or(s.olLayer))continue;const n=this._selectionSourceFactory.createSelectionSource({vectorLayer:s.olLayer,label:s.title}),i=n.on("changed:status",()=>{n.status!=="available"&&(n.status==="unavailable"||n.status?.kind==="unavailable")&&e.removeHighlight()});this._resources.push(i,n),this._state.selectionSources.unshift(tt(n))}}}function or(o){return o instanceof be&&o.getSource()instanceof Fe}const ot={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class st extends Ko{constructor(e,t){super(e),this.feature=t}}function sr(o,e){const t=[];for(let s=0;s<e.length;++s){const i=e[s].getGeometry();bs(o,i,t)}return t}function nt(o,e){return Yo(o[0],o[1],e[0],e[1])}function ke(o,e){const t=o.length;return e<0?o[e+t]:e>=t?o[e-t]:o[e]}function it(o,e,t){let s,n;e<t?(s=e,n=t):(s=t,n=e);const i=Math.ceil(s),r=Math.floor(n);if(i>r){const c=Ce(o,s),l=Ce(o,n);return nt(c,l)}let a=0;if(s<i){const c=Ce(o,s),l=ke(o,i);a+=nt(c,l)}if(r<n){const c=ke(o,r),l=Ce(o,n);a+=nt(c,l)}for(let c=i;c<r-1;++c){const l=ke(o,c),d=ke(o,c+1);a+=nt(l,d)}return a}function bs(o,e,t){if(e instanceof Pe){rt(o,e.getCoordinates(),!1,t);return}if(e instanceof rs){const s=e.getCoordinates();for(let n=0,i=s.length;n<i;++n)rt(o,s[n],!1,t);return}if(e instanceof yt){const s=e.getCoordinates();for(let n=0,i=s.length;n<i;++n)rt(o,s[n],!0,t);return}if(e instanceof as){const s=e.getCoordinates();for(let n=0,i=s.length;n<i;++n){const r=s[n];for(let a=0,c=r.length;a<c;++a)rt(o,r[a],!0,t)}return}if(e instanceof qn){const s=e.getGeometries();for(let n=0;n<s.length;++n)bs(o,s[n],t);return}}const Rt={index:-1,endIndex:NaN};function nr(o,e,t,s){const n=o[0],i=o[1];let r=1/0,a=-1,c=NaN;for(let h=0;h<e.targets.length;++h){const m=e.targets[h],b=m.coordinates;let w=1/0,_;for(let T=0;T<b.length-1;++T){const C=b[T],R=b[T+1],P=ys(n,i,C,R);P.squaredDistance<w&&(w=P.squaredDistance,_=T+P.along)}w<r&&(r=w,m.ring&&e.targetIndex===h&&(m.endIndex>m.startIndex?_<m.startIndex&&(_+=b.length):m.endIndex<m.startIndex&&_>m.startIndex&&(_-=b.length)),c=_,a=h)}const l=e.targets[a];let d=l.ring;if(e.targetIndex===a&&d){const h=Ce(l.coordinates,c),m=t.getPixelFromCoordinate(h);qo(m,e.startPx)>s&&(d=!1)}if(d){const h=l.coordinates,m=h.length,b=l.startIndex,w=c;if(b<w){const _=it(h,b,w);it(h,b,w-m)<_&&(c-=m)}else{const _=it(h,b,w);it(h,b,w+m)<_&&(c+=m)}}return Rt.index=a,Rt.endIndex=c,Rt}function rt(o,e,t,s){const n=o[0],i=o[1];for(let r=0,a=e.length-1;r<a;++r){const c=e[r],l=e[r+1],d=ys(n,i,c,l);if(d.squaredDistance===0){const h=r+d.along;s.push({coordinates:e,ring:t,startIndex:h,endIndex:h});return}}}const At={along:0,squaredDistance:0};function ys(o,e,t,s){const n=t[0],i=t[1],r=s[0],a=s[1],c=r-n,l=a-i;let d=0,h=n,m=i;return(c!==0||l!==0)&&(d=an(((o-n)*c+(e-i)*l)/(c*c+l*l),0,1),h+=c*d,m+=l*d),At.along=d,At.squaredDistance=nn(Yo(o,e,h,m),10),At}function Ce(o,e){const t=o.length;let s=Math.floor(e);const n=e-s;s>=t?s-=t:s<0&&(s+=t);let i=s+1;i>=t&&(i-=t);const r=o[s],a=r[0],c=r[1],l=o[i],d=l[0]-a,h=l[1]-c;return[a+d*n,c+h*n]}class ir extends Ks{constructor(e){const t=e;t.stopDown||(t.stopDown=Ys),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=ar(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Zs,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let s=e.geometryFunction;if(!s){const n=this.mode_;if(n==="Circle")s=function(i,r,a){const c=r||new ki([NaN,NaN]),l=ao(i[0]),d=Xs(l,ao(i[i.length-1]));return c.setCenterAndRadius(l,Math.sqrt(d),this.geometryLayout_),c};else{let i;n==="Point"?i=Ee:n==="LineString"?i=Pe:n==="Polygon"&&(i=yt),s=function(r,a,c){return a?n==="Polygon"?r[0].length?a.setCoordinates([r[0].concat([r[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(r,this.geometryLayout_):a=new i(r,this.geometryLayout_),a}}}this.geometryFunction_=s,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new be({source:new Fe({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:rr(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Js,this.freehandCondition_,e.freehand?this.freehandCondition_=lo:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Qs,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(en.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=lo:t=e:t=rn,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===Wo.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===te.POINTERMOVE,s=!0;return!this.freehand_&&this.lastDragTime_&&e.type===te.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===te.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),s=!1):this.freehand_&&e.type===te.POINTERDOWN?s=!1:t&&this.getPointerCount()<2?(s=e.type===te.POINTERMOVE,s&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===te.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===te.DBLCLICK&&(s=!1),super.handleEvent(e)&&s}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new tn(te.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const t=this.getMap(),s=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),n=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),i=on([s,n]),r=this.traceSource_.getFeaturesInExtent(i);if(r.length===0)return;const a=sr(e.coordinate,r);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const s=e.startIndex<=e.endIndex,n=e.startIndex<=t;s===n?s&&t>e.endIndex||!s&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(s&&t<e.endIndex||!s&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let s=0;if(e<t){const n=Math.ceil(e);let i=Math.floor(t);i===t&&(i-=1),s=i-n+1}else{const n=Math.floor(e);let i=Math.ceil(t);i===t&&(i+=1),s=n-i+1}s>0&&this.removeLastPoints_(s)}addTracedCoordinates_(e,t,s){if(t===s)return;const n=[];if(t<s){const i=Math.ceil(t);let r=Math.floor(s);r===s&&(r-=1);for(let a=i;a<=r;++a)n.push(ke(e.coordinates,a))}else{const i=Math.floor(t);let r=Math.ceil(s);r===s&&(r+=1);for(let a=i;a>=r;--a)n.push(ke(e.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(e){const t=this.traceState_;if(!t.active||t.targetIndex===-1&&qo(t.startPx,e.pixel)<this.snapTolerance_)return;const s=nr(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==s.index){if(t.targetIndex!==-1){const c=t.targets[t.targetIndex];this.removeTracedCoordinates_(c.startIndex,c.endIndex)}const a=t.targets[s.index];this.addTracedCoordinates_(a,a.startIndex,s.endIndex)}else{const a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,s.endIndex)}t.targetIndex=s.index;const n=t.targets[t.targetIndex];n.endIndex=s.endIndex;const i=Ce(n.coordinates,n.endIndex),r=this.getMap().getPixelFromCoordinate(i);e.coordinate=i,e.pixel=[Math.round(r[0]),Math.round(r[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const s=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(e.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(e.pixel,s)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,s=e.pixel,n=t[0]-s[0],i=t[1]-s[1],r=n*n+i*i;if(this.shouldHandle_=this.freehand_?r>this.squaredClickTolerance_:r<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let s=!1;if(this.sketchFeature_){let n=!1,i=[this.finishCoordinate_];const r=this.mode_;if(r==="Point")s=!0;else if(r==="Circle")s=this.sketchCoords_.length===2;else if(r==="LineString")n=!t&&this.sketchCoords_.length>this.minPoints_;else if(r==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,i=[a[0][0],a[0][a[0].length-2]],t?i=[a[0][0]]:i=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let c=0,l=i.length;c<l;c++){const d=i[c],h=a.getPixelFromCoordinate(d),m=e[0]-h[0],b=e[1]-h[1],w=this.freehand_?1:this.snapTolerance_;if(s=Math.sqrt(m*m+b*b)<=w,s){this.finishCoordinate_=d;break}}}}return s}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new ue(new Ee(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new ue);const t=e.getLinearRing(0);let s=this.sketchLine_.getGeometry();s?(s.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),s.changed()):(s=new Pe(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(s))}startDrawing_(e){const t=this.getMap().getView().getProjection(),s=co(this.geometryLayout_);for(;e.length<s;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ue(new Pe(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new ue,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new st(ot.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),s=this.sketchFeature_.getGeometry(),n=t.getView().getProjection(),i=co(this.geometryLayout_);let r,a;for(;e.length<i;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(r=this.sketchCoords_[0],a=r[r.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(r=this.sketchCoords_,a=r[r.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,s,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),s.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(s):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection();let n,i;const r=this.mode_;r==="LineString"||r==="Circle"?(this.finishCoordinate_=e.slice(),i=this.sketchCoords_,i.length>=this.maxPoints_&&(this.freehand_?i.pop():n=!0),i.push(e.slice()),this.geometryFunction_(i,t,s)):r==="Polygon"&&(i=this.sketchCoords_[0],i.length>=this.maxPoints_&&(this.freehand_?i.pop():n=!0),i.push(e.slice()),n&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,t,s)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),n&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection(),n=this.mode_;for(let i=0;i<e;++i){let r;if(n==="LineString"||n==="Circle"){if(r=this.sketchCoords_,r.splice(-2,1),r.length>=2){this.finishCoordinate_=r[r.length-2].slice();const a=this.finishCoordinate_.slice();r[r.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(r,t,s),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(n==="Polygon"){r=this.sketchCoords_[0],r.splice(-2,1);const a=this.sketchLine_.getGeometry();if(r.length>=2){const c=r[r.length-2].slice();r[r.length-1]=c,this.createOrUpdateSketchPoint_(c)}a.setCoordinates(r),this.geometryFunction_(this.sketchCoords_,t,s)}if(r.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const s=e.getGeometry(),n=this.getMap().getView().getProjection();this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,s,n)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,s,n),t=s.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Wn([t])):this.type_==="MultiLineString"?e.setGeometry(new rs([t])):this.type_==="MultiPolygon"&&e.setGeometry(new as([t])),this.dispatchEvent(new st(ot.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new st(ot.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,s=!this.sketchFeature_;s&&this.startDrawing_(e[0]);let n;if(t==="LineString"||t==="Circle")n=this.sketchCoords_;else if(t==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;s&&n.shift(),n.pop();for(let r=0;r<e.length;r++)this.addToDrawing_(e[r]);const i=e[e.length-1];this.addToDrawing_(i),this.modifyDrawing_(i)}extend(e){const s=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=s.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new ue(new Ee(n)),this.updateSketchFeatures_(),this.dispatchEvent(new st(ot.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function rr(){const o=sn();return function(e,t){return o[e.getGeometry().getType()]}}function ar(o){switch(o){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+o)}}const lr=ir,N={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},cr={ERROR:"error"};class ur extends Ko{constructor(e){super(cr.ERROR),this.code=e.code,this.message=e.message}}let dr=class extends Zo{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.position_=null,this.transform_=ln,this.watchId_=void 0,this.addChangeListener(N.PROJECTION,this.handleProjectionChanged_),this.addChangeListener(N.TRACKING,this.handleTrackingChanged_),e.projection!==void 0&&this.setProjection(e.projection),e.trackingOptions!==void 0&&this.setTrackingOptions(e.trackingOptions),this.setTracking(e.tracking!==void 0?e.tracking:!1)}disposeInternal(){this.setTracking(!1),super.disposeInternal()}handleProjectionChanged_(){const e=this.getProjection();e&&(this.transform_=cn(uo("EPSG:4326"),e),this.position_&&this.set(N.POSITION,this.transform_(this.position_)))}handleTrackingChanged_(){if("geolocation"in navigator){const e=this.getTracking();e&&this.watchId_===void 0?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):!e&&this.watchId_!==void 0&&(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}}positionChange_(e){const t=e.coords;this.set(N.ACCURACY,t.accuracy),this.set(N.ALTITUDE,t.altitude===null?void 0:t.altitude),this.set(N.ALTITUDE_ACCURACY,t.altitudeAccuracy===null?void 0:t.altitudeAccuracy),this.set(N.HEADING,t.heading===null?void 0:un(t.heading)),this.position_?(this.position_[0]=t.longitude,this.position_[1]=t.latitude):this.position_=[t.longitude,t.latitude];const s=this.transform_(this.position_);this.set(N.POSITION,s.slice()),this.set(N.SPEED,t.speed===null?void 0:t.speed);const n=dn(this.position_,t.accuracy);n.applyTransform(this.transform_),this.set(N.ACCURACY_GEOMETRY,n),this.changed()}positionError_(e){this.dispatchEvent(new ur(e))}getAccuracy(){return this.get(N.ACCURACY)}getAccuracyGeometry(){return this.get(N.ACCURACY_GEOMETRY)||null}getAltitude(){return this.get(N.ALTITUDE)}getAltitudeAccuracy(){return this.get(N.ALTITUDE_ACCURACY)}getHeading(){return this.get(N.HEADING)}getPosition(){return this.get(N.POSITION)}getProjection(){return this.get(N.PROJECTION)}getSpeed(){return this.get(N.SPEED)}getTracking(){return this.get(N.TRACKING)}getTrackingOptions(){return this.get(N.TRACKING_OPTIONS)}setProjection(e){this.set(N.PROJECTION,uo(e))}setTracking(e){this.set(N.TRACKING,e)}setTrackingOptions(e){this.set(N.TRACKING_OPTIONS,e)}};const hr=dr,U={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class fr extends Zo{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+hn,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(U.ELEMENT,this.handleElementChanged),this.addChangeListener(U.MAP,this.handleMapChanged),this.addChangeListener(U.OFFSET,this.handleOffsetChanged),this.addChangeListener(U.POSITION,this.handlePositionChanged),this.addChangeListener(U.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(U.ELEMENT)}getId(){return this.id}getMap(){return this.get(U.MAP)||null}getOffset(){return this.get(U.OFFSET)}getPosition(){return this.get(U.POSITION)}getPositioning(){return this.get(U.POSITIONING)}handleElementChanged(){fn(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(pn(this.element),gn(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Xo(e,Jo.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(U.ELEMENT,e)}setMap(e){this.set(U.MAP,e)}setOffset(e){this.set(U.OFFSET,e)}setPosition(e){this.set(U.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(U.POSITION))return;const s=this.getRect(t.getTargetElement(),t.getSize()),n=this.getElement(),i=this.getRect(n,[mn(n),vn(n)]);e=e||{};const r=e.margin===void 0?20:e.margin;if(!Qo(s,i)){const a=i[0]-s[0],c=s[2]-i[2],l=i[1]-s[1],d=s[3]-i[3],h=[0,0];if(a<0?h[0]=a-r:c<0&&(h[0]=Math.abs(c)+r),l<0?h[1]=l-r:d<0&&(h[1]=Math.abs(d)+r),h[0]!==0||h[1]!==0){const m=t.getView().getCenterInternal(),b=t.getPixelFromCoordinateInternal(m);if(!b)return;const w=[b[0]+h[0],b[1]+h[1]],_=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(w),duration:_.duration,easing:_.easing})}}}getRect(e,t){const s=e.getBoundingClientRect(),n=s.left+window.pageXOffset,i=s.top+window.pageYOffset;return[n,i,n+t[0],i+t[1]]}setPositioning(e){this.set(U.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const s=e.getPixelFromCoordinate(t),n=e.getSize();this.updateRenderedPosition(s,n)}updateRenderedPosition(e,t){const s=this.element.style,n=this.getOffset(),i=this.getPositioning();this.setVisible(!0);const r=Math.round(e[0]+n[0])+"px",a=Math.round(e[1]+n[1])+"px";let c="0%",l="0%";i=="bottom-right"||i=="center-right"||i=="top-right"?c="-100%":(i=="bottom-center"||i=="center-center"||i=="top-center")&&(c="-50%"),i=="bottom-left"||i=="bottom-center"||i=="bottom-right"?l="-100%":(i=="center-left"||i=="center-center"||i=="center-right")&&(l="-50%");const d=`translate(${c}, ${l}) translate(${r}, ${a})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,s.transform=d)}getOptions(){return this.options}}const dt=fr;class pr{constructor({properties:e}){const t=e.logLevel;console.debug("Log Service created with log level",t)}destroy(){console.debug("Log Service destroyed")}log(e){console.info("LOG: "+e)}}new Ee([407354,5754673]),new Ee([404740,5757893]);var de,ne,We,qe,Ke,$t;class gr extends ls{constructor(t,s,n){super();D(this,Ke);ro(this,"label");D(this,de,{kind:"available"});D(this,ne,void 0);D(this,We,void 0);D(this,qe,void 0);this.label=s,O(this,ne,t),O(this,qe,n),z(this,Ke,$t).call(this),O(this,We,M(this,ne).on("change:visible",()=>{z(this,Ke,$t).call(this)}))}destroy(){ae(M(this,We))}get status(){return M(this,de)}async select(t,s){if(t.type!=="extent")throw new Error(`Unsupported selection kind: ${t.type}`);if(M(this,de).kind!=="available"||M(this,ne).getSource()===null)return[];const n=[];M(this,ne).getSource().forEachFeatureIntersectingExtent(t.extent,a=>{if(!a.getGeometry())return;const c={id:a.getId()?.toString()||a.getGeometry.toString(),geometry:a.getGeometry()};n.push(c)});const i=n.filter(a=>a!=null);return i.length>s.maxResults?i.slice(0,s.maxResults):i}}de=new WeakMap,ne=new WeakMap,We=new WeakMap,qe=new WeakMap,Ke=new WeakSet,$t=function(){const s=M(this,ne).getVisible()?{kind:"available"}:{kind:"unavailable",reason:M(this,qe)};s.kind!==M(this,de).kind&&(O(this,de,s),this.emit("changed:status"))};var Ye;class mr{constructor({intl:e}){D(this,Ye,void 0);O(this,Ye,e)}createSelectionSource(e){return new gr(e.vectorLayer,e.label,M(this,Ye).formatMessage({id:"layerNotVisibleReason"}))}}Ye=new WeakMap;const pe=ve("local-storage"),vr=0,X={CORRUPTED_DATA:"local-storage:corrupted-data",INVALID_PATH:"local-storage:invalid-path",INVALID_VALUE:"local-storage:invalid-value",NOT_SUPPORTED:"local-storage:not-supported",INTERNAL:"local-storage:internal-error"};var Me,q,ie,Te,K,pt,ws,gt,Ss,he,He,re,Se,mt,_s;class br{constructor(e){D(this,pt);D(this,gt);D(this,he);D(this,re);D(this,mt);D(this,Me,void 0);D(this,q,{});D(this,ie,void 0);D(this,Te,void 0);D(this,K,void 0);O(this,Me,_r(e.properties)),O(this,ie,xr()),M(this,ie)&&(z(this,gt,Ss).call(this),O(this,Te,z(this,mt,_s).call(this)))}destroy(){M(this,K)&&(clearTimeout(M(this,K)),O(this,K,void 0)),M(this,ie)&&z(this,he,He).call(this)}get isSupported(){return!!M(this,Te)}get(e){return z(this,re,Se).call(this).get(e)}set(e,t){return z(this,re,Se).call(this).set(e,t)}remove(e){return z(this,re,Se).call(this).remove(e)}removeAll(){return z(this,re,Se).call(this).removeAll()}getNamespace(e){return z(this,re,Se).call(this).getNamespace(e)}}Me=new WeakMap,q=new WeakMap,ie=new WeakMap,Te=new WeakMap,K=new WeakMap,pt=new WeakSet,ws=function(){M(this,K)&&clearTimeout(M(this,K)),O(this,K,setTimeout(()=>{O(this,K,void 0),z(this,he,He).call(this)},vr))},gt=new WeakSet,Ss=function(){try{const e=M(this,ie);if(!e)throw new Z(X.INTERNAL,"Local storage is not available.");const t=e.getItem(M(this,Me));if(t==null){O(this,q,{}),z(this,he,He).call(this);return}try{const s=JSON.parse(t);if(!je(s))throw new Z(X.CORRUPTED_DATA,"Persisted value should be an object.");O(this,q,s)}catch(s){pe.warn("Invalid persisted data, reverting to default.",s),O(this,q,{}),z(this,he,He).call(this)}}catch(e){pe.error("Failed to load from local storage",e)}},he=new WeakSet,He=function(){try{const e=M(this,ie);if(!e)throw new Z(X.INTERNAL,"Local storage is not available.");const t=JSON.stringify(M(this,q));e.setItem(M(this,Me),t)}catch(e){pe.error("Failed to save to local storage",e)}},re=new WeakSet,Se=function(){const e=M(this,Te);if(!e)throw new Z(X.NOT_SUPPORTED,"Local storage is not supported by this browser.");return e},mt=new WeakSet,_s=function(){const e={getByPath:t=>ko(yr(M(this,q),t)),setByPath:(t,s)=>{if(!Sr(s))throw new Z(X.INVALID_VALUE,"The value is not supported by local storage.");if(s=ko(s),t.length===0){if(!je(s))throw new Z(X.INVALID_VALUE,"The root value must be a plain object.");O(this,q,s)}else wr(M(this,q),t,s);z(this,pt,ws).call(this)}};return new eo([],e)};class eo{path;access;constructor(e,t){this.path=e,this.access=t}get(e){return this.access.getByPath([...this.path,e])}set(e,t){this.access.setByPath([...this.path,e],t)}remove(e){this.access.setByPath([...this.path,e],void 0)}removeAll(){this.access.setByPath(this.path,{})}getNamespace(e){const t=this.get(e);if(t===void 0)this.set(e,{});else if(!je(t))throw new Z(X.INVALID_PATH,`Cannot use '${e}' as a namespace because it is not associated with an object.`);return new eo(this.path.concat([e]),this.access)}}const xo="trails-state";function yr(o,e){let t=o;for(const s of e){if(!je(t))throw new Z(X.INVALID_PATH,`Cannot get nested property '${s}' because the parent is no object.`);t=t[s]}return t}function wr(o,e,t){if(!e.length)throw new Z(X.INTERNAL,"Path must not be empty.");let s=o;for(let i=0,r=e.length-1;i<r;++i){const a=e[i],c=s[a];if(!je(c))throw new Z(X.INVALID_PATH,`Cannot set property on '${a}' because it is no object.`);s=c}const n=e[e.length-1];s[n]=t}function je(o){return!!(o&&typeof o=="object"&&!Array.isArray(o))}function Sr(o){const e=typeof o;return e==="boolean"||e==="number"||e==="string"||e==="undefined"||o===null||Array.isArray(o)||je(o)}function _r(o){const e=o.storageId;return!e||typeof e!="string"?(pe.warn(`The 'storageId' property of the 'local-storage' package should be set to a valid string to avoid collisions with other applications. Defaulting to '${xo}'.`),xo):e}function xr(){if(typeof Storage>"u"){pe.warn("Local storage is not supported by this browser.");return}try{const o=globalThis.localStorage;if(!o){pe.warn("Local storage is not supported by this browser.");return}return o}catch(o){pe.warn("Local storage is not supported by this browser.",o);return}}function ko(o){return o!=null&&(o=JSON.parse(JSON.stringify(o))),o}const kr={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:Ci,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},AppConfig:{name:"AppConfig",clazz:tr,provides:[{name:"ol-app.AppConfig",qualifier:void 0}],references:{ogcSearchSourceFactory:{name:"ogc-features.SearchSourceFactory",qualifier:void 0,all:!1},selectionSourceFactory:{name:"selection.SelectionSourceFactory",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1},mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map-sample-logging.LogService",qualifier:void 0,all:!1},{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppConfig",qualifier:void 0,all:!1},{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:bn,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:yn,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Yn,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:Xn,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:Jn,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"map-sample-logging":{name:"map-sample-logging",services:{LogService:{name:"LogService",clazz:pr,provides:[{name:"map-sample-logging.LogService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{logLevel:{value:"INFO",required:!1}}},"@open-pioneer/selection":{name:"@open-pioneer/selection",services:{SelectionSourceFactory:{name:"SelectionSourceFactory",clazz:mr,provides:[{name:"selection.SelectionSourceFactory",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:br,provides:[{name:"local-storage.LocalStorageService",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}}},Cr=`.search-box{position:absolute;width:500px;max-width:100%;z-index:1}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.selection-drag-box{background-color:#ffffff4d!important;border:3px solid var(--chakra-colors-background_primary)!important}.selection-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.selection .react-select{cursor:default}.map-container .selection-active{cursor:crosshair}.map-container .selection-inactive{cursor:no-drop}.selection-source-value.selection-source-value--disabled{opacity:.4}.selection-source-value.selection-source-value--disabled span{margin:0 6px 0 0}.measurement-tooltip{position:relative;background:rgba(255,255,255,.8);border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:rgba(0,0,0,.9);border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}
`,Er=["en","de"];function Pr(o){switch(o){case"en":return bo(()=>import("./60b1426a8ea5.js"),[],import.meta.url).then(e=>e.default);case"de":return bo(()=>import("./38b6a9af24db.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${o}'`)}const Mr=js(Cr),Tr=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Pr,locales:Er,packages:kr,styles:Mr},Symbol.toStringTag,{value:"Module"})),Lr="@open-pioneer/coordinate-viewer",Rr=le.bind(void 0,Lr),Ar=4,Ir=o=>{const{mapId:e,precision:t}=o,{containerProps:s}=Q("coordinate-viewer",o),{map:n}=W(e),i=n?.olMap,{coordinates:r}=Or(i),a=Dr(r,t),c=us(i)?.getCode()??"",l=a?a+" "+c:"";return u.jsx(V,{...s,children:u.jsx(et,{className:"coordinate-viewer-text",children:l})})};function Dr(o,e){const t=Rr();return o?jr(o,e,t):""}function Or(o){const[e,t]=y.useState();return y.useEffect(()=>{if(!o)return;const s=o.on("pointermove",n=>{t(n.coordinate)});return()=>ae(s)},[o]),{coordinates:e}}function jr(o,e,t){if(o[0]==null||o[1]==null)return"";const s=e??Ar,[n,i]=o,r=t.formatNumber(n,{maximumFractionDigits:s,minimumFractionDigits:s}),a=t.formatNumber(i,{maximumFractionDigits:s,minimumFractionDigits:s});return r+" "+a}const xs="@open-pioneer/geolocation",Nr=St.bind(void 0,xs),Fr=le.bind(void 0,xs);function Vr(o){return oi({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}}]})(o)}const Co=ve("geolocation:GeolocationController"),Eo=17;class Br extends ls{olMap;positionHighlightLayer;geolocation;maxZoom=Eo;accuracyFeature;positionFeature;changeHandlers=[];isCurrentlyActive=!1;setMapToPosition=!0;trackingOptions={};isInitialZoom=!0;constructor(e,t){super(),this.olMap=e,this.isInitialZoom=!0,this.accuracyFeature=new ue,this.accuracyFeature.setStyle(Mo()),this.positionFeature=new ue,this.positionFeature.setStyle(Po()),this.positionHighlightLayer=new be({source:new Fe({features:[this.accuracyFeature,this.positionFeature]})}),this.positionHighlightLayer.setZIndex(es);const s=t||Gr();this.geolocation=new hr({tracking:!1,trackingOptions:s,projection:e.getView()?.getProjection()}),this.trackingOptions=s,this.geolocation.on("error",n=>this.handleGeolocationError(n))}destroy(){this.stopGeolocation(),this.geolocation?.setTracking(!1),this.geolocation.dispose(),this.accuracyFeature=void 0,this.positionFeature=void 0,this.positionHighlightLayer.dispose()}startGeolocation(){if(this.isCurrentlyActive)return Promise.resolve();const e=this.olMap;return new Promise(s=>{this.isCurrentlyActive=!0,this.geolocation?.setProjection(e.getView()?.getProjection()),this.geolocation?.setTracking(!0);const n=this.geolocation.on("change:accuracyGeometry",()=>{const c=this.geolocation.getAccuracyGeometry()||void 0;if(this.accuracyFeature?.setGeometry(c),this.accuracyFeature?.getGeometry()!==void 0&&s(),this.isInitialZoom){const l=this?.accuracyFeature?.getGeometry()?.getExtent();if(l){const d=wn(l);if(!d)return;e.getView().fit(d,{maxZoom:this.maxZoom}),this.isInitialZoom=!1}}}),i=this.geolocation.on("change:position",()=>{const c=this.geolocation.getPosition();c&&(c[0]||c[1])!==void 0&&(this.positionFeature?.setGeometry(new Ee(c)),this.setMapToPosition&&e.getView().setCenter(c),this.positionFeature?.getGeometry()!==void 0&&s())}),r=e.getView().on("change:resolution",()=>{this.setMapToPosition=this.isInitialZoom}),a=e.on("pointermove",c=>{c.dragging&&(this.setMapToPosition=!1)});this.changeHandlers.push(n,i,r,a),e.addLayer(this.positionHighlightLayer)}).catch(s=>{Co.error("Failed to determine location",s)})}stopGeolocation(){this.geolocation?.setTracking(!1),this.isCurrentlyActive=!1,this.trackingOptions={},this.setMapToPosition=!0,this.isInitialZoom=!0,this.changeHandlers.forEach(e=>{ae(e)}),this.changeHandlers=[],this.accuracyFeature?.setGeometry(void 0),this.positionFeature?.setGeometry(void 0),this.olMap.removeLayer(this.positionHighlightLayer)}setPositionFeatureStyle(e){this.positionFeature?.setStyle(e??Po())}setAccuracyFeatureStyle(e){this.accuracyFeature?.setStyle(e??Mo())}setMaxZoom(e){this.maxZoom=e??Eo}getMaxZoom(){return this.maxZoom}getPositionFeature(){return this.positionFeature}getAccuracyFeature(){return this.accuracyFeature}getTrackingOptions(){return this.trackingOptions}getGeolocation(){return this.geolocation}handleGeolocationError(e){Co.error("Error from geolocation API:",e.message);const t=(()=>{switch(e.code){case 1:return"permission-denied";case 2:return"position-unavailable";case 3:return"timeout";default:return"unknown"}})();this.emit("error",t)}}const Po=()=>new ge({image:new Yt({radius:6,fill:new Ie({color:"#3399CC"}),stroke:new fe({color:"#fff",width:2})})}),Mo=()=>new ge({stroke:new fe({color:"#3399CC",width:3}),fill:new Ie({color:"rgba(0, 0, 255, 0.05)"})}),Gr=()=>({enableHighAccuracy:!0,timeout:6e4,maximumAge:6e5}),zr=y.forwardRef(function(e,t){const{mapId:s,maxZoom:n,positionFeatureStyle:i,accuracyFeatureStyle:r,trackingOptions:a}=e,{containerProps:c}=Q("geolocation",e),l=!!navigator.geolocation,[d,h]=y.useState(!1),[m,b]=y.useState(!1),{map:w}=W(s),_=Fr(),T=Nr("notifier.NotificationService"),C=Ur(w,n,a,i,r),R=(()=>l?d?_.formatMessage({id:"locateMeEnd"}):_.formatMessage({id:"locateMeStart"}):_.formatMessage({id:"locateNotSupported"}))();y.useEffect(()=>{if(C===void 0)return;const $=C.on("error",function(H){const L=_.formatMessage({id:"error"}),B=(()=>{switch(H){case"permission-denied":return _.formatMessage({id:"permissionDenied"});case"position-unavailable":return _.formatMessage({id:"positionUnavailable"});case"timeout":return _.formatMessage({id:"timeout"});case"unknown":return _.formatMessage({id:"unknownError"})}})();b(!1),h(!1),T.notify({level:"error",title:L,message:B})});return()=>{$.destroy()}},[C,_,T]),y.useEffect(()=>{if(!C){b(!1);return}return d&&(b(!0),C.startGeolocation().then(()=>{b(!1)})),()=>{C?.stopGeolocation(),b(!1)}},[C,d]);const P=()=>{w&&h(!d)};return u.jsx(we,{ref:t,label:R,icon:u.jsx(Vr,{}),onClick:()=>P(),isActive:d,isLoading:m,isDisabled:!l,...c})});function Ur(o,e,t,s,n){const[i,r]=y.useState();return y.useEffect(()=>{if(!o)return;const a=new Br(o.olMap,t);return r(a),()=>{a.destroy(),r(void 0)}},[o,t]),y.useEffect(()=>{i?.setPositionFeatureStyle(s)},[i,s]),y.useEffect(()=>{i?.setAccuracyFeatureStyle(n)},[i,n]),y.useEffect(()=>{i?.setMaxZoom(e)},[i,e]),i}const $r="@open-pioneer/measurement",Hr=le.bind(void 0,$r);class Wr{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;sketch=void 0;helpTooltip;measureTooltip;overlayTooltips=[];resources=[];constructor(e,t){this.olMap=e,this.messages=t;const s=this.source=new Fe;this.layer=new be({source:s}),this.layer.setZIndex(es),e.addLayer(this.layer);const n=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){ae(n)}});const i=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",i),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",i)}}),this.helpTooltip=this.createHelpTooltip()}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.helpTooltip.destroy(),this.measureTooltip?.destroy();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[],this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setActiveFeatureStyle(e){const t=Sn(e);this.activeFeatureStyle=(s,...n)=>{const i=s?.getGeometry()?.getType();if(i==="Polygon"||i==="LineString"||i==="Point")return t(s,...n)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){this.source.clear();for(const e of this.overlayTooltips)e.destroy();this.overlayTooltips=[]}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",s=this.draw=new lr({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(s);let n,i;s.on("drawstart",r=>{n=this.measureTooltip=this.createMeasureTooltip();const a=this.sketch=r.feature;if(!a)return;let c;i=a.getGeometry()?.on("change",l=>{const d=l.target,h=this.olMap.getView().getProjection();let m="";d instanceof yt?(m=Kr(d,h,this.messages),c=d.getInteriorPoint().getCoordinates()||null):d instanceof Pe&&(m=Yr(d,h,this.messages),c=d.getLastCoordinate()||null),n&&(n.element.innerHTML=m,c&&n?.overlay.setPosition(c))})}),s.on("drawend",()=>{if(n){const r=n.element.classList;r.remove("measurement-active-tooltip"),r.add("measurement-finished-tooltip"),n.overlay.setOffset([0,-7]),this.overlayTooltips.push(n),this.measureTooltip=n=void 0}this.sketch=void 0,i&&ae(i)}),s.on("drawabort",()=>{n&&(n.destroy(),this.measureTooltip=n=void 0),this.sketch=void 0,i&&ae(i)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.sketch=void 0,this.measureTooltip?.destroy(),this.measureTooltip=void 0}createMeasureTooltip(){const e=document.createElement("div");e.className="measurement-tooltip measurement-active-tooltip";const t=new dt({element:e,offset:[0,-15],positioning:"bottom-center",stopEvent:!1,insertFirst:!1}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}createHelpTooltip(){const e=document.createElement("div");e.className="measurement-tooltip hidden";const t=new dt({element:e,offset:[15,0],positioning:"center-left"}),s=this.olMap;return s.addOverlay(t),{overlay:t,element:e,destroy(){s.removeOverlay(t)}}}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,s=qr(this.messages,this.sketch);t.element.textContent=s,t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}}function qr(o,e){if(e){const t=e.getGeometry();if(t instanceof yt||t instanceof Pe)return o.getContinueMessage()}return o.getHelpMessage()}function Kr(o,e,t){const s=_n(o,{projection:e});let n;return s>=1e6?n=`${t.formatNumber(s/1e6)} km<sup>2</sup>`:n=`${t.formatNumber(s)} m<sup>2</sup>`,n}function Yr(o,e,t){const s=xn(o,{projection:e});let n;return s>=1e3?n=`${t.formatNumber(s/1e3)} km`:n=`${t.formatNumber(s)} m`,n}const Zr=o=>{const e=Hr(),{mapId:t,activeFeatureStyle:s,finishedFeatureStyle:n}=o,{containerProps:i}=Q("measurement",o),[r,a]=y.useState("distance"),c=b=>e.formatMessage({id:b}),l=W(t),d=Xr(l.map,e);y.useEffect(()=>{d?.setActiveFeatureStyle(s??Jr())},[d,s]),y.useEffect(()=>{d?.setFinishedFeatureStyle(n??Qr())},[d,n]),y.useEffect(()=>{if(d)return d.startMeasurement(r),()=>{d.stopMeasurement()}},[d,r]);function h(b){if(b==="distance"||b==="area")a(b);else throw new Error(`Unexpected measurement type: '${b}'.`)}function m(){d?.clearMeasurements()}return u.jsxs(V,{...i,children:[u.jsx(et,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),u.jsx(Ft,{mb:4,alignItems:"center",children:u.jsxs(ni,{mb:2,children:[u.jsx(Vt,{mb:1,children:c("measurementLabel")}),u.jsxs(ii,{value:r,onChange:b=>h(b.target.value),className:"measurement-select",children:[u.jsx("option",{value:"distance",children:c("distance")}),u.jsx("option",{value:"area",children:c("area")})]})]})}),u.jsx(qt,{padding:2,className:"measurement-delete-button",onClick:m,width:"100%",children:c("deleteMeasurementLabel")})]})};function Xr(o,e){const[t,s]=y.useState(void 0);return y.useEffect(()=>{if(!o)return;const n=new Wr(o.olMap,{getContinueMessage(){return e.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return e.formatMessage({id:"tooltips.help"})},formatNumber(i){return e.formatNumber(i,{maximumFractionDigits:2})}});return s(n),()=>{n.destroy(),s(void 0)}},[o,e]),t}function Jr(){return[new ge({stroke:new fe({color:"#fff",lineDash:[10,10],width:5})}),new ge({fill:new Ie({color:"rgba(0,0,0,0.15)"}),stroke:new fe({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new Yt({radius:5,stroke:new fe({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new Ie({color:"rgba(255, 255, 255, 0.2)"})})})]}function Qr(){return[new ge({stroke:new fe({color:"#fff",width:5})}),new ge({stroke:new fe({color:"#0b96fc",width:3}),fill:new Ie({color:"rgba(11,150,252,0.15)"})})]}var ea=ri({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"});const It=.75,at=.1;let ta=class extends ts{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",s=e.tipLabel!==void 0?e.tipLabel:"Overview map",n=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof n=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n):this.collapseLabel_=n;const i=e.label!==void 0?e.label:"›";typeof i=="string"?(this.label_=document.createElement("span"),this.label_.textContent=i):this.label_=i;const r=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=s,a.appendChild(r),a.addEventListener(Wo.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const c=new kn({view:e.view,controls:new ho,interactions:new ho});this.ovmap_=c,e.layers&&e.layers.forEach(function(R){c.addLayer(R)});const l=document.createElement("div");l.className="ol-overviewmap-box",l.style.boxSizing="border-box",this.boxOverlay_=new dt({position:[0,0],positioning:"center-center",element:l}),this.ovmap_.addOverlay(this.boxOverlay_);const d=t+" "+os+" "+Cn+(this.collapsed_&&this.collapsible_?" "+fo:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=d,h.appendChild(this.ovmapDiv_),h.appendChild(a);const m=this,b=this.boxOverlay_,w=this.boxOverlay_.getElement(),_=function(R){return{clientX:R.clientX,clientY:R.clientY}},T=function(R){const P=_(R),$=c.getEventCoordinateInternal(P);b.setPosition($)},C=function(R){const P=c.getEventCoordinateInternal(R);m.getMap().getView().setCenterInternal(P),window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",C)};w.addEventListener("mousedown",function(){window.addEventListener("mousemove",T),window.addEventListener("mouseup",C)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const s=t.getView();s&&this.unbindView_(s),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(Xo(e,En.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const s=e.getView();s&&(this.bindView_(s),s.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===Pt.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const s=this.getMap().getView();this.bindView_(s)}else!this.ovmap_.isRendered()&&(e.key===Pt.TARGET||e.key===Pt.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new Pn({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(po.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(po.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),i=e.getView().calculateExtentInternal(s);if(this.viewExtent_&&Mn(i,this.viewExtent_))return;this.viewExtent_=i;const r=t.getSize(),c=t.getView().calculateExtentInternal(r),l=t.getPixelFromCoordinateInternal(Tn(i)),d=t.getPixelFromCoordinateInternal(Ln(i)),h=Math.abs(l[0]-d[0]),m=Math.abs(l[1]-d[1]),b=r[0],w=r[1];h<b*at||m<w*at||h>b*It||m>w*It?this.resetExtent_():Qo(c,i)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,s=e.getSize(),i=e.getView().calculateExtentInternal(s),r=t.getView(),a=Math.log(It/at)/Math.LN2,c=1/(Math.pow(2,a/2)*at);Rn(i,c),r.fitInternal(An(i))}recenter_(){const e=this.getMap(),t=this.ovmap_,s=e.getView();t.getView().setCenterInternal(s.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const s=e.getSize(),n=e.getView(),i=t.getView(),r=this.rotateWithView_?0:-n.getRotation(),a=this.boxOverlay_,c=this.boxOverlay_.getElement(),l=n.getCenterInternal(),d=n.getResolution(),h=i.getResolution(),m=s[0]*d/h,b=s[1]*d/h;if(a.setPosition(l),c){c.style.width=m+"px",c.style.height=b+"px";const w="rotate("+r+"rad)";c.style.transform=w}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=In(this.ovmap_,Jo.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(fo),this.collapsed_?go(this.collapseLabel_,this.label_):go(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}};const oa=ta,Dt="units",sa=[1,2,5],Ge=25.4/.28;class na extends ts{constructor(e){e=e||{};const t=document.createElement("div");t.style.pointerEvents="none",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un;const s=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=s+"-inner",this.element.className=s+" "+os,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(Dt,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(Dt)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(Dt,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=e.center,s=e.projection,n=this.getUnits(),i=n=="degrees"?"degrees":"m";let r=Nt(s,e.resolution,t,i);const a=this.minWidth_*(this.dpi_||Ge)/Ge,c=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Ge)/Ge:void 0;let l=a*r,d="";if(n=="degrees"){const P=Dn.degrees;l*=P,l<P/60?(d="″",r*=3600):l<P?(d="′",r*=60):d="°"}else if(n=="imperial")l<.9144?(d="in",r/=.0254):l<1609.344?(d="ft",r/=.3048):(d="mi",r/=1609.344);else if(n=="nautical")r/=1852,d="NM";else if(n=="metric")l<.001?(d="μm",r*=1e6):l<1?(d="mm",r*=1e3):l<1e3?d="m":(d="km",r/=1e3);else if(n=="us")l<.9144?(d="in",r*=39.37):l<1609.344?(d="ft",r/=.30480061):(d="mi",r/=1609.3472);else throw new Error("Invalid units");let h=3*Math.floor(Math.log(a*r)/Math.log(10)),m,b,w,_,T,C;for(;;){w=Math.floor(h/3);const P=Math.pow(10,w);if(m=sa[(h%3+3)%3]*P,b=Math.round(m/r),isNaN(b)){this.element.style.display="none",this.renderedVisible_=!1;return}if(c!==void 0&&b>=c){m=_,b=T,w=C;break}else if(b>=a)break;_=m,T=b,C=w,++h}const R=this.scaleBar_?this.createScaleBar(b,m,d):m.toFixed(w<0?-w:0)+" "+d;this.renderedHTML_!=R&&(this.innerElement_.innerHTML=R,this.renderedHTML_=R),this.renderedWidth_!=b&&(this.innerElement_.style.width=b+"px",this.renderedWidth_=b),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,t,s){const n=this.getScaleForResolution(),i=n<1?Math.round(1/n).toLocaleString()+" : 1":"1 : "+Math.round(n).toLocaleString(),r=this.scaleBarSteps_,a=e/r,c=[this.createMarker("absolute")];for(let d=0;d<r;++d){const h=d%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";c.push(`<div><div class="ol-scale-singlebar ${h}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(d%2===0||r===2?this.createStepText(d,e,!1,t,s):"")+"</div>")}return c.push(this.createStepText(r,e,!0,t,s)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+i+"</div>":"")+c.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,t,s,n,i){const a=(e===0?0:Math.round(n/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+i),c=e===0?-3:t/this.scaleBarSteps_*-1,l=e===0?0:t/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${c}px;text-align: ${e===0?"left":"center"};min-width: ${l}px;left: ${s?t+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=Nt(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),t=this.dpi_||Ge,s=1e3/25.4;return e*s*t}render(e){const t=e.frameState;t?this.viewState_=t.viewState:this.viewState_=null,this.updateElement_()}}const ia=na,ra="200px",aa="300px",la=o=>{const{mapId:e,olLayer:t,height:s=ra,width:n=aa}=o,{containerProps:i}=Q("overview-map",o),r=y.useRef(null),{map:a}=W(e);return y.useEffect(()=>{if(r.current&&a&&t){const c=a.olMap,l=new oa({className:"ol-overviewmap",layers:[t],collapsible:!1,collapsed:!1,target:r.current});return c.addControl(l),()=>{c.removeControl(l)}}},[a,t]),u.jsx(V,{height:s,width:n,ref:r,...i})},ca=o=>{const{mapId:e,displayMode:t="line"}=o,{containerProps:s}=Q("scale-bar",o),{map:n}=W(e),i=y.useRef(null);return y.useEffect(()=>{if(i.current&&n){const r=n.olMap,a=new ia({units:"metric",target:i.current,bar:t==="bar"});return r.addControl(a),()=>{r.removeControl(a)}}},[t,n]),u.jsx(V,{...s,ref:i})},ua="@open-pioneer/scale-viewer",da=le.bind(void 0,ua),ha=o=>{const{mapId:e}=o,{containerProps:t}=Q("scale-viewer",o),{map:s}=W(e),n=da(),i=xi(s?.olMap),r=i?n.formatNumber(i):void 0;return u.jsx(V,{...t,children:r&&u.jsxs(et,{children:["1:",r]})})},fa="@open-pioneer/search",xt=le.bind(void 0,fa);function pa(o){const e=o.selectProps.inputValue.length>0,t={...o,className:wt(o.className,{"search-invisible":!e})};return u.jsx(ee.Menu,{...t,children:o.children})}function ga(o){const t=xt().formatMessage({id:"noOptionsText"});return u.jsx(ee.NoOptionsMessage,{...o,children:u.jsx(me.span,{className:"search-no-match",children:t})})}function ma(o){const t=xt().formatMessage({id:"loadingText"});return u.jsx(ee.LoadingMessage,{...o,children:u.jsx(me.span,{className:"search-loading-text",children:t})})}function va({children:o,...e}){const t={...e,className:wt(e.className,"search-value-container")};return u.jsxs(ee.ValueContainer,{...t,children:[!!o&&u.jsx(ea,{style:{position:"absolute",left:8}}),o]})}function ba(o){const e={...o,isHidden:!1};return u.jsx(ee.Input,{...e})}function ya(o){return null}function wa(o){return u.jsxs(ee.IndicatorsContainer,{...o,children:[o.children,!o.selectProps.isLoading&&o.selectProps.inputValue&&u.jsx(Sa,{selectProps:o.selectProps,clearValue:o.clearValue})]})}function Sa(o){const t=xt().formatMessage({id:"ariaLabel.clearButton"}),s=n=>{n.preventDefault(),n.stopPropagation(),o.clearValue()};return u.jsx(Ns,{role:"button",size:"md",mr:1,"aria-label":t,onClick:s,onTouchEnd:s,onMouseDown:n=>n.preventDefault()})}function _a(o){return null}function xa(o){const e=o.selectProps.inputValue,t=o.data.label,s={...o,className:wt(o.className,"search-option")};return u.jsx(ee.Option,{...s,children:u.jsx(me.div,{className:"search-option-label",children:e.trim().length>0?ka(t,e):t})})}function ka(o,e){const t=o.toLowerCase().indexOf(e.toLowerCase());return t>=0?u.jsxs(u.Fragment,{children:[o.substring(0,t),u.jsx(me.span,{className:"search-highlighted-match",children:o.substring(t,t+e.length)},"highlighted"),o.substring(t+e.length)]}):o}const To=ve("search:SearchController"),Lo=200,Ro=5;var Ze,Le,Re,Ae,Y,vt,ks;class Ca{constructor(e,t){D(this,vt);D(this,Ze,void 0);D(this,Le,[]);D(this,Re,Ro);D(this,Ae,Lo);D(this,Y,void 0);O(this,Ze,e),O(this,Le,t)}destroy(){M(this,Y)?.abort(),O(this,Y,void 0)}async search(e){if(M(this,Y)?.abort(),O(this,Y,void 0),!e)return[];const t=O(this,Y,new AbortController);try{return await Ea(t.signal,M(this,Ae)),t.signal.aborted&&(To.debug(`search canceled with ${e}`),Fs()),(await Promise.all(M(this,Le).map(n=>z(this,vt,ks).call(this,n,e,t.signal)))).filter(n=>n!=null)}finally{M(this,Y)===t&&O(this,Y,void 0)}}get searchTypingDelay(){return M(this,Ae)}set searchTypingDelay(e){O(this,Ae,e??Lo)}get maxResultsPerSource(){return M(this,Re)}set maxResultsPerSource(e){O(this,Re,e??Ro)}get sources(){return M(this,Le)}}Ze=new WeakMap,Le=new WeakMap,Re=new WeakMap,Ae=new WeakMap,Y=new WeakMap,vt=new WeakSet,ks=async function(e,t,s){const n=e.label,i=M(this,Ze).olMap.getView().getProjection();try{const r=M(this,Re);let a=await e.search(t,{maxResults:r,signal:s,mapProjection:i});return a.length>r&&(a=a.slice(0,r)),{label:n,source:e,results:a}}catch(r){zo(r)||To.error(`search for source ${n} failed`,r);return}};async function Ea(o,e){o.aborted||await new Promise(t=>{const s=()=>{o.removeEventListener("abort",s),clearTimeout(n),t()};o.addEventListener("abort",s);const n=setTimeout(s,e)})}const ht=ve("search:Search"),Pa=o=>{const{mapId:e,sources:t,searchTypingDelay:s,maxResultsPerGroup:n,onSelect:i,onClear:r}=o,{containerProps:a}=Q("search",o),{map:c}=W(e),l=xt(),d=Ra(t,s,n,c),{input:h,search:m,selectedOption:b,onInputChanged:w,onResultConfirmed:_}=Aa(d),T=La(),C=Ma(l),R=Ta(),P=De((L,B)=>{B.action==="input-change"&&w(L)}),$=De((L,B)=>{switch(B.action){case"select-option":L&&(_(L),i?.({source:L.source,result:L.result}));break;case"clear":w(""),H.current?.blur(),H.current?.focus(),r?.();break;default:ht.debug(`Unhandled action type '${B.action}'.`);break}}),H=y.useRef(null);return u.jsx(V,{...a,children:u.jsx(Bt,{className:"search-component",classNamePrefix:"react-select",ref:H,inputValue:h,onInputChange:P,"aria-label":l.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:C,colorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:T,isClearable:!0,placeholder:l.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:m.kind==="loading",options:m.kind==="ready"?m.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:R,onChange:$,value:b,menuPosition:"fixed"})})};function Ma(o){return y.useMemo(()=>({onFocus:({focused:i})=>`${i.label} ${o.formatMessage({id:"ariaLabel.searchFocus"})}.`,onChange:({action:i,label:r})=>{let a="";switch(i){case"select-option":a=`${r} ${o.formatMessage({id:"ariaLabel.searchSelect"})}.`;break;case"clear":a=`${r} ${o.formatMessage({id:"ariaLabel.searchClear"})}.`;break}return a},guidance:()=>`${o.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[o])}function Ta(){return y.useMemo(()=>({Menu:pa,Input:ba,SingleValue:ya,Option:xa,NoOptionsMessage:ga,LoadingMessage:ma,ValueContainer:va,IndicatorsContainer:wa,ClearIndicator:_a}),[])}function La(){const[o,e]=Uo("colors",["trails.100","trails.50"],["#d5e5ec","#eaf2f5"]);return y.useMemo(()=>({groupHeading:s=>({...s,backgroundColor:o,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:s=>({...s,backgroundColor:"inherit",_focus:{backgroundColor:e}}),dropdownIndicator:s=>({...s,display:"none"})}),[o,e])}function Ra(o,e,t,s){const[n,i]=y.useState(void 0);return y.useEffect(()=>{if(!s)return;const r=new Ca(s,o);return i(r),()=>{r.destroy(),i(void 0)}},[s,o]),y.useEffect(()=>{n&&(n.searchTypingDelay=e)},[n,e]),y.useEffect(()=>{n&&(n.maxResultsPerSource=t)},[n,t]),n}function Aa(o){const[e,t]=y.useReducer((a,c)=>{switch(c.kind){case"input":return{...a,query:c.query,selectedOption:null};case"select-option":return{...a,selectedOption:c.option,query:c.option.label};case"load-results":return{...a,search:{kind:"loading"}};case"accept-results":return{...a,search:{kind:"ready",results:c.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),s=y.useRef(),n=De(a=>{if(!o){s.current=void 0,t({kind:"accept-results",results:[]});return}ht.isDebug()&&ht.debug(`Starting new search for query ${JSON.stringify(a)}.`),t({kind:"load-results"});const c=s.current=Ia(o,a).then(l=>{s.current===c&&t({kind:"accept-results",results:l})})}),i=y.useCallback(a=>{t({kind:"select-option",option:a})},[]),r=y.useCallback(a=>{t({kind:"input",query:a}),n(a)},[n]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:i,onInputChanged:r}}async function Ia(o,e){let t;try{t=await o.search(e)}catch(s){zo(s)||ht.error("Search failed",s),t=[]}return Da(t)}function Da(o){return o.map((t,s)=>({label:t.label,options:t.results.map(n=>({value:`${s}-${n.id}`,label:n.label,source:t.source,result:n}))}))}const Cs="@open-pioneer/selection",Oa=St.bind(void 0,Cs),to=le.bind(void 0,Cs),ze="selection-active",lt="selection-inactive";class ja{tooltip;interactionResources=[];olMap;isActive=!0;tooltipMessage;tooltipDisabledMessage;constructor(e,t,s,n,i){let r;switch(t){case oo.extent:default:r=this.initViewport(e),this.interactionResources.push(this.createDragBox(e,i,r,this.interactionResources)),this.interactionResources.push(this.createDrag(e,r,this.interactionResources));break}this.tooltip=this.createHelpTooltip(e,s),this.olMap=e,this.tooltipMessage=s,this.tooltipDisabledMessage=n}initViewport(e){const t=e.getViewport();return t.classList.add(ze),t.oncontextmenu=s=>(s.preventDefault(),!1),t}destroy(){this.tooltip.destroy(),this.interactionResources.forEach(e=>{e.destroy()})}setActive(e){if(this.isActive===e)return;const t=this.olMap.getViewport();e?(this.interactionResources.forEach(s=>this.olMap.addInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipMessage,t.classList.remove(lt),t.classList.add(ze),this.isActive=!0):(this.interactionResources.forEach(s=>this.olMap.removeInteraction(s.interaction)),this.tooltip.element.textContent=this.tooltipDisabledMessage,t.classList.remove(ze),t.classList.add(lt),this.isActive=!1)}createDragBox(e,t,s,n){const i=new mo({className:"selection-drag-box",condition:On});return e.addInteraction(i),i.on("boxend",function(){t(i.getGeometry())}),{interaction:i,destroy(){e.removeInteraction(i),n.splice(n.indexOf(this)),i.dispose(),s.classList.remove(ze),s.classList.remove(lt),s.oncontextmenu=null}}}createDrag(e,t,s){const n=function(a){return a.originalEvent.button==2},i=new vo({condition:n});return e.addInteraction(i),{interaction:i,destroy(){e.removeInteraction(i),s.splice(s.indexOf(this)),i.dispose(),t.classList.remove(ze),t.classList.remove(lt),t.oncontextmenu=null}}}createHelpTooltip(e,t){const s=document.createElement("div");s.className="selection-tooltip",s.textContent=t;const n=new dt({element:s,offset:[15,0],positioning:"center-left"}),i=e.on("pointermove",r=>{n.setPosition(r.coordinate)});return e.addOverlay(n),{overlay:n,element:s,destroy(){e.removeOverlay(n),n.dispose(),ae(i)}}}getDragboxInteraction(){return this.interactionResources.find(e=>e.interaction instanceof mo)}getDragPanInteraction(){return this.interactionResources.find(e=>e.interaction instanceof vo)}}const Ot=ve("selection:SelectionController"),Na=1e4;var Xe,Je,Qe,bt,Es;class Fa{constructor(e){D(this,bt);D(this,Xe,void 0);D(this,Je,void 0);D(this,Qe,void 0);const{mapModel:t,onError:s,maxResults:n=Na}=e;O(this,Xe,t),O(this,Je,n),O(this,Qe,s)}destroy(){}async select(e,t){if(t)return await z(this,bt,Es).call(this,e,t)}}Xe=new WeakMap,Je=new WeakMap,Qe=new WeakMap,bt=new WeakSet,Es=async function(e,t){const s=M(this,Xe).olMap.getView().getProjection();try{Ot.debug(`Starting selection on source '${e.label}'`);const n=M(this,Je);let i=await e.select({type:"extent",extent:t},{maxResults:n,mapProjection:s,signal:new AbortController().signal});return i.length>n&&(i=i.slice(0,n)),Ot.debug(`Found ${i.length} results on source '${e.label}'`),{source:e,results:i}}catch(n){Ot.error(`selection from source ${e.label} failed`,n),M(this,Qe).call(this);return}};var oo=(o=>(o.extent="EXTENT",o.polygon="POLYGON",o.free="FREEPOLYGON",o.circle="CIRCLE",o))(oo||{});const Ao={classNamePrefix:"react-select",menuPosition:"fixed",isSearchable:!1,isClearable:!1},Va=o=>{const e=to(),{mapId:t,sources:s,onSelectionComplete:n,onSelectionSourceChanged:i}=o,{containerProps:r}=Q("selection",o),[a,c]=y.useState(()=>s.find(L=>(L.status??"available")==="available")),l=W(t),{onExtentSelected:d}=za(l.map,s,a,n),h=Ha(),b=y.useCallback(L=>{const B=[];if(L||(L=["EXTENT"]),L.forEach(p=>{Object.values(oo).includes(p)&&B.push({label:e.formatMessage({id:p}),value:p})}),B.length===0)throw new Error("methods does not contain valid values");return B},[e])(void 0),[w,_]=y.useState(b[0]),T=De(L=>{_(L)}),[C,R]=y.useState(!0);$a(l.map,w,e,d,C);const P=y.useMemo(()=>s.map(L=>({label:L.label,value:L})),[s]),$=y.useMemo(()=>P.find(L=>L.value===a),[P,a]),H=De(L=>{c(L?.value),i&&i({source:L?.value})});return y.useEffect(()=>{if(!a){R(!1);return}const L=e.formatMessage({id:"sourceNotAvailable"}),B=()=>a&&Ht(a,L).kind==="available";R(B());const p=a.on("changed:status",()=>{R(B())});return()=>p.destroy()},[a,R,e]),u.jsxs(Gt,{...r,spacing:2,children:[b.length>1&&u.jsxs(Ft,{children:[u.jsx(Vt,{children:e.formatMessage({id:"selectMethod"})}),u.jsx(Bt,{className:"selection-method react-select",...Ao,options:b,onChange:T,value:w,chakraStyles:h})]}),u.jsxs(Ft,{children:[u.jsx(Vt,{children:e.formatMessage({id:"selectSource"})}),u.jsx(Bt,{className:"selection-source react-select",...Ao,options:P,placeholder:e.formatMessage({id:"selectionPlaceholder"}),value:$,onChange:H,components:{Option:Ba,SingleValue:Ga},isOptionDisabled:L=>L.value===void 0||L.value.status==="unavailable",getOptionLabel:L=>L.label+(L.value===void 0||L.value.status==="unavailable"?" "+e.formatMessage({id:"sourceNotAvailable"}):""),chakraStyles:h})]})]})};function Ba(o){const{value:e}=o.data,{isAvailable:t,content:s}=Ps(e,!1);return u.jsx(ee.Option,{...o,isDisabled:!t,className:"selection-source-option",children:s})}function Ga(o){const{value:e}=o.data,{isAvailable:t,content:s}=Ps(e,!0),n=t?"selection-source-value":"selection-source-value selection-source-value--disabled";return u.jsx(ee.SingleValue,{...o,isDisabled:!t,className:n,children:s})}function Ps(o,e){const t=o?.label,s=Ua(o);return{isAvailable:s.kind==="available",content:u.jsxs(J,{direction:"row",alignItems:"center",grow:1,children:[!e&&u.jsx(J,{grow:1,children:t}),s.kind==="unavailable"&&u.jsx(V,{ml:2,children:u.jsx($o,{label:s.reason,placement:"right",openDelay:500,children:u.jsx(me.span,{children:u.jsx(Vs,{as:si,color:"red",className:"warning-icon","aria-label":s.reason})})})}),e&&t]})}}function za(o,e,t,s){const n=Oa("notifier.NotificationService"),i=to(),[r,a]=y.useState(void 0);y.useEffect(()=>{if(!o)return;const l=new Fa({mapModel:o,onError(){n.notify({level:"error",message:i.formatMessage({id:"selectionFailed"})})}});return a(l),()=>{l.destroy()}},[o,n,e,i]);const c=De(async l=>{if(!r||!t)return;const d=await r.select(t,l.getExtent());d&&s?.(d)});return{controller:r,onExtentSelected:c}}function Ht(o,e){const t=o.status??"available",s=typeof t=="string"?{kind:t}:t;return s.kind==="available"?s:{kind:"unavailable",reason:s.reason??e}}function Ua(o){const e=to(),[t,s]=y.useState(()=>({kind:"available"}));return y.useEffect(()=>{if(!o){s({kind:"available"});return}const n=e.formatMessage({id:"sourceNotAvailable"});s(Ht(o,n));const i=o.on?.("changed:status",()=>{s(Ht(o,n))});return()=>i?.destroy()},[o,e]),t}function $a(o,e,t,s,n){y.useEffect(()=>{if(!o)return;const i=new ja(o.olMap,e.value,t.formatMessage({id:"tooltip"}),t.formatMessage({id:"disabledTooltip"}),s);return i.setActive(n),()=>{i?.destroy()}},[o,e,t,s,n])}function Ha(){const[o,e]=Uo("colors",["background_body","border"],["#ffffff","#ffffff"]);return y.useMemo(()=>({control:s=>({...s,cursor:"pointer"}),indicatorSeparator:s=>({...s,borderColor:e}),dropdownIndicator:s=>({...s,backgroundColor:o})}),[o,e])}let Wa=0;function qa(o,e){const t=`atom${++Wa}`,s={toString:()=>t};return typeof o=="function"?s.read=o:(s.init=o,s.read=function(n){return n(this)},s.write=function(n,i,r){return i(this,typeof r=="function"?r(n(this)):r)}),e&&(s.write=e),s}const Io=o=>"init"in o,Do=o=>!!o.write,ft=new WeakMap,Ka=(o,e)=>{ft.set(o,e),o.catch(()=>{}).finally(()=>ft.delete(o))},Oo=(o,e)=>{const t=ft.get(o);t&&(ft.delete(o),t(e))},jo=(o,e)=>{o.status="fulfilled",o.value=e},No=(o,e)=>{o.status="rejected",o.reason=e},Ya=o=>typeof o?.then=="function",Ue=(o,e)=>!!o&&"v"in o&&"v"in e&&Object.is(o.v,e.v),Fo=(o,e)=>!!o&&"e"in o&&"e"in e&&Object.is(o.e,e.e),ye=o=>!!o&&"v"in o&&o.v instanceof Promise,Za=(o,e)=>"v"in o&&"v"in e&&o.v.orig&&o.v.orig===e.v.orig,ct=o=>{if("e"in o)throw o.e;return o.v},so=()=>{const o=new WeakMap,e=new WeakMap,t=new Map;let s,n;const i=p=>o.get(p),r=(p,g)=>{const v=o.get(p);if(o.set(p,g),t.has(p)||t.set(p,v),ye(v)){const f="v"in g?g.v instanceof Promise?g.v:Promise.resolve(g.v):Promise.reject(g.e);v.v!==f&&Oo(v.v,f)}},a=(p,g,v)=>{const f=new Map;let S=!1;v.forEach((E,x)=>{!E&&x===p&&(E=g),E&&(f.set(x,E),g.d.get(x)!==E&&(S=!0))}),(S||g.d.size!==f.size)&&(g.d=f)},c=(p,g,v)=>{const f=i(p),S={d:f?.d||new Map,v:g};if(v&&a(p,S,v),Ue(f,S)&&f.d===S.d)return f;if(ye(f)&&ye(S)&&Za(f,S)){if(f.d===S.d)return f;S.v=f.v}return r(p,S),S},l=(p,g,v,f)=>{if(Ya(g)){let S;const E=()=>{const k=i(p);if(!ye(k)||k.v!==x)return;const I=c(p,x,v);e.has(p)&&k.d!==I.d&&H(p,I,k.d)},x=new Promise((k,I)=>{let A=!1;g.then(j=>{A||(A=!0,jo(x,j),k(j),E())},j=>{A||(A=!0,No(x,j),I(j),E())}),S=j=>{A||(A=!0,j.then(G=>jo(x,G),G=>No(x,G)),k(j))}});return x.orig=g,x.status="pending",Ka(x,k=>{k&&S(k),f?.()}),c(p,x,v)}return c(p,g,v)},d=(p,g,v)=>{const f=i(p),S={d:f?.d||new Map,e:g};return v&&a(p,S,v),Fo(f,S)&&f.d===S.d?f:(r(p,S),S)},h=(p,g)=>{const v=i(p);if(!g&&v&&(e.has(p)||Array.from(v.d).every(([A,j])=>{if(A===p)return!0;const G=h(A);return G===j||Ue(G,j)})))return v;const f=new Map;let S=!0;const E=A=>{if(A===p){const G=i(A);if(G)return f.set(A,G),ct(G);if(Io(A))return f.set(A,void 0),A.init;throw new Error("no atom init")}const j=h(A);return f.set(A,j),ct(j)};let x,k;const I={get signal(){return x||(x=new AbortController),x.signal},get setSelf(){return!k&&Do(p)&&(k=(...A)=>{if(!S)return R(p,...A)}),k}};try{const A=p.read(E,I);return l(p,A,f,()=>x?.abort())}catch(A){return d(p,A,f)}finally{S=!1}},m=p=>ct(h(p)),b=p=>{let g=e.get(p);return g||(g=P(p)),g},w=(p,g)=>!g.l.size&&(!g.t.size||g.t.size===1&&g.t.has(p)),_=p=>{const g=e.get(p);g&&w(p,g)&&$(p)},T=p=>{const g=new Map,v=new WeakMap,f=x=>{var k;const I=new Set((k=e.get(x))==null?void 0:k.t);return t.forEach((A,j)=>{var G;(G=i(j))!=null&&G.d.has(x)&&I.add(j)}),I},S=x=>{f(x).forEach(k=>{k!==x&&(g.set(k,(g.get(k)||new Set).add(x)),v.set(k,(v.get(k)||0)+1),S(k))})};S(p);const E=x=>{f(x).forEach(k=>{var I;if(k!==x){let A=v.get(k);if(A&&v.set(k,--A),!A){let j=!!((I=g.get(k))!=null&&I.size);if(j){const G=i(k),Rs=h(k,!0);j=!Ue(G,Rs)}j||g.forEach(G=>G.delete(k))}E(k)}})};E(p)},C=(p,...g)=>{let v=!0;const f=x=>ct(h(x)),S=(x,...k)=>{let I;if(x===p){if(!Io(x))throw new Error("atom not writable");const A=i(x),j=l(x,k[0]);Ue(A,j)||T(x)}else I=C(x,...k);if(!v){const A=L()}return I},E=p.write(f,S,...g);return v=!1,E},R=(p,...g)=>{const v=C(p,...g),f=L();return v},P=(p,g,v)=>{var f;const S=v||[];(f=i(p))==null||f.d.forEach((x,k)=>{const I=e.get(k);I?I.t.add(p):k!==p&&P(k,p,S)}),h(p);const E={t:new Set(g&&[g]),l:new Set};if(e.set(p,E),Do(p)&&p.onMount){const{onMount:x}=p;S.push(()=>{const k=x((...I)=>R(p,...I));k&&(E.u=k)})}return v||S.forEach(x=>x()),E},$=p=>{var g;const v=(g=e.get(p))==null?void 0:g.u;v&&v(),e.delete(p);const f=i(p);f&&(ye(f)&&Oo(f.v),f.d.forEach((S,E)=>{if(E!==p){const x=e.get(E);x&&(x.t.delete(p),w(E,x)&&$(E))}}))},H=(p,g,v)=>{const f=new Set(g.d.keys());v?.forEach((S,E)=>{if(f.has(E)){f.delete(E);return}const x=e.get(E);x&&(x.t.delete(p),w(E,x)&&$(E))}),f.forEach(S=>{const E=e.get(S);E?E.t.add(p):e.has(p)&&P(S,p)})},L=()=>{let p;for(;t.size;){const g=Array.from(t);t.clear(),g.forEach(([v,f])=>{const S=i(v);if(S){const E=e.get(v);E&&S.d!==f?.d&&H(v,S,f?.d),E&&!(!ye(f)&&(Ue(f,S)||Fo(f,S)))&&E.l.forEach(x=>x())}})}};return{get:m,set:R,sub:(p,g)=>{const v=b(p),f=L(),S=v.l;return S.add(g),()=>{S.delete(g),_(p)}}}};let jt;const Xa=()=>(jt||(jt=so()),jt),Ms=y.createContext(void 0),Ja=o=>{const e=y.useContext(Ms);return o?.store||e||Xa()},Qa=({children:o,store:e})=>{const t=y.useRef();return!e&&!t.current&&(t.current=so()),y.createElement(Ms.Provider,{value:e||t.current},o)},el=o=>typeof o?.then=="function",tl=Go.use||(o=>{if(o.status==="pending")throw o;if(o.status==="fulfilled")return o.value;throw o.status==="rejected"?o.reason:(o.status="pending",o.then(e=>{o.status="fulfilled",o.value=e},e=>{o.status="rejected",o.reason=e}),o)});function ol(o,e){const t=Ja(e),[[s,n,i],r]=y.useReducer(l=>{const d=t.get(o);return Object.is(l[0],d)&&l[1]===t&&l[2]===o?l:[d,t,o]},void 0,()=>[t.get(o),t,o]);let a=s;(n!==t||i!==o)&&(r(),a=t.get(o));const c=e?.delay;return y.useEffect(()=>{const l=t.sub(o,()=>{if(typeof c=="number"){setTimeout(r,c);return}r()});return r(),l},[t,o,c]),y.useDebugValue(a),el(a)?tl(a):a}const Ts="@open-pioneer/spatial-bookmarks",sl=St.bind(void 0,Ts),nl=le.bind(void 0,Ts),oe=ve("spatial-bookmark:SpatialBookmarkViewModel");class il{map;packageNamespace;writableBookmarks=qa([]);stopBookmarksListener;store;get bookmarks(){return this.writableBookmarks}constructor(e,t){this.map=e,this.packageNamespace=t.getNamespace("spatial-bookmarks"),this.store=so(),this.loadState(),this.stopBookmarksListener=this.store.sub(this.bookmarks,()=>{this.saveState()})}destroy(){this.stopBookmarksListener()}createBookmark(e){const t=this.map.olMap,s=t.getView().calculateExtent(),n=t.getView().getProjection().getCode(),i={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3]},r={id:jn(),title:e,extent:i,projection:n};oe.debug("Created a new bookmark",r);const a=this.writableBookmarks;this.store.set(a,[...this.store.get(a),r])}activateBookmark(e){oe.debug("Activating bookmark",e);const t=this.getBookmarkExtent(e);oe.debug("Attempting to apply extent",t),this.applyExtent(t)}deleteBookmark(e){oe.debug("Deleting bookmark",e);const t=this.writableBookmarks;this.store.set(t,[...this.store.get(t).filter(s=>s.id!==e)])}deleteAllBookmarks(){oe.debug("Deleting all bookmarks"),this.store.set(this.writableBookmarks,[])}loadState(){oe.debug("Restoring bookmarks from local storage");const e=this.packageNamespace.get("bookmarks")??[];try{rl(e),this.store.set(this.writableBookmarks,e)}catch(t){oe.error("Bookmarks data in local storage is invalid, resetting to default value.",t),this.store.set(this.writableBookmarks,[]),this.saveState()}}saveState(){oe.debug("Saving bookmarks to local storage"),this.packageNamespace.set("bookmarks",this.store.get(this.bookmarks))}getBookmarkExtent(e){const s=this.map.olMap.getView(),n=e.extent,i=[n.minX,n.minY,n.maxX,n.maxY],r=s.getProjection(),a=e.projection;return Nn(i,a,r)}applyExtent(e){const s=this.map.olMap.getView(),n=Fn(e),i=s.getResolutionForExtent(e);s.setCenter(n),s.setResolution(i)}}function rl(o){if(!Array.isArray(o))throw new Error("Expected bookmarks from local storage to be an array.");for(const e of o)al(e)}function al(o){if(!o||typeof o!="object")throw new Error("Expected bookmark from local storage to be an object.");const e=o;if(typeof e.id!="string")throw new Error("Bookmark does not have a valid id.");if(typeof e.title!="string")throw new Error("Bookmark does not have a valid title.");if(ll(e.extent),typeof e.projection!="string")throw new Error("Bookmark does not have a valid projection value.")}function ll(o){if(!o||typeof o!="object")throw new Error("Expected bookmark extent from local storage to be an object.");const e=o;if(typeof e.minX!="number"||typeof e.minY!="number"||typeof e.maxX!="number"||typeof e.maxY!="number")throw new Error("Expected bookmark extent from local storage to have valid coordinates.")}const Vo=o=>{const{map:e}=W(o.mapId),t=sl("local-storage.LocalStorageService"),s=gl(e,t);return s&&u.jsx(Qa,{store:s.store,children:u.jsx(cl,{...o,viewModel:s})})};function cl(o){const{viewModel:e}=o,t=nl(),s=y.useRef([]),[n,i]=y.useState(!1),r=ol(e.bookmarks),[a,c]=y.useState(""),l=a.trim().length>0,{containerProps:d}=Q("spatial-bookmarks",o),[h,m]=y.useState("list"),b=()=>{e.deleteAllBookmarks(),m("list")},w=()=>{l&&(e.createBookmark(a),m("list"),c(""),i(!0))};y.useEffect(()=>{if(n){const P=s.current;P&&P[r.length-1]?.scrollIntoView?.(),i(!1)}},[r,n]);const _=()=>u.jsxs(Gt,{children:[u.jsxs(Ct,{rounded:"md",status:"warning",children:[u.jsx(Et,{}),t.formatMessage({id:"bookmark.alert.delete"})]}),u.jsx(fl,{intl:t,onClear:b,onCancel:()=>m("list")})]}),T=()=>u.jsxs(Gt,{children:[u.jsxs(Ct,{rounded:"md",status:"info",children:[u.jsx(Et,{}),t.formatMessage({id:"bookmark.alert.create"})]}),u.jsx(ai,{"aria-label":t.formatMessage({id:"bookmark.input.label"}),placeholder:t.formatMessage({id:"bookmark.input.placeholder"}),value:a,onChange:P=>{c(P.target.value)},onKeyDown:P=>{P.key==="Enter"&&w()},isRequired:!0,isInvalid:!l,autoFocus:!0}),u.jsx(pl,{intl:t,isInvalid:!l,onCancel:()=>{c(""),m("list")},onSave:w})]}),C=()=>u.jsxs(u.Fragment,{children:[r.length?ul(r,e,t,s):u.jsxs(Ct,{rounded:"md",status:"info",children:[u.jsx(Et,{}),t.formatMessage({id:"bookmark.alert.noSaved"})]}),u.jsx(hl,{intl:t,bookmarks:r,showCreate:()=>m("create"),showDelete:()=>m("delete")})]}),R=u.jsxs(u.Fragment,{children:[h==="list"&&C(),h==="create"&&T(),h==="delete"&&_()]});return u.jsx(J,{flexDirection:"column",...d,children:R})}function ul(o,e,t,s){const n=t.formatMessage({id:"bookmark.button.deleteOne"}),i=o.map((r,a)=>u.jsx(dl,{index:a,listItemNodes:s,bookmark:r,onActivate:()=>e.activateBookmark(r),onDelete:()=>e.deleteBookmark(r.id),deleteBtnLabel:n},r.id));return u.jsx(li,{as:"ul",className:"spatial-bookmark-list",role:"listbox","aria-label":t.formatMessage({id:"bookmark.list.label"}),flexShrink:1,flexGrow:1,p:1,spacing:1,overflowY:"auto",listStyleType:"none",children:i})}const Bo={ArrowDown:1,ArrowUp:-1};function dl(o){const{index:e,listItemNodes:t,bookmark:s,onDelete:n,onActivate:i,deleteBtnLabel:r}=o,a=s.title,c=l=>{const d=l.key;if(d==="Enter"){l.target===l.currentTarget&&i();return}if(Bo[d]!=null){const h=t.current?.length;if(!h)return;let m=(e+Bo[d])%h;m<0&&(m=h-1),t.current[m]?.focus()}};return u.jsx(V,{as:"li",p:1,ref:l=>{if(!l){t.current.splice(e,1);return}t.current[e]=l},className:wt("spatial-bookmarks-item"),tabIndex:0,rounded:"md",role:"option",cursor:"pointer",outline:0,_hover:{background:"trails.50"},_focusVisible:{boxShadow:"outline"},onKeyDown:c,onClick:i,children:u.jsxs(J,{width:"100%",flexDirection:"row",align:"center",gap:1,children:[u.jsx(cs,{children:u.jsx(ns,{})}),u.jsx(et,{ps:2,noOfLines:1,children:a}),u.jsx(ci,{}),u.jsx($o,{hasArrow:!0,label:r,placement:"right",children:u.jsx(qt,{className:"spatial-bookmarks-item-delete","aria-label":r,borderRadius:"full",iconSpacing:0,padding:0,colorScheme:"red",variant:"ghost",leftIcon:u.jsx(is,{}),onClick:l=>{n(),l.stopPropagation()}})},e)]})})}function hl(o){const{intl:e,bookmarks:t,showCreate:s,showDelete:n}=o;return u.jsxs(no,{children:[u.jsx(Ne,{isDisabled:t.length===0,colorScheme:"red",width:void 0,iconSpacing:0,leftIcon:u.jsx(is,{}),onClick:n,"aria-label":e.formatMessage({id:"bookmark.button.deleteAll"}),variant:"outline"}),u.jsx(Ne,{onClick:s,width:"100%",children:e.formatMessage({id:"bookmark.button.create"})})]})}function fl(o){const{intl:e,onCancel:t,onClear:s}=o;return u.jsxs(no,{children:[u.jsx(Ne,{variant:"outline",onClick:t,children:e.formatMessage({id:"bookmark.button.cancelDelete"})}),u.jsx(Ne,{onClick:s,children:e.formatMessage({id:"bookmark.button.confirmDelete"})})]})}function pl(o){const{intl:e,onCancel:t,onSave:s,isInvalid:n}=o;return u.jsxs(no,{children:[u.jsx(Ne,{variant:"outline",onClick:()=>t(),children:e.formatMessage({id:"bookmark.button.cancel"})}),u.jsx(Ne,{isDisabled:n,onClick:()=>s(),children:e.formatMessage({id:"bookmark.button.save"})})]})}function no(o){return u.jsx(J,{width:"100%",flexDirection:"row",mt:2,gap:1,flexGrow:0,flexShrink:0,children:o.children})}function Ne(o){return u.jsx(qt,{width:"100%",...o})}function gl(o,e){const[t,s]=y.useState();return y.useEffect(()=>{let n;return o?n=new il(o,e):n=void 0,s(n),()=>n?.destroy()},[o,e]),t}const Ls="ol-map",Wt=St.bind(void 0,Ls),io=le.bind(void 0,Ls);function ml(){const o=io(),e=y.useId(),t=y.useId(),{map:s}=W(F),[n,i]=y.useState(!0),[r,a]=y.useState(!1);function c(){a(!r)}const[l,d]=y.useState(!0),[h,m]=y.useState();function b(P){m(P===h?void 0:P),s?.removeHighlight()}function w(){b("measurement")}function _(){b("selection")}function T(){i(!n)}function C(){d(!l)}let R=null;switch(h){case"selection":R=u.jsx(bl,{});break;case"measurement":R=u.jsx(yl,{});break}return u.jsxs(J,{height:"100%",direction:"column",overflow:"hidden",children:[u.jsx(Zn,{position:"top-right"}),u.jsxs(_e,{title:u.jsx(V,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:u.jsx(xe,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[u.jsx(J,{flex:"1",direction:"column",position:"relative",children:u.jsxs(Vn,{mapId:F,role:"main","aria-label":o.formatMessage({id:"ariaLabel.map"}),children:[u.jsx(ui,{centerContent:!0,children:u.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-box",children:u.jsx(vl,{})})}),u.jsx(Ve,{position:"top-left",horizontalGap:20,verticalGap:20,children:(l||h)&&u.jsxs(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:[l&&u.jsx(V,{role:"dialog","aria-labelledby":e,children:u.jsx(_e,{title:u.jsx(xe,{id:e,size:"md",mb:2,children:u.jsx(et,{children:o.formatMessage({id:"tocTitle"})})}),children:u.jsx(Kn,{mapId:F,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})}),l&&h&&u.jsx(di,{mt:4,mb:4}),R]})}),u.jsx(Ve,{position:"top-right",horizontalGap:20,verticalGap:20,children:n&&u.jsx(wl,{})}),u.jsx(Ve,{horizontalGap:20,position:"bottom-left",children:r&&u.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(V,{role:"dialog","aria-labelledby":t,children:u.jsx(_e,{title:u.jsx(xe,{id:t,size:"md",mb:2,children:o.formatMessage({id:"spatialBookmarkTitle"})}),children:u.jsx(Vo,{mapId:F})})})})}),u.jsx(Ve,{horizontalGap:20,position:"bottom-left",children:r&&u.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(V,{role:"dialog","aria-labelledby":t,children:u.jsx(_e,{title:u.jsx(xe,{id:t,size:"md",mb:2,children:o.formatMessage({id:"spatialBookmarkTitle"})}),children:u.jsx(Vo,{mapId:F})})})})}),u.jsx(Ve,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:u.jsxs(J,{role:"toolbar","aria-label":o.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[u.jsx(we,{label:o.formatMessage({id:"spatialBookmarkTitle"}),icon:u.jsx(Bn,{}),isActive:r,onClick:c}),u.jsx(zr,{mapId:F}),u.jsx(we,{label:o.formatMessage({id:"tocTitle"}),icon:u.jsx(Gn,{}),isActive:l,onClick:C}),u.jsx(we,{label:o.formatMessage({id:"measurementTitle"}),icon:u.jsx(zn,{}),isActive:h==="measurement",onClick:w}),u.jsx(we,{label:o.formatMessage({id:"selectionTitle"}),icon:u.jsx(Un,{}),isActive:h==="selection",onClick:_}),u.jsx(we,{label:o.formatMessage({id:"overviewMapTitle"}),icon:u.jsx(ns,{}),isActive:n,onClick:T}),u.jsx(Qn,{mapId:F}),u.jsx(ei,{mapId:F}),u.jsx(ti,{mapId:F})]})})]})}),u.jsxs(J,{role:"region","aria-label":o.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[u.jsx(Ir,{mapId:F,precision:2}),u.jsx(ca,{mapId:F}),u.jsx(ha,{mapId:F})]})]})]})}function vl(){const{map:o}=W(F),e=Wt("ol-app.AppConfig"),t=vs(e.state).searchSources;function s(i){if(console.debug("The user selected the following item: ",i.result),!o)return;const r=i.result.geometry;r&&o.highlightAndZoom([r])}function n(){console.debug("The user cleared the search"),o?.removeHighlight()}return u.jsx(Pa,{mapId:F,sources:t,maxResultsPerGroup:10,onSelect:s,onClear:n})}function bl(){const o=io(),e=Wt("notifier.NotificationService"),t=y.useId(),{map:s}=W(F),n=Wt("ol-app.AppConfig"),i=vs(n.state).selectionSources;function r(c){const l=c.results;if(!s){console.debug("Map not ready");return}s?.removeHighlight();const d=l.map(h=>h.geometry);d.length>0&&s.highlightAndZoom(d),e.notify({level:"info",message:o.formatMessage({id:"foundResults"},{resultsCount:l.length}),displayDuration:4e3})}function a(c){s?.removeHighlight()}return u.jsx(V,{role:"dialog","aria-labelledby":t,children:u.jsx(_e,{title:u.jsx(xe,{id:t,size:"md",mb:2,children:o.formatMessage({id:"selectionTitle"})}),children:u.jsx(Va,{mapId:F,sources:i,onSelectionComplete:r,onSelectionSourceChanged:a})})})}function yl(){const o=y.useId(),e=io();return u.jsx(V,{role:"dialog","aria-labelledby":o,children:u.jsx(_e,{title:u.jsx(xe,{id:o,size:"md",mb:2,children:e.formatMessage({id:"measurementTitle"})}),children:u.jsx(Zr,{mapId:F})})})}function wl(){const o=y.useMemo(()=>new Kt({source:new Ho}),[]);return u.jsx(V,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:325,children:u.jsx(V,{role:"dialog",children:u.jsx(la,{mapId:F,olLayer:o})})})}const Sl=Bs({component:ml,theme:Gs,appMetadata:Tr,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(o){const e=o.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",Sl);const _l=document.getElementsByTagName("body")[0];xl();function xl(){const o=window.location.search,t=new URLSearchParams(o).get("lang"),s=document.createElement("ol-map-app");s.classList.add("full-height"),s.classList.add("app"),s.setAttribute("id","test"),t&&s.setAttribute("forced-locale",t),_l.appendChild(s)}
