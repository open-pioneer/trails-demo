var Et=Object.defineProperty;var Mt=(o,e,t)=>e in o?Et(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var v=(o,e,t)=>(Mt(o,typeof e!="symbol"?e+"":e,t),t),Ge=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var L=(o,e,t)=>(Ge(o,e,"read from private field"),t?t.call(o):e.get(o)),ke=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},Ee=(o,e,t,r)=>(Ge(o,e,"write to private field"),r?r.call(o,t):e.set(o,t),t);import{r as k,g as Lt,R as Ct,c as ot,a as nt,b as Pt,j as u,d as It}from"./DTCJ8zUXYCFK.js";import{t as Ft}from"./pKw9by_EWWaf.js";import{V as At,S as ie,T as st,O as at,a as Q,b as A,c as jt,C as Tt,F as Dt,P as Rt,p as zt,d as Ot,s as lt,e as Gt,R as Vt,f as _e,g as Ve,h as $,E as Ne,i as D,j as Me,k as ce,l as qe,M as fe,m as Ue,n as F,o as C,q,t as Fe,r as Nt,u as qt,v as Ut,w as Ae,x as Wt,y as Ht,z as ct,B as dt,A as Bt,I as Kt,D as We,G as $t,H as He,J as Yt,K as Be,L as de,N as ut,Q as ht,U as Jt,W as Zt,X as Xt,Y as Qt,Z as E,_ as U,$ as W,a0 as ve,a1 as P,a2 as De,a3 as er,a4 as te}from"./1mybnJ7phGO6.js";import{W as ue,P as tr,a as rr,b as ir,c as or,d as nr,e as sr,f as ar,g as lr,h as cr,i as dr,j as ur}from"./BL3K0z8HbpPZ.js";import{W as Ke,C as hr,O as pt,V as pr,L as gr,S as fr,P as mr,a as vr,G as yr,M as _r,b as br,c as wr,d as Sr,N as xr,e as kr,f as Er,g as Mr}from"./Cnfs-VcNJTAQ.js";import{G as he,T as Lr}from"./D1mF74hSAK0L.js";import{D as Cr,N as Pr,P as Ir}from"./72sd1G7cu3s8.js";import{V as Fr,S as Ar,I as jr,Z as Tr,a as Dr}from"./C1m0MlEFBl_w.js";import{M as Rr}from"./DcTeDxMslkAD.js";import{_ as $e}from"./Dch09mLNbtBx.js";import{u as zr,R as Or}from"./BMCyePFs3u3x.js";import{G as gt}from"./CV2vCj2hnT-X.js";import{T as Gr}from"./BIA8ntS0DxTH.js";import{C as Vr}from"./CoEIwXwvlJ6k.js";import{D as Nr}from"./B5-Mc2PbXXMs.js";import"./CKUc2QYdJAHT.js";import"./DqjceUz0qOuV.js";import"./vPrb6pfZCATP.js";import"./CCVYFdIzwr5R.js";import"./CAA67vYgO4r4.js";import"./Bc1T6cboqrZG.js";import"./DNr9U4lV2nYc.js";import"./ClGI28DzgriQ.js";import"./DG5Zl0oXWggS.js";const S="main";class qr{mapId=S;vectorSourceFactory;constructor(e){this.vectorSourceFactory=e.references.vectorSourceFactory}async getMapConfig(){const e={Component:hr};return{advanced:{view:new At({center:[404747,5757920],zoom:13,constrainResolution:!0,projection:"EPSG:25832"})},layers:[new ue({title:"Linfos",visible:!0,url:"https://www.wms.nrw.de/umwelt/linfos",sublayers:[{name:"SonstigeSchutzgebiete",title:"SonstigeSchutzgebiete"},{name:"SCH_GSG",title:"SCH_GSG"}]}),new Ke({isBaseLayer:!0,title:"Topplus grau",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_grau",matrixSet:"EPSG_25832_14",visible:!1,sourceOptions:{attributions:`Kartendarstellung und Präsentationsgraphiken: &copy; Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a title="Datenquellen öffnen" aria-label="Datenquellen öffnen" href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html " target="_blank">Datenquellen</a>`}}),new Ke({isBaseLayer:!0,title:"Topplus farbig",url:"https://www.wmts.nrw.de/topplus_open/1.0.0/WMTSCapabilities.xml",name:"topplus_col",matrixSet:"EPSG_25832_14",visible:!0,sourceOptions:{attributions:`Kartendarstellung und Präsentationsgraphiken: &copy; Bundesamt für Kartographie und Geodäsie ${new Date().getFullYear()}, <a title="Datenquellen öffnen" aria-label="Datenquellen öffnen" href="https://sg.geodatenzentrum.de/web_public/gdz/datenquellen/Datenquellen_TopPlusOpen.html " target="_blank">Datenquellen</a>`}}),new ie({title:"OSM",visible:!1,isBaseLayer:!0,olLayer:new st({source:new at})}),new ie({title:"Haltestellen Stadt Rostock",visible:!0,description:"Haltestellen des öffentlichen Personenverkehrs in der Hanse- und Universitätsstadt Rostock.",olLayer:Ur(),attributes:{legend:e}}),new ie({id:"ogc_kitas",title:"Kindertagesstätten",visible:!0,olLayer:Wr(),attributes:{legend:e,resultListMetadata:[{id:"id",displayName:"ID",width:100,getPropertyValue(t){return t.id}},{propertyName:"pointOfContact.address.postCode",displayName:"PLZ",width:120},{propertyName:"name",displayName:"Name"},{propertyName:"inspireId",displayName:"inspireID"},{displayName:"Gefördert",width:160,getPropertyValue(t){switch(t.properties?.gefoerdert){case"ja":return!0;case"nein":return!1;default:return t.properties?.gefoerdert}}}]}}),new ie({id:"ogc_kataster",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:Hr(this.vectorSourceFactory),attributes:{resultListMetadata:[{propertyName:"id",displayName:"ID",width:600,getPropertyValue(t){return t.id}},{displayName:"Aktualit",width:600,getPropertyValue(t){const r=t.properties?.aktualit;return typeof r=="string"&&!isNaN(Date.parse(r))?new Date(r):r}}]}}),$r(this.vectorSourceFactory),Yr(),Jr(),Br(),Kr()]}}}function Ur(){const o=new Q({url:"https://geo.sv.rostock.de/download/opendata/haltestellen/haltestellen.json",format:new he,attributions:"Haltestellen Stadt Rostock, Creative Commons CC Zero License (cc-zero)"});return new A({source:o})}function Wr(){const o=new Q({url:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json&limit=10000",format:new he,attributions:'&copy; <a href="http://www.bkg.bund.de" target="_blank">Bundesamt f&uuml;r Kartographie und Geod&auml;sie</a> 2017, <a href="http://sg.geodatenzentrum.de/web_public/Datenquellen_TopPlus_Open.pdf" target="_blank">Datenquellen</a>'});return new A({source:o,style:new jt({image:new Tt({fill:new Dt({color:"blue"}),radius:4})})})}function Hr(o){const e=o.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:`Land NRW (${new Date().getFullYear()}), <a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>, <a href='https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1'>Datenquelle</a>`});return new A({source:e})}function Br(){return new ue({title:"Verwaltungsgebiete",visible:!0,url:"https://www.wms.nrw.de/geobasis/wms_nw_dvg",sublayers:[{name:"nw_dvg_bld",title:"NRW"}]})}function Kr(){return new ue({title:"Bodenkarte zur Landwirtschaftlichen Standorterkundung",visible:!0,url:"https://www.wms.nrw.de/gd/bk05l",sublayers:[{name:"Versickerung_und_Stofftransport",title:"Versickerung und Stofftransport",sublayers:[{name:"Sickerwasserrate",title:"Sickerwasserrate",sublayers:[{name:"Szenario_Wald",title:"Szenario Wald",sublayers:[{name:"Sickerwasserrate_Wald",title:"Sickerwasserrate Wald"},{name:"Direktabfluss_Wald",title:"Direktabfluss Wald"}]},{name:"Szenario_Gruenland",title:"Szenario Grünland",sublayers:[{name:"Sickerwasserrate_Gruenland",title:"Sickerwasserrate Grünland"},{name:"Direktabfluss_Gruenland",title:"Direktabfluss Grünland"}]}]}]},{name:"Wasserhaushalt",title:"Wasserhaushalt",sublayers:[{name:"Kapillaraufstieg_von_Grundwasser",title:"Kapillaraufstieg von Grundwasser",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/gd/bk05l?request=GetLegendGraphic%26version=1.3.0%26format=image/png%26layer=Kapillaraufstieg_von_Grundwasser"}}},{name:"Luftkapazitaet_We",title:"Luftkapazitaet (We)",attributes:{legend:{}}}]}]})}function $r(o){const e="https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1",t="governmentalservice",r=o.createVectorSource({baseUrl:e,collectionId:t,limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/25832",attributions:`Land NRW (${new Date().getFullYear()}), <a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>, <a href='https://ogc-api-test.nrw.de/inspire-us-krankenhaus/v1'>Datenquelle</a>`}),i=new A({source:r});return new ie({id:"krankenhaus",title:"Krankenhäuser",visible:!0,olLayer:i,attributes:{collectionURL:e+"/collections/"+t}})}function Yr(){return new ue({title:"Schulstandorte",description:"Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.Der vorliegende Datenbestand / Dienst zu den Schulstandorten in NRW stammt aus der Schuldatenbank. Die Informationen werden von den Schulträgern bzw. Schulen selbst eingetragen und aktuell gehalten. Die Daten werden tagesaktuell bereitgestellt und enthalten alle grundlegenden Informationen zu Schulen wie Schulnummer, Schulbezeichnung und Adresse.",visible:!0,url:"https://www.wms.nrw.de/wms/wms_nw_inspire-schulen",sublayers:[{name:"US.education",title:"INSPIRE - WMS Schulstandorte NRW",attributes:{legend:{}}}],sourceOptions:{ratio:1}})}function Jr(){return new ue({title:"Straßennetz Landesbetrieb Straßenbau NRW",url:"https://www.wms.nrw.de/wms/strassen_nrw_wms",visible:!0,sublayers:[{name:"1",title:"Verwaltungen",attributes:{legend:{imageUrl:"https://www.wms.nrw.de/legends/wms/strassen_nrw_wms/1.png"}}},{name:"4",title:"Abschnitte und Äste"},{name:"6",title:"Unfälle"}]})}const Zr=Symbol(),Re=Symbol(),re="a",se="w";let Xr=(o,e)=>new Proxy(o,e);const je=Object.getPrototypeOf,Te=new WeakMap,ft=o=>o&&(Te.has(o)?Te.get(o):je(o)===Object.prototype||je(o)===Array.prototype),be=o=>typeof o=="object"&&o!==null,Qr=o=>{if(Array.isArray(o))return Array.from(o);const e=Object.getOwnPropertyDescriptors(o);return Object.values(e).forEach(t=>{t.configurable=!0}),Object.create(je(o),e)},ze=o=>o[Re]||o,mt=(o,e,t,r)=>{if(!ft(o))return o;let i=r&&r.get(o);if(!i){const c=ze(o);i=(s=>Object.values(Object.getOwnPropertyDescriptors(s)).some(d=>!d.configurable&&!d.writable))(c)?[c,Qr(c)]:[c],r?.set(o,i)}const[n,a]=i;let l=t&&t.get(n);return l&&l[1].f===!!a||(l=((c,s)=>{const d={f:s};let h=!1;const g=(f,m)=>{if(!h){let x=d[re].get(c);if(x||(x={},d[re].set(c,x)),f===se)x[se]=!0;else{let w=x[f];w||(w=new Set,x[f]=w),w.add(m)}}},p={get:(f,m)=>m===Re?c:(g("k",m),mt(Reflect.get(f,m),d[re],d.c,d.t)),has:(f,m)=>m===Zr?(h=!0,d[re].delete(c),!0):(g("h",m),Reflect.has(f,m)),getOwnPropertyDescriptor:(f,m)=>(g("o",m),Reflect.getOwnPropertyDescriptor(f,m)),ownKeys:f=>(g(se),Reflect.ownKeys(f))};return s&&(p.set=p.deleteProperty=()=>!1),[p,d]})(n,!!a),l[1].p=Xr(a||n,l[0]),t&&t.set(n,l)),l[1][re]=e,l[1].c=t,l[1].t=r,l[1].p},vt=(o,e,t,r,i=Object.is)=>{if(i(o,e))return!1;if(!be(o)||!be(e))return!0;const n=t.get(ze(o));if(!n)return!0;if(r){const l=r.get(o);if(l&&l.n===e)return l.g;r.set(o,{n:e,g:!1})}let a=null;try{for(const l of n.h||[])if(a=Reflect.has(o,l)!==Reflect.has(e,l),a)return a;if(n[se]===!0){if(a=((l,c)=>{const s=Reflect.ownKeys(l),d=Reflect.ownKeys(c);return s.length!==d.length||s.some((h,g)=>h!==d[g])})(o,e),a)return a}else for(const l of n.o||[])if(a=!!Reflect.getOwnPropertyDescriptor(o,l)!=!!Reflect.getOwnPropertyDescriptor(e,l),a)return a;for(const l of n.k||[])if(a=vt(o[l],e[l],t,r,i),a)return a;return a===null&&(a=!0),a}finally{r&&r.set(o,{n:e,g:a})}},ei=o=>ft(o)&&o[Re]||null,Ye=(o,e=!0)=>{Te.set(o,e)},ti=(o,e,t)=>{const r=[],i=new WeakSet,n=(a,l)=>{if(i.has(a))return;be(a)&&i.add(a);const c=be(a)&&e.get(ze(a));if(c){var s,d;if((s=c.h)==null||s.forEach(g=>{const p=`:has(${String(g)})`;r.push(l?[...l,p]:[p])}),c[se]===!0){const g=":ownKeys";r.push(l?[...l,g]:[g])}else{var h;(h=c.o)==null||h.forEach(g=>{const p=`:hasOwn(${String(g)})`;r.push(l?[...l,p]:[p])})}(d=c.k)==null||d.forEach(g=>{!("value"in(Object.getOwnPropertyDescriptor(a,g)||{}))||n(a[g],l?[...l,g]:[g])})}else l&&r.push(l)};return n(o),r};var we={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Le=o=>typeof o=="object"&&o!==null,G=new WeakMap,oe=new WeakSet,ri=(o=Object.is,e=(s,d)=>new Proxy(s,d),t=s=>Le(s)&&!oe.has(s)&&(Array.isArray(s)||!(Symbol.iterator in s))&&!(s instanceof WeakMap)&&!(s instanceof WeakSet)&&!(s instanceof Error)&&!(s instanceof Number)&&!(s instanceof Date)&&!(s instanceof String)&&!(s instanceof RegExp)&&!(s instanceof ArrayBuffer),r=s=>{switch(s.status){case"fulfilled":return s.value;case"rejected":throw s.reason;default:throw s}},i=new WeakMap,n=(s,d,h=r)=>{const g=i.get(s);if(g?.[0]===d)return g[1];const p=Array.isArray(s)?[]:Object.create(Object.getPrototypeOf(s));return Ye(p,!0),i.set(s,[d,p]),Reflect.ownKeys(s).forEach(f=>{if(Object.getOwnPropertyDescriptor(p,f))return;const m=Reflect.get(s,f),{enumerable:x}=Reflect.getOwnPropertyDescriptor(s,f),w={value:m,enumerable:x,configurable:!0};if(oe.has(m))Ye(m,!1);else if(m instanceof Promise)delete w.value,w.get=()=>h(m);else if(G.has(m)){const[N,j]=G.get(m);w.value=n(N,j(),h)}Object.defineProperty(p,f,w)}),Object.preventExtensions(p)},a=new WeakMap,l=[1,1],c=s=>{if(!Le(s))throw new Error("object required");const d=a.get(s);if(d)return d;let h=l[0];const g=new Set,p=(b,_=++l[0])=>{h!==_&&(h=_,g.forEach(y=>y(b,_)))};let f=l[1];const m=(b=++l[1])=>(f!==b&&!g.size&&(f=b,w.forEach(([_])=>{const y=_[1](b);y>h&&(h=y)})),h),x=b=>(_,y)=>{const M=[..._];M[1]=[b,...M[1]],p(M,y)},w=new Map,N=(b,_)=>{if((we?"production":void 0)!=="production"&&w.has(b))throw new Error("prop listener already exists");if(g.size){const y=_[3](x(b));w.set(b,[_,y])}else w.set(b,[_])},j=b=>{var _;const y=w.get(b);y&&(w.delete(b),(_=y[1])==null||_.call(y))},Se=b=>(g.add(b),g.size===1&&w.forEach(([y,M],H)=>{if((we?"production":void 0)!=="production"&&M)throw new Error("remove already exists");const ee=y[3](x(H));w.set(H,[y,ee])}),()=>{g.delete(b),g.size===0&&w.forEach(([y,M],H)=>{M&&(M(),w.set(H,[y]))})}),T=Array.isArray(s)?[]:Object.create(Object.getPrototypeOf(s)),pe=e(T,{deleteProperty(b,_){const y=Reflect.get(b,_);j(_);const M=Reflect.deleteProperty(b,_);return M&&p(["delete",[_],y]),M},set(b,_,y,M){const H=Reflect.has(b,_),ee=Reflect.get(b,_,M);if(H&&(o(ee,y)||a.has(y)&&o(ee,a.get(y))))return!0;j(_),Le(y)&&(y=ei(y)||y);let ge=y;if(y instanceof Promise)y.then(O=>{y.status="fulfilled",y.value=O,p(["resolve",[_],O])}).catch(O=>{y.status="rejected",y.reason=O,p(["reject",[_],O])});else{!G.has(y)&&t(y)&&(ge=c(y));const O=!oe.has(ge)&&G.get(ge);O&&N(_,O)}return Reflect.set(b,_,ge,M),p(["set",[_],y,ee]),!0}});a.set(s,pe);const kt=[T,m,n,Se];return G.set(pe,kt),Reflect.ownKeys(s).forEach(b=>{const _=Object.getOwnPropertyDescriptor(s,b);"value"in _&&(pe[b]=s[b],delete _.value,delete _.writable),Object.defineProperty(T,b,_)}),pe})=>[c,G,oe,o,e,t,r,i,n,a,l],[ii]=ri();function yt(o={}){return ii(o)}function oi(o,e,t){const r=G.get(o);(we?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let i;const n=[],a=r[3];let l=!1;const s=a(d=>{n.push(d),i||(i=Promise.resolve().then(()=>{i=void 0,l&&e(n.splice(0))}))});return l=!0,()=>{l=!1,s()}}function Je(o,e){const t=G.get(o);(we?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[r,i,n]=t;return n(r,i(),e)}function B(o){return oe.add(o),o}var _t={exports:{}},bt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z=k;function ni(o,e){return o===e&&(o!==0||1/o===1/e)||o!==o&&e!==e}var si=typeof Object.is=="function"?Object.is:ni,ai=Z.useState,li=Z.useEffect,ci=Z.useLayoutEffect,di=Z.useDebugValue;function ui(o,e){var t=e(),r=ai({inst:{value:t,getSnapshot:e}}),i=r[0].inst,n=r[1];return ci(function(){i.value=t,i.getSnapshot=e,Ce(i)&&n({inst:i})},[o,t,e]),li(function(){return Ce(i)&&n({inst:i}),o(function(){Ce(i)&&n({inst:i})})},[o]),di(t),t}function Ce(o){var e=o.getSnapshot;o=o.value;try{var t=e();return!si(o,t)}catch{return!0}}function hi(o,e){return e()}var pi=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?hi:ui;bt.useSyncExternalStore=Z.useSyncExternalStore!==void 0?Z.useSyncExternalStore:pi;_t.exports=bt;var gi=_t.exports;const fi=Lt(gi);var mi={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{use:Ze}=Ct,{useSyncExternalStore:vi}=fi,yi=(o,e)=>{const t=k.useRef();k.useEffect(()=>{t.current=ti(o,e)}),k.useDebugValue(t.current)},_i=new WeakMap;function X(o,e){const r=k.useRef(),i=k.useRef();let n=!0;const a=vi(k.useCallback(s=>{const d=oi(o,s);return s(),d},[o,void 0]),()=>{const s=Je(o,Ze);try{if(!n&&r.current&&i.current&&!vt(r.current,s,i.current,new WeakMap))return r.current}catch{}return s},()=>Je(o,Ze));n=!1;const l=new WeakMap;k.useEffect(()=>{r.current=a,i.current=l}),(mi?"production":void 0)!=="production"&&yi(a,l);const c=k.useMemo(()=>new WeakMap,[]);return mt(a,l,c,_i)}function bi(o){const e=yt({data:Array.from([]),has(t){return this.data.some(r=>r[0]===t)},set(t,r){const i=this.data.find(n=>n[0]===t);return i?i[1]=r:this.data.push([t,r]),this},get(t){var r;return(r=this.data.find(i=>i[0]===t))==null?void 0:r[1]},delete(t){const r=this.data.findIndex(i=>i[0]===t);return r===-1?!1:(this.data.splice(r,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(r=>{t(r[1],r[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}class wi{label;filteredTypes;httpService;constructor(e,t,r){this.label=e,this.filteredTypes=t,this.httpService=r}async search(e,{mapProjection:t,signal:r}){const i=await this.request(e,100,r),n=new he({dataProjection:"EPSG:4326",featureProjection:t});return i.features.filter(a=>this.filteredTypes.includes(a.properties.type)).map((a,l)=>{const c=n.readGeometry(a.geometry);return{id:a.properties.osm_id||l,label:this.createLabel(a),geometry:c,properties:a.properties}})}async request(e,t,r){const i=new URL("https://photon.komoot.io/api?");i.searchParams.set("q",e),i.searchParams.set("lang","de"),i.searchParams.set("lat","51.961563"),i.searchParams.set("lon","7.628202"),i.searchParams.set("limit",t.toString());const n=await this.httpService.fetch(i,{signal:r});if(!n.ok)throw new Error("Request failed: "+n.status);return await n.json()}createLabel(e){return`${e.properties.name} (${e.properties.osm_value?e.properties.osm_value+", ":""}${e.properties.postcode?e.properties.postcode+", ":""}${e.properties.city?e.properties.city+", ":""}${e.properties.country?e.properties.country+")":")"}`}}const Si=ot("ol-app:AppModel");class xi{_intl;_mapRegistry;_ogcSearchSourceFactory;_vectorSelectionSourceFactory;_httpService;_state;_resources=[];_featureHighlight=void 0;constructor({references:e,intl:t}){this._mapRegistry=e.mapRegistry,this._intl=t,this._ogcSearchSourceFactory=e.ogcSearchSourceFactory,this._vectorSelectionSourceFactory=e.vectorSelectionSourceFactory,this._httpService=e.httpService,this._state=yt({searchSources:[],selectionSources:[],sourceMetadata:bi(),resultListState:{input:void 0,open:!1,key:0}}),this.initSearchSources(),this.initSelectionSources().catch(r=>{Si.error("Failed to initialize selection sources",r)})}destroy(){this._resources.forEach(e=>e.destroy())}get state(){return this._state}setResultListInput(e){const t=this._state.resultListState.key;this._state.resultListState={open:!0,key:t+1,input:B(e)}}setResultListVisibility(e){this._state.resultListState.open=e}highlightAndZoom(e,t){const r=e.olMap.getViewport();this.clearPreviousHighlight(),this._featureHighlight=e.highlightAndZoom(t,{viewPadding:r&&r.offsetWidth<1e3?{top:150,right:75,bottom:50,left:75}:{top:150,right:400,bottom:50,left:400}})}zoom(e,t){const r=e.olMap.getViewport();e.zoom(t,{viewPadding:r&&r.offsetWidth<1e3?{top:150,right:75,bottom:50,left:75}:{top:150,right:400,bottom:50,left:400}})}clearPreviousHighlight(){this._featureHighlight&&(this._featureHighlight.destroy(),this._featureHighlight=void 0)}initSearchSources(){const e=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.lika"}),baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"flurstueck",searchProperty:"flurstid",labelProperty:"objid"}),t=this._ogcSearchSourceFactory.createSearchSource({label:this._intl.formatMessage({id:"searchSources.miningPermissions"}),baseUrl:"https://ogc-api.nrw.de/inspire-am-bergbauberechtigungen/v1",collectionId:"managementrestrictionorregulationzone",searchProperty:"thematicId",labelProperty:"name",renderLabel(i){const n=i?.properties?.name,a=i?.id;return typeof n=="string"?n+" ("+a+")":String(a)},rewriteUrl(i){return i.searchParams.set("properties","name"),i}}),r=new wi("Photon Geocoder",["city","street"],this._httpService);this._state.searchSources=[B(e),B(t),B(r)]}async initSelectionSources(){const e=["ogc_kitas","ogc_kataster"],r=(await this._mapRegistry.expectMapModel(S)).layers.getOperationalLayers({sortByDisplayOrder:!0});for(const i of r){if(!e.includes(i.id)||!ki(i.olLayer))continue;const n=this._vectorSelectionSourceFactory.createSelectionSource({vectorLayer:i.olLayer,label:i.title}),a=n.on("changed:status",()=>{n.status!=="available"&&(n.status==="unavailable"||n.status?.kind==="unavailable")&&this.clearPreviousHighlight()});this._resources.push(a,n),this._state.selectionSources.unshift(B(n)),this._state.sourceMetadata.set(B(n),i.attributes.resultListMetadata)}}}function ki(o){return o instanceof A&&o.getSource()instanceof Q}const Xe=0,ae=1,Qe=[0,0,0,0],Y=[],Pe={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class Ie extends dt{constructor(e,t,r){super(e),this.features=t,this.mapBrowserEvent=r}}class Ei extends Rt{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:zt,this.defaultDeleteCondition_=function(r){return Ot(r)&&lt(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Gt,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Vt,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new A({source:new Q({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:Li(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new _e(this.source_.getFeatures()),this.source_.addEventListener(Ve.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Ve.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener($.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener($.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),e.addEventListener(Ne.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new _e;const r=this.featuresBeingModified_.getArray();for(let i=0,n=t.length;i<n;++i){const a=t[i];for(let l=0,c=a.length;l<c;++l){const s=a[l].feature;s&&!r.includes(s)&&this.featuresBeingModified_.push(s)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Ie(Pe.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Ne.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,r=[];t.forEach(function(i){e===i.feature&&r.push(i)});for(let i=r.length-1;i>=0;--i){const n=r[i];for(let a=this.dragSegments_.length-1;a>=0;--a)this.dragSegments_[a][0]===n&&this.dragSegments_.splice(a,1);t.remove(n)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const r=t.getCoordinates(),i={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)}writeMultiPointGeometry_(e,t){const r=t.getCoordinates();for(let i=0,n=r.length;i<n;++i){const a=r[i],l={feature:e,geometry:t,depth:[i],index:i,segment:[a,a]};this.rBush_.insert(t.getExtent(),l)}}writeLineStringGeometry_(e,t){const r=t.getCoordinates();for(let i=0,n=r.length-1;i<n;++i){const a=r.slice(i,i+2),l={feature:e,geometry:t,index:i,segment:a};this.rBush_.insert(D(a),l)}}writeMultiLineStringGeometry_(e,t){const r=t.getCoordinates();for(let i=0,n=r.length;i<n;++i){const a=r[i];for(let l=0,c=a.length-1;l<c;++l){const s=a.slice(l,l+2),d={feature:e,geometry:t,depth:[i],index:l,segment:s};this.rBush_.insert(D(s),d)}}}writePolygonGeometry_(e,t){const r=t.getCoordinates();for(let i=0,n=r.length;i<n;++i){const a=r[i];for(let l=0,c=a.length-1;l<c;++l){const s=a.slice(l,l+2),d={feature:e,geometry:t,depth:[i],index:l,segment:s};this.rBush_.insert(D(s),d)}}}writeMultiPolygonGeometry_(e,t){const r=t.getCoordinates();for(let i=0,n=r.length;i<n;++i){const a=r[i];for(let l=0,c=a.length;l<c;++l){const s=a[l];for(let d=0,h=s.length-1;d<h;++d){const g=s.slice(d,d+2),p={feature:e,geometry:t,depth:[l,i],index:d,segment:g};this.rBush_.insert(D(g),p)}}}}writeCircleGeometry_(e,t){const r=t.getCenter(),i={feature:e,geometry:t,index:Xe,segment:[r,r]},n={feature:e,geometry:t,index:ae,segment:[r,r]},a=[i,n];i.featureSegments=a,n.featureSegments=a,this.rBush_.insert(Me(r),i);let l=t;this.rBush_.insert(l.getExtent(),n)}writeGeometryCollectionGeometry_(e,t){const r=t.getGeometriesArray();for(let i=0;i<r.length;++i){const n=r[i],a=this.SEGMENT_WRITERS_[n.getType()];a(e,n)}}createOrUpdateVertexFeature_(e,t,r){let i=this.vertexFeature_;return i?i.getGeometry().setCoordinates(e):(i=new ce(new qe(e)),this.vertexFeature_=i,this.overlay_.getSource().addFeature(i)),i.set("features",t),i.set("geometries",r),i}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==fe.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=fe.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==fe.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],i=[];for(let n=0,a=this.dragSegments_.length;n<a;++n){const l=this.dragSegments_[n],c=l[0],s=c.feature;r.includes(s)||r.push(s);const d=c.geometry;i.includes(d)||i.push(d);const h=c.depth;let g;const p=c.segment,f=l[1];for(;t.length<d.getStride();)t.push(p[f][t.length]);switch(d.getType()){case"Point":g=t,p[0]=t,p[1]=t;break;case"MultiPoint":g=d.getCoordinates(),g[c.index]=t,p[0]=t,p[1]=t;break;case"LineString":g=d.getCoordinates(),g[c.index+f]=t,p[f]=t;break;case"MultiLineString":g=d.getCoordinates(),g[h[0]][c.index+f]=t,p[f]=t;break;case"Polygon":g=d.getCoordinates(),g[h[0]][c.index+f]=t,p[f]=t;break;case"MultiPolygon":g=d.getCoordinates(),g[h[1]][h[0]][c.index+f]=t,p[f]=t;break;case"Circle":if(p[0]=t,p[1]=t,c.index===Xe)this.changingFeature_=!0,d.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let m=Ue(F(d.getCenter()),F(t));d.setRadius(m),this.changingFeature_=!1}break}g&&this.setGeometryCoordinates_(d,g)}this.createOrUpdateVertexFeature_(t,r,i)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;const r=this.vertexFeature_;if(r){e.map.getView().getProjection();const i=[],n=r.getGeometry().getCoordinates(),a=D([n]),l=this.rBush_.getInExtent(a),c={};l.sort(Mi);for(let s=0,d=l.length;s<d;++s){const h=l[s],g=h.segment;let p=C(h.geometry);const f=h.depth;if(f&&(p+="-"+f.join("-")),c[p]||(c[p]=new Array(2)),h.geometry.getType()==="Circle"&&h.index===ae){const m=tt(t,h);q(m,n)&&!c[p][0]&&(this.dragSegments_.push([h,0]),c[p][0]=h);continue}if(q(g[0],n)&&!c[p][0]){this.dragSegments_.push([h,0]),c[p][0]=h;continue}if(q(g[1],n)&&!c[p][1]){if(c[p][0]&&c[p][0].index===0){let m=h.geometry.getCoordinates();switch(h.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":m=m[f[1]];case"Polygon":if(h.index!==m[f[0]].length-2)continue;break}}this.dragSegments_.push([h,1]),c[p][1]=h;continue}C(g)in this.vertexSegments_&&!c[p][0]&&!c[p][1]&&this.insertVertexCondition_(e)&&i.push(h)}i.length&&this.willModifyFeatures_(e,[i]);for(let s=i.length-1;s>=0;--s)this.insertVertex_(i[s],n)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const r=this.dragSegments_[t][0],i=r.geometry;if(i.getType()==="Circle"){const n=i.getCenter(),a=r.featureSegments[0],l=r.featureSegments[1];a.segment[0]=n,a.segment[1]=n,l.segment[0]=n,l.segment[1]=n,this.rBush_.update(Me(n),a);let c=i;this.rBush_.update(c.getExtent(),l)}else this.rBush_.update(D(r.segment),r)}return this.featuresBeingModified_&&(this.dispatchEvent(new Ie(Pe.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,r){const i=r||t.getCoordinateFromPixel(e);t.getView().getProjection();const n=function(c,s){return et(i,c)-et(i,s)};let a,l;if(this.hitDetection_){const c=typeof this.hitDetection_=="object"?s=>s===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,(s,d,h)=>{h&&h.getType()==="Point"&&(h=new qe(Fe(h.getCoordinates())));const g=h||s.getGeometry();if(s instanceof ce&&this.features_.getArray().includes(s)){l=g;const p=s.getGeometry().getFlatCoordinates().slice(0,2);a=[{feature:s,geometry:l,segment:[p,p]}]}return!0},{layerFilter:c})}if(!a){const c=Nt(Me(i,Qe)),s=t.getView().getResolution()*this.pixelTolerance_,d=qt(Ut(c,s,Qe));a=this.rBush_.getInExtent(d)}if(a&&a.length>0){const c=a.sort(n)[0],s=c.segment;let d=tt(i,c);const h=t.getPixelFromCoordinate(d);let g=Ue(e,h);if(l||g<=this.pixelTolerance_){const p={};if(p[C(s)]=!0,this.snapToPointer_||(this.delta_[0]=d[0]-i[0],this.delta_[1]=d[1]-i[1]),c.geometry.getType()==="Circle"&&c.index===ae)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d,[c.feature],[c.geometry]);else{const f=t.getPixelFromCoordinate(s[0]),m=t.getPixelFromCoordinate(s[1]),x=Ae(h,f),w=Ae(h,m);g=Math.sqrt(Math.min(x,w)),this.snappedToVertex_=g<=this.pixelTolerance_,this.snappedToVertex_&&(d=x>w?s[1]:s[0]),this.createOrUpdateVertexFeature_(d,[c.feature],[c.geometry]);const N={};N[C(c.geometry)]=!0;for(let j=1,Se=a.length;j<Se;++j){const T=a[j].segment;if(q(s[0],T[0])&&q(s[1],T[1])||q(s[0],T[1])&&q(s[1],T[0])){const xe=C(a[j].geometry);xe in N||(N[xe]=!0,p[C(T)]=!0)}else break}}this.vertexSegments_=p;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const r=e.segment,i=e.feature,n=e.geometry,a=e.depth,l=e.index;let c;for(;t.length<n.getStride();)t.push(0);switch(n.getType()){case"MultiLineString":c=n.getCoordinates(),c[a[0]].splice(l+1,0,t);break;case"Polygon":c=n.getCoordinates(),c[a[0]].splice(l+1,0,t);break;case"MultiPolygon":c=n.getCoordinates(),c[a[1]][a[0]].splice(l+1,0,t);break;case"LineString":c=n.getCoordinates(),c.splice(l+1,0,t);break;default:return}this.setGeometryCoordinates_(n,c);const s=this.rBush_;s.remove(e),this.updateSegmentIndices_(n,l,a,1);const d={segment:[r[0],t],feature:i,geometry:n,depth:a,index:l};s.insert(D(d.segment),d),this.dragSegments_.push([d,1]);const h={segment:[t,r[1]],feature:i,geometry:n,depth:a,index:l+1};s.insert(D(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=fe.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);const t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Ie(Pe.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){const e=this.dragSegments_,t={};let r=!1,i,n,a,l,c,s,d,h,g,p,f;for(c=e.length-1;c>=0;--c)a=e[c],p=a[0],f=C(p.feature),p.depth&&(f+="-"+p.depth.join("-")),f in t||(t[f]={}),a[1]===0?(t[f].right=p,t[f].index=p.index):a[1]==1&&(t[f].left=p,t[f].index=p.index+1);for(f in t){switch(g=t[f].right,d=t[f].left,s=t[f].index,h=s-1,d!==void 0?p=d:p=g,h<0&&(h=0),l=p.geometry,n=l.getCoordinates(),i=n,r=!1,l.getType()){case"MultiLineString":n[p.depth[0]].length>2&&(n[p.depth[0]].splice(s,1),r=!0);break;case"LineString":n.length>2&&(n.splice(s,1),r=!0);break;case"MultiPolygon":i=i[p.depth[1]];case"Polygon":i=i[p.depth[0]],i.length>4&&(s==i.length-1&&(s=0),i.splice(s,1),r=!0,s===0&&(i.pop(),i.push(i[0]),h=i.length-1));break}if(r){this.setGeometryCoordinates_(l,n);const m=[];if(d!==void 0&&(this.rBush_.remove(d),m.push(d.segment[0])),g!==void 0&&(this.rBush_.remove(g),m.push(g.segment[1])),d!==void 0&&g!==void 0){const x={depth:p.depth,feature:p.feature,geometry:p.geometry,index:h,segment:m};this.rBush_.insert(D(x.segment),x)}this.updateSegmentIndices_(l,s,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(n){n.geometry===e&&(r===void 0||n.depth===void 0||Wt(n.depth,r))&&n.index>t&&(n.index+=i)})}}function Mi(o,e){return o.index-e.index}function et(o,e,t){const r=e.geometry;if(r.getType()==="Circle"){let n=r;if(e.index===ae){const a=Ae(n.getCenter(),F(o)),l=Math.sqrt(a)-n.getRadius();return l*l}}const i=F(o);return Y[0]=F(e.segment[0]),Y[1]=F(e.segment[1]),Bt(i,Y)}function tt(o,e,t){const r=e.geometry;if(r.getType()==="Circle"&&e.index===ae)return Fe(r.getClosestPoint(F(o)));const i=F(o);return Y[0]=F(e.segment[0]),Y[1]=F(e.segment[1]),Fe(Ht(i,Y))}function Li(){const o=ct();return function(e,t){return o.Point}}const Ci={SELECT:"select"};class Pi extends dt{constructor(e,t,r,i){super(e),this.selected=t,this.deselected=r,this.mapBrowserEvent=i}}const me={};class Oe extends Kt{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:lt,this.addCondition_=e.addCondition?e.addCondition:We,this.removeCondition_=e.removeCondition?e.removeCondition:We,this.toggleCondition_=e.toggleCondition?e.toggleCondition:$t,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:He,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:Ii(),this.features_=e.features||new _e;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const r=e.layers;t=function(i){return r.includes(i)}}else t=He;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[C(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[C(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener($.ADD,this.boundAddFeature_),this.features_.addEventListener($.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener($.ADD,this.boundAddFeature_),this.features_.removeEventListener($.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const r=this.getMap().getAllLayers().find(function(i){if(i instanceof A&&i.getSource()&&i.getSource().hasFeature(t))return i});r&&this.addFeatureLayerAssociation_(t,r)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=C(e);t in me||(me[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let i=t.length-1;i>=0;--i){const n=t[i];if(n!==this&&n instanceof Oe&&n.getStyle()&&n.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(n.getStyle());return}}const r=C(e);e.setStyle(me[r]),delete me[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[C(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),n=!t&&!r&&!i,a=e.map,l=this.getFeatures(),c=[],s=[];if(n){Yt(this.featureLayerAssociation_),a.forEachFeatureAtPixel(e.pixel,(d,h)=>{if(!(!(d instanceof ce)||!this.filter_(d,h)))return this.addFeatureLayerAssociation_(d,h),s.push(d),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let d=l.getLength()-1;d>=0;--d){const h=l.item(d),g=s.indexOf(h);g>-1?s.splice(g,1):(l.remove(h),c.push(h))}s.length!==0&&l.extend(s)}else{a.forEachFeatureAtPixel(e.pixel,(d,h)=>{if(!(!(d instanceof ce)||!this.filter_(d,h)))return(t||i)&&!l.getArray().includes(d)?(this.addFeatureLayerAssociation_(d,h),s.push(d)):(r||i)&&l.getArray().includes(d)&&(c.push(d),this.removeFeatureLayerAssociation_(d)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let d=c.length-1;d>=0;--d)l.remove(c[d]);l.extend(s)}return(s.length>0||c.length>0)&&this.dispatchEvent(new Pi(Ci.SELECT,s,c,e)),!0}}function Ii(){const o=ct();return Be(o.Polygon,o.LineString),Be(o.GeometryCollection,o.LineString),function(e){return e.getGeometry()?o[e.getGeometry().getType()]:null}}async function Fi(o,e,t,r){const n=r.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),a=await o.fetch(e,{method:"POST",body:JSON.stringify({type:"Feature",properties:{},geometry:t}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${n}>`}});if(!a||!a.ok||a.status!==201)throw new Error("Request failed: "+a.status);const l=a.headers.get("location");if(!l)throw new Error("Request failed: no Location response header");const c=l.substring(l.lastIndexOf("/")+1);return Promise.resolve(c)}async function Ai(o,e,t,r,i){const a=i.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),l=new URL(`${e.toString()}/${t}`),c=await o.fetch(l,{method:"PATCH",body:JSON.stringify({type:"Feature",properties:{},geometry:r}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${a}>`}});if(!c||!c.ok||c.status!==204)throw new Error("Request failed: "+c.status);return Promise.resolve(t)}function wt(o,e){const t=document.createElement("div");t.className="editing-tooltip editing-tooltip-hidden",t.textContent=e;const r=new pt({element:t,offset:[15,0],positioning:"center-left"}),i=o.on("pointermove",n=>{n.dragging||r.setPosition(n.coordinate)});return o.addOverlay(r),{destroy(){de(i),o.removeOverlay(r)},setVisible(n){t.classList.toggle("editing-tooltip-hidden",!n)},setText(n){t.textContent=n}}}function St(o){let e=rt(o.polygon);Array.isArray(e)&&(e=e[0]);let t=rt(o.vertex);Array.isArray(t)&&(t=t[0]);const r=[];return e&&r.push(e),t&&(t.setGeometry(ji),r.push(t)),r}const ji=o=>{if(o){const e=o.getGeometry();if(e&&e.getType()==="Polygon"){const t=e.getCoordinates()[0];if(t)return new Rr(t)}}},rt=o=>{const e=new ce,r=new A({style:o}).getStyleFunction();if(!r)throw new Error("can't retrieve style function");const i=r(e,1);if(!i)throw new Error("can't retrieve styles from feature style function");return Array.isArray(i)&&i.length?i.length>1?i:i[0]:i},Ti=ot("editing:EditingCreateWorkflowImpl");var R;class Di extends ut{constructor(t){super();ke(this,R,void 0);v(this,"_httpService");v(this,"_intl");v(this,"_map");v(this,"_polygonStyle");v(this,"_vertexStyle");v(this,"_state");v(this,"_editLayerURL");v(this,"_featureId");v(this,"_editingSource");v(this,"_editingLayer");v(this,"_drawInteraction");v(this,"_olMap");v(this,"_mapContainer");v(this,"_tooltip");v(this,"_enterHandler");v(this,"_escapeHandler");v(this,"_error");v(this,"_interactionListener");v(this,"_mapListener");this._httpService=t.httpService,this._intl=t.intl,this._polygonStyle=t.polygonStyle,this._vertexStyle=t.vertexStyle,this._map=t.map,this._olMap=t.map.olMap,this._state="active:initialized",this._editLayerURL=t.ogcApiFeatureLayerUrl,this._editingSource=new Q,this._editingLayer=new A({source:this._editingSource,zIndex:ht,properties:{name:"editing-layer"}}),this._drawInteraction=new Cr({source:this._editingSource,type:"Polygon",style:St({polygon:this._polygonStyle,vertex:this._vertexStyle})}),this._tooltip=wt(this._olMap,this._intl.formatMessage({id:"create.tooltip.begin"})),this._enterHandler=r=>{if((r.code==="Enter"||r.code==="NumpadEnter")&&r.target===this._olMap.getTargetElement()){const i=this._drawInteraction.getOverlay().getSource().getFeatures();i[0]&&i[0].getGeometry().getCoordinates()[0].length>4&&this.triggerSave()}},this._escapeHandler=r=>{r.code==="Escape"&&r.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getDrawInteraction(){return this._drawInteraction}getState(){return this._state}_setState(t){this._state=t,this.emit(t)}_save(t){this._setState("active:saving");const r=this._editLayerURL,i=t.getGeometry();if(!i){this._destroy(),this._error=new Error("no geometry available"),L(this,R)?.reject(this._error);return}const n=this._olMap.getView().getProjection(),l=new he({dataProjection:n}).writeGeometryObject(i,{rightHanded:!0,decimals:10});Fi(this._httpService,r,l,n).then(c=>{this._featureId=c,this._destroy(),L(this,R)?.resolve({featureId:this._featureId})}).catch(c=>{Ti.error(c),this._destroy(),this._error=new Error("Failed to save feature",{cause:c}),L(this,R)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._drawInteraction),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1)),this._tooltip.setVisible(!0);const t=this._drawInteraction.on("drawstart",()=>{this._setState("active:drawing"),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.continue"}))}),r=this._drawInteraction.on("drawend",n=>{const a=n.feature;if(!a){this._destroy(),this._error=new Error("no feature available"),L(this,R)?.reject(this._error);return}this._save(a)}),i=this._map.on("changed:container",()=>{this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1))});this._interactionListener.push(t,r),this._mapListener.push(i)}reset(){this._drawInteraction.abortDrawing(),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.begin"})),this._setState("active:initialized")}stop(){this._destroy(),L(this,R)?.resolve(void 0)}_destroy(){this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._drawInteraction),this._tooltip.destroy(),this._interactionListener.map(t=>{de(t)}),this._mapListener.map(t=>{t.destroy()}),this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._setState("destroyed")}triggerSave(){this._drawInteraction.finishDrawing()}whenComplete(){return this._state==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(L(this,R)??Ee(this,R,nt())).promise}}R=new WeakMap;var I;class Ri extends ut{constructor(t){super();ke(this,I,void 0);v(this,"_httpService");v(this,"_intl");v(this,"_map");v(this,"_polygonStyle");v(this,"_vertexStyle");v(this,"_state");v(this,"_editLayerURL");v(this,"_featureId");v(this,"_initialFeature");v(this,"_editFeature");v(this,"_editingSource");v(this,"_editingLayer");v(this,"_modifyInteraction");v(this,"_olMap");v(this,"_mapContainer");v(this,"_tooltip");v(this,"_enterHandler");v(this,"_escapeHandler");v(this,"_error");v(this,"_interactionListener");v(this,"_mapListener");this._httpService=t.httpService,this._intl=t.intl,this._polygonStyle=t.polygonStyle,this._vertexStyle=t.vertexStyle,this._map=t.map,this._olMap=t.map.olMap,this._state="active:initialized",this._editLayerURL=t.ogcApiFeatureLayerUrl,this._initialFeature=t.feature.clone(),this._initialFeature.setId(t.feature.getId()),this._editFeature=t.feature.clone(),this._editFeature.setId(t.feature.getId()),this._editFeature.setStyle(St({polygon:this._polygonStyle,vertex:this._vertexStyle})),this._editingSource=new Q({features:new _e([this._editFeature])}),this._editingLayer=new A({source:this._editingSource,zIndex:ht,properties:{name:"editing-layer"}}),this._modifyInteraction=new Ei({source:this._editingSource}),this._tooltip=wt(this._olMap,this._intl.formatMessage({id:"create.tooltip.deselect"})),this._enterHandler=r=>{if((r.code==="Enter"||r.code==="NumpadEnter")&&r.target===this._olMap.getTargetElement()){const i=this._editingSource.getFeatures()[0];if(!i)throw Error("no updated feature found");this._save(i)}},this._escapeHandler=r=>{r.code==="Escape"&&r.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getModifyInteraction(){return this._modifyInteraction}getState(){return this._state}_setState(t){this._state=t,this.emit(t)}_save(t){this._setState("active:saving");const r=this._editLayerURL;if(this._featureId=t.getId()?.toString(),!this._featureId){this._destroy(),this._error=new Error("no feature id available"),L(this,I)?.reject(this._error);return}const i=t?.getGeometry();if(!i){this._destroy(),this._error=new Error("no geometry available"),L(this,I)?.reject(this._error);return}const n=this._olMap.getView().getProjection(),l=new he({dataProjection:n}).writeGeometryObject(i,{rightHanded:!0,decimals:10});Ai(this._httpService,r,this._featureId,l,n).then(c=>{this._destroy(),L(this,I)?.resolve({featureId:c})}).catch(c=>{this._destroy(),this._error=new Error("Failed to save feature",{cause:c}),L(this,I)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._modifyInteraction);const t=this._editingSource.getFeatures()[0];if(t&&!t.getId()?.toString()){this._destroy(),this._error=new Error("no feature id available"),L(this,I)?.reject(this._error);return}this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1)),this._tooltip.setVisible(!0);const r=this._map.olMap.on("click",a=>{const l=a.coordinate,c=a.originalEvent.altKey,s=this._editingSource.getFeaturesAtCoordinate(l);c||s.length===0&&this.triggerSave()}),i=this._modifyInteraction.on("modifystart",()=>{this._setState("active:drawing")}),n=this._map.on("changed:container",()=>{this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._mapContainer=this._olMap.getTargetElement()??void 0,this._mapContainer&&(this._mapContainer.addEventListener("keydown",this._enterHandler,!1),this._mapContainer.addEventListener("keydown",this._escapeHandler,!1))});this._interactionListener.push(r,i),this._mapListener.push(n)}reset(){const t=this._initialFeature.getGeometry()?.clone(),r=this._editingSource.getFeatures()[0];if(!r)throw Error("no updated feature found");r.setGeometry(t),this._setState("active:initialized")}stop(){this._destroy(),L(this,I)?.resolve(void 0)}_destroy(){this._editingSource.clear(),this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._modifyInteraction),this._tooltip.destroy(),this._interactionListener.map(t=>{de(t)}),this._mapListener.map(t=>{t.destroy()}),this._mapContainer?.removeEventListener("keydown",this._enterHandler),this._mapContainer?.removeEventListener("keydown",this._escapeHandler),this._setState("destroyed")}triggerSave(){const t=this._editingSource.getFeatures()[0];if(!t)throw Error("no updated feature found");this._save(t)}whenComplete(){return this._state==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(L(this,I)??Ee(this,I,nt())).promise}}I=new WeakMap;class zi{_serviceOptions;_workflows;constructor(e){this._serviceOptions=e,this._workflows=new Map}createFeature(e,t){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const r=e.id;let i=this._workflows.get(r);if(i)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return i=new Di({map:e,ogcApiFeatureLayerUrl:t,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(r,i),this._connectToWorkflowDestroyEvent(i,r),i}updateFeature(e,t,r){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const i=e.id;let n=this._workflows.get(i);if(n)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return n=new Ri({map:e,ogcApiFeatureLayerUrl:t,feature:r,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(i,n),this._connectToWorkflowDestroyEvent(n,i),n}stop(e){const t=this._workflows.get(e);t&&t.stop()}reset(e){const t=this._workflows.get(e);if(t)t.reset();else throw new Error("No workflow found for mapId: "+e)}_connectToWorkflowDestroyEvent(e,t){e.on("destroyed",()=>{this._workflows.get(t)===e&&this._workflows.delete(t)})}}const Oi={"ol-map":{name:"ol-map",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:qr,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},AppModel:{name:"AppModel",clazz:xi,provides:[{name:"ol-app.AppModel",qualifier:void 0}],references:{ogcSearchSourceFactory:{name:"ogc-features.SearchSourceFactory",qualifier:void 0,all:!1},vectorSelectionSourceFactory:{name:"selection.VectorSelectionSourceFactory",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1},mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1},{name:"ol-app.AppModel",qualifier:void 0,all:!1},{name:"notifier.NotificationService",qualifier:void 0,all:!1},{name:"editing.EditingService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/coordinate-viewer":{name:"@open-pioneer/coordinate-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/experimental-layout-sidebar":{name:"@open-pioneer/experimental-layout-sidebar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/geolocation":{name:"@open-pioneer/geolocation",services:{},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:Jt,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/legend":{name:"@open-pioneer/legend",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:Zt,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/measurement":{name:"@open-pioneer/measurement",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:Pr,provides:[{name:"notifier.NotificationService",qualifier:"notifier.NotificationService"}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:Fr,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:Ar,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/overview-map":{name:"@open-pioneer/overview-map",services:{},ui:{references:[]},properties:{}},"@open-pioneer/printing":{name:"@open-pioneer/printing",services:{PrintingServiceImpl:{name:"PrintingServiceImpl",clazz:Ir,provides:[{name:"printing.PrintingService",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1},{name:"printing.PrintingService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/result-list":{name:"@open-pioneer/result-list",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-bar":{name:"@open-pioneer/scale-bar",services:{},ui:{references:[]},properties:{}},"@open-pioneer/scale-viewer":{name:"@open-pioneer/scale-viewer",services:{},ui:{references:[]},properties:{}},"@open-pioneer/search":{name:"@open-pioneer/search",services:{},ui:{references:[]},properties:{}},"@open-pioneer/selection":{name:"@open-pioneer/selection",services:{VectorSelectionSourceFactory:{name:"VectorSelectionSourceFactory",clazz:pr,provides:[{name:"selection.VectorSelectionSourceFactory",qualifier:void 0}],references:{}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/spatial-bookmarks":{name:"@open-pioneer/spatial-bookmarks",services:{},ui:{references:[{name:"local-storage.LocalStorageService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/local-storage":{name:"@open-pioneer/local-storage",services:{LocalStorageServiceImpl:{name:"LocalStorageServiceImpl",clazz:gr,provides:[{name:"local-storage.LocalStorageService",qualifier:"local-storage.LocalStorageService"}],references:{}}},ui:{references:[]},properties:{storageId:{value:null,required:!1}}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/editing":{name:"@open-pioneer/editing",services:{EditingServiceImpl:{name:"EditingServiceImpl",clazz:zi,provides:[{name:"editing.EditingService",qualifier:void 0}],references:{mapRegistry:{name:"map.MapRegistry",qualifier:void 0,all:!1},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{polygonStyle:{value:{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"red","stroke-width":1.25,"circle-radius":3,"circle-fill-color":"red","circle-stroke-width":1.25,"circle-stroke-color":"red"},required:!1},vertexStyle:{value:{"circle-radius":3,"circle-fill-color":"red","circle-stroke-width":1.25,"circle-stroke-color":"red"},required:!1}}}},Gi='.search-box{position:absolute;width:500px;max-width:100%;z-index:1}.spatial-bookmarks{max-height:300px}:root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.measurement-tooltip{position:relative;background:#fffc;border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.measurement-active-tooltip{background:#000000e6;border-radius:4px;border-color:#000000e6;opacity:.9;color:#fff}.measurement-finished-tooltip{background-color:#4cb3ffe6;color:#000;border:1px solid white}.measurement-active-tooltip:before,.measurement-finished-tooltip:before{border-top:6px solid rgba(0,0,0,.9);border-right:6px solid transparent;border-left:6px solid transparent;content:"";position:absolute;bottom:-6px;margin-left:-7px;left:50%}.measurement-finished-tooltip:before{border-top-color:#4cb3ff}.printing-overlay{position:absolute;top:0;right:0;bottom:0;left:0;z-index:10000;-webkit-user-select:none;user-select:none;pointer-events:all;cursor:wait;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#b4b4b4cc}.printing-overlay-status{flex:1 1 auto;font-size:1.5em;text-align:center}.printing-scale-bar.ol-scale-bar{left:var(--printing-scale-bar-left);bottom:var(--printing-scale-bar-bottom)}.search-component .chakra-divider{display:none}.search-component .search-highlighted-match{font-weight:700}.search-component .search-value-container{cursor:text;padding-left:30px!important}.search-component .search-invisible{display:none}.selection-drag-box{background-color:#ffffff4d!important;border:3px solid var(--chakra-colors-background_primary)!important}.selection-tooltip{position:relative;background:#fffc;border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.selection .react-select{cursor:default}.map-container .selection-active{cursor:crosshair}.map-container .selection-inactive{cursor:no-drop}.selection-source-value.selection-source-value--disabled{opacity:.4}.selection-source-value.selection-source-value--disabled span{margin:0 6px 0 0}.editing-tooltip{position:relative;background:#fffc;border-radius:4px;color:#000;padding:4px 8px;opacity:1;white-space:nowrap;font-size:12px;cursor:default;-webkit-user-select:none;user-select:none;font-weight:700}.editing-tooltip-hidden{visibility:hidden}.layout-sidebar{height:100%;position:absolute;top:0}.layout-sidebar[data-theme=light]{background-color:var(--chakra-colors-whiteAlpha-700)}.layout-sidebar[data-theme=dark]{background-color:var(--chakra-colors-blackAlpha-700)}.layout-sidebar .layout-sidebar-main{transition:width .3s ease-out 0s;border-right:1px solid var(--chakra-colors-chakra-border-color)}.layout-sidebar .layout-sidebar-content{overflow:auto;transition:width .3s ease-out 0s}.layout-sidebar .layout-sidebar-content .content-section .content-header{font-size:1.5em;background-color:var(--chakra-colors-blackAlpha-500);padding:.5rem 1rem}.layout-sidebar .layout-sidebar-content .content-section .content-body{padding:1rem}.overview-map .ol-overviewmap{position:relative;height:100%;width:100%}.overview-map .ol-overviewmap:not(.ol-collapsed){border:1px solid black}.overview-map .ol-overviewmap .ol-overviewmap-map{border:none;width:100%;height:100%}.overview-map .ol-overviewmap .ol-overviewmap-box{border:2px solid red}.result-list-no-data-message{text-align:center;margin-top:50px;font-weight:700;font-size:larger}.result-list-table th,.result-list-table td{overflow-wrap:break-word}.result-list-table.result-list-table--is-resizing *{cursor:col-resize}.result-list-table thead{position:sticky;top:0;z-index:1;background:var(--chakra-colors-background_body)}.result-list-table th{position:relative;border-right-width:thin}.result-list-table tbody tr:hover{background:var(--chakra-colors-background_light)}.result-list-table .result-list-resizer{position:absolute;top:0;height:100%;right:0;width:8px;background:var(--chakra-colors-trails-100);transform:scaleX(.25);cursor:col-resize;-webkit-user-select:none;user-select:none;touch-action:none;padding-left:0}.result-list-table th:last-child .result-list-resizer{width:8px;transform:translate(50%) scaleX(.25)}.result-list-table th .result-list-resizer.result-list-resizer--is-resizing{background:var(--chakra-colors-trails-500);transform:scale(1)}.result-list-table th .result-list-resizer:hover{transform:scale(1)}.scale-bar .ol-scale-bar{margin-bottom:8px;margin-right:8px}.scale-bar .ol-scale-bar,.scale-bar .ol-scale-line{position:relative;bottom:0;left:0;background:none}.scale-bar .ol-scale-bar .ol-scale-bar-inner,.scale-bar .ol-scale-bar .ol-scale-line-inner,.scale-bar .ol-scale-line .ol-scale-bar-inner,.scale-bar .ol-scale-line .ol-scale-line-inner{color:var(--chakra-white);border-color:var(--chakra-white)}',Vi=["en","de"];function Ni(o){switch(o){case"en":return $e(()=>import("./Dn42TbqYYI02.js"),[],import.meta.url).then(e=>e.default);case"de":return $e(()=>import("./CBVV-aBiBGWZ.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${o}'`)}const qi=Pt(Gi),Ui=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Ni,locales:Vi,packages:Oi,styles:qi},Symbol.toStringTag,{value:"Module"})),xt="ol-map",z=Xt.bind(void 0,xt),V=Qt.bind(void 0,xt);function Wi(){const o=k.useId(),e=V();return u.jsx(E,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(E,{role:"dialog","aria-labelledby":o,children:u.jsx(U,{title:u.jsx(W,{id:o,size:"md",mb:2,children:e.formatMessage({id:"spatialBookmarkTitle"})}),children:u.jsx(fr,{mapId:S})})})})}function Hi(){const o=k.useId(),e=V();return u.jsx(E,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",role:"dialog",width:350,children:u.jsx(E,{role:"dialog","aria-labelledby":o,children:u.jsx(U,{title:u.jsx(W,{id:o,size:"md",mb:2,children:e.formatMessage({id:"printingTitle"})}),children:u.jsx(mr,{mapId:S})})})})}function Bi(){const o=k.useId(),e=V();return u.jsx(E,{role:"dialog","aria-labelledby":o,children:u.jsx(U,{title:u.jsx(W,{id:o,size:"md",mb:2,children:e.formatMessage({id:"legendTitle"})}),children:u.jsx(E,{overflowY:"auto",maxHeight:300,children:u.jsx(vr,{mapId:S,showBaseLayers:!0})})})})}function Ki(o){return gt({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M6.5 9.5l1.546 -1.311"}},{tag:"path",attr:{d:"M14 5.5l3 1.5"}},{tag:"path",attr:{d:"M18.5 10l-1.185 3.318m-1.062 2.972l-.253 .71"}},{tag:"path",attr:{d:"M13.5 17.5l-7 -5"}},{tag:"path",attr:{d:"M3 3l18 18"}}]})(o)}function $i(o){return gt({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M12 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M19 8m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M5 11m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M15 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0"}},{tag:"path",attr:{d:"M6.5 9.5l3.5 -3"}},{tag:"path",attr:{d:"M14 5.5l3 1.5"}},{tag:"path",attr:{d:"M18.5 10l-2.5 7"}},{tag:"path",attr:{d:"M13.5 17.5l-7 -5"}}]})(o)}function Yi(o){const{toolState:e,onToolStateChange:t}=o,r=V(),i=z("ol-app.AppModel"),n=X(i.state).resultListState,a=n.open,l=z("editing.EditingService"),c=zr((s,d)=>{t(s,d??!e[s])});return u.jsxs(ve,{role:"toolbar","aria-label":r.formatMessage({id:"ariaLabel.toolbar"}),direction:"column",gap:1,padding:1,children:[u.jsx(P,{label:e.editingCreateActive?r.formatMessage({id:"editing.stopTitle"}):r.formatMessage({id:"editing.create.startTitle"}),icon:e.editingCreateActive?u.jsx(Ki,{}):u.jsx($i,{}),isActive:e.editingCreateActive,onClick:()=>c("editingCreateActive")}),u.jsx(P,{label:e.editingUpdateActive?r.formatMessage({id:"editing.stopTitle"}):r.formatMessage({id:"editing.update.startTitle"}),icon:e.editingUpdateActive?u.jsx(tr,{}):u.jsx(rr,{}),isActive:e.editingUpdateActive,onClick:()=>c("editingUpdateActive")}),u.jsx(P,{label:r.formatMessage({id:"editing.resetTitle"}),icon:u.jsx(ir,{}),onClick:()=>l.reset(S)}),n.input&&u.jsx(P,{label:r.formatMessage({id:"resultListTitle"}),icon:u.jsx(or,{}),isActive:n.open,onClick:()=>i.setResultListVisibility(!a)}),u.jsx(P,{label:r.formatMessage({id:"printingTitle"}),icon:u.jsx(nr,{}),isActive:e.printingActive,onClick:()=>c("printingActive")}),u.jsx(P,{label:r.formatMessage({id:"spatialBookmarkTitle"}),icon:u.jsx(sr,{}),isActive:e.bookmarksActive,onClick:()=>c("bookmarksActive")}),u.jsx(yr,{mapId:S}),u.jsx(P,{label:r.formatMessage({id:"tocTitle"}),icon:u.jsx(ar,{}),isActive:e.tocActive,onClick:()=>c("tocActive")}),u.jsx(P,{label:r.formatMessage({id:"legendTitle"}),icon:u.jsx(lr,{}),isActive:e.legendActive,onClick:()=>c("legendActive")}),u.jsx(P,{label:r.formatMessage({id:"measurementTitle"}),icon:u.jsx(cr,{}),isActive:e.measurementActive,onClick:()=>c("measurementActive")}),u.jsx(P,{label:r.formatMessage({id:"selectionTitle"}),icon:u.jsx(dr,{}),isActive:e.selectionActive,onClick:()=>c("selectionActive")}),u.jsx(P,{label:r.formatMessage({id:"overviewMapTitle"}),icon:u.jsx(ur,{}),isActive:e.overviewMapActive,onClick:()=>c("overviewMapActive")}),u.jsx(jr,{mapId:S}),u.jsx(Tr,{mapId:S}),u.jsx(Dr,{mapId:S})]})}function Ji(){const o=k.useId(),e=V();return u.jsx(E,{role:"dialog","aria-labelledby":o,children:u.jsx(U,{title:u.jsx(W,{id:o,size:"md",mb:2,children:e.formatMessage({id:"measurementTitle"})}),children:u.jsx(_r,{mapId:S})})})}function Zi(){const o=k.useMemo(()=>new st({source:new at}),[]);return u.jsx(E,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:325,children:u.jsx(E,{role:"dialog",children:u.jsx(br,{mapId:S,olLayer:o})})})}function Xi(){const o=z("ol-app.AppModel"),e=X(o.state).resultListState,[t,r]=k.useState([]),[i,n]=k.useState([]),a=k.useCallback(l=>{r(l.features),n(l.getFeatureIds())},[]);return k.useEffect(()=>{console.log("Anzahl Features: "+t.length),console.log("SelectedIds: "+i.toString())},[t,i]),e.input&&u.jsx(E,{className:"result-list-container",position:"absolute",visibility:e.open?"visible":"hidden",bottom:"0",backgroundColor:"white",width:"100%",height:"400px",zIndex:1,borderTop:"2px solid",borderBottom:"2px solid",borderColor:"trails.100",children:u.jsx(Or,{input:e.input,mapId:S,onSelectionChange:a},e.key)})}function Qi(){const{map:o}=De(S),e=z("ol-app.AppModel"),t=X(e.state).searchSources;function r(n){if(console.debug("The user selected the following item: ",n.result),!o)return;const a=n.result.geometry;a&&e.highlightAndZoom(o,[a])}function i(){console.debug("The user cleared the search"),e.clearPreviousHighlight()}return u.jsx(E,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",mt:5,className:"search-box",children:u.jsx(wr,{mapId:S,sources:t,maxResultsPerGroup:10,onSelect:r,onClear:i})})}function eo(){const o=V(),e=z("notifier.NotificationService"),t=k.useId(),{map:r}=De(S),i=z("ol-app.AppModel"),n=X(i.state).selectionSources,a=X(i.state).sourceMetadata,l={numberOptions:{maximumFractionDigits:3},dateOptions:{dateStyle:"medium",timeStyle:"medium",timeZone:"UTC"}};function c(d){const{source:h,results:g}=d;if(!r){console.debug("Map not ready");return}const p=a.get(h);if(!p){console.warn("Can not show results because no metadata could be found");return}i.setResultListInput({columns:p,data:g,formatOptions:l}),e.notify({level:"info",message:o.formatMessage({id:"foundResults"},{resultsCount:g.length}),displayDuration:4e3})}function s(d){i.clearPreviousHighlight()}return u.jsx(E,{role:"dialog","aria-labelledby":t,children:u.jsx(U,{title:u.jsx(W,{id:t,size:"md",mb:2,children:o.formatMessage({id:"selectionTitle"})}),children:u.jsx(Sr,{mapId:S,sources:n,onSelectionComplete:c,onSelectionSourceChanged:s})})})}function to(o){const e=k.useId(),t=V();return u.jsx(E,{role:"dialog","aria-labelledby":e,children:u.jsx(U,{title:u.jsx(W,{id:e,size:"md",mb:2,children:u.jsx(Gr,{children:t.formatMessage({id:"tocTitle"})})}),children:u.jsx(E,{overflowY:"auto",maxHeight:o.maxHeight,children:u.jsx(Lr,{mapId:S,showTools:!0,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})})})}const ro={bookmarksActive:!1,legendActive:!0,overviewMapActive:!0,tocActive:!0,printingActive:!1,editingCreateActive:!1,editingUpdateActive:!1};let ne=!1,K=!1,ye,J,le;function io(){const o=z("editing.EditingService"),e=z("notifier.NotificationService"),{map:t}=De(S),r=V(),i=z("ol-app.AppModel"),[n,a]=k.useState(),[l,c]=k.useState(ro),s={...l,measurementActive:n==="measurement",selectionActive:n==="selection"},d=(f,m)=>{if(f==="selectionActive"||f==="measurementActive"){let x;switch(f){case"measurementActive":x="measurement";break;case"selectionActive":x="selection";break}x!==n&&m?(a(x),i.clearPreviousHighlight()):x===n&&!m&&(a(void 0),i.clearPreviousHighlight())}else m&&(f==="editingCreateActive"&&s.editingUpdateActive||f==="editingUpdateActive"&&s.editingCreateActive)?e.notify({level:"warning",message:r.formatMessage({id:"editing.toggleNotAllowed"})}):c({...l,[f]:m})},h=X(i.state).resultListState,g=h.input&&h.open,p=[s.tocActive&&u.jsx(to,{maxHeight:s.legendActive||n?"300px":"75vh"},"toc"),s.legendActive&&u.jsx(Bi,{},"legend"),n==="selection"?u.jsx(eo,{},"selection"):n==="measurement"?u.jsx(Ji,{},"measurement"):void 0];return oo(t,o,e,r,c,l),no(t,o,e,r,c,l),u.jsxs(ve,{height:"100%",direction:"column",overflow:"hidden",children:[u.jsx(xr,{position:"top-right"}),u.jsxs(U,{title:u.jsx(E,{role:"region","aria-label":r.formatMessage({id:"ariaLabel.header"}),textAlign:"center",py:1,children:u.jsx(W,{size:"md",children:"OpenLayers Base Packages - Default Sample"})}),children:[u.jsx(ve,{flex:"1",direction:"column",position:"relative",children:u.jsxs(er,{mapId:S,role:"main","aria-label":r.formatMessage({id:"ariaLabel.map"}),viewPadding:g?{bottom:400}:void 0,children:[u.jsx(Vr,{centerContent:!0,children:u.jsx(Qi,{})}),u.jsx(te,{position:"top-left",horizontalGap:20,verticalGap:20,children:u.jsx(so,{children:p})}),u.jsx(te,{position:"top-right",horizontalGap:20,verticalGap:20,children:s.overviewMapActive&&u.jsx(Zi,{})}),u.jsx(te,{horizontalGap:20,position:"bottom-left",children:s.bookmarksActive&&u.jsx(Wi,{})}),u.jsx(te,{horizontalGap:20,position:"bottom-left",children:s.printingActive&&u.jsx(Hi,{})}),u.jsx(te,{position:"bottom-right",horizontalGap:10,verticalGap:45,children:u.jsx(Yi,{toolState:s,onToolStateChange:d})}),u.jsx(Xi,{})]})}),u.jsxs(ve,{role:"region","aria-label":r.formatMessage({id:"ariaLabel.footer"}),gap:3,alignItems:"center",justifyContent:"center",children:[u.jsx(kr,{mapId:S,precision:2,displayProjectionCode:"EPSG:4326"}),u.jsx(Er,{mapId:S}),u.jsx(Mr,{mapId:S})]})]})]})}function oo(o,e,t,r,i,n){k.useEffect(()=>{if(!o)return;n.editingCreateActive&&!ne&&!K?a():!n.editingCreateActive&&ne&&l();function a(){if(!o)throw Error("map is undefined");try{ne=!0;const c=o.layers.getLayerById("krankenhaus"),s=new URL(c.attributes.collectionURL+"/items");e.createFeature(o,s).whenComplete().then(h=>{if(!h)return;t.notify({level:"info",message:r.formatMessage({id:"editing.create.featureCreated"},{featureId:h.featureId})}),(c?.olLayer).getSource()?.refresh()}).catch(h=>{console.error(h)}).finally(()=>{i({...n,editingCreateActive:!1}),ne=!1})}catch(c){console.error(c)}}function l(){e.stop(S)}},[o,e,t,r,i,n])}function no(o,e,t,r,i,n){k.useEffect(()=>{if(!o)return;n.editingUpdateActive&&!ne&&!K?l():!n.editingUpdateActive&&K&&(it(o),c(),K=!1);function a(s){const d=document.createElement("div");d.className="editing-tooltip editing-tooltip-hidden",d.textContent=r.formatMessage({id:"editing.update.tooltip.select"});const h=new pt({element:d,offset:[15,0],positioning:"center-left"}),g=s.on("pointermove",p=>{p.dragging||h.setPosition(p.coordinate)});return s.addOverlay(h),{overlay:h,element:d,destroy(){de(g),s.removeOverlay(h)}}}function l(){if(!o)throw Error("map is undefined");K=!0,le=a(o.olMap);try{const s=o.layers.getLayerById("krankenhaus"),d=s?.olLayer;J=new Oe({layers:[d]}),o.olMap.addInteraction(J),le.element.classList.remove("editing-tooltip-hidden");const h=new URL(s.attributes.collectionURL+"/items");ye=J.on("select",g=>{const p=g.selected,f=g.deselected;if(p.length===1&&f.length===0){it(o);const m=p[0];if(!m)throw Error("feature is undefined");e.updateFeature(o,h,m).whenComplete().then(w=>{w&&(t.notify({level:"info",message:r.formatMessage({id:"editing.update.featureModified"},{featureId:w.featureId})}),d.getSource()?.refresh())}).catch(w=>{console.error(w)}).finally(()=>{i({...n,editingUpdateActive:!1}),K=!1})}})}catch(s){console.error(s)}}function c(){e.stop(S)}},[o,e,t,r,i,n])}function it(o){J&&o.olMap.removeInteraction(J),ye&&de(ye),le&&le.destroy(),J=void 0,ye=void 0,le=void 0}function so(o){const e=o.children,t=[];for(const r of e)r&&(t.length&&t.push(u.jsx(Nr,{mt:4,mb:4},t.length)),t.push(r));if(t.length!==0)return u.jsx(E,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",width:350,maxWidth:350,children:t})}const ao=It({component:io,theme:Ft,appMetadata:Ui,config:{properties:{"@open-pioneer/local-storage":{storageId:"ol-app-state"}}},async resolveConfig(o){const e=o.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ol-map-app",ao);const lo=document.getElementsByTagName("body")[0];co();function co(){const o=window.location.search,t=new URLSearchParams(o).get("lang"),r=document.createElement("ol-map-app");r.classList.add("full-height"),r.classList.add("app"),r.setAttribute("id","test"),t&&r.setAttribute("forced-locale",t),lo.appendChild(r)}
