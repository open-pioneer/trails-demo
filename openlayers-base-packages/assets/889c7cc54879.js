var te=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var u=(s,e,t)=>(te(s,e,"read from private field"),t?t.call(s):e.get(s)),g=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},d=(s,e,t,r)=>(te(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t);var H=(s,e,t)=>(te(s,e,"access private method"),t);import{a as De}from"./632b1064413a.js";import{bh as Fe,bs as Ce,aI as Ie,bt as le,aH as he,bu as ye,bv as m,aN as Ne,bw as Ge,bx as V,by as D,bz as ue,bA as Ue,bB as Ze,i as We,a0 as re,bC as pe,ax as be,bD as Ee,bE as Be,bF as ke,Y as $e,E as Re,X as Ye,bG as qe,bj as Xe,bH as Ke,bm as ge,ak as ze,bI as Y,bJ as Se,B as Qe,L as K,bK as Le,bL as de,bM as me,bN as Je,bO as et,bP as tt}from"./e45abcba95d2.js";import{b as ve}from"./4bbd07bbe4ca.js";import{E as st}from"./960f2965a833.js";import{G as x}from"./e6c16a5c3a19.js";function Ae(s,e){const t=(""+s).split("."),r=(""+e).split(".");for(let a=0;a<Math.max(t.length,r.length);a++){const i=parseInt(t[a]||"0",10),n=parseInt(r[a]||"0",10);if(i>n)return 1;if(n>i)return-1}return 0}class rt extends Fe{constructor(e){e=e||{},super(e)}}const at=rt;class it extends Ce{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,a=e.viewState,i=a.resolution,n=this.getLayer().getSource(),o=e.viewHints;let c=e.extent;if(t.extent!==void 0&&(c=Ie(c,le(t.extent,a.projection))),!o[he.ANIMATING]&&!o[he.INTERACTING]&&!ye(c))if(n){const h=a.projection,l=n.getImage(c,i,r,h);l&&(this.loadImage(l)?this.image_=l:l.getState()===m.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),a=Ne(t.pixelToCoordinateTransform,e.slice()),i=r.getExtent();if(i&&!Ge(i,a))return null;const n=this.image_.getExtent(),o=this.image_.getImage(),c=V(n),h=Math.floor(o.width*((a[0]-n[0])/c));if(h<0||h>=o.width)return null;const l=D(n),_=Math.floor(o.height*((n[3]-a[1])/l));return _<0||_>=o.height?null:this.getImageData(o,h,_)}renderFrame(e,t){const r=this.image_,a=r.getExtent(),i=r.getResolution(),[n,o]=Array.isArray(i)?i:[i,i],c=r.getPixelRatio(),h=e.layerStatesArray[e.layerIndex],l=e.pixelRatio,_=e.viewState,O=_.center,U=_.resolution,Z=l*n/(U*c),W=l*o/(U*c),b=e.extent,B=_.resolution,k=_.rotation,M=Math.round(V(b)/B*l),T=Math.round(D(b)/B*l);ue(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,k,-M/2,-T/2),Ue(this.inversePixelTransform,this.pixelTransform);const z=Ze(this.pixelTransform);this.useContainer(t,z,this.getBackground(e));const f=this.context,R=f.canvas;R.width!=M||R.height!=T?(R.width=M,R.height=T):this.containerReused||f.clearRect(0,0,M,T);let Q=!1,J=!0;if(h.extent){const P=le(h.extent,_.projection);J=We(P,e.extent),Q=J&&!re(P,e.extent),Q&&this.clipUnrotated(f,e,P)}const j=r.getImage(),$=ue(this.tempTransform,M/2,T/2,Z,W,0,c*(a[0]-O[0])/n,c*(O[1]-a[3])/o);this.renderedResolution=o*l/c;const ne=j.width*$[0],oe=j.height*$[3];if(this.getLayer().getSource().getInterpolate()||(f.imageSmoothingEnabled=!1),this.preRender(f,e),J&&ne>=.5&&oe>=.5){const P=$[4],Ve=$[5],ee=h.opacity;let ce;ee!==1&&(ce=f.globalAlpha,f.globalAlpha=ee),f.drawImage(j,0,0,+j.width,+j.height,P,Ve,ne,oe),ee!==1&&(f.globalAlpha=ce)}return this.postRender(f,e),Q&&f.restore(),f.imageSmoothingEnabled=!0,z!==R.style.transform&&(R.style.transform=z),this.container}}const nt=it;class ot extends at{constructor(e){super(e)}createRenderer(){return new nt(this)}getData(e){return super.getData(e)}}const ct=ot;function ae(s){return Array.isArray(s)?Math.min(...s):s}class lt extends pe{constructor(e,t,r,a,i,n,o){let c=e.getExtent();c&&e.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);let h=t.getExtent();h&&t.canWrapX()&&(h=h.slice(),h[0]=-1/0,h[2]=1/0);const l=h?Ie(r,h):r,_=be(l),O=Ee(e,t,_,a),U=qe,Z=new Be(e,t,l,c,O*U,a),W=Z.calculateSourceExtent(),b=ye(W)?null:n(W,O,i),B=b?m.IDLE:m.EMPTY,k=b?b.getPixelRatio():1;super(r,a,k,B),this.targetProj_=t,this.maxSourceExtent_=c,this.triangulation_=Z,this.targetResolution_=a,this.targetExtent_=r,this.sourceImage_=b,this.sourcePixelRatio_=k,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==m.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==m.LOADED){const t=V(this.targetExtent_)/this.targetResolution_,r=D(this.targetExtent_)/this.targetResolution_;this.canvas_=ke(t,r,this.sourcePixelRatio_,ae(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==m.IDLE){this.state=m.LOADING,this.changed();const e=this.sourceImage_.getState();e==m.LOADED||e==m.ERROR?this.reproject_():(this.sourceListenerKey_=$e(this.sourceImage_,Re.CHANGE,function(t){const r=this.sourceImage_.getState();(r==m.LOADED||r==m.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){Ye(this.sourceListenerKey_),this.sourceListenerKey_=null}}const ht=lt,p=4,se={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ut extends Qe{constructor(e,t){super(e),this.image=t}}class gt extends Xe{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const r=Ke(t,e,0);e=t[r]}return e}getImage(e,t,r,a){const i=this.getProjection();if(!i||!a||ge(i,a))return i&&(a=i),this.getImageInternal(e,t,r,a);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&ge(this.reprojectedImage_.getProjection(),a)&&this.reprojectedImage_.getResolution()==t&&ze(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new ht(i,a,e,t,r,(n,o,c)=>this.getImageInternal(n,o,c,i),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,r,a){if(this.loader){const i=we(e,t,r,1),n=this.findNearestResolution(t);if(this.image&&(this.static_||this.wantedProjection_===a&&(this.wantedExtent_&&re(this.wantedExtent_,i)||re(this.image.getExtent(),i))&&(this.wantedResolution_&&ae(this.wantedResolution_)===n||ae(this.image.getResolution())===n)))return this.image;this.wantedProjection_=a,this.wantedExtent_=i,this.wantedResolution_=n,this.image=new pe(i,n,r,this.loader),this.image.addEventListener(Re.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const t=e.target;let r;switch(t.getState()){case m.LOADING:this.loading=!0,r=se.IMAGELOADSTART;break;case m.LOADED:this.loading=!1,r=se.IMAGELOADEND;break;case m.ERROR:this.loading=!1,r=se.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new ut(r,t))}}function dt(s,e){s.getImage().src=e}function we(s,e,t,r){const a=e/t,i=be(s),n=Y(V(s)/a,p),o=Y(D(s)/a,p),c=Y((r-1)*n/2,p),h=n+2*c,l=Y((r-1)*o/2,p),_=o+2*l;return Se(i,a,0,[h,_])}const mt=gt,xe="1.3.0",_e=[101,101];function Oe(s,e,t,r,a){a.WIDTH=t[0],a.HEIGHT=t[1];const i=r.getAxisOrientation();let n;const o=Ae(a.VERSION,"1.3")>=0;return a[o?"CRS":"SRS"]=r.getCode(),o&&i.substr(0,2)=="ne"?n=[e[1],e[0],e[3],e[2]]:n=e,a.BBOX=n.join(","),ve(s,a)}function _t(s,e,t,r,a,i,n){i=Object.assign({REQUEST:"GetMap"},i);const o=e/t,c=[me(V(s)/o,p),me(D(s)/o,p)];if(t!=1)switch(n){case"geoserver":const l=90*t+.5|0;"FORMAT_OPTIONS"in i?i.FORMAT_OPTIONS+=";dpi:"+l:i.FORMAT_OPTIONS="dpi:"+l;break;case"mapserver":i.MAP_RESOLUTION=90*t;break;case"carmentaserver":case"qgis":i.DPI=90*t;break;default:throw new Error("Unknown `serverType` configured")}return Oe(a,s,c,r,i)}function Me(s,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:xe,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}function ft(s){const e=s.hidpi===void 0?!0:s.hidpi,t=K(s.projection||"EPSG:3857"),r=s.ratio||1.5,a=s.load||Le;return(i,n,o)=>{i=we(i,n,o,r),o!=1&&(!e||s.serverType===void 0)&&(o=1);const c=_t(i,n,o,t,s.url,Me(s.params,"GetMap"),s.serverType),h=new Image;return s.crossOrigin!==null&&(h.crossOrigin=s.crossOrigin),a(h,c).then(l=>({image:l,extent:i,pixelRatio:o}))}}function It(s,e,t){if(s.url===void 0)return;const r=K(s.projection||"EPSG:3857"),a=Se(e,t,0,_e),i={QUERY_LAYERS:s.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(i,Me(s.params,"GetFeatureInfo"),s.params);const n=de((e[0]-a[0])/t,p),o=de((a[3]-e[1])/t,p),c=Ae(i.VERSION,"1.3")>=0;return i[c?"I":"X"]=n,i[c?"J":"Y"]=o,Oe(s.url,a,_e,r,i)}function yt(s,e){if(s.url===void 0)return;const t={SERVICE:"WMS",VERSION:xe,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(s.params===void 0||s.params.LAYER===void 0){const r=s.params.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;t.LAYER=r}if(e!==void 0){const r=K(s.projection||"EPSG:3857").getMetersPerUnit()||1,a=28e-5;t.SCALE=e*r/a}return Object.assign(t,s.params),ve(s.url,t)}class pt extends mt{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:dt,this.params_=e.params,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,t,r,a){const i=K(r),n=this.getProjection();n&&n!==i&&(t=Ee(n,i,e,t),e=Je(e,i,n));const o={url:this.url_,params:{...this.params_,...a},projection:n||i};return It(o,e,t)}getLegendUrl(e,t){return yt({url:this.url_,params:{...this.params_,...t}},e)}getParams(){return this.params_}getImageInternal(e,t,r,a){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==a)&&(this.loaderProjection_=a,this.loader=ft({crossOrigin:this.crossOrigin_,params:this.params_,projection:a,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(i,n)=>(this.image.setImage(i),this.imageLoadFunction_(this.image,n),Le(i))})),super.getImageInternal(e,t,r,a))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const bt=pt;function Et(s){let e=!1,t=setTimeout(()=>{e=!0,t=void 0,s()});return{reschedule(){return!e},cancel(){t&&clearTimeout(t)}}}var I;class Te extends st{constructor(t){super();g(this,I,void 0);d(this,I,t)}destroy(){for(const t of u(this,I))t.destroy();d(this,I,[])}getSublayers(t){return u(this,I).slice()}__getRawSublayers(){return u(this,I)}}I=new WeakMap;const fe=De("map:WMSLayer");var F,S,L,v,A,C,ie,q,je,X,Pe;class Rt extends et{constructor(t){const r=new ct;super({...t,olLayer:r});g(this,C);g(this,q);g(this,X);g(this,F,void 0);g(this,S,void 0);g(this,L,void 0);g(this,v,void 0);g(this,A,void 0);const a=new bt({...t.sourceOptions,url:t.url,params:{...t.sourceOptions?.params},imageLoadFunction:(i,n)=>H(this,X,Pe).call(this,i,n).catch(o=>{fe.error(`Failed to load tile at '${n}'`,o)})});d(this,F,t.url),d(this,A,a),d(this,v,r),d(this,S,new Te(He(t.sublayers))),H(this,C,ie).call(this)}get url(){return u(this,F)}get sublayers(){return u(this,S)}__attach(t){super.__attach(t);for(const r of u(this,S).getSublayers())r.__attach(t,this,this)}__updateSublayerVisibility(){u(this,L)?.reschedule()||d(this,L,Et(()=>{try{H(this,C,ie).call(this),d(this,L,void 0)}catch(t){fe.error(`Failed to update sublayer visibility on WMS layer '${this.id}'.`,t)}}))}}F=new WeakMap,S=new WeakMap,L=new WeakMap,v=new WeakMap,A=new WeakMap,C=new WeakSet,ie=function(){const t=H(this,q,je).call(this);u(this,A).updateParams({LAYERS:t});const r=t.length===0?null:u(this,A);u(this,v).getSource()!==r&&u(this,v).setSource(r)},q=new WeakSet,je=function(){const t=[],r=a=>{if(!a.visible)return;const i=a.sublayers.__getRawSublayers();if(i.length)for(const n of i)r(n);else t.push(a.name)};for(const a of this.sublayers.__getRawSublayers())r(a);return t},X=new WeakSet,Pe=async function(t,r){const i=await this.map.__sharedDependencies.httpService.fetch(r);if(!i.ok)throw new Error(`Request failed with status ${i.status}.`);const n=await i.blob(),o=URL.createObjectURL(n),c=t.getImage();c.src=o,c.onload=()=>{URL.revokeObjectURL(o)}};var E,y,N,G,w;class St extends tt{constructor(t){super(t);g(this,E,void 0);g(this,y,void 0);g(this,N,void 0);g(this,G,void 0);g(this,w,void 0);d(this,N,t.name),d(this,w,t.visible??!0),d(this,G,new Te(He(t.sublayers)))}get name(){return u(this,N)}get sublayers(){return u(this,G)}get parent(){const t=u(this,E);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}get parentLayer(){const t=u(this,y);if(!t)throw new Error(`WMS sublayer ${this.id} has not been attached to its parent yet.`);return t}__attach(t,r,a){if(super.__attachToMap(t),u(this,E))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent '${u(this,E).id}'`);if(d(this,E,a),u(this,y))throw new Error(`WMS sublayer '${this.id}' has already been attached to parent layer '${u(this,y).id}'`);d(this,y,r);for(const i of this.sublayers.__getRawSublayers())i.__attach(t,r,this)}get visible(){return u(this,w)}setVisible(t){this.visible!==t&&(d(this,w,t),u(this,y)?.__updateSublayerVisibility(),this.__emitChangeEvent("changed:visible"))}}E=new WeakMap,y=new WeakMap,N=new WeakMap,G=new WeakMap,w=new WeakMap;function He(s=[]){const e=[];try{for(const t of s)e.push(new St(t));return e}catch(t){for(;e.length;)e.pop()?.destroy();throw new Error("Failed to construct sublayers.",{cause:t})}}const Mt=Rt;function Tt(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,56H60A20,20,0,0,0,40,76V228a12,12,0,0,0,19,9.76l49-35,49,35A12,12,0,0,0,176,228V76A20,20,0,0,0,156,56Zm-4,148.68-37-26.45a12,12,0,0,0-14,0L64,204.68V80h88ZM216,36V188a12,12,0,0,1-24,0V40H92a12,12,0,0,1,0-24H196A20,20,0,0,1,216,36Z"}}]})(s)}function jt(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,40a12,12,0,0,1-12,12H112a12,12,0,0,1,0-24h32A12,12,0,0,1,156,40ZM144,204H112a12,12,0,0,0,0,24h32a12,12,0,0,0,0-24ZM204,52V72a12,12,0,0,0,24,0V48a20,20,0,0,0-20-20H184a12,12,0,0,0,0,24Zm12,48a12,12,0,0,0-12,12v32a12,12,0,0,0,24,0V112A12,12,0,0,0,216,100ZM40,156a12,12,0,0,0,12-12V112a12,12,0,0,0-24,0v32A12,12,0,0,0,40,156Zm32,48H52V184a12,12,0,0,0-24,0v24a20,20,0,0,0,20,20H72a12,12,0,0,0,0-24ZM72,28H48A20,20,0,0,0,28,48V72a12,12,0,0,0,24,0V52H72a12,12,0,0,0,0-24ZM240,204H228V192a12,12,0,0,0-24,0v12H192a12,12,0,0,0,0,24h12v12a12,12,0,0,0,24,0V228h12a12,12,0,0,0,0-24Z"}}]})(s)}function Pt(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128ZM40,70H216a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12ZM216,186H40a6,6,0,0,0,0,12H216a6,6,0,0,0,0-12Z"}}]})(s)}function Ht(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M233.91,74.79,181.22,22.1a14,14,0,0,0-19.8,0L22.09,161.41a14,14,0,0,0,0,19.8L74.78,233.9a14,14,0,0,0,19.8,0L233.91,94.59A14,14,0,0,0,233.91,74.79ZM225.42,86.1,86.1,225.41h0a2,2,0,0,1-2.83,0L30.58,172.73a2,2,0,0,1,0-2.83L64,136.48l27.76,27.76a6,6,0,1,0,8.48-8.48L72.48,128,96,104.48l27.76,27.76a6,6,0,0,0,8.48-8.48L104.48,96,128,72.49l27.76,27.75a6,6,0,0,0,8.48-8.48L136.49,64,169.9,30.59a2,2,0,0,1,2.83,0l52.69,52.68A2,2,0,0,1,225.42,86.1Z"}}]})(s)}function Vt(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,50H40a6,6,0,0,0,0,12H50V208a14,14,0,0,0,14,14H192a14,14,0,0,0,14-14V62h10a6,6,0,0,0,0-12ZM194,208a2,2,0,0,1-2,2H64a2,2,0,0,1-2-2V62H194ZM82,24a6,6,0,0,1,6-6h80a6,6,0,0,1,0,12H88A6,6,0,0,1,82,24Z"}}]})(s)}function Dt(s){return x({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM104,52.94l48,24V203.06l-48-24ZM40,62.25l48-12v127.5l-48,12Zm176,131.5-48,12V78.25l48-12Z"}}]})(s)}export{Dt as P,Mt as W,Vt as a,Tt as b,Pt as c,Ht as d,jt as e};
