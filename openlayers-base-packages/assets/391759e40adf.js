import{bR as pt,u as yt,m as Ct,W as bt,bS as z,bT as Pt,bU as vt,au as _t,S as ce,bV as G,bW as jt,bX as xt,bY as wt,bZ as Ft,b_ as St,b$ as Gt,c0 as Mt,c1 as ue,a4 as Ot,c2 as Et,$ as se,c3 as kt,c4 as At,c5 as Lt,c6 as Rt,c7 as Nt,c8 as Tt,c9 as re,ca as It,cb as Bt,cc as Dt,cd as Oe,ce as Ht,a2 as ne,cf as Vt,cg as Ee,_ as ke,a as j,bw as p,bq as Yt,ch as $t,bi as Ae,ci as Xt,cj as Jt,aU as Ut,ck as O,aa as Le}from"./1b4899316e13.js";import{L as oe}from"./29d7f0536452.js";import{S as zt,H as Re,f as L,j as a,c as M,k as R,r as d,T as Kt,U as Wt,V as q,D as A,K as P,M as Zt,z as Qt,Q as qt,W as es,C as ts,X as ss,N as rs,F as ns,B as Ne,Y as Te}from"./3c75eb6dca66.js";import{B as os}from"./7fb34ca20623.js";import{c as is,u as as,T as we,S as Fe}from"./29276a06a447.js";import{u as ls}from"./c8563f515675.js";import{F as cs,d as Ie}from"./279b8b7adcbe.js";import{u as us,a as ds,b as hs,l as fs,M as gs}from"./d874786889e6.js";import{T as ie}from"./8d3619b1618e.js";import{L as ms}from"./a15d5a084848.js";import{B as $}from"./5821444c040b.js";import{F as ae}from"./e32f2adefa8f.js";import{C as ps}from"./729f6a123e98.js";import{S as Be}from"./41f0f45560dd.js";import{M as ys,a as Cs,b as bs}from"./75c5289c2316.js";function Ps(r){return"current"in r}var De=()=>typeof window<"u";function vs(){var r;const e=navigator.userAgentData;return(r=e?.platform)!=null?r:navigator.platform}var _s=r=>De()&&r.test(navigator.vendor),js=r=>De()&&r.test(vs()),xs=()=>js(/mac|iphone|ipad|ipod/i),ws=()=>xs()&&_s(/apple/i);function Fs(r){const{ref:e,elements:t,enabled:s}=r,n=()=>{var o,i;return(i=(o=e.current)==null?void 0:o.ownerDocument)!=null?i:document};zt(n,"pointerdown",o=>{if(!ws()||!s)return;const i=o.target,c=(t??[e]).some(u=>{const h=Ps(u)?u.current:u;return h?.contains(i)||h===i});n().activeElement!==i&&c&&(o.preventDefault(),i.focus())})}var[Ss,w]=Re({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Gs,N]=Re({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),He=L(function(e,t){const{getHeaderProps:s}=w(),n=N();return a.jsx(M.header,{...s(e,t),className:R("chakra-popover__header",e.className),__css:n.header})});He.displayName="PopoverHeader";function Ve(r){const e=d.Children.only(r.children),{getTriggerProps:t}=w();return d.cloneElement(e,t(e.props,e.ref))}Ve.displayName="PopoverTrigger";var S={click:"click",hover:"hover"};function Ms(r={}){const{closeOnBlur:e=!0,closeOnEsc:t=!0,initialFocusRef:s,id:n,returnFocusOnClose:o=!0,autoFocus:i=!0,arrowSize:l,arrowShadowColor:c,trigger:u=S.click,openDelay:h=200,closeDelay:g=200,isLazy:C,lazyBehavior:E="unmount",computePositionOnMount:et,...tt}=r,{isOpen:y,onClose:v,onOpen:K,onToggle:pe}=Kt(r),W=d.useRef(null),T=d.useRef(null),F=d.useRef(null),k=d.useRef(!1),ye=d.useRef(!1);y&&(ye.current=!0);const[Ce,st]=d.useState(!1),[be,rt]=d.useState(!1),nt=d.useId(),ot=n??nt,[Pe,I,B,D]=["popover-trigger","popover-content","popover-header","popover-body"].map(f=>`${f}-${ot}`),{referenceRef:H,getArrowProps:it,getPopperProps:ve,getArrowInnerProps:at,forceUpdate:lt}=Wt({...tt,enabled:y||!!et}),_e=us({isOpen:y,ref:F});Fs({enabled:y,ref:T}),ds(F,{focusRef:T,visible:y,shouldFocus:o&&u===S.click}),hs(F,{focusRef:s,visible:y,shouldFocus:i&&u===S.click});const je=fs({wasSelected:ye.current,enabled:C,mode:E,isSelected:_e.present}),ct=d.useCallback((f={},b=null)=>{const m={...f,style:{...f.style,transformOrigin:q.transformOrigin.varRef,[q.arrowSize.var]:l?`${l}px`:void 0,[q.arrowShadowColor.var]:c},ref:A(F,b),children:je?f.children:null,id:I,tabIndex:-1,role:"dialog",onKeyDown:P(f.onKeyDown,_=>{t&&_.key==="Escape"&&v()}),onBlur:P(f.onBlur,_=>{const V=Se(_),Q=ee(F.current,V),mt=ee(T.current,V);y&&e&&(!Q&&!mt)&&v()}),"aria-labelledby":Ce?B:void 0,"aria-describedby":be?D:void 0};return u===S.hover&&(m.role="tooltip",m.onMouseEnter=P(f.onMouseEnter,()=>{k.current=!0}),m.onMouseLeave=P(f.onMouseLeave,_=>{_.nativeEvent.relatedTarget!==null&&(k.current=!1,setTimeout(()=>v(),g))})),m},[je,I,Ce,B,be,D,u,t,v,y,e,g,c,l]),ut=d.useCallback((f={},b=null)=>ve({...f,style:{visibility:y?"visible":"hidden",...f.style}},b),[y,ve]),dt=d.useCallback((f,b=null)=>({...f,ref:A(b,W,H)}),[W,H]),x=d.useRef(),Z=d.useRef(),xe=d.useCallback(f=>{W.current==null&&H(f)},[H]),ht=d.useCallback((f={},b=null)=>{const m={...f,ref:A(T,b,xe),id:Pe,"aria-haspopup":"dialog","aria-expanded":y,"aria-controls":I};return u===S.click&&(m.onClick=P(f.onClick,pe)),u===S.hover&&(m.onFocus=P(f.onFocus,()=>{x.current===void 0&&K()}),m.onBlur=P(f.onBlur,_=>{const V=Se(_),Q=!ee(F.current,V);y&&e&&Q&&v()}),m.onKeyDown=P(f.onKeyDown,_=>{_.key==="Escape"&&v()}),m.onMouseEnter=P(f.onMouseEnter,()=>{k.current=!0,x.current=window.setTimeout(()=>K(),h)}),m.onMouseLeave=P(f.onMouseLeave,()=>{k.current=!1,x.current&&(clearTimeout(x.current),x.current=void 0),Z.current=window.setTimeout(()=>{k.current===!1&&v()},g)})),m},[Pe,y,I,u,xe,pe,K,e,v,h,g]);d.useEffect(()=>()=>{x.current&&clearTimeout(x.current),Z.current&&clearTimeout(Z.current)},[]);const ft=d.useCallback((f={},b=null)=>({...f,id:B,ref:A(b,m=>{st(!!m)})}),[B]),gt=d.useCallback((f={},b=null)=>({...f,id:D,ref:A(b,m=>{rt(!!m)})}),[D]);return{forceUpdate:lt,isOpen:y,onAnimationComplete:_e.onComplete,onClose:v,getAnchorProps:dt,getArrowProps:it,getArrowInnerProps:at,getPopoverPositionerProps:ut,getPopoverProps:ct,getTriggerProps:ht,getHeaderProps:ft,getBodyProps:gt}}function ee(r,e){return r===e||r?.contains(e)}function Se(r){var e;const t=r.currentTarget.ownerDocument.activeElement;return(e=r.relatedTarget)!=null?e:t}function Ye(r){const e=Zt("Popover",r),{children:t,...s}=Qt(r),n=qt(),o=Ms({...s,direction:n.direction});return a.jsx(Ss,{value:o,children:a.jsx(Gs,{value:e,children:es(t,{isOpen:o.isOpen,onClose:o.onClose,forceUpdate:o.forceUpdate})})})}Ye.displayName="Popover";var te=(r,e)=>e?`${r}.${e}, ${e}`:void 0;function $e(r){var e;const{bg:t,bgColor:s,backgroundColor:n,shadow:o,boxShadow:i,shadowColor:l}=r,{getArrowProps:c,getArrowInnerProps:u}=w(),h=N(),g=(e=t??s)!=null?e:n,C=o??i;return a.jsx(M.div,{...c(),className:"chakra-popover__arrow-positioner",children:a.jsx(M.div,{className:R("chakra-popover__arrow",r.className),...u(r),__css:{"--popper-arrow-shadow-color":te("colors",l),"--popper-arrow-bg":te("colors",g),"--popper-arrow-shadow":te("shadows",C),...h.arrow}})})}$e.displayName="PopoverArrow";var Xe=L(function(e,t){const{getBodyProps:s}=w(),n=N();return a.jsx(M.div,{...s(e,t),className:R("chakra-popover__body",e.className),__css:n.body})});Xe.displayName="PopoverBody";var Je=L(function(e,t){const{onClose:s}=w(),n=N();return a.jsx(ts,{size:"sm",onClick:s,className:R("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:t,...e})});Je.displayName="PopoverCloseButton";function Os(r){if(r)return{enter:{...r.enter,visibility:"visible"},exit:{...r.exit,transitionEnd:{visibility:"hidden"}}}}var Es={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},ks=M(ss.section),Ue=L(function(e,t){const{variants:s=Es,...n}=e,{isOpen:o}=w();return a.jsx(ks,{ref:t,variants:Os(s),initial:!1,animate:o?"enter":"exit",...n})});Ue.displayName="PopoverTransition";var ze=L(function(e,t){const{rootProps:s,motionProps:n,...o}=e,{getPopoverProps:i,getPopoverPositionerProps:l,onAnimationComplete:c}=w(),u=N(),h={position:"relative",display:"flex",flexDirection:"column",...u.content};return a.jsx(M.div,{...l(s),__css:u.popper,className:"chakra-popover__popper",children:a.jsx(Ue,{...n,...i(o,t),onAnimationComplete:rs(c,o.onAnimationComplete),className:R("chakra-popover__content",e.className),__css:h})})});ze.displayName="PopoverContent";class X extends pt{constructor(e){super(),this.geometries_=e||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(yt),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(Ct(this.geometries_[e],bt.CHANGE,this.changed,this))}clone(){const e=new X(null);return e.setGeometries(this.geometries_),e.applyProperties(this),e}closestPointXY(e,t,s,n){if(n<z(this.getExtent(),e,t))return n;const o=this.geometries_;for(let i=0,l=o.length;i<l;++i)n=o[i].closestPointXY(e,t,s,n);return n}containsXY(e,t){const s=this.geometries_;for(let n=0,o=s.length;n<o;++n)if(s[n].containsXY(e,t))return!0;return!1}computeExtent(e){Pt(e);const t=this.geometries_;for(let s=0,n=t.length;s<n;++s)vt(e,t[s].getExtent());return e}getGeometries(){return Ge(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const t=this.geometries_;for(let s=0,n=t.length;s<n;++s)t[s].getType()===this.getType()?e=e.concat(t[s].getGeometriesArrayRecursive()):e.push(t[s]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=[],s=this.geometries_;let n=!1;for(let o=0,i=s.length;o<i;++o){const l=s[o],c=l.getSimplifiedGeometry(e);t.push(c),c!==l&&(n=!0)}if(n){const o=new X(null);return o.setGeometriesArray(t),o}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this}getType(){return"GeometryCollection"}intersectsExtent(e){const t=this.geometries_;for(let s=0,n=t.length;s<n;++s)if(t[s].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){const s=this.geometries_;for(let n=0,o=s.length;n<o;++n)s[n].rotate(e,t);this.changed()}scale(e,t,s){s||(s=_t(this.getExtent()));const n=this.geometries_;for(let o=0,i=n.length;o<i;++o)n[o].scale(e,t,s);this.changed()}setGeometries(e){this.setGeometriesArray(Ge(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const t=this.geometries_;for(let s=0,n=t.length;s<n;++s)t[s].applyTransform(e);this.changed()}translate(e,t){const s=this.geometries_;for(let n=0,o=s.length;n<o;++n)s[n].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Ge(r){const e=[];for(let t=0,s=r.length;t<s;++t)e.push(r[t].clone());return e}const As=X;class J extends ce{constructor(e,t,s){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&s)this.setFlatCoordinates(t,e),this.ends_=s;else{const n=e,o=[],i=[];for(let c=0,u=n.length;c<u;++c){const h=n[c];G(o,h.getFlatCoordinates()),i.push(o.length)}const l=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(l,o),this.ends_=i}}appendLineString(e){G(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new J(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,s,n){return n<z(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jt(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xt(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,s,n))}getCoordinateAtM(e,t,s){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,s=s!==void 0?s:!1,wt(this.flatCoordinates,0,this.ends_,this.stride,e,t,s))}getCoordinates(){return Ft(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new oe(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,t=this.ends_,s=this.layout,n=[];let o=0;for(let i=0,l=t.length;i<l;++i){const c=t[i],u=new oe(e.slice(o,c),s);n.push(u),o=c}return n}getFlatMidpoints(){const e=[],t=this.flatCoordinates;let s=0;const n=this.ends_,o=this.stride;for(let i=0,l=n.length;i<l;++i){const c=n[i],u=St(t,s,c,o,.5);G(e,u),s=c}return e}getSimplifiedGeometryInternal(e){const t=[],s=[];return t.length=Gt(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,s),new J(t,"XY",s)}getType(){return"MultiLineString"}intersectsExtent(e){return Mt(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const s=ue(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=s.length===0?0:s[s.length-1],this.changed()}}const Ls=J;class de extends ce{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){G(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new de(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,s,n){if(n<z(this.getExtent(),e,t))return n;const o=this.flatCoordinates,i=this.stride;for(let l=0,c=o.length;l<c;l+=i){const u=Ot(e,t,o[l],o[l+1]);if(u<n){n=u;for(let h=0;h<i;++h)s[h]=o[l+h];s.length=i}}return n}getCoordinates(){return Et(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new se(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,t=this.layout,s=this.stride,n=[];for(let o=0,i=e.length;o<i;o+=s){const l=new se(e.slice(o,o+s),t);n.push(l)}return n}getType(){return"MultiPoint"}intersectsExtent(e){const t=this.flatCoordinates,s=this.stride;for(let n=0,o=t.length;n<o;n+=s){const i=t[n],l=t[n+1];if(kt(e,i,l))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=At(this.flatCoordinates,0,e,this.stride),this.changed()}}const Ke=de;class U extends ce{constructor(e,t,s){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!s&&!Array.isArray(e[0])){const n=e,o=[],i=[];for(let l=0,c=n.length;l<c;++l){const u=n[l],h=o.length,g=u.getEnds();for(let C=0,E=g.length;C<E;++C)g[C]+=h;G(o,u.getFlatCoordinates()),i.push(g)}t=n.length===0?this.getLayout():n[0].getLayout(),e=o,s=i}t!==void 0&&s?(this.setFlatCoordinates(t,e),this.endss_=s):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{const s=this.flatCoordinates.length;G(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let n=0,o=t.length;n<o;++n)t[n]+=s}this.endss_.push(t),this.changed()}clone(){const e=this.endss_.length,t=new Array(e);for(let n=0;n<e;++n)t[n]=this.endss_[n].slice();const s=new U(this.flatCoordinates.slice(),this.layout,t);return s.applyProperties(this),s}closestPointXY(e,t,s,n){return n<z(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Lt(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Rt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,s,n))}containsXY(e,t){return Nt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return Tt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),re(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,It(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=Bt(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Dt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ke(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Oe(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=re(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],s=[];return t.length=Ht(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,s),new U(t,"XY",s)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{const o=this.endss_[e-1];t=o[o.length-1]}const s=this.endss_[e].slice(),n=s[s.length-1];if(t!==0)for(let o=0,i=s.length;o<i;++o)s[o]-=t;return new ne(this.flatCoordinates.slice(t,n),this.layout,s)}getPolygons(){const e=this.layout,t=this.flatCoordinates,s=this.endss_,n=[];let o=0;for(let i=0,l=s.length;i<l;++i){const c=s[i].slice(),u=c[c.length-1];if(o!==0)for(let g=0,C=c.length;g<C;++g)c[g]-=o;const h=new ne(t.slice(o,u),e,c);n.push(h),o=u}return n}getType(){return"MultiPolygon"}intersectsExtent(e){return Vt(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const s=Ee(this.flatCoordinates,0,e,this.stride,this.endss_);if(s.length===0)this.flatCoordinates.length=0;else{const n=s[s.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}const Rs=U;class Ns{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=ke,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let s=t.dataProjection?j(t.dataProjection):this.readProjection(e);t.extent&&s&&s.getUnits()==="tile-pixels"&&(s=j(s),s.setWorldExtent(t.extent)),t={dataProjection:s,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return p()}readFeature(e,t){return p()}readFeatures(e,t){return p()}readGeometry(e,t){return p()}readProjection(e){return p()}writeFeature(e,t){return p()}writeFeatures(e,t){return p()}writeGeometry(e,t){return p()}}const Ts=Ns;function he(r,e,t){const s=t?j(t.featureProjection):null,n=t?j(t.dataProjection):null;let o=r;if(s&&n&&!Yt(s,n)){e&&(o=r.clone());const i=e?s:n,l=e?n:s;i.getUnits()==="tile-pixels"?o.transform(i,l):o.applyTransform($t(i,l))}if(e&&t&&t.decimals!==void 0){const i=Math.pow(10,t.decimals),l=function(c){for(let u=0,h=c.length;u<h;++u)c[u]=Math.round(c[u]*i)/i;return c};o===r&&(o=r.clone()),o.applyTransform(l)}return o}const Is={Point:se,LineString:oe,Polygon:ne,MultiPoint:Ke,MultiLineString:Ls,MultiPolygon:Rs};function Bs(r,e,t){return Array.isArray(e[0])?(Oe(r,0,e,t)||(r=r.slice(),re(r,0,e,t)),r):(Xt(r,0,e,t)||(r=r.slice(),Jt(r,0,e,t)),r)}function We(r,e){const t=r.geometry;if(!t)return[];if(Array.isArray(t))return t.map(o=>We({...r,geometry:o})).flat();const s=t.type==="MultiPolygon"?"Polygon":t.type;if(s==="GeometryCollection"||s==="Circle")throw new Error("Unsupported geometry type: "+s);const n=t.layout.length;return he(new Ae(s,s==="Polygon"?Bs(t.flatCoordinates,t.ends,n):t.flatCoordinates,t.ends?.flat(),n,r.properties||{},r.id).enableSimplifyTransformed(),!1,e)}function fe(r,e){if(!r)return null;if(Array.isArray(r)){const s=r.map(n=>fe(n,e));return new As(s)}const t=Is[r.type];return he(new t(r.flatCoordinates,r.layout,r.ends),!1,e)}class Ds extends Ts{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Y(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Y(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return p()}readFeaturesFromObject(e,t){return p()}readGeometry(e,t){return this.readGeometryFromObject(Y(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return p()}readProjection(e){return this.readProjectionFromObject(Y(e))}readProjectionFromObject(e){return p()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return p()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return p()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return p()}}function Y(r){if(typeof r=="string"){const e=JSON.parse(r);return e||null}return r!==null?r:null}const Hs=Ds;class Vs extends Hs{constructor(e){e=e||{},super(),this.dataProjection=j(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=j(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let s=null;e.type==="Feature"?s=e:s={type:"Feature",geometry:e,properties:null};const n=ge(s.geometry);if(this.featureClass===Ae)return We({geometry:n,id:s.id,properties:s.properties},t);const o=new ke;return this.geometryName_?o.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in s!==void 0&&o.setGeometryName(s.geometry_name),o.setGeometry(fe(n,t)),"id"in s&&o.setId(s.id),s.properties&&o.setProperties(s.properties,!0),o}readFeaturesFromObject(e,t){const s=e;let n=null;if(s.type==="FeatureCollection"){const o=e;n=[];const i=o.features;for(let l=0,c=i.length;l<c;++l){const u=this.readFeatureFromObject(i[l],t);u&&n.push(u)}}else n=[this.readFeatureFromObject(e,t)];return n.flat()}readGeometryFromObject(e,t){return Ys(e,t)}readProjectionFromObject(e){const t=e.crs;let s;if(t)if(t.type=="name")s=j(t.properties.name);else if(t.type==="EPSG")s=j("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else s=this.dataProjection;return s}writeFeatureObject(e,t){t=this.adaptOptions(t);const s={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(s.id=n),!e.hasProperties())return s;const o=e.getProperties(),i=e.getGeometry();return i&&(s.geometry=le(i,t),delete o[e.getGeometryName()]),Ut(o)||(s.properties=o),s}writeFeaturesObject(e,t){t=this.adaptOptions(t);const s=[];for(let n=0,o=e.length;n<o;++n)s.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:s}}writeGeometryObject(e,t){return le(e,this.adaptOptions(t))}}function ge(r,e){if(!r)return null;let t;switch(r.type){case"Point":{t=Xs(r);break}case"LineString":{t=Js(r);break}case"Polygon":{t=Ws(r);break}case"MultiPoint":{t=zs(r);break}case"MultiLineString":{t=Us(r);break}case"MultiPolygon":{t=Ks(r);break}case"GeometryCollection":{t=$s(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return t}function Ys(r,e){const t=ge(r);return fe(t,e)}function $s(r,e){return r.geometries.map(function(s){return ge(s)})}function Xs(r){const e=r.coordinates;return{type:"Point",flatCoordinates:e,layout:O(e.length)}}function Js(r){const e=r.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:O(e[0].length)}}function Us(r){const e=r.coordinates,t=e[0][0].length,s=[],n=ue(s,0,e,t);return{type:"MultiLineString",flatCoordinates:s,ends:n,layout:O(t)}}function zs(r){const e=r.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:O(e[0].length)}}function Ks(r){const e=r.coordinates,t=[],s=e[0][0][0].length,n=Ee(t,0,e,s);return{type:"MultiPolygon",flatCoordinates:t,ends:n,layout:O(s)}}function Ws(r){const e=r.coordinates,t=[],s=e[0][0].length,n=ue(t,0,e,s);return{type:"Polygon",flatCoordinates:t,ends:n,layout:O(s)}}function le(r,e){r=he(r,!0,e);const t=r.getType();let s;switch(t){case"Point":{s=sr(r);break}case"LineString":{s=Qs(r);break}case"Polygon":{s=rr(r,e);break}case"MultiPoint":{s=er(r);break}case"MultiLineString":{s=qs(r);break}case"MultiPolygon":{s=tr(r,e);break}case"GeometryCollection":{s=Zs(r,e);break}case"Circle":{s={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return s}function Zs(r,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(s){return le(s,e)})}}function Qs(r,e){return{type:"LineString",coordinates:r.getCoordinates()}}function qs(r,e){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function er(r,e){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function tr(r,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(t)}}function sr(r,e){return{type:"Point",coordinates:r.getCoordinates()}}function rr(r,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(t)}}const kr=Vs,nr="@open-pioneer/toc",me=ls.bind(void 0,nr);function or(r){const{map:e,"aria-labelledby":t}=r,s=me(),n=dr(e);return n.length?Ze(n,s,{"aria-labelledby":t}):a.jsx(ie,{className:"toc-missing-layers","aria-labelledby":t,children:s.formatMessage({id:"missingLayers"})})}function Ze(r,e,t){const s=r.map(n=>a.jsx(ir,{layer:n,intl:e},n.id));return a.jsx(ms,{as:"ul",className:"toc-layer-list",listStyleType:"none",...t,children:s})}function ir(r){const{layer:e,intl:t}=r,s=cr(e),{isVisible:n,setVisible:o}=ur(e),i=hr(e),l=Qe(e)!=="error",c=t.formatMessage({id:"layerNotAvailable"});let u;return i?.length&&(u=Ze(i,t,{ml:4})),a.jsxs($,{as:"li",className:is("toc-layer-item",`layer-${fr(e.id)}`),children:[a.jsxs(ae,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[a.jsx(ps,{"aria-label":s+(l?"":" "+c),isChecked:n,isDisabled:!l,onChange:h=>o(h.target.checked),children:s}),!l&&a.jsx(ns,{className:"toc-layer-item-content-tooltip",label:c,placement:"right",openDelay:500,children:a.jsx("span",{children:a.jsx(cs,{className:"toc-layer-item-content-icon",color:"red","aria-label":c})})}),a.jsx(Be,{}),e.description&&a.jsx(ar,{layer:e,title:s,intl:t})]}),u]})}function ar(r){const{layer:e,title:t,intl:s}=r,n=s.formatMessage({id:"descriptionLabel"}),o=lr(e),i=Qe(e)!=="error";return a.jsxs(Ye,{placement:"bottom-start",children:[a.jsx(Ve,{children:a.jsx(Ne,{isDisabled:!i,className:"toc-layer-item-details-button","aria-label":n,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:a.jsx(Ie,{})})}),a.jsx(Te,{children:a.jsxs(ze,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[a.jsx($e,{}),a.jsx(Je,{mt:1}),a.jsx(He,{children:t}),a.jsx(Xe,{children:o})]})})]})}function lr(r){const e=d.useCallback(()=>r.description,[r]),t=d.useCallback(s=>{const n=r.on("changed:description",s);return()=>n.destroy()},[r]);return d.useSyncExternalStore(t,e)}function cr(r){const e=d.useCallback(()=>r.title,[r]),t=d.useCallback(s=>{const n=r.on("changed:title",s);return()=>n.destroy()},[r]);return d.useSyncExternalStore(t,e)}function ur(r){const e=d.useCallback(()=>r.visible,[r]),t=d.useCallback(o=>{const i=r.on("changed:visible",o);return()=>i.destroy()},[r]),s=d.useSyncExternalStore(t,e),n=d.useCallback(o=>{r.setVisible(o)},[r]);return{isVisible:s,setVisible:n}}function dr(r){const e=d.useCallback(s=>{const n=r.layers.on("changed",s);return()=>n.destroy()},[r]),t=d.useCallback(()=>{let s=r.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return s=s.reverse(),s},[r]);return qe(e,t)}function hr(r){const e=d.useCallback(s=>{const n=r.sublayers?.on("changed",s);return()=>n?.destroy()},[r]),t=d.useCallback(()=>{if(!r.sublayers)return;let n=r.sublayers?.getSublayers({sortByDisplayOrder:!0});return n=n.reverse(),n},[r]);return qe(e,t)}function Qe(r){const e="parentLayer"in r?r.parentLayer:r,t=d.useCallback(n=>{const o=e.on("changed:loadState",n);return()=>o.destroy()},[e]),s=d.useCallback(()=>e.loadState,[e]);return d.useSyncExternalStore(t,s)}function qe(r,e){const t=d.useRef(),s=d.useCallback(o=>{const i=r(()=>{t.current=void 0,o()});return()=>{t.current=void 0,i()}},[r]),n=d.useCallback(()=>{if(t.current)return t.current.value;const o=e();return t.current={value:o},o},[e]);return d.useSyncExternalStore(s,n)}function fr(r){return r.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}const gr=r=>{const e=me(),{mapId:t,showHideAllLayers:s=!0}=r,{map:n}=Le(t);return!!s&&a.jsx($,{className:"toc-tools",children:a.jsxs(gs,{placement:"bottom-start",children:[a.jsx(ys,{as:Ne,className:"toc-tools-button","aria-label":e.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:a.jsx(Ie,{})}),a.jsx(Te,{children:a.jsx(Cs,{className:"tools-menu",children:a.jsx(bs,{"aria-label":e.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{mr(n)},children:e.formatMessage({id:"tools.hideAllLayers"})})})})]})})};function mr(r){const e=t=>{t?.getSublayers().forEach(s=>{s.setVisible(!1),e(s?.sublayers)})};r?.layers.getOperationalLayers().forEach(t=>{t.setVisible(!1),e(t?.sublayers)})}const Me=2,Ar=r=>{const e=me(),{mapId:t,showTools:s=!1,toolsConfig:n,showBasemapSwitcher:o=!0,basemapSwitcherProps:i}=r,{containerProps:l}=as("toc",r),c=d.useId(),u=d.useId(),h=Le(t);let g;switch(h.kind){case"loading":g=null;break;case"rejected":g=a.jsx(ie,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const C=o&&a.jsx($,{className:"toc-basemap-switcher",children:a.jsx(we,{title:a.jsx(Fe,{id:c,size:"sm",mb:Me,children:e.formatMessage({id:"basemapsLabel"})}),children:a.jsx(os,{mapId:t,"aria-labelledby":c,...i})})}),E=a.jsx($,{className:"toc-operational-layers",children:a.jsx(we,{title:a.jsx(Fe,{id:u,size:"sm",mb:2,children:a.jsxs(ae,{children:[a.jsx(ie,{my:3,children:e.formatMessage({id:"operationalLayerLabel"})}),a.jsx(Be,{}),s&&a.jsx(gr,{mapId:t,...n})]})}),children:a.jsx(or,{map:h.map,"aria-labelledby":u})})});g=a.jsxs(a.Fragment,{children:[C,E]});break}}return a.jsx(ae,{...l,direction:"column",gap:Me,children:g})};export{Ts as F,kr as G,Ke as M,Ar as T,Ls as a,Rs as b,As as c,he as t};
