import{r as l,j as u}from"./c4a29752c861.js";import{aw as B}from"./f0e91bcc9c61.js";import{u as L}from"./d485cd197377.js";import{u as h}from"./b5dfa77580c2.js";import{B as g}from"./12fdd0c6beeb.js";import{S as v}from"./55d2a46316db.js";const S="@open-pioneer/basemap-switcher",_=h.bind(void 0,S),m="___NO_BASEMAP___",P=e=>{const a=_(),{mapId:i,allowSelectingEmptyBasemap:r,"aria-label":n,"aria-labelledby":s}=e,{containerProps:o}=L("basemap-switcher",e),p=a.formatMessage({id:"emptyBasemapLabel"}),{map:c}=B(i),b=x(c),{selectOptions:d,selectedId:f}=l.useMemo(()=>E({baseLayers:b,allowSelectingEmptyBasemap:r,emptyBasemapLabel:p}),[b,r,p]),y=t=>{c?.layers.activateBaseLayer(t===m?void 0:t)};return u.jsx(g,{...o,children:c?u.jsx(v,{"aria-label":n,"aria-labelledby":s,className:"basemap-switcher-select",value:f,onChange:t=>y(t.target.value),children:d.map(t=>u.jsx("option",{value:t.id,children:t.label},t.id))}):""})};function x(e){const a=l.useRef(),i=l.useCallback(n=>{if(a.current=void 0,!e)return()=>{};const s=e.layers.on("changed",()=>{a.current=void 0,n()});return()=>s.destroy()},[e]),r=l.useCallback(()=>a.current?a.current:a.current=e?.layers.getBaseLayers()??[],[e]);return l.useSyncExternalStore(i,r)}function E(e){const{baseLayers:a=[],allowSelectingEmptyBasemap:i=!1,emptyBasemapLabel:r}=e,n=a.map(o=>({id:o.id,label:o.title}));let s=a.find(o=>o.visible)?.id;return(i||s==null)&&n.push(w(r)),s==null&&(s=m),{selectOptions:n,selectedId:s}}function w(e){return{id:m,label:e}}export{P as B};
